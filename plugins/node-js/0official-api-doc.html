<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>official-api-doc.html</title>
	<style>
.alt pre {
    font-size: 14px;
    margin-left: 0px;
    border-left: 2px solid #DADAD7;
    background-color: #F4F4F2;
    color: #46483E;
    padding: 1em 1.5em;
    line-height: 2em;
}

pre>code {
	argin-left: 0px;
    border-left: 2px solid #DADAD7;
	background-color: #FFF5EE;
}

.sh_sourceCode {
  font-weight: normal;
  font-style: normal;
}

.sh_sourceCode .sh_symbol,
.sh_sourceCode .sh_cbracket {
  color: #333;
}

.sh_sourceCode .sh_keyword {
  color: #c96;
}

.sh_sourceCode .sh_string,
.sh_sourceCode .sh_regexp,
.sh_sourceCode .sh_number,
.sh_sourceCode .sh_specialchar {
  color: #690;
}

.sh_sourceCode .sh_comment {
  color: #666;
}

	</style>
</head>
<body>
source url: https://nodejs.org/api/all.html <p></p>

<div id="content-wrap">
<div id="content" class="clearfix">
<div id="column1" class="interior">
<div id="toc">
<h2>Table of Contents</h2>
<ul>
<li><a href="#all_about_this_documentation">About this Documentation</a>
<ul>
<li><a href="#all_stability_index">Stability Index</a></li>
<li><a href="#all_json_output">JSON Output</a></li>
</ul>
</li>
<li><a href="#all_synopsis">Synopsis</a></li>
<li><a href="#all_global_objects">Global Objects</a>
<ul>
<li><a href="#all_global">global</a></li>
<li><a href="#all_process">process</a></li>
<li><a href="#all_console">console</a></li>
<li><a href="#all_class_buffer">Class: Buffer</a></li>
<li><a href="#all_require">require()</a>
<ul>
<li><a href="#all_require_resolve">require.resolve()</a></li>
<li><a href="#all_require_cache">require.cache</a></li>
<li><a href="#all_require_extensions">require.extensions</a></li>
</ul>
</li>
<li><a href="#all_filename">__filename</a></li>
<li><a href="#all_dirname">__dirname</a></li>
<li><a href="#all_module">module</a></li>
<li><a href="#all_exports">exports</a></li>
<li><a href="#all_settimeout_cb_ms">setTimeout(cb, ms)</a></li>
<li><a href="#all_cleartimeout_t">clearTimeout(t)</a></li>
<li><a href="#all_setinterval_cb_ms">setInterval(cb, ms)</a></li>
<li><a href="#all_clearinterval_t">clearInterval(t)</a></li>
</ul>
</li>
<li><a href="#all_console_1">console</a>
<ul>
<li><a href="#all_console_log_data">console.log([data][, ...])</a></li>
<li><a href="#all_console_info_data">console.info([data][, ...])</a></li>
<li><a href="#all_console_error_data">console.error([data][, ...])</a></li>
<li><a href="#all_console_warn_data">console.warn([data][, ...])</a></li>
<li><a href="#all_console_dir_obj_options">console.dir(obj[, options])</a></li>
<li><a href="#all_console_time_label">console.time(label)</a></li>
<li><a href="#all_console_timeend_label">console.timeEnd(label)</a></li>
<li><a href="#all_console_trace_message">console.trace(message[, ...])</a></li>
<li><a href="#all_console_assert_value_message">console.assert(value[, message][, ...])</a></li>
</ul>
</li>
<li><a href="#all_timers">Timers</a>
<ul>
<li><a href="#all_settimeout_callback_delay_arg">setTimeout(callback, delay[, arg][, ...])</a></li>
<li><a href="#all_cleartimeout_timeoutobject">clearTimeout(timeoutObject)</a></li>
<li><a href="#all_setinterval_callback_delay_arg">setInterval(callback, delay[, arg][, ...])</a></li>
<li><a href="#all_clearinterval_intervalobject">clearInterval(intervalObject)</a></li>
<li><a href="#all_unref">unref()</a></li>
<li><a href="#all_ref">ref()</a></li>
<li><a href="#all_setimmediate_callback_arg">setImmediate(callback[, arg][, ...])</a></li>
<li><a href="#all_clearimmediate_immediateobject">clearImmediate(immediateObject)</a></li>
</ul>
</li>
<li><a href="#all_modules">Modules</a>
<ul>
<li><a href="#all_cycles">Cycles</a></li>
<li><a href="#all_core_modules">Core Modules</a></li>
<li><a href="#all_file_modules">File Modules</a></li>
<li><a href="#all_loading_from_node_modules_folders">Loading from <code>node_modules</code> Folders</a></li>
<li><a href="#all_folders_as_modules">Folders as Modules</a></li>
<li><a href="#all_caching">Caching</a>
<ul>
<li><a href="#all_module_caching_caveats">Module Caching Caveats</a></li>
</ul>
</li>
<li><a href="#all_the_module_object">The <code>module</code> Object</a>
<ul>
<li><a href="#all_module_exports">module.exports</a>
<ul>
<li><a href="#all_exports_alias">exports alias</a></li>
</ul>
</li>
<li><a href="#all_module_require_id">module.require(id)</a></li>
<li><a href="#all_module_id">module.id</a></li>
<li><a href="#all_module_filename">module.filename</a></li>
<li><a href="#all_module_loaded">module.loaded</a></li>
<li><a href="#all_module_parent">module.parent</a></li>
<li><a href="#all_module_children">module.children</a></li>
</ul>
</li>
<li><a href="#all_all_together">All Together...</a></li>
<li><a href="#all_loading_from_the_global_folders">Loading from the global folders</a></li>
<li><a href="#all_accessing_the_main_module">Accessing the main module</a></li>
<li><a href="#all_addenda_package_manager_tips">Addenda: Package Manager Tips</a></li>
</ul>
</li>
<li><a href="#all_addons">Addons</a>
<ul>
<li><a href="#all_hello_world">Hello world</a></li>
<li><a href="#all_addon_patterns">Addon patterns</a>
<ul>
<li><a href="#all_function_arguments">Function arguments</a></li>
<li><a href="#all_callbacks">Callbacks</a></li>
<li><a href="#all_object_factory">Object factory</a></li>
<li><a href="#all_function_factory">Function factory</a></li>
<li><a href="#all_wrapping_c_objects">Wrapping C++ objects</a></li>
<li><a href="#all_factory_of_wrapped_objects">Factory of wrapped objects</a></li>
<li><a href="#all_passing_wrapped_objects_around">Passing wrapped objects around</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_process_1">process</a>
<ul>
<li><a href="#all_exit_codes">Exit Codes</a></li>
<li><a href="#all_event_exit">Event: 'exit'</a></li>
<li><a href="#all_event_beforeexit">Event: 'beforeExit'</a></li>
<li><a href="#all_event_uncaughtexception">Event: 'uncaughtException'</a></li>
<li><a href="#all_signal_events">Signal Events</a></li>
<li><a href="#all_process_stdout">process.stdout</a></li>
<li><a href="#all_process_stderr">process.stderr</a></li>
<li><a href="#all_process_stdin">process.stdin</a></li>
<li><a href="#all_process_argv">process.argv</a></li>
<li><a href="#all_process_execpath">process.execPath</a></li>
<li><a href="#all_process_execargv">process.execArgv</a></li>
<li><a href="#all_process_abort">process.abort()</a></li>
<li><a href="#all_process_chdir_directory">process.chdir(directory)</a></li>
<li><a href="#all_process_cwd">process.cwd()</a></li>
<li><a href="#all_process_env">process.env</a></li>
<li><a href="#all_process_exit_code">process.exit([code])</a></li>
<li><a href="#all_process_exitcode">process.exitCode</a></li>
<li><a href="#all_process_getgid">process.getgid()</a></li>
<li><a href="#all_process_setgid_id">process.setgid(id)</a></li>
<li><a href="#all_process_getuid">process.getuid()</a></li>
<li><a href="#all_process_setuid_id">process.setuid(id)</a></li>
<li><a href="#all_process_getgroups">process.getgroups()</a></li>
<li><a href="#all_process_setgroups_groups">process.setgroups(groups)</a></li>
<li><a href="#all_process_initgroups_user_extra_group">process.initgroups(user, extra_group)</a></li>
<li><a href="#all_process_version">process.version</a></li>
<li><a href="#all_process_versions">process.versions</a></li>
<li><a href="#all_process_config">process.config</a></li>
<li><a href="#all_process_kill_pid_signal">process.kill(pid[, signal])</a></li>
<li><a href="#all_process_pid">process.pid</a></li>
<li><a href="#all_process_title">process.title</a></li>
<li><a href="#all_process_arch">process.arch</a></li>
<li><a href="#all_process_platform">process.platform</a></li>
<li><a href="#all_process_memoryusage">process.memoryUsage()</a></li>
<li><a href="#all_process_nexttick_callback">process.nextTick(callback)</a></li>
<li><a href="#all_process_umask_mask">process.umask([mask])</a></li>
<li><a href="#all_process_uptime">process.uptime()</a></li>
<li><a href="#all_process_hrtime">process.hrtime()</a></li>
<li><a href="#all_process_mainmodule">process.mainModule</a></li>
</ul>
</li>
<li><a href="#all_util">util</a>
<ul>
<li><a href="#all_util_debuglog_section">util.debuglog(section)</a></li>
<li><a href="#all_util_format_format">util.format(format[, ...])</a></li>
<li><a href="#all_util_log_string">util.log(string)</a></li>
<li><a href="#all_util_inspect_object_options">util.inspect(object[, options])</a>
<ul>
<li><a href="#all_customizing_util_inspect_colors">Customizing <code>util.inspect</code> colors</a></li>
<li><a href="#all_custom_inspect_function_on_objects">Custom <code>inspect()</code> function on Objects</a></li>
</ul>
</li>
<li><a href="#all_util_isarray_object">util.isArray(object)</a></li>
<li><a href="#all_util_isregexp_object">util.isRegExp(object)</a></li>
<li><a href="#all_util_isdate_object">util.isDate(object)</a></li>
<li><a href="#all_util_iserror_object">util.isError(object)</a></li>
<li><a href="#all_util_inherits_constructor_superconstructor">util.inherits(constructor, superConstructor)</a></li>
<li><a href="#all_util_deprecate_function_string">util.deprecate(function, string)</a></li>
<li><a href="#all_util_debug_string">util.debug(string)</a></li>
<li><a href="#all_util_error">util.error([...])</a></li>
<li><a href="#all_util_puts">util.puts([...])</a></li>
<li><a href="#all_util_print">util.print([...])</a></li>
<li><a href="#all_util_pump_readablestream_writablestream_callback">util.pump(readableStream, writableStream[, callback])</a></li>
</ul>
</li>
<li><a href="#all_events">Events</a>
<ul>
<li><a href="#all_class_events_eventemitter">Class: events.EventEmitter</a>
<ul>
<li><a href="#all_emitter_addlistener_event_listener">emitter.addListener(event, listener)</a></li>
<li><a href="#all_emitter_on_event_listener">emitter.on(event, listener)</a></li>
<li><a href="#all_emitter_once_event_listener">emitter.once(event, listener)</a></li>
<li><a href="#all_emitter_removelistener_event_listener">emitter.removeListener(event, listener)</a></li>
<li><a href="#all_emitter_removealllisteners_event">emitter.removeAllListeners([event])</a></li>
<li><a href="#all_emitter_setmaxlisteners_n">emitter.setMaxListeners(n)</a></li>
<li><a href="#all_eventemitter_defaultmaxlisteners">EventEmitter.defaultMaxListeners</a></li>
<li><a href="#all_emitter_listeners_event">emitter.listeners(event)</a></li>
<li><a href="#all_emitter_emit_event_arg1_arg2">emitter.emit(event[, arg1][, arg2][, ...])</a></li>
<li><a href="#all_class_method_eventemitter_listenercount_emitter_event">Class Method: EventEmitter.listenerCount(emitter, event)</a></li>
<li><a href="#all_event_newlistener">Event: 'newListener'</a></li>
<li><a href="#all_event_removelistener">Event: 'removeListener'</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_domain">Domain</a>
<ul>
<li><a href="#all_warning_don_t_ignore_errors">Warning: Don't Ignore Errors!</a></li>
<li><a href="#all_additions_to_error_objects">Additions to Error objects</a></li>
<li><a href="#all_implicit_binding">Implicit Binding</a></li>
<li><a href="#all_explicit_binding">Explicit Binding</a></li>
<li><a href="#all_domain_create">domain.create()</a></li>
<li><a href="#all_class_domain">Class: Domain</a>
<ul>
<li><a href="#all_domain_run_fn">domain.run(fn)</a></li>
<li><a href="#all_domain_members">domain.members</a></li>
<li><a href="#all_domain_add_emitter">domain.add(emitter)</a></li>
<li><a href="#all_domain_remove_emitter">domain.remove(emitter)</a></li>
<li><a href="#all_domain_bind_callback">domain.bind(callback)</a>
<ul>
<li><a href="#all_example">Example</a></li>
</ul>
</li>
<li><a href="#all_domain_intercept_callback">domain.intercept(callback)</a>
<ul>
<li><a href="#all_example_1">Example</a></li>
</ul>
</li>
<li><a href="#all_domain_enter">domain.enter()</a></li>
<li><a href="#all_domain_exit">domain.exit()</a></li>
<li><a href="#all_domain_dispose">domain.dispose()</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_buffer">Buffer</a>
<ul>
<li><a href="#all_class_buffer_1">Class: Buffer</a>
<ul>
<li><a href="#all_new_buffer_size">new Buffer(size)</a></li>
<li><a href="#all_new_buffer_array">new Buffer(array)</a></li>
<li><a href="#all_new_buffer_buffer">new Buffer(buffer)</a></li>
<li><a href="#all_new_buffer_str_encoding">new Buffer(str[, encoding])</a></li>
<li><a href="#all_class_method_buffer_isencoding_encoding">Class Method: Buffer.isEncoding(encoding)</a></li>
<li><a href="#all_class_method_buffer_isbuffer_obj">Class Method: Buffer.isBuffer(obj)</a></li>
<li><a href="#all_class_method_buffer_bytelength_string_encoding">Class Method: Buffer.byteLength(string[, encoding])</a></li>
<li><a href="#all_class_method_buffer_concat_list_totallength">Class Method: Buffer.concat(list[, totalLength])</a></li>
<li><a href="#all_class_method_buffer_compare_buf1_buf2">Class Method: Buffer.compare(buf1, buf2)</a></li>
<li><a href="#all_buf_length">buf.length</a></li>
<li><a href="#all_buf_write_string_offset_length_encoding">buf.write(string[, offset][, length][, encoding])</a></li>
<li><a href="#all_buf_writeuintle_value_offset_bytelength_noassert">buf.writeUIntLE(value, offset, byteLength[, noAssert])</a></li>
<li><a href="#all_buf_writeuintbe_value_offset_bytelength_noassert">buf.writeUIntBE(value, offset, byteLength[, noAssert])</a></li>
<li><a href="#all_buf_writeintle_value_offset_bytelength_noassert">buf.writeIntLE(value, offset, byteLength[, noAssert])</a></li>
<li><a href="#all_buf_writeintbe_value_offset_bytelength_noassert">buf.writeIntBE(value, offset, byteLength[, noAssert])</a></li>
<li><a href="#all_buf_readuintle_offset_bytelength_noassert">buf.readUIntLE(offset, byteLength[, noAssert])</a></li>
<li><a href="#all_buf_readuintbe_offset_bytelength_noassert">buf.readUIntBE(offset, byteLength[, noAssert])</a></li>
<li><a href="#all_buf_readintle_offset_bytelength_noassert">buf.readIntLE(offset, byteLength[, noAssert])</a></li>
<li><a href="#all_buf_readintbe_offset_bytelength_noassert">buf.readIntBE(offset, byteLength[, noAssert])</a></li>
<li><a href="#all_buf_tostring_encoding_start_end">buf.toString([encoding][, start][, end])</a></li>
<li><a href="#all_buf_tojson">buf.toJSON()</a></li>
<li><a href="#all_buf_index">buf[index]</a></li>
<li><a href="#all_buf_equals_otherbuffer">buf.equals(otherBuffer)</a></li>
<li><a href="#all_buf_compare_otherbuffer">buf.compare(otherBuffer)</a></li>
<li><a href="#all_buf_copy_targetbuffer_targetstart_sourcestart_sourceend">buf.copy(targetBuffer[, targetStart][, sourceStart][, sourceEnd])</a></li>
<li><a href="#all_buf_slice_start_end">buf.slice([start][, end])</a></li>
<li><a href="#all_buf_readuint8_offset_noassert">buf.readUInt8(offset[, noAssert])</a></li>
<li><a href="#all_buf_readuint16le_offset_noassert">buf.readUInt16LE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readuint16be_offset_noassert">buf.readUInt16BE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readuint32le_offset_noassert">buf.readUInt32LE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readuint32be_offset_noassert">buf.readUInt32BE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readint8_offset_noassert">buf.readInt8(offset[, noAssert])</a></li>
<li><a href="#all_buf_readint16le_offset_noassert">buf.readInt16LE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readint16be_offset_noassert">buf.readInt16BE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readint32le_offset_noassert">buf.readInt32LE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readint32be_offset_noassert">buf.readInt32BE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readfloatle_offset_noassert">buf.readFloatLE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readfloatbe_offset_noassert">buf.readFloatBE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readdoublele_offset_noassert">buf.readDoubleLE(offset[, noAssert])</a></li>
<li><a href="#all_buf_readdoublebe_offset_noassert">buf.readDoubleBE(offset[, noAssert])</a></li>
<li><a href="#all_buf_writeuint8_value_offset_noassert">buf.writeUInt8(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeuint16le_value_offset_noassert">buf.writeUInt16LE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeuint16be_value_offset_noassert">buf.writeUInt16BE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeuint32le_value_offset_noassert">buf.writeUInt32LE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeuint32be_value_offset_noassert">buf.writeUInt32BE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeint8_value_offset_noassert">buf.writeInt8(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeint16le_value_offset_noassert">buf.writeInt16LE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeint16be_value_offset_noassert">buf.writeInt16BE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeint32le_value_offset_noassert">buf.writeInt32LE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writeint32be_value_offset_noassert">buf.writeInt32BE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writefloatle_value_offset_noassert">buf.writeFloatLE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writefloatbe_value_offset_noassert">buf.writeFloatBE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writedoublele_value_offset_noassert">buf.writeDoubleLE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_writedoublebe_value_offset_noassert">buf.writeDoubleBE(value, offset[, noAssert])</a></li>
<li><a href="#all_buf_fill_value_offset_end">buf.fill(value[, offset][, end])</a></li>
</ul>
</li>
<li><a href="#all_buffer_inspect_max_bytes">buffer.INSPECT_MAX_BYTES</a></li>
<li><a href="#all_class_slowbuffer">Class: SlowBuffer</a></li>
</ul>
</li>
<li><a href="#all_stream">Stream</a>
<ul>
<li><a href="#all_api_for_stream_consumers">API for Stream Consumers</a>
<ul>
<li><a href="#all_class_stream_readable">Class: stream.Readable</a>
<ul>
<li><a href="#all_event_readable">Event: 'readable'</a></li>
<li><a href="#all_event_data">Event: 'data'</a></li>
<li><a href="#all_event_end">Event: 'end'</a></li>
<li><a href="#all_event_close">Event: 'close'</a></li>
<li><a href="#all_event_error">Event: 'error'</a></li>
<li><a href="#all_readable_read_size">readable.read([size])</a></li>
<li><a href="#all_readable_setencoding_encoding">readable.setEncoding(encoding)</a></li>
<li><a href="#all_readable_resume">readable.resume()</a></li>
<li><a href="#all_readable_pause">readable.pause()</a></li>
<li><a href="#all_readable_ispaused">readable.isPaused()</a></li>
<li><a href="#all_readable_pipe_destination_options">readable.pipe(destination[, options])</a></li>
<li><a href="#all_readable_unpipe_destination">readable.unpipe([destination])</a></li>
<li><a href="#all_readable_unshift_chunk">readable.unshift(chunk)</a></li>
<li><a href="#all_readable_wrap_stream">readable.wrap(stream)</a></li>
</ul>
</li>
<li><a href="#all_class_stream_writable">Class: stream.Writable</a>
<ul>
<li><a href="#all_writable_write_chunk_encoding_callback">writable.write(chunk[, encoding][, callback])</a></li>
<li><a href="#all_event_drain">Event: 'drain'</a></li>
<li><a href="#all_writable_cork">writable.cork()</a></li>
<li><a href="#all_writable_uncork">writable.uncork()</a></li>
<li><a href="#all_writable_setdefaultencoding_encoding">writable.setDefaultEncoding(encoding)</a></li>
<li><a href="#all_writable_end_chunk_encoding_callback">writable.end([chunk][, encoding][, callback])</a></li>
<li><a href="#all_event_finish">Event: 'finish'</a></li>
<li><a href="#all_event_pipe">Event: 'pipe'</a></li>
<li><a href="#all_event_unpipe">Event: 'unpipe'</a></li>
<li><a href="#all_event_error_1">Event: 'error'</a></li>
</ul>
</li>
<li><a href="#all_class_stream_duplex">Class: stream.Duplex</a></li>
<li><a href="#all_class_stream_transform">Class: stream.Transform</a></li>
</ul>
</li>
<li><a href="#all_api_for_stream_implementors">API for Stream Implementors</a>
<ul>
<li><a href="#all_class_stream_readable_1">Class: stream.Readable</a>
<ul>
<li><a href="#all_example_a_counting_stream">Example: A Counting Stream</a></li>
<li><a href="#all_example_simpleprotocol_v1_sub_optimal">Example: SimpleProtocol v1 (Sub-optimal)</a></li>
<li><a href="#all_new_stream_readable_options">new stream.Readable([options])</a></li>
<li><a href="#all_readable_read_size_1">readable._read(size)</a></li>
<li><a href="#all_readable_push_chunk_encoding">readable.push(chunk[, encoding])</a></li>
</ul>
</li>
<li><a href="#all_class_stream_writable_1">Class: stream.Writable</a>
<ul>
<li><a href="#all_new_stream_writable_options">new stream.Writable([options])</a></li>
<li><a href="#all_writable_write_chunk_encoding_callback_1">writable._write(chunk, encoding, callback)</a></li>
</ul>
</li>
<li><a href="#all_writable_writev_chunks_callback">writable._writev(chunks, callback)</a></li>
<li><a href="#all_class_stream_duplex_1">Class: stream.Duplex</a>
<ul>
<li><a href="#all_new_stream_duplex_options">new stream.Duplex(options)</a></li>
</ul>
</li>
<li><a href="#all_class_stream_transform_1">Class: stream.Transform</a>
<ul>
<li><a href="#all_new_stream_transform_options">new stream.Transform([options])</a></li>
<li><a href="#all_transform_transform_chunk_encoding_callback">transform._transform(chunk, encoding, callback)</a></li>
<li><a href="#all_transform_flush_callback">transform._flush(callback)</a></li>
<li><a href="#all_events_finish_and_end">Events: 'finish' and 'end'</a></li>
<li><a href="#all_example_simpleprotocol_parser_v2">Example: <code>SimpleProtocol</code> parser v2</a></li>
</ul>
</li>
<li><a href="#all_class_stream_passthrough">Class: stream.PassThrough</a></li>
</ul>
</li>
<li><a href="#all_streams_under_the_hood">Streams: Under the Hood</a>
<ul>
<li><a href="#all_buffering">Buffering</a></li>
<li><a href="#all_stream_read_0"><code>stream.read(0)</code></a></li>
<li><a href="#all_stream_push"><code>stream.push('')</code></a></li>
<li><a href="#all_compatibility_with_older_node_versions">Compatibility with Older Node Versions</a></li>
<li><a href="#all_object_mode">Object Mode</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_crypto">Crypto</a>
<ul>
<li><a href="#all_crypto_setengine_engine_flags">crypto.setEngine(engine[, flags])</a></li>
<li><a href="#all_crypto_getciphers">crypto.getCiphers()</a></li>
<li><a href="#all_crypto_gethashes">crypto.getHashes()</a></li>
<li><a href="#all_crypto_createcredentials_details">crypto.createCredentials(details)</a></li>
<li><a href="#all_crypto_createhash_algorithm">crypto.createHash(algorithm)</a></li>
<li><a href="#all_class_hash">Class: Hash</a>
<ul>
<li><a href="#all_hash_update_data_input_encoding">hash.update(data[, input_encoding])</a></li>
<li><a href="#all_hash_digest_encoding">hash.digest([encoding])</a></li>
</ul>
</li>
<li><a href="#all_crypto_createhmac_algorithm_key">crypto.createHmac(algorithm, key)</a></li>
<li><a href="#all_class_hmac">Class: Hmac</a>
<ul>
<li><a href="#all_hmac_update_data">hmac.update(data)</a></li>
<li><a href="#all_hmac_digest_encoding">hmac.digest([encoding])</a></li>
</ul>
</li>
<li><a href="#all_crypto_createcipher_algorithm_password">crypto.createCipher(algorithm, password)</a></li>
<li><a href="#all_crypto_createcipheriv_algorithm_key_iv">crypto.createCipheriv(algorithm, key, iv)</a></li>
<li><a href="#all_class_cipher">Class: Cipher</a>
<ul>
<li><a href="#all_cipher_update_data_input_encoding_output_encoding">cipher.update(data[, input_encoding][, output_encoding])</a></li>
<li><a href="#all_cipher_final_output_encoding">cipher.final([output_encoding])</a></li>
<li><a href="#all_cipher_setautopadding_auto_padding_true">cipher.setAutoPadding(auto_padding=true)</a></li>
<li><a href="#all_cipher_getauthtag">cipher.getAuthTag()</a></li>
<li><a href="#all_cipher_setaad_buffer">cipher.setAAD(buffer)</a></li>
</ul>
</li>
<li><a href="#all_crypto_createdecipher_algorithm_password">crypto.createDecipher(algorithm, password)</a></li>
<li><a href="#all_crypto_createdecipheriv_algorithm_key_iv">crypto.createDecipheriv(algorithm, key, iv)</a></li>
<li><a href="#all_class_decipher">Class: Decipher</a>
<ul>
<li><a href="#all_decipher_update_data_input_encoding_output_encoding">decipher.update(data[, input_encoding][, output_encoding])</a></li>
<li><a href="#all_decipher_final_output_encoding">decipher.final([output_encoding])</a></li>
<li><a href="#all_decipher_setautopadding_auto_padding_true">decipher.setAutoPadding(auto_padding=true)</a></li>
<li><a href="#all_decipher_setauthtag_buffer">decipher.setAuthTag(buffer)</a></li>
<li><a href="#all_decipher_setaad_buffer">decipher.setAAD(buffer)</a></li>
</ul>
</li>
<li><a href="#all_crypto_createsign_algorithm">crypto.createSign(algorithm)</a></li>
<li><a href="#all_class_sign">Class: Sign</a>
<ul>
<li><a href="#all_sign_update_data">sign.update(data)</a></li>
<li><a href="#all_sign_sign_private_key_output_format">sign.sign(private_key[, output_format])</a></li>
</ul>
</li>
<li><a href="#all_crypto_createverify_algorithm">crypto.createVerify(algorithm)</a></li>
<li><a href="#all_class_verify">Class: Verify</a>
<ul>
<li><a href="#all_verifier_update_data">verifier.update(data)</a></li>
<li><a href="#all_verifier_verify_object_signature_signature_format">verifier.verify(object, signature[, signature_format])</a></li>
</ul>
</li>
<li><a href="#all_crypto_creatediffiehellman_prime_length_generator">crypto.createDiffieHellman(prime_length[, generator])</a></li>
<li><a href="#all_crypto_creatediffiehellman_prime_prime_encoding_generator_generator_encoding">crypto.createDiffieHellman(prime[, prime_encoding][, generator][, generator_encoding])</a></li>
<li><a href="#all_class_diffiehellman">Class: DiffieHellman</a>
<ul>
<li><a href="#all_diffiehellman_verifyerror">diffieHellman.verifyError</a></li>
<li><a href="#all_diffiehellman_generatekeys_encoding">diffieHellman.generateKeys([encoding])</a></li>
<li><a href="#all_diffiehellman_computesecret_other_public_key_input_encoding_output_encoding">diffieHellman.computeSecret(other_public_key[, input_encoding][, output_encoding])</a></li>
<li><a href="#all_diffiehellman_getprime_encoding">diffieHellman.getPrime([encoding])</a></li>
<li><a href="#all_diffiehellman_getgenerator_encoding">diffieHellman.getGenerator([encoding])</a></li>
<li><a href="#all_diffiehellman_getpublickey_encoding">diffieHellman.getPublicKey([encoding])</a></li>
<li><a href="#all_diffiehellman_getprivatekey_encoding">diffieHellman.getPrivateKey([encoding])</a></li>
<li><a href="#all_diffiehellman_setpublickey_public_key_encoding">diffieHellman.setPublicKey(public_key[, encoding])</a></li>
<li><a href="#all_diffiehellman_setprivatekey_private_key_encoding">diffieHellman.setPrivateKey(private_key[, encoding])</a></li>
</ul>
</li>
<li><a href="#all_crypto_getdiffiehellman_group_name">crypto.getDiffieHellman(group_name)</a></li>
<li><a href="#all_crypto_createecdh_curve_name">crypto.createECDH(curve_name)</a></li>
<li><a href="#all_class_ecdh">Class: ECDH</a>
<ul>
<li><a href="#all_ecdh_generatekeys_encoding_format">ECDH.generateKeys([encoding[, format]])</a></li>
<li><a href="#all_ecdh_computesecret_other_public_key_input_encoding_output_encoding">ECDH.computeSecret(other_public_key[, input_encoding][, output_encoding])</a></li>
<li><a href="#all_ecdh_getpublickey_encoding_format">ECDH.getPublicKey([encoding[, format]])</a></li>
<li><a href="#all_ecdh_getprivatekey_encoding">ECDH.getPrivateKey([encoding])</a></li>
<li><a href="#all_ecdh_setpublickey_public_key_encoding">ECDH.setPublicKey(public_key[, encoding])</a></li>
<li><a href="#all_ecdh_setprivatekey_private_key_encoding">ECDH.setPrivateKey(private_key[, encoding])</a></li>
</ul>
</li>
<li><a href="#all_crypto_pbkdf2_password_salt_iterations_keylen_digest_callback">crypto.pbkdf2(password, salt, iterations, keylen[, digest], callback)</a></li>
<li><a href="#all_crypto_pbkdf2sync_password_salt_iterations_keylen_digest">crypto.pbkdf2Sync(password, salt, iterations, keylen[, digest])</a></li>
<li><a href="#all_crypto_randombytes_size_callback">crypto.randomBytes(size[, callback])</a></li>
<li><a href="#all_crypto_pseudorandombytes_size_callback">crypto.pseudoRandomBytes(size[, callback])</a></li>
<li><a href="#all_class_certificate">Class: Certificate</a>
<ul>
<li><a href="#all_certificate_verifyspkac_spkac">Certificate.verifySpkac(spkac)</a></li>
<li><a href="#all_certificate_exportchallenge_spkac">Certificate.exportChallenge(spkac)</a></li>
<li><a href="#all_certificate_exportpublickey_spkac">Certificate.exportPublicKey(spkac)</a></li>
</ul>
</li>
<li><a href="#all_crypto_publicencrypt_public_key_buffer">crypto.publicEncrypt(public_key, buffer)</a></li>
<li><a href="#all_crypto_privatedecrypt_private_key_buffer">crypto.privateDecrypt(private_key, buffer)</a></li>
<li><a href="#all_crypto_default_encoding">crypto.DEFAULT_ENCODING</a></li>
<li><a href="#all_recent_api_changes">Recent API Changes</a></li>
</ul>
</li>
<li><a href="#all_tls_ssl">TLS (SSL)</a>
<ul>
<li><a href="#all_protocol_support">Protocol support</a></li>
<li><a href="#all_client_initiated_renegotiation_attack_mitigation">Client-initiated renegotiation attack mitigation</a></li>
<li><a href="#all_npn_and_sni">NPN and SNI</a></li>
<li><a href="#all_perfect_forward_secrecy">Perfect Forward Secrecy</a></li>
<li><a href="#all_tls_getciphers">tls.getCiphers()</a></li>
<li><a href="#all_tls_createserver_options_secureconnectionlistener">tls.createServer(options[, secureConnectionListener])</a></li>
<li><a href="#all_tls_connect_options_callback">tls.connect(options[, callback])</a></li>
<li><a href="#all_tls_connect_port_host_options_callback">tls.connect(port[, host][, options][, callback])</a></li>
<li><a href="#all_class_tls_tlssocket">Class: tls.TLSSocket</a></li>
<li><a href="#all_new_tls_tlssocket_socket_options">new tls.TLSSocket(socket, options)</a></li>
<li><a href="#all_tls_createsecurecontext_details">tls.createSecureContext(details)</a></li>
<li><a href="#all_tls_createsecurepair_context_isserver_requestcert_rejectunauthorized">tls.createSecurePair([context][, isServer][, requestCert][, rejectUnauthorized])</a></li>
<li><a href="#all_class_securepair">Class: SecurePair</a>
<ul>
<li><a href="#all_event_secure">Event: 'secure'</a></li>
</ul>
</li>
<li><a href="#all_class_tls_server">Class: tls.Server</a>
<ul>
<li><a href="#all_event_secureconnection">Event: 'secureConnection'</a></li>
<li><a href="#all_event_clienterror">Event: 'clientError'</a></li>
<li><a href="#all_event_newsession">Event: 'newSession'</a></li>
<li><a href="#all_event_resumesession">Event: 'resumeSession'</a></li>
<li><a href="#all_event_ocsprequest">Event: 'OCSPRequest'</a></li>
<li><a href="#all_server_listen_port_host_callback">server.listen(port[, host][, callback])</a></li>
<li><a href="#all_server_close">server.close()</a></li>
<li><a href="#all_server_address">server.address()</a></li>
<li><a href="#all_server_addcontext_hostname_context">server.addContext(hostname, context)</a></li>
<li><a href="#all_server_maxconnections">server.maxConnections</a></li>
<li><a href="#all_server_connections">server.connections</a></li>
</ul>
</li>
<li><a href="#all_class_cryptostream">Class: CryptoStream</a>
<ul>
<li><a href="#all_cryptostream_byteswritten">cryptoStream.bytesWritten</a></li>
</ul>
</li>
<li><a href="#all_class_tls_tlssocket_1">Class: tls.TLSSocket</a>
<ul>
<li><a href="#all_event_secureconnect">Event: 'secureConnect'</a></li>
<li><a href="#all_event_ocspresponse">Event: 'OCSPResponse'</a></li>
<li><a href="#all_tlssocket_encrypted">tlsSocket.encrypted</a></li>
<li><a href="#all_tlssocket_authorized">tlsSocket.authorized</a></li>
<li><a href="#all_tlssocket_authorizationerror">tlsSocket.authorizationError</a></li>
<li><a href="#all_tlssocket_getpeercertificate_detailed">tlsSocket.getPeerCertificate([ detailed ])</a></li>
<li><a href="#all_tlssocket_getcipher">tlsSocket.getCipher()</a></li>
<li><a href="#all_tlssocket_renegotiate_options_callback">tlsSocket.renegotiate(options, callback)</a></li>
<li><a href="#all_tlssocket_setmaxsendfragment_size">tlsSocket.setMaxSendFragment(size)</a></li>
<li><a href="#all_tlssocket_getsession">tlsSocket.getSession()</a></li>
<li><a href="#all_tlssocket_gettlsticket">tlsSocket.getTLSTicket()</a></li>
<li><a href="#all_tlssocket_address">tlsSocket.address()</a></li>
<li><a href="#all_tlssocket_remoteaddress">tlsSocket.remoteAddress</a></li>
<li><a href="#all_tlssocket_remotefamily">tlsSocket.remoteFamily</a></li>
<li><a href="#all_tlssocket_remoteport">tlsSocket.remotePort</a></li>
<li><a href="#all_tlssocket_localaddress">tlsSocket.localAddress</a></li>
<li><a href="#all_tlssocket_localport">tlsSocket.localPort</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_stringdecoder">StringDecoder</a>
<ul>
<li><a href="#all_class_stringdecoder">Class: StringDecoder</a>
<ul>
<li><a href="#all_decoder_write_buffer">decoder.write(buffer)</a></li>
<li><a href="#all_decoder_end">decoder.end()</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_file_system">File System</a>
<ul>
<li><a href="#all_fs_rename_oldpath_newpath_callback">fs.rename(oldPath, newPath, callback)</a></li>
<li><a href="#all_fs_renamesync_oldpath_newpath">fs.renameSync(oldPath, newPath)</a></li>
<li><a href="#all_fs_ftruncate_fd_len_callback">fs.ftruncate(fd, len, callback)</a></li>
<li><a href="#all_fs_ftruncatesync_fd_len">fs.ftruncateSync(fd, len)</a></li>
<li><a href="#all_fs_truncate_path_len_callback">fs.truncate(path, len, callback)</a></li>
<li><a href="#all_fs_truncatesync_path_len">fs.truncateSync(path, len)</a></li>
<li><a href="#all_fs_chown_path_uid_gid_callback">fs.chown(path, uid, gid, callback)</a></li>
<li><a href="#all_fs_chownsync_path_uid_gid">fs.chownSync(path, uid, gid)</a></li>
<li><a href="#all_fs_fchown_fd_uid_gid_callback">fs.fchown(fd, uid, gid, callback)</a></li>
<li><a href="#all_fs_fchownsync_fd_uid_gid">fs.fchownSync(fd, uid, gid)</a></li>
<li><a href="#all_fs_lchown_path_uid_gid_callback">fs.lchown(path, uid, gid, callback)</a></li>
<li><a href="#all_fs_lchownsync_path_uid_gid">fs.lchownSync(path, uid, gid)</a></li>
<li><a href="#all_fs_chmod_path_mode_callback">fs.chmod(path, mode, callback)</a></li>
<li><a href="#all_fs_chmodsync_path_mode">fs.chmodSync(path, mode)</a></li>
<li><a href="#all_fs_fchmod_fd_mode_callback">fs.fchmod(fd, mode, callback)</a></li>
<li><a href="#all_fs_fchmodsync_fd_mode">fs.fchmodSync(fd, mode)</a></li>
<li><a href="#all_fs_lchmod_path_mode_callback">fs.lchmod(path, mode, callback)</a></li>
<li><a href="#all_fs_lchmodsync_path_mode">fs.lchmodSync(path, mode)</a></li>
<li><a href="#all_fs_stat_path_callback">fs.stat(path, callback)</a></li>
<li><a href="#all_fs_lstat_path_callback">fs.lstat(path, callback)</a></li>
<li><a href="#all_fs_fstat_fd_callback">fs.fstat(fd, callback)</a></li>
<li><a href="#all_fs_statsync_path">fs.statSync(path)</a></li>
<li><a href="#all_fs_lstatsync_path">fs.lstatSync(path)</a></li>
<li><a href="#all_fs_fstatsync_fd">fs.fstatSync(fd)</a></li>
<li><a href="#all_fs_link_srcpath_dstpath_callback">fs.link(srcpath, dstpath, callback)</a></li>
<li><a href="#all_fs_linksync_srcpath_dstpath">fs.linkSync(srcpath, dstpath)</a></li>
<li><a href="#all_fs_symlink_srcpath_dstpath_type_callback">fs.symlink(srcpath, dstpath[, type], callback)</a></li>
<li><a href="#all_fs_symlinksync_srcpath_dstpath_type">fs.symlinkSync(srcpath, dstpath[, type])</a></li>
<li><a href="#all_fs_readlink_path_callback">fs.readlink(path, callback)</a></li>
<li><a href="#all_fs_readlinksync_path">fs.readlinkSync(path)</a></li>
<li><a href="#all_fs_realpath_path_cache_callback">fs.realpath(path[, cache], callback)</a></li>
<li><a href="#all_fs_realpathsync_path_cache">fs.realpathSync(path[, cache])</a></li>
<li><a href="#all_fs_unlink_path_callback">fs.unlink(path, callback)</a></li>
<li><a href="#all_fs_unlinksync_path">fs.unlinkSync(path)</a></li>
<li><a href="#all_fs_rmdir_path_callback">fs.rmdir(path, callback)</a></li>
<li><a href="#all_fs_rmdirsync_path">fs.rmdirSync(path)</a></li>
<li><a href="#all_fs_mkdir_path_mode_callback">fs.mkdir(path[, mode], callback)</a></li>
<li><a href="#all_fs_mkdirsync_path_mode">fs.mkdirSync(path[, mode])</a></li>
<li><a href="#all_fs_readdir_path_callback">fs.readdir(path, callback)</a></li>
<li><a href="#all_fs_readdirsync_path">fs.readdirSync(path)</a></li>
<li><a href="#all_fs_close_fd_callback">fs.close(fd, callback)</a></li>
<li><a href="#all_fs_closesync_fd">fs.closeSync(fd)</a></li>
<li><a href="#all_fs_open_path_flags_mode_callback">fs.open(path, flags[, mode], callback)</a></li>
<li><a href="#all_fs_opensync_path_flags_mode">fs.openSync(path, flags[, mode])</a></li>
<li><a href="#all_fs_utimes_path_atime_mtime_callback">fs.utimes(path, atime, mtime, callback)</a></li>
<li><a href="#all_fs_utimessync_path_atime_mtime">fs.utimesSync(path, atime, mtime)</a></li>
<li><a href="#all_fs_futimes_fd_atime_mtime_callback">fs.futimes(fd, atime, mtime, callback)</a></li>
<li><a href="#all_fs_futimessync_fd_atime_mtime">fs.futimesSync(fd, atime, mtime)</a></li>
<li><a href="#all_fs_fsync_fd_callback">fs.fsync(fd, callback)</a></li>
<li><a href="#all_fs_fsyncsync_fd">fs.fsyncSync(fd)</a></li>
<li><a href="#all_fs_write_fd_buffer_offset_length_position_callback">fs.write(fd, buffer, offset, length[, position], callback)</a></li>
<li><a href="#all_fs_write_fd_data_position_encoding_callback">fs.write(fd, data[, position[, encoding]], callback)</a></li>
<li><a href="#all_fs_writesync_fd_buffer_offset_length_position">fs.writeSync(fd, buffer, offset, length[, position])</a></li>
<li><a href="#all_fs_writesync_fd_data_position_encoding">fs.writeSync(fd, data[, position[, encoding]])</a></li>
<li><a href="#all_fs_read_fd_buffer_offset_length_position_callback">fs.read(fd, buffer, offset, length, position, callback)</a></li>
<li><a href="#all_fs_readsync_fd_buffer_offset_length_position">fs.readSync(fd, buffer, offset, length, position)</a></li>
<li><a href="#all_fs_readfile_filename_options_callback">fs.readFile(filename[, options], callback)</a></li>
<li><a href="#all_fs_readfilesync_filename_options">fs.readFileSync(filename[, options])</a></li>
<li><a href="#all_fs_writefile_filename_data_options_callback">fs.writeFile(filename, data[, options], callback)</a></li>
<li><a href="#all_fs_writefilesync_filename_data_options">fs.writeFileSync(filename, data[, options])</a></li>
<li><a href="#all_fs_appendfile_filename_data_options_callback">fs.appendFile(filename, data[, options], callback)</a></li>
<li><a href="#all_fs_appendfilesync_filename_data_options">fs.appendFileSync(filename, data[, options])</a></li>
<li><a href="#all_fs_watchfile_filename_options_listener">fs.watchFile(filename[, options], listener)</a></li>
<li><a href="#all_fs_unwatchfile_filename_listener">fs.unwatchFile(filename[, listener])</a></li>
<li><a href="#all_fs_watch_filename_options_listener">fs.watch(filename[, options][, listener])</a>
<ul>
<li><a href="#all_caveats">Caveats</a>
<ul>
<li><a href="#all_availability">Availability</a></li>
<li><a href="#all_filename_argument">Filename Argument</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_fs_exists_path_callback">fs.exists(path, callback)</a></li>
<li><a href="#all_fs_existssync_path">fs.existsSync(path)</a></li>
<li><a href="#all_fs_access_path_mode_callback">fs.access(path[, mode], callback)</a></li>
<li><a href="#all_fs_accesssync_path_mode">fs.accessSync(path[, mode])</a></li>
<li><a href="#all_class_fs_stats">Class: fs.Stats</a>
<ul>
<li><a href="#all_stat_time_values">Stat Time Values</a></li>
</ul>
</li>
<li><a href="#all_fs_createreadstream_path_options">fs.createReadStream(path[, options])</a></li>
<li><a href="#all_class_fs_readstream">Class: fs.ReadStream</a>
<ul>
<li><a href="#all_event_open">Event: 'open'</a></li>
</ul>
</li>
<li><a href="#all_fs_createwritestream_path_options">fs.createWriteStream(path[, options])</a></li>
<li><a href="#all_class_fs_writestream">Class: fs.WriteStream</a>
<ul>
<li><a href="#all_event_open_1">Event: 'open'</a></li>
<li><a href="#all_file_byteswritten">file.bytesWritten</a></li>
</ul>
</li>
<li><a href="#all_class_fs_fswatcher">Class: fs.FSWatcher</a>
<ul>
<li><a href="#all_watcher_close">watcher.close()</a></li>
<li><a href="#all_event_change">Event: 'change'</a></li>
<li><a href="#all_event_error_2">Event: 'error'</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_path">Path</a>
<ul>
<li><a href="#all_path_normalize_p">path.normalize(p)</a></li>
<li><a href="#all_path_join_path1_path2">path.join([path1][, path2][, ...])</a></li>
<li><a href="#all_path_resolve_from_to">path.resolve([from ...], to)</a></li>
<li><a href="#all_path_isabsolute_path">path.isAbsolute(path)</a></li>
<li><a href="#all_path_relative_from_to">path.relative(from, to)</a></li>
<li><a href="#all_path_dirname_p">path.dirname(p)</a></li>
<li><a href="#all_path_basename_p_ext">path.basename(p[, ext])</a></li>
<li><a href="#all_path_extname_p">path.extname(p)</a></li>
<li><a href="#all_path_sep">path.sep</a></li>
<li><a href="#all_path_delimiter">path.delimiter</a></li>
<li><a href="#all_path_parse_pathstring">path.parse(pathString)</a></li>
<li><a href="#all_path_format_pathobject">path.format(pathObject)</a></li>
<li><a href="#all_path_posix">path.posix</a></li>
<li><a href="#all_path_win32">path.win32</a></li>
</ul>
</li>
<li><a href="#all_net">net</a>
<ul>
<li><a href="#all_net_createserver_options_connectionlistener">net.createServer([options][, connectionListener])</a></li>
<li><a href="#all_net_connect_options_connectionlistener">net.connect(options[, connectionListener])</a></li>
<li><a href="#all_net_createconnection_options_connectionlistener">net.createConnection(options[, connectionListener])</a></li>
<li><a href="#all_net_connect_port_host_connectlistener">net.connect(port[, host][, connectListener])</a></li>
<li><a href="#all_net_createconnection_port_host_connectlistener">net.createConnection(port[, host][, connectListener])</a></li>
<li><a href="#all_net_connect_path_connectlistener">net.connect(path[, connectListener])</a></li>
<li><a href="#all_net_createconnection_path_connectlistener">net.createConnection(path[, connectListener])</a></li>
<li><a href="#all_class_net_server">Class: net.Server</a>
<ul>
<li><a href="#all_server_listen_port_host_backlog_callback">server.listen(port[, host][, backlog][, callback])</a></li>
<li><a href="#all_server_listen_path_callback">server.listen(path[, callback])</a></li>
<li><a href="#all_server_listen_handle_callback">server.listen(handle[, callback])</a></li>
<li><a href="#all_server_listen_options_callback">server.listen(options[, callback])</a></li>
<li><a href="#all_server_close_callback">server.close([callback])</a></li>
<li><a href="#all_server_address_1">server.address()</a></li>
<li><a href="#all_server_unref">server.unref()</a></li>
<li><a href="#all_server_ref">server.ref()</a></li>
<li><a href="#all_server_maxconnections_1">server.maxConnections</a></li>
<li><a href="#all_server_connections_1">server.connections</a></li>
<li><a href="#all_server_getconnections_callback">server.getConnections(callback)</a></li>
<li><a href="#all_event_listening">Event: 'listening'</a></li>
<li><a href="#all_event_connection">Event: 'connection'</a></li>
<li><a href="#all_event_close_1">Event: 'close'</a></li>
<li><a href="#all_event_error_3">Event: 'error'</a></li>
</ul>
</li>
<li><a href="#all_class_net_socket">Class: net.Socket</a>
<ul>
<li><a href="#all_new_net_socket_options">new net.Socket([options])</a></li>
<li><a href="#all_socket_connect_port_host_connectlistener">socket.connect(port[, host][, connectListener])</a></li>
<li><a href="#all_socket_connect_path_connectlistener">socket.connect(path[, connectListener])</a></li>
<li><a href="#all_socket_buffersize">socket.bufferSize</a></li>
<li><a href="#all_socket_setencoding_encoding">socket.setEncoding([encoding])</a></li>
<li><a href="#all_socket_write_data_encoding_callback">socket.write(data[, encoding][, callback])</a></li>
<li><a href="#all_socket_end_data_encoding">socket.end([data][, encoding])</a></li>
<li><a href="#all_socket_destroy">socket.destroy()</a></li>
<li><a href="#all_socket_pause">socket.pause()</a></li>
<li><a href="#all_socket_resume">socket.resume()</a></li>
<li><a href="#all_socket_settimeout_timeout_callback">socket.setTimeout(timeout[, callback])</a></li>
<li><a href="#all_socket_setnodelay_nodelay">socket.setNoDelay([noDelay])</a></li>
<li><a href="#all_socket_setkeepalive_enable_initialdelay">socket.setKeepAlive([enable][, initialDelay])</a></li>
<li><a href="#all_socket_address">socket.address()</a></li>
<li><a href="#all_socket_unref">socket.unref()</a></li>
<li><a href="#all_socket_ref">socket.ref()</a></li>
<li><a href="#all_socket_remoteaddress">socket.remoteAddress</a></li>
<li><a href="#all_socket_remotefamily">socket.remoteFamily</a></li>
<li><a href="#all_socket_remoteport">socket.remotePort</a></li>
<li><a href="#all_socket_localaddress">socket.localAddress</a></li>
<li><a href="#all_socket_localport">socket.localPort</a></li>
<li><a href="#all_socket_bytesread">socket.bytesRead</a></li>
<li><a href="#all_socket_byteswritten">socket.bytesWritten</a></li>
<li><a href="#all_event_lookup">Event: 'lookup'</a></li>
<li><a href="#all_event_connect">Event: 'connect'</a></li>
<li><a href="#all_event_data_1">Event: 'data'</a></li>
<li><a href="#all_event_end_1">Event: 'end'</a></li>
<li><a href="#all_event_timeout">Event: 'timeout'</a></li>
<li><a href="#all_event_drain_1">Event: 'drain'</a></li>
<li><a href="#all_event_error_4">Event: 'error'</a></li>
<li><a href="#all_event_close_2">Event: 'close'</a></li>
</ul>
</li>
<li><a href="#all_net_isip_input">net.isIP(input)</a></li>
<li><a href="#all_net_isipv4_input">net.isIPv4(input)</a></li>
<li><a href="#all_net_isipv6_input">net.isIPv6(input)</a></li>
</ul>
</li>
<li><a href="#all_udp_datagram_sockets">UDP / Datagram Sockets</a>
<ul>
<li><a href="#all_dgram_createsocket_type_callback">dgram.createSocket(type[, callback])</a></li>
<li><a href="#all_dgram_createsocket_options_callback">dgram.createSocket(options[, callback])</a></li>
<li><a href="#all_class_dgram_socket">Class: dgram.Socket</a>
<ul>
<li><a href="#all_event_message">Event: 'message'</a></li>
<li><a href="#all_event_listening_1">Event: 'listening'</a></li>
<li><a href="#all_event_close_3">Event: 'close'</a></li>
<li><a href="#all_event_error_5">Event: 'error'</a></li>
<li><a href="#all_socket_send_buf_offset_length_port_address_callback">socket.send(buf, offset, length, port, address[, callback])</a></li>
<li><a href="#all_socket_bind_port_address_callback">socket.bind(port[, address][, callback])</a></li>
<li><a href="#all_socket_bind_options_callback">socket.bind(options[, callback])</a></li>
<li><a href="#all_socket_close">socket.close()</a></li>
<li><a href="#all_socket_address_1">socket.address()</a></li>
<li><a href="#all_socket_setbroadcast_flag">socket.setBroadcast(flag)</a></li>
<li><a href="#all_socket_setttl_ttl">socket.setTTL(ttl)</a></li>
<li><a href="#all_socket_setmulticastttl_ttl">socket.setMulticastTTL(ttl)</a></li>
<li><a href="#all_socket_setmulticastloopback_flag">socket.setMulticastLoopback(flag)</a></li>
<li><a href="#all_socket_addmembership_multicastaddress_multicastinterface">socket.addMembership(multicastAddress[, multicastInterface])</a></li>
<li><a href="#all_socket_dropmembership_multicastaddress_multicastinterface">socket.dropMembership(multicastAddress[, multicastInterface])</a></li>
<li><a href="#all_socket_unref_1">socket.unref()</a></li>
<li><a href="#all_socket_ref_1">socket.ref()</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_dns">DNS</a>
<ul>
<li><a href="#all_dns_lookup_hostname_options_callback">dns.lookup(hostname[, options], callback)</a></li>
</ul>
</li>
<li><a href="#all_dns_lookupservice_address_port_callback">dns.lookupService(address, port, callback)</a>
<ul>
<li><a href="#all_dns_resolve_hostname_rrtype_callback">dns.resolve(hostname[, rrtype], callback)</a></li>
<li><a href="#all_dns_resolve4_hostname_callback">dns.resolve4(hostname, callback)</a></li>
<li><a href="#all_dns_resolve6_hostname_callback">dns.resolve6(hostname, callback)</a></li>
<li><a href="#all_dns_resolvemx_hostname_callback">dns.resolveMx(hostname, callback)</a></li>
<li><a href="#all_dns_resolvetxt_hostname_callback">dns.resolveTxt(hostname, callback)</a></li>
<li><a href="#all_dns_resolvesrv_hostname_callback">dns.resolveSrv(hostname, callback)</a></li>
<li><a href="#all_dns_resolvesoa_hostname_callback">dns.resolveSoa(hostname, callback)</a></li>
<li><a href="#all_dns_resolvens_hostname_callback">dns.resolveNs(hostname, callback)</a></li>
<li><a href="#all_dns_resolvecname_hostname_callback">dns.resolveCname(hostname, callback)</a></li>
<li><a href="#all_dns_reverse_ip_callback">dns.reverse(ip, callback)</a></li>
<li><a href="#all_dns_getservers">dns.getServers()</a></li>
<li><a href="#all_dns_setservers_servers">dns.setServers(servers)</a></li>
<li><a href="#all_error_codes">Error codes</a></li>
<li><a href="#all_supported_getaddrinfo_flags">Supported getaddrinfo flags</a></li>
<li><a href="#all_implementation_considerations">Implementation considerations</a>
<ul>
<li><a href="#all_dns_lookup">dns.lookup</a></li>
<li><a href="#all_dns_resolve_functions_starting_with_dns_resolve_and_dns_reverse">dns.resolve, functions starting with dns.resolve and dns.reverse</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_http">HTTP</a>
<ul>
<li><a href="#all_http_methods">http.METHODS</a></li>
<li><a href="#all_http_status_codes">http.STATUS_CODES</a></li>
<li><a href="#all_http_createserver_requestlistener">http.createServer([requestListener])</a></li>
<li><a href="#all_http_createclient_port_host">http.createClient([port][, host])</a></li>
<li><a href="#all_class_http_server">Class: http.Server</a>
<ul>
<li><a href="#all_event_request">Event: 'request'</a></li>
<li><a href="#all_event_connection_1">Event: 'connection'</a></li>
<li><a href="#all_event_close_4">Event: 'close'</a></li>
<li><a href="#all_event_checkcontinue">Event: 'checkContinue'</a></li>
<li><a href="#all_event_connect_1">Event: 'connect'</a></li>
<li><a href="#all_event_upgrade">Event: 'upgrade'</a></li>
<li><a href="#all_event_clienterror_1">Event: 'clientError'</a></li>
<li><a href="#all_server_listen_port_hostname_backlog_callback">server.listen(port[, hostname][, backlog][, callback])</a></li>
<li><a href="#all_server_listen_path_callback_1">server.listen(path[, callback])</a></li>
<li><a href="#all_server_listen_handle_callback_1">server.listen(handle[, callback])</a></li>
<li><a href="#all_server_close_callback_1">server.close([callback])</a></li>
<li><a href="#all_server_maxheaderscount">server.maxHeadersCount</a></li>
<li><a href="#all_server_settimeout_msecs_callback">server.setTimeout(msecs, callback)</a></li>
<li><a href="#all_server_timeout">server.timeout</a></li>
</ul>
</li>
<li><a href="#all_class_http_serverresponse">Class: http.ServerResponse</a>
<ul>
<li><a href="#all_event_close_5">Event: 'close'</a></li>
<li><a href="#all_event_finish_1">Event: 'finish'</a></li>
<li><a href="#all_response_writecontinue">response.writeContinue()</a></li>
<li><a href="#all_response_writehead_statuscode_statusmessage_headers">response.writeHead(statusCode[, statusMessage][, headers])</a></li>
<li><a href="#all_response_settimeout_msecs_callback">response.setTimeout(msecs, callback)</a></li>
<li><a href="#all_response_statuscode">response.statusCode</a></li>
<li><a href="#all_response_statusmessage">response.statusMessage</a></li>
<li><a href="#all_response_setheader_name_value">response.setHeader(name, value)</a></li>
<li><a href="#all_response_headerssent">response.headersSent</a></li>
<li><a href="#all_response_senddate">response.sendDate</a></li>
<li><a href="#all_response_getheader_name">response.getHeader(name)</a></li>
<li><a href="#all_response_removeheader_name">response.removeHeader(name)</a></li>
<li><a href="#all_response_write_chunk_encoding_callback">response.write(chunk[, encoding][, callback])</a></li>
<li><a href="#all_response_addtrailers_headers">response.addTrailers(headers)</a></li>
<li><a href="#all_response_end_data_encoding_callback">response.end([data][, encoding][, callback])</a></li>
</ul>
</li>
<li><a href="#all_http_request_options_callback">http.request(options[, callback])</a></li>
<li><a href="#all_http_get_options_callback">http.get(options[, callback])</a></li>
<li><a href="#all_class_http_agent">Class: http.Agent</a>
<ul>
<li><a href="#all_new_agent_options">new Agent([options])</a></li>
<li><a href="#all_agent_maxsockets">agent.maxSockets</a></li>
<li><a href="#all_agent_maxfreesockets">agent.maxFreeSockets</a></li>
<li><a href="#all_agent_sockets">agent.sockets</a></li>
<li><a href="#all_agent_freesockets">agent.freeSockets</a></li>
<li><a href="#all_agent_requests">agent.requests</a></li>
<li><a href="#all_agent_destroy">agent.destroy()</a></li>
<li><a href="#all_agent_getname_options">agent.getName(options)</a></li>
</ul>
</li>
<li><a href="#all_http_globalagent">http.globalAgent</a></li>
<li><a href="#all_class_http_clientrequest">Class: http.ClientRequest</a>
<ul>
<li><a href="#all_event_response">Event: 'response'</a></li>
<li><a href="#all_event_socket">Event: 'socket'</a></li>
<li><a href="#all_event_connect_2">Event: 'connect'</a></li>
<li><a href="#all_event_upgrade_1">Event: 'upgrade'</a></li>
<li><a href="#all_event_continue">Event: 'continue'</a></li>
<li><a href="#all_request_flushheaders">request.flushHeaders()</a></li>
<li><a href="#all_request_write_chunk_encoding_callback">request.write(chunk[, encoding][, callback])</a></li>
<li><a href="#all_request_end_data_encoding_callback">request.end([data][, encoding][, callback])</a></li>
<li><a href="#all_request_abort">request.abort()</a></li>
<li><a href="#all_request_settimeout_timeout_callback">request.setTimeout(timeout[, callback])</a></li>
<li><a href="#all_request_setnodelay_nodelay">request.setNoDelay([noDelay])</a></li>
<li><a href="#all_request_setsocketkeepalive_enable_initialdelay">request.setSocketKeepAlive([enable][, initialDelay])</a></li>
</ul>
</li>
<li><a href="#all_http_incomingmessage">http.IncomingMessage</a>
<ul>
<li><a href="#all_event_close_6">Event: 'close'</a></li>
<li><a href="#all_message_httpversion">message.httpVersion</a></li>
<li><a href="#all_message_headers">message.headers</a></li>
<li><a href="#all_message_rawheaders">message.rawHeaders</a></li>
<li><a href="#all_message_trailers">message.trailers</a></li>
<li><a href="#all_message_rawtrailers">message.rawTrailers</a></li>
<li><a href="#all_message_settimeout_msecs_callback">message.setTimeout(msecs, callback)</a></li>
<li><a href="#all_message_method">message.method</a></li>
<li><a href="#all_message_url">message.url</a></li>
<li><a href="#all_message_statuscode">message.statusCode</a></li>
<li><a href="#all_message_statusmessage">message.statusMessage</a></li>
<li><a href="#all_message_socket">message.socket</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_https">HTTPS</a>
<ul>
<li><a href="#all_class_https_server">Class: https.Server</a>
<ul>
<li><a href="#all_server_settimeout_msecs_callback_1">server.setTimeout(msecs, callback)</a></li>
<li><a href="#all_server_timeout_1">server.timeout</a></li>
</ul>
</li>
<li><a href="#all_https_createserver_options_requestlistener">https.createServer(options[, requestListener])</a>
<ul>
<li><a href="#all_server_listen_port_host_backlog_callback_1">server.listen(port[, host][, backlog][, callback])</a></li>
<li><a href="#all_server_listen_path_callback_2">server.listen(path[, callback])</a></li>
<li><a href="#all_server_listen_handle_callback_2">server.listen(handle[, callback])</a></li>
<li><a href="#all_server_close_callback_2">server.close([callback])</a></li>
</ul>
</li>
<li><a href="#all_https_request_options_callback">https.request(options, callback)</a></li>
<li><a href="#all_https_get_options_callback">https.get(options, callback)</a></li>
<li><a href="#all_class_https_agent">Class: https.Agent</a></li>
<li><a href="#all_https_globalagent">https.globalAgent</a></li>
</ul>
</li>
<li><a href="#all_url">URL</a>
<ul>
<li><a href="#all_url_parse_urlstr_parsequerystring_slashesdenotehost">url.parse(urlStr[, parseQueryString][, slashesDenoteHost])</a></li>
<li><a href="#all_url_format_urlobj">url.format(urlObj)</a></li>
<li><a href="#all_url_resolve_from_to">url.resolve(from, to)</a></li>
</ul>
</li>
<li><a href="#all_query_string">Query String</a>
<ul>
<li><a href="#all_querystring_stringify_obj_sep_eq_options">querystring.stringify(obj[, sep][, eq][, options])</a></li>
<li><a href="#all_querystring_parse_str_sep_eq_options">querystring.parse(str[, sep][, eq][, options])</a></li>
<li><a href="#all_querystring_escape">querystring.escape</a></li>
<li><a href="#all_querystring_unescape">querystring.unescape</a></li>
</ul>
</li>
<li><a href="#all_punycode">punycode</a>
<ul>
<li><a href="#all_punycode_decode_string">punycode.decode(string)</a></li>
<li><a href="#all_punycode_encode_string">punycode.encode(string)</a></li>
<li><a href="#all_punycode_tounicode_domain">punycode.toUnicode(domain)</a></li>
<li><a href="#all_punycode_toascii_domain">punycode.toASCII(domain)</a></li>
<li><a href="#all_punycode_ucs2">punycode.ucs2</a>
<ul>
<li><a href="#all_punycode_ucs2_decode_string">punycode.ucs2.decode(string)</a></li>
<li><a href="#all_punycode_ucs2_encode_codepoints">punycode.ucs2.encode(codePoints)</a></li>
</ul>
</li>
<li><a href="#all_punycode_version">punycode.version</a></li>
</ul>
</li>
<li><a href="#all_readline">Readline</a>
<ul>
<li><a href="#all_readline_createinterface_options">readline.createInterface(options)</a></li>
<li><a href="#all_class_interface">Class: Interface</a>
<ul>
<li><a href="#all_rl_setprompt_prompt">rl.setPrompt(prompt)</a></li>
<li><a href="#all_rl_prompt_preservecursor">rl.prompt([preserveCursor])</a></li>
<li><a href="#all_rl_question_query_callback">rl.question(query, callback)</a></li>
<li><a href="#all_rl_pause">rl.pause()</a></li>
<li><a href="#all_rl_resume">rl.resume()</a></li>
<li><a href="#all_rl_close">rl.close()</a></li>
<li><a href="#all_rl_write_data_key">rl.write(data[, key])</a></li>
</ul>
</li>
<li><a href="#all_events_1">Events</a>
<ul>
<li><a href="#all_event_line">Event: 'line'</a></li>
<li><a href="#all_event_pause">Event: 'pause'</a></li>
<li><a href="#all_event_resume">Event: 'resume'</a></li>
<li><a href="#all_event_close_7">Event: 'close'</a></li>
<li><a href="#all_event_sigint">Event: 'SIGINT'</a></li>
<li><a href="#all_event_sigtstp">Event: 'SIGTSTP'</a></li>
<li><a href="#all_event_sigcont">Event: 'SIGCONT'</a></li>
</ul>
</li>
<li><a href="#all_example_tiny_cli">Example: Tiny CLI</a></li>
<li><a href="#all_readline_cursorto_stream_x_y">readline.cursorTo(stream, x, y)</a></li>
<li><a href="#all_readline_movecursor_stream_dx_dy">readline.moveCursor(stream, dx, dy)</a></li>
<li><a href="#all_readline_clearline_stream_dir">readline.clearLine(stream, dir)</a></li>
<li><a href="#all_readline_clearscreendown_stream">readline.clearScreenDown(stream)</a></li>
</ul>
</li>
<li><a href="#all_repl">REPL</a>
<ul>
<li><a href="#all_repl_start_options">repl.start(options)</a>
<ul>
<li><a href="#all_event_exit_1">Event: 'exit'</a></li>
<li><a href="#all_event_reset">Event: 'reset'</a></li>
</ul>
</li>
<li><a href="#all_repl_features">REPL Features</a></li>
</ul>
</li>
<li><a href="#all_executing_javascript">Executing JavaScript</a>
<ul>
<li><a href="#all_vm_runinthiscontext_code_options">vm.runInThisContext(code[, options])</a></li>
<li><a href="#all_vm_createcontext_sandbox">vm.createContext([sandbox])</a></li>
<li><a href="#all_vm_iscontext_sandbox">vm.isContext(sandbox)</a></li>
<li><a href="#all_vm_runincontext_code_contextifiedsandbox_options">vm.runInContext(code, contextifiedSandbox[, options])</a></li>
<li><a href="#all_vm_runinnewcontext_code_sandbox_options">vm.runInNewContext(code[, sandbox][, options])</a></li>
<li><a href="#all_vm_runindebugcontext_code">vm.runInDebugContext(code)</a></li>
<li><a href="#all_class_script">Class: Script</a>
<ul>
<li><a href="#all_new_vm_script_code_options">new vm.Script(code, options)</a></li>
<li><a href="#all_script_runinthiscontext_options">script.runInThisContext([options])</a></li>
<li><a href="#all_script_runincontext_contextifiedsandbox_options">script.runInContext(contextifiedSandbox[, options])</a></li>
<li><a href="#all_script_runinnewcontext_sandbox_options">script.runInNewContext([sandbox][, options])</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_child_process">Child Process</a>
<ul>
<li><a href="#all_class_childprocess">Class: ChildProcess</a>
<ul>
<li><a href="#all_event_error_6">Event: 'error'</a></li>
<li><a href="#all_event_exit_2">Event: 'exit'</a></li>
<li><a href="#all_event_close_8">Event: 'close'</a></li>
<li><a href="#all_event_disconnect">Event: 'disconnect'</a></li>
<li><a href="#all_event_message_1">Event: 'message'</a></li>
<li><a href="#all_child_stdin">child.stdin</a></li>
<li><a href="#all_child_stdout">child.stdout</a></li>
<li><a href="#all_child_stderr">child.stderr</a></li>
<li><a href="#all_child_stdio">child.stdio</a></li>
<li><a href="#all_child_pid">child.pid</a></li>
<li><a href="#all_child_connected">child.connected</a></li>
<li><a href="#all_child_kill_signal">child.kill([signal])</a></li>
<li><a href="#all_child_send_message_sendhandle">child.send(message[, sendHandle])</a>
<ul>
<li><a href="#all_example_sending_server_object">Example: sending server object</a></li>
<li><a href="#all_example_sending_socket_object">Example: sending socket object</a></li>
</ul>
</li>
<li><a href="#all_child_disconnect">child.disconnect()</a></li>
</ul>
</li>
<li><a href="#all_asynchronous_process_creation">Asynchronous Process Creation</a>
<ul>
<li><a href="#all_child_process_spawn_command_args_options">child_process.spawn(command[, args][, options])</a></li>
<li><a href="#all_options_stdio">options.stdio</a></li>
<li><a href="#all_options_detached">options.detached</a></li>
<li><a href="#all_options_customfds">options.customFds</a></li>
<li><a href="#all_child_process_exec_command_options_callback">child_process.exec(command[, options], callback)</a></li>
<li><a href="#all_child_process_execfile_file_args_options_callback">child_process.execFile(file[, args][, options][, callback])</a></li>
<li><a href="#all_child_process_fork_modulepath_args_options">child_process.fork(modulePath[, args][, options])</a></li>
</ul>
</li>
<li><a href="#all_synchronous_process_creation">Synchronous Process Creation</a>
<ul>
<li><a href="#all_child_process_spawnsync_command_args_options">child_process.spawnSync(command[, args][, options])</a></li>
<li><a href="#all_child_process_execfilesync_command_args_options">child_process.execFileSync(command[, args][, options])</a></li>
<li><a href="#all_child_process_execsync_command_options">child_process.execSync(command[, options])</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_assert">Assert</a>
<ul>
<li><a href="#all_assert_fail_actual_expected_message_operator">assert.fail(actual, expected, message, operator)</a></li>
<li><a href="#all_assert_value_message_assert_ok_value_message">assert(value[, message]), assert.ok(value[, message])</a></li>
<li><a href="#all_assert_equal_actual_expected_message">assert.equal(actual, expected[, message])</a></li>
<li><a href="#all_assert_notequal_actual_expected_message">assert.notEqual(actual, expected[, message])</a></li>
<li><a href="#all_assert_deepequal_actual_expected_message">assert.deepEqual(actual, expected[, message])</a></li>
<li><a href="#all_assert_notdeepequal_actual_expected_message">assert.notDeepEqual(actual, expected[, message])</a></li>
<li><a href="#all_assert_strictequal_actual_expected_message">assert.strictEqual(actual, expected[, message])</a></li>
<li><a href="#all_assert_notstrictequal_actual_expected_message">assert.notStrictEqual(actual, expected[, message])</a></li>
<li><a href="#all_assert_throws_block_error_message">assert.throws(block[, error][, message])</a></li>
<li><a href="#all_assert_doesnotthrow_block_message">assert.doesNotThrow(block[, message])</a></li>
<li><a href="#all_assert_iferror_value">assert.ifError(value)</a></li>
</ul>
</li>
<li><a href="#all_tty">TTY</a>
<ul>
<li><a href="#all_tty_isatty_fd">tty.isatty(fd)</a></li>
<li><a href="#all_tty_setrawmode_mode">tty.setRawMode(mode)</a></li>
<li><a href="#all_class_readstream">Class: ReadStream</a>
<ul>
<li><a href="#all_rs_israw">rs.isRaw</a></li>
<li><a href="#all_rs_setrawmode_mode">rs.setRawMode(mode)</a></li>
</ul>
</li>
<li><a href="#all_class_writestream">Class: WriteStream</a>
<ul>
<li><a href="#all_ws_columns">ws.columns</a></li>
<li><a href="#all_ws_rows">ws.rows</a></li>
<li><a href="#all_event_resize">Event: 'resize'</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_zlib">Zlib</a>
<ul>
<li><a href="#all_examples">Examples</a></li>
<li><a href="#all_zlib_creategzip_options">zlib.createGzip([options])</a></li>
<li><a href="#all_zlib_creategunzip_options">zlib.createGunzip([options])</a></li>
<li><a href="#all_zlib_createdeflate_options">zlib.createDeflate([options])</a></li>
<li><a href="#all_zlib_createinflate_options">zlib.createInflate([options])</a></li>
<li><a href="#all_zlib_createdeflateraw_options">zlib.createDeflateRaw([options])</a></li>
<li><a href="#all_zlib_createinflateraw_options">zlib.createInflateRaw([options])</a></li>
<li><a href="#all_zlib_createunzip_options">zlib.createUnzip([options])</a></li>
<li><a href="#all_class_zlib_zlib">Class: zlib.Zlib</a>
<ul>
<li><a href="#all_zlib_flush_kind_callback">zlib.flush([kind], callback)</a></li>
<li><a href="#all_zlib_params_level_strategy_callback">zlib.params(level, strategy, callback)</a></li>
<li><a href="#all_zlib_reset">zlib.reset()</a></li>
</ul>
</li>
<li><a href="#all_class_zlib_gzip">Class: zlib.Gzip</a></li>
<li><a href="#all_class_zlib_gunzip">Class: zlib.Gunzip</a></li>
<li><a href="#all_class_zlib_deflate">Class: zlib.Deflate</a></li>
<li><a href="#all_class_zlib_inflate">Class: zlib.Inflate</a></li>
<li><a href="#all_class_zlib_deflateraw">Class: zlib.DeflateRaw</a></li>
<li><a href="#all_class_zlib_inflateraw">Class: zlib.InflateRaw</a></li>
<li><a href="#all_class_zlib_unzip">Class: zlib.Unzip</a></li>
<li><a href="#all_convenience_methods">Convenience Methods</a></li>
<li><a href="#all_zlib_deflate_buf_options_callback">zlib.deflate(buf[, options], callback)</a></li>
<li><a href="#all_zlib_deflatesync_buf_options">zlib.deflateSync(buf[, options])</a></li>
<li><a href="#all_zlib_deflateraw_buf_options_callback">zlib.deflateRaw(buf[, options], callback)</a></li>
<li><a href="#all_zlib_deflaterawsync_buf_options">zlib.deflateRawSync(buf[, options])</a></li>
<li><a href="#all_zlib_gzip_buf_options_callback">zlib.gzip(buf[, options], callback)</a></li>
<li><a href="#all_zlib_gzipsync_buf_options">zlib.gzipSync(buf[, options])</a></li>
<li><a href="#all_zlib_gunzip_buf_options_callback">zlib.gunzip(buf[, options], callback)</a></li>
<li><a href="#all_zlib_gunzipsync_buf_options">zlib.gunzipSync(buf[, options])</a></li>
<li><a href="#all_zlib_inflate_buf_options_callback">zlib.inflate(buf[, options], callback)</a></li>
<li><a href="#all_zlib_inflatesync_buf_options">zlib.inflateSync(buf[, options])</a></li>
<li><a href="#all_zlib_inflateraw_buf_options_callback">zlib.inflateRaw(buf[, options], callback)</a></li>
<li><a href="#all_zlib_inflaterawsync_buf_options">zlib.inflateRawSync(buf[, options])</a></li>
<li><a href="#all_zlib_unzip_buf_options_callback">zlib.unzip(buf[, options], callback)</a></li>
<li><a href="#all_zlib_unzipsync_buf_options">zlib.unzipSync(buf[, options])</a></li>
<li><a href="#all_options">Options</a></li>
<li><a href="#all_memory_usage_tuning">Memory Usage Tuning</a></li>
<li><a href="#all_constants">Constants</a></li>
</ul>
</li>
<li><a href="#all_os">os</a>
<ul>
<li><a href="#all_os_tmpdir">os.tmpdir()</a></li>
<li><a href="#all_os_endianness">os.endianness()</a></li>
<li><a href="#all_os_hostname">os.hostname()</a></li>
<li><a href="#all_os_type">os.type()</a></li>
<li><a href="#all_os_platform">os.platform()</a></li>
<li><a href="#all_os_arch">os.arch()</a></li>
<li><a href="#all_os_release">os.release()</a></li>
<li><a href="#all_os_uptime">os.uptime()</a></li>
<li><a href="#all_os_loadavg">os.loadavg()</a></li>
<li><a href="#all_os_totalmem">os.totalmem()</a></li>
<li><a href="#all_os_freemem">os.freemem()</a></li>
<li><a href="#all_os_cpus">os.cpus()</a></li>
<li><a href="#all_os_networkinterfaces">os.networkInterfaces()</a></li>
<li><a href="#all_os_eol">os.EOL</a></li>
</ul>
</li>
<li><a href="#all_debugger">Debugger</a>
<ul>
<li><a href="#all_watchers">Watchers</a></li>
<li><a href="#all_commands_reference">Commands reference</a>
<ul>
<li><a href="#all_stepping">Stepping</a></li>
<li><a href="#all_breakpoints">Breakpoints</a></li>
<li><a href="#all_info">Info</a></li>
<li><a href="#all_execution_control">Execution control</a></li>
<li><a href="#all_various">Various</a></li>
</ul>
</li>
<li><a href="#all_advanced_usage">Advanced Usage</a></li>
</ul>
</li>
<li><a href="#all_cluster">Cluster</a>
<ul>
<li><a href="#all_how_it_works">How It Works</a></li>
<li><a href="#all_cluster_schedulingpolicy">cluster.schedulingPolicy</a></li>
<li><a href="#all_cluster_settings">cluster.settings</a></li>
<li><a href="#all_cluster_ismaster">cluster.isMaster</a></li>
<li><a href="#all_cluster_isworker">cluster.isWorker</a></li>
<li><a href="#all_event_fork">Event: 'fork'</a></li>
<li><a href="#all_event_online">Event: 'online'</a></li>
<li><a href="#all_event_listening_2">Event: 'listening'</a></li>
<li><a href="#all_event_disconnect_1">Event: 'disconnect'</a></li>
<li><a href="#all_event_exit_3">Event: 'exit'</a></li>
<li><a href="#all_event_setup">Event: 'setup'</a></li>
<li><a href="#all_cluster_setupmaster_settings">cluster.setupMaster([settings])</a></li>
<li><a href="#all_cluster_fork_env">cluster.fork([env])</a></li>
<li><a href="#all_cluster_disconnect_callback">cluster.disconnect([callback])</a></li>
<li><a href="#all_cluster_worker">cluster.worker</a></li>
<li><a href="#all_cluster_workers">cluster.workers</a></li>
<li><a href="#all_class_worker">Class: Worker</a>
<ul>
<li><a href="#all_worker_id">worker.id</a></li>
<li><a href="#all_worker_process">worker.process</a></li>
<li><a href="#all_worker_suicide">worker.suicide</a></li>
<li><a href="#all_worker_send_message_sendhandle">worker.send(message[, sendHandle])</a></li>
<li><a href="#all_worker_kill_signal_sigterm">worker.kill([signal='SIGTERM'])</a></li>
<li><a href="#all_worker_disconnect">worker.disconnect()</a></li>
<li><a href="#all_worker_isdead">worker.isDead()</a></li>
<li><a href="#all_worker_isconnected">worker.isConnected()</a></li>
<li><a href="#all_event_message_2">Event: 'message'</a></li>
<li><a href="#all_event_online_1">Event: 'online'</a></li>
<li><a href="#all_event_listening_3">Event: 'listening'</a></li>
<li><a href="#all_event_disconnect_2">Event: 'disconnect'</a></li>
<li><a href="#all_event_exit_4">Event: 'exit'</a></li>
<li><a href="#all_event_error_7">Event: 'error'</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_smalloc">Smalloc</a>
<ul>
<li><a href="#all_class_smalloc">Class: smalloc</a>
<ul>
<li><a href="#all_smalloc_alloc_length_receiver_type">smalloc.alloc(length[, receiver][, type])</a></li>
<li><a href="#all_smalloc_copyonto_source_sourcestart_dest_deststart_copylength">smalloc.copyOnto(source, sourceStart, dest, destStart, copyLength);</a></li>
<li><a href="#all_smalloc_dispose_obj">smalloc.dispose(obj)</a></li>
<li><a href="#all_smalloc_hasexternaldata_obj">smalloc.hasExternalData(obj)</a></li>
<li><a href="#all_smalloc_kmaxlength">smalloc.kMaxLength</a></li>
<li><a href="#all_smalloc_types">smalloc.Types</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="apicontent">
<h1>About this Documentation<a id="all_about_this_documentation" class="mark" href="#all_about_this_documentation">#</a></h1>
<p>The goal of this documentation is to comprehensively explain the Node.js API, both from a reference as well as a conceptual point of view. Each section describes a built-in module or high-level concept.</p>
<p>Where appropriate, property types, method arguments, and the arguments provided to event handlers are detailed in a list underneath the topic heading.</p>
<p>Every <code>.html</code> document has a corresponding <code>.json</code> document presenting the same information in a structured manner. This feature is experimental, and added for the benefit of IDEs and other utilities that wish to do programmatic things with the documentation.</p>
<p>Every <code>.html</code> and <code>.json</code> file is generated based on the corresponding <code>.markdown</code> file in the <code>doc/api/</code> folder in node's source tree. The documentation is generated using the <code>tools/doc/generate.js</code> program. The HTML template is located at <code>doc/template.html</code>.</p>
<h2>Stability Index<a id="all_stability_index" class="mark" href="#all_stability_index">#</a></h2>
<p>Throughout the documentation, you will see indications of a section's stability. The Node.js API is still somewhat changing, and as it matures, certain parts are more reliable than others. Some are so proven, and so relied upon, that they are unlikely to ever change at all. Others are brand new and experimental, or known to be hazardous and in the process of being redesigned.</p>
<p>The stability indices are as follows:</p>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated
This feature is known to be problematic<span class="sh_symbol">,</span> and changes are
planned<span class="sh_symbol">.</span>  Do not rely on it<span class="sh_symbol">.</span>  Use of the feature may cause warnings<span class="sh_symbol">.</span>  Backwards
compatibility should not be expected<span class="sh_symbol">.</span></pre>
<pre class="api_stability_1 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">1</span> <span class="sh_symbol">-</span> Experimental
This feature was introduced recently<span class="sh_symbol">,</span> and may change
or be removed <span class="sh_keyword">in</span> future versions<span class="sh_symbol">.</span>  Please <span class="sh_keyword">try</span> it out and provide feedback<span class="sh_symbol">.</span>
If it addresses a use<span class="sh_symbol">-</span><span class="sh_keyword">case</span> that is important to you<span class="sh_symbol">,</span> tell the node core team<span class="sh_symbol">.</span></pre>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable
The API is <span class="sh_keyword">in</span> the process of settling<span class="sh_symbol">,</span> but has not yet had
sufficient real<span class="sh_symbol">-</span>world testing to be considered stable<span class="sh_symbol">.</span> Backwards<span class="sh_symbol">-</span>compatibility
will be maintained <span class="sh_keyword">if</span> reasonable<span class="sh_symbol">.</span></pre>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable
The API has proven satisfactory<span class="sh_symbol">,</span> but cleanup <span class="sh_keyword">in</span> the underlying
code may cause minor changes<span class="sh_symbol">.</span>  Backwards<span class="sh_symbol">-</span>compatibility is guaranteed<span class="sh_symbol">.</span></pre>
<pre class="api_stability_4 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">4</span> <span class="sh_symbol">-</span> API Frozen
This API has been tested extensively <span class="sh_keyword">in</span> production and is
unlikely to ever have to change<span class="sh_symbol">.</span></pre>
<pre class="api_stability_5 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">5</span> <span class="sh_symbol">-</span> Locked
Unless serious bugs are found<span class="sh_symbol">,</span> <span class="sh_keyword">this</span> code will not ever
change<span class="sh_symbol">.</span>  Please <span class="sh_keyword">do</span> not suggest changes <span class="sh_keyword">in</span> <span class="sh_keyword">this</span> area<span class="sh_symbol">;</span> they will be refused<span class="sh_symbol">.</span></pre>
<h2>JSON Output<a id="all_json_output" class="mark" href="#all_json_output">#</a></h2>
<pre class="api_stability_1 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">1</span> <span class="sh_symbol">-</span> Experimental</pre>
<p>Every HTML file in the markdown has a corresponding JSON file with the same data.</p>
<p>This feature is new as of node v0.6.12. It is experimental.</p>
<h1>Synopsis<a id="all_synopsis" class="mark" href="#all_synopsis">#</a></h1>
<p>An example of a <a href="https://nodejs.org/api/http.html">web server</a> written with Node which responds with 'Hello World':</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>

http<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>request<span class="sh_symbol">,</span> response<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  response<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span><span class="sh_string">'Content-Type'</span><span class="sh_symbol">:</span> <span class="sh_string">'text/plain'</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  response<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'Hello World</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8124</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Server running at http://127.0.0.1:8124/'</span><span class="sh_symbol">);</span></code></pre>
<p>To run the server, put the code into a file called <code>example.js</code> and execute it with the node program</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">&gt;</span> node example<span class="sh_symbol">.</span>js
Server running at http<span class="sh_symbol">:</span><span class="sh_comment">//127.0.0.1:8124/</span></code></pre>
<p>All of the examples in the documentation can be run similarly.</p>
<h1>Global Objects<a id="all_global_objects" class="mark" href="#all_global_objects">#</a></h1>
<p>These objects are available in all modules. Some of these objects aren't actually in the global scope but in the module scope - this will be noted.</p>
<h2>global<a id="all_global" class="mark" href="#all_global">#</a></h2>
<ul>
<li>{Object} The global namespace object.</li>
</ul>
<p>In browsers, the top-level scope is the global scope. That means that in browsers if you're in the global scope <code>var something</code> will define a global variable. In Node this is different. The top-level scope is not the global scope; <code>var something</code> inside a Node module will be local to that module.</p>
<h2>process<a id="all_process" class="mark" href="#all_process">#</a></h2>
<ul>
<li>{Object}</li>
</ul>
<p>The process object. See the <a href="https://nodejs.org/api/process.html#process_process">process object</a> section.</p>
<h2>console<a id="all_console" class="mark" href="#all_console">#</a></h2>
<ul>
<li>{Object}</li>
</ul>
<p>Used to print to stdout and stderr. See the <a href="https://nodejs.org/api/console.html">console</a> section.</p>
<h2>Class: Buffer<a id="all_class_buffer" class="mark" href="#all_class_buffer">#</a></h2>
<ul>
<li>{Function}</li>
</ul>
<p>Used to handle binary data. See the <a href="https://nodejs.org/api/buffer.html">buffer section</a></p>
<h2>require()<a id="all_require" class="mark" href="#all_require">#</a></h2>
<ul>
<li>{Function}</li>
</ul>
<p>To require modules. See the <a href="https://nodejs.org/api/modules.html#modules_modules">Modules</a> section. <code>require</code> isn't actually a global but rather local to each module.</p>
<h3>require.resolve()<a id="all_require_resolve" class="mark" href="#all_require_resolve">#</a></h3>
<p>Use the internal <code>require()</code> machinery to look up the location of a module, but rather than loading the module, just return the resolved filename.</p>
<h3>require.cache<a id="all_require_cache" class="mark" href="#all_require_cache">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Object</span></li>
</ul>
</div>
<p>Modules are cached in this object when they are required. By deleting a key value from this object, the next <code>require</code> will reload the module.</p>
<h3>require.extensions<a id="all_require_extensions" class="mark" href="#all_require_extensions">#</a></h3>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated</pre>
<div class="signature">
<ul>
<li><span class="type">Object</span></li>
</ul>
</div>
<p>Instruct <code>require</code> on how to handle certain file extensions.</p>
<p>Process files with the extension <code>.sjs</code> as <code>.js</code>:</p>
<pre class="sh_sourceCode"><code>require<span class="sh_symbol">.</span>extensions<span class="sh_symbol">[</span><span class="sh_string">'.sjs'</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> require<span class="sh_symbol">.</span>extensions<span class="sh_symbol">[</span><span class="sh_string">'.js'</span><span class="sh_symbol">];</span></code></pre>
<p><strong>Deprecated</strong> In the past, this list has been used to load non-JavaScript modules into Node by compiling them on-demand. However, in practice, there are much better ways to do this, such as loading modules via some other Node program, or compiling them to JavaScript ahead of time.</p>
<p>Since the Module system is locked, this feature will probably never go away. However, it may have subtle bugs and complexities that are best left untouched.</p>
<h2>__filename<a id="all_filename" class="mark" href="#all_filename">#</a></h2>
<ul>
<li>{String}</li>
</ul>
<p>The filename of the code being executed. This is the resolved absolute path of this code file. For a main program this is not necessarily the same filename used in the command line. The value inside a module is the path to that module file.</p>
<p>Example: running <code>node example.js</code> from <code>/Users/mjr</code></p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>__filename<span class="sh_symbol">);</span>
<span class="sh_comment">// /Users/mjr/example.js</span></code></pre>
<p><code>__filename</code> isn't actually a global but rather local to each module.</p>
<h2>__dirname<a id="all_dirname" class="mark" href="#all_dirname">#</a></h2>
<ul>
<li>{String}</li>
</ul>
<p>The name of the directory that the currently executing script resides in.</p>
<p>Example: running <code>node example.js</code> from <code>/Users/mjr</code></p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>__dirname<span class="sh_symbol">);</span>
<span class="sh_comment">// /Users/mjr</span></code></pre>
<p><code>__dirname</code> isn't actually a global but rather local to each module.</p>
<h2>module<a id="all_module" class="mark" href="#all_module">#</a></h2>
<ul>
<li>{Object}</li>
</ul>
<p>A reference to the current module. In particular <code>module.exports</code> is used for defining what a module exports and makes available through <code>require()</code>.</p>
<p><code>module</code> isn't actually a global but rather local to each module.</p>
<p>See the <a href="https://nodejs.org/api/modules.html">module system documentation</a> for more information.</p>
<h2>exports<a id="all_exports" class="mark" href="#all_exports">#</a></h2>
<p>A reference to the <code>module.exports</code> that is shorter to type. See <a href="https://nodejs.org/api/modules.html">module system documentation</a> for details on when to use <code>exports</code> and when to use <code>module.exports</code>.</p>
<p><code>exports</code> isn't actually a global but rather local to each module.</p>
<p>See the <a href="https://nodejs.org/api/modules.html">module system documentation</a> for more information.</p>
<p>See the <a href="https://nodejs.org/api/modules.html">module section</a> for more information.</p>
<h2>setTimeout(cb, ms)<a id="all_settimeout_cb_ms" class="mark" href="#all_settimeout_cb_ms">#</a></h2>
<p>Run callback <code>cb</code> after <em>at least</em> <code>ms</code> milliseconds. The actual delay depends on external factors like OS timer granularity and system load.</p>
<p>The timeout must be in the range of 1-2,147,483,647 inclusive. If the value is outside that range, it's changed to 1 millisecond. Broadly speaking, a timer cannot span more than 24.8 days.</p>
<p>Returns an opaque value that represents the timer.</p>
<h2>clearTimeout(t)<a id="all_cleartimeout_t" class="mark" href="#all_cleartimeout_t">#</a></h2>
<p>Stop a timer that was previously created with <code>setTimeout()</code>. The callback will not execute.</p>
<h2>setInterval(cb, ms)<a id="all_setinterval_cb_ms" class="mark" href="#all_setinterval_cb_ms">#</a></h2>
<p>Run callback <code>cb</code> repeatedly every <code>ms</code> milliseconds. Note that the actual interval may vary, depending on external factors like OS timer granularity and system load. It's never less than <code>ms</code> but it may be longer.</p>
<p>The interval must be in the range of 1-2,147,483,647 inclusive. If the value is outside that range, it's changed to 1 millisecond. Broadly speaking, a timer cannot span more than 24.8 days.</p>
<p>Returns an opaque value that represents the timer.</p>
<h2>clearInterval(t)<a id="all_clearinterval_t" class="mark" href="#all_clearinterval_t">#</a></h2>
<p>Stop a timer that was previously created with <code>setInterval()</code>. The callback will not execute.</p>
<p>The timer functions are global variables. See the <a href="https://nodejs.org/api/timers.html">timers</a> section.</p>
<h1>console<a id="all_console_1" class="mark" href="#all_console_1">#</a></h1>
<pre class="api_stability_4 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">4</span> <span class="sh_symbol">-</span> API Frozen</pre>
<div class="signature">
<ul>
<li><span class="type">Object</span></li>
</ul>
</div>
<p>For printing to stdout and stderr. Similar to the console object functions provided by most web browsers, here the output is sent to stdout or stderr.</p>
<p>The console functions are synchronous when the destination is a terminal or a file (to avoid lost messages in case of premature exit) and asynchronous when it's a pipe (to avoid blocking for long periods of time).</p>
<p>That is, in the following example, stdout is non-blocking while stderr is blocking:</p>
<pre class="sh_sourceCode"><code>$ node script<span class="sh_symbol">.</span>js <span class="sh_number">2</span><span class="sh_symbol">&gt;</span> error<span class="sh_symbol">.</span>log <span class="sh_symbol">|</span> tee info<span class="sh_symbol">.</span>log</code></pre>
<p>In daily use, the blocking/non-blocking dichotomy is not something you should worry about unless you log huge amounts of data.</p>
<h2>console.log([data][, ...])<a id="all_console_log_data" class="mark" href="#all_console_log_data">#</a></h2>
<p>Prints to stdout with newline. This function can take multiple arguments in a <code>printf()</code>-like way. Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> count <span class="sh_symbol">=</span> <span class="sh_number">5</span><span class="sh_symbol">;</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'count: %d'</span><span class="sh_symbol">,</span> count<span class="sh_symbol">);</span>
<span class="sh_comment">// prints 'count: 5'</span></code></pre>
<p>If formatting elements are not found in the first string then <code>util.inspect</code> is used on each argument. See <a href="https://nodejs.org/api/util.html#util_util_format_format">util.format()</a> for more information.</p>
<h2>console.info([data][, ...])<a id="all_console_info_data" class="mark" href="#all_console_info_data">#</a></h2>
<p>Same as <code>console.log</code>.</p>
<h2>console.error([data][, ...])<a id="all_console_error_data" class="mark" href="#all_console_error_data">#</a></h2>
<p>Same as <code>console.log</code> but prints to stderr.</p>
<h2>console.warn([data][, ...])<a id="all_console_warn_data" class="mark" href="#all_console_warn_data">#</a></h2>
<p>Same as <code>console.error</code>.</p>
<h2>console.dir(obj[, options])<a id="all_console_dir_obj_options" class="mark" href="#all_console_dir_obj_options">#</a></h2>
<p>Uses <code>util.inspect</code> on <code>obj</code> and prints resulting string to stdout. This function bypasses any custom <code>inspect()</code> function on <code>obj</code>. An optional <em>options</em> object may be passed that alters certain aspects of the formatted string:</p>
<ul>
<li>
<p><code>showHidden</code> - if <code>true</code> then the object's non-enumerable properties will be shown too. Defaults to <code>false</code>.</p>
</li>
<li>
<p><code>depth</code> - tells <code>inspect</code> how many times to recurse while formatting the object. This is useful for inspecting large complicated objects. Defaults to <code>2</code>. To make it recurse indefinitely pass <code>null</code>.</p>
</li>
<li>
<p><code>colors</code> - if <code>true</code>, then the output will be styled with ANSI color codes. Defaults to <code>false</code>. Colors are customizable, see below.</p>
</li>
</ul>
<h2>console.time(label)<a id="all_console_time_label" class="mark" href="#all_console_time_label">#</a></h2>
<p>Mark a time.</p>
<h2>console.timeEnd(label)<a id="all_console_timeend_label" class="mark" href="#all_console_timeend_label">#</a></h2>
<p>Finish timer, record output. Example:</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">time</span><span class="sh_symbol">(</span><span class="sh_string">'100-elements'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">100</span><span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  <span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>
console<span class="sh_symbol">.</span><span class="sh_function">timeEnd</span><span class="sh_symbol">(</span><span class="sh_string">'100-elements'</span><span class="sh_symbol">);</span>
<span class="sh_comment">// prints 100-elements: 262ms</span></code></pre>
<h2>console.trace(message[, ...])<a id="all_console_trace_message" class="mark" href="#all_console_trace_message">#</a></h2>
<p>Print to stderr <code>'Trace :'</code>, followed by the formatted message and stack trace to the current position.</p>
<h2>console.assert(value[, message][, ...])<a id="all_console_assert_value_message" class="mark" href="#all_console_assert_value_message">#</a></h2>
<p>Similar to <a href="https://nodejs.org/api/assert.html#assert_assert_value_message_assert_ok_value_message">assert.ok()</a>, but the error message is formatted as <code>util.format(message...)</code>.</p>
<h1>Timers<a id="all_timers" class="mark" href="#all_timers">#</a></h1>
<pre class="api_stability_5 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">5</span> <span class="sh_symbol">-</span> Locked</pre>
<p>All of the timer functions are globals. You do not need to <code>require()</code> this module in order to use them.</p>
<h2>setTimeout(callback, delay[, arg][, ...])<a id="all_settimeout_callback_delay_arg" class="mark" href="#all_settimeout_callback_delay_arg">#</a></h2>
<p>To schedule execution of a one-time <code>callback</code> after <code>delay</code> milliseconds. Returns a <code>timeoutObject</code> for possible use with <code>clearTimeout()</code>. Optionally you can also pass arguments to the callback.</p>
<p>It is important to note that your callback will probably not be called in exactly <code>delay</code> milliseconds - Node.js makes no guarantees about the exact timing of when the callback will fire, nor of the ordering things will fire in. The callback will be called as close as possible to the time specified.</p>
<h2>clearTimeout(timeoutObject)<a id="all_cleartimeout_timeoutobject" class="mark" href="#all_cleartimeout_timeoutobject">#</a></h2>
<p>Prevents a timeout from triggering.</p>
<h2>setInterval(callback, delay[, arg][, ...])<a id="all_setinterval_callback_delay_arg" class="mark" href="#all_setinterval_callback_delay_arg">#</a></h2>
<p>To schedule the repeated execution of <code>callback</code> every <code>delay</code> milliseconds. Returns a <code>intervalObject</code> for possible use with <code>clearInterval()</code>. Optionally you can also pass arguments to the callback.</p>
<h2>clearInterval(intervalObject)<a id="all_clearinterval_intervalobject" class="mark" href="#all_clearinterval_intervalobject">#</a></h2>
<p>Stops an interval from triggering.</p>
<h2>unref()<a id="all_unref" class="mark" href="#all_unref">#</a></h2>
<p>The opaque value returned by <code>setTimeout</code> and <code>setInterval</code> also has the method <code>timer.unref()</code> which will allow you to create a timer that is active but if it is the only item left in the event loop won't keep the program running. If the timer is already <code>unref</code>d calling <code>unref</code> again will have no effect.</p>
<p>In the case of <code>setTimeout</code> when you <code>unref</code> you create a separate timer that will wakeup the event loop, creating too many of these may adversely effect event loop performance -- use wisely.</p>
<h2>ref()<a id="all_ref" class="mark" href="#all_ref">#</a></h2>
<p>If you had previously <code>unref()</code>d a timer you can call <code>ref()</code> to explicitly request the timer hold the program open. If the timer is already <code>ref</code>d calling <code>ref</code> again will have no effect.</p>
<h2>setImmediate(callback[, arg][, ...])<a id="all_setimmediate_callback_arg" class="mark" href="#all_setimmediate_callback_arg">#</a></h2>
<p>To schedule the "immediate" execution of <code>callback</code> after I/O events callbacks and before <code>setTimeout</code> and <code>setInterval</code> . Returns an <code>immediateObject</code> for possible use with <code>clearImmediate()</code>. Optionally you can also pass arguments to the callback.</p>
<p>Callbacks for immediates are queued in the order in which they were created. The entire callback queue is processed every event loop iteration. If you queue an immediate from inside an executing callback, that immediate won't fire until the next event loop iteration.</p>
<h2>clearImmediate(immediateObject)<a id="all_clearimmediate_immediateobject" class="mark" href="#all_clearimmediate_immediateobject">#</a></h2>
<p>Stops an immediate from triggering.</p>
<h1>Modules<a id="all_modules" class="mark" href="#all_modules">#</a></h1>
<pre class="api_stability_5 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">5</span> <span class="sh_symbol">-</span> Locked</pre>
<p>Node has a simple module loading system. In Node, files and modules are in one-to-one correspondence. As an example, <code>foo.js</code> loads the module <code>circle.js</code> in the same directory.</p>
<p>The contents of <code>foo.js</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> circle <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./circle.js'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> <span class="sh_string">'The area of a circle of radius 4 is '</span>
           <span class="sh_symbol">+</span> circle<span class="sh_symbol">.</span><span class="sh_function">area</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">));</span></code></pre>
<p>The contents of <code>circle.js</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> PI <span class="sh_symbol">=</span> <span class="sh_predef_var">Math</span><span class="sh_symbol">.</span>PI<span class="sh_symbol">;</span>

exports<span class="sh_symbol">.</span>area <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>r<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">return</span> PI <span class="sh_symbol">*</span> r <span class="sh_symbol">*</span> r<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

exports<span class="sh_symbol">.</span>circumference <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>r<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">return</span> <span class="sh_number">2</span> <span class="sh_symbol">*</span> PI <span class="sh_symbol">*</span> r<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span></code></pre>
<p>The module <code>circle.js</code> has exported the functions <code>area()</code> and <code>circumference()</code>. To add functions and objects to the root of your module, you can add them to the special <code>exports</code> object.</p>
<p>Variables local to the module will be private, as though the module was wrapped in a function. In this example the variable <code>PI</code> is private to <code>circle.js</code>.</p>
<p>If you want the root of your module's export to be a function (such as a constructor) or if you want to export a complete object in one assignment instead of building it one property at a time, assign it to <code>module.exports</code> instead of <code>exports</code>.</p>
<p>Below, <code>bar.js</code> makes use of the <code>square</code> module, which exports a constructor:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> square <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./square.js'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> mySquare <span class="sh_symbol">=</span> <span class="sh_function">square</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'The area of my square is '</span> <span class="sh_symbol">+</span> mySquare<span class="sh_symbol">.</span><span class="sh_function">area</span><span class="sh_symbol">());</span></code></pre>
<p>The <code>square</code> module is defined in <code>square.js</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// assigning to exports will not modify module, must use module.exports</span>
module<span class="sh_symbol">.</span>exports <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>width<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">return</span> <span class="sh_cbracket">{</span>
    area<span class="sh_symbol">:</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">return</span> width <span class="sh_symbol">*</span> width<span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span></code></pre>
<p>The module system is implemented in the <code>require("module")</code> module.</p>
<h2>Cycles<a id="all_cycles" class="mark" href="#all_cycles">#</a></h2>
<p>When there are circular <code>require()</code> calls, a module might not have finished executing when it is returned.</p>
<p>Consider this situation:</p>
<p><code>a.js</code>:</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'a starting'</span><span class="sh_symbol">);</span>
exports<span class="sh_symbol">.</span>done <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> b <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./b.js'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'in a, b.done = %j'</span><span class="sh_symbol">,</span> b<span class="sh_symbol">.</span>done<span class="sh_symbol">);</span>
exports<span class="sh_symbol">.</span>done <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'a done'</span><span class="sh_symbol">);</span></code></pre>
<p><code>b.js</code>:</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'b starting'</span><span class="sh_symbol">);</span>
exports<span class="sh_symbol">.</span>done <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> a <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./a.js'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'in b, a.done = %j'</span><span class="sh_symbol">,</span> a<span class="sh_symbol">.</span>done<span class="sh_symbol">);</span>
exports<span class="sh_symbol">.</span>done <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'b done'</span><span class="sh_symbol">);</span></code></pre>
<p><code>main.js</code>:</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'main starting'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> a <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./a.js'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> b <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./b.js'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'in main, a.done=%j, b.done=%j'</span><span class="sh_symbol">,</span> a<span class="sh_symbol">.</span>done<span class="sh_symbol">,</span> b<span class="sh_symbol">.</span>done<span class="sh_symbol">);</span></code></pre>
<p>When <code>main.js</code> loads <code>a.js</code>, then <code>a.js</code> in turn loads <code>b.js</code>. At that point, <code>b.js</code> tries to load <code>a.js</code>. In order to prevent an infinite loop, an <strong>unfinished copy</strong> of the <code>a.js</code> exports object is returned to the <code>b.js</code> module. <code>b.js</code> then finishes loading, and its <code>exports</code> object is provided to the <code>a.js</code> module.</p>
<p>By the time <code>main.js</code> has loaded both modules, they're both finished. The output of this program would thus be:</p>
<pre class="sh_sourceCode"><code>$ node main<span class="sh_symbol">.</span>js
main starting
a starting
b starting
<span class="sh_keyword">in</span> b<span class="sh_symbol">,</span> a<span class="sh_symbol">.</span>done <span class="sh_symbol">=</span> <span class="sh_keyword">false</span>
b done
<span class="sh_keyword">in</span> a<span class="sh_symbol">,</span> b<span class="sh_symbol">.</span>done <span class="sh_symbol">=</span> <span class="sh_keyword">true</span>
a done
<span class="sh_keyword">in</span> main<span class="sh_symbol">,</span> a<span class="sh_symbol">.</span>done<span class="sh_symbol">=</span><span class="sh_keyword">true</span><span class="sh_symbol">,</span> b<span class="sh_symbol">.</span>done<span class="sh_symbol">=</span><span class="sh_keyword">true</span></code></pre>
<p>If you have cyclic module dependencies in your program, make sure to plan accordingly.</p>
<h2>Core Modules<a id="all_core_modules" class="mark" href="#all_core_modules">#</a></h2>
<p>Node has several modules compiled into the binary. These modules are described in greater detail elsewhere in this documentation.</p>
<p>The core modules are defined in node's source in the <code>lib/</code> folder.</p>
<p>Core modules are always preferentially loaded if their identifier is passed to <code>require()</code>. For instance, <code>require('http')</code> will always return the built in HTTP module, even if there is a file by that name.</p>
<h2>File Modules<a id="all_file_modules" class="mark" href="#all_file_modules">#</a></h2>
<p>If the exact filename is not found, then node will attempt to load the required filename with the added extension of <code>.js</code>, <code>.json</code>, and then <code>.node</code>.</p>
<p><code>.js</code> files are interpreted as JavaScript text files, and <code>.json</code> files are parsed as JSON text files. <code>.node</code> files are interpreted as compiled addon modules loaded with <code>dlopen</code>.</p>
<p>A module prefixed with <code>'/'</code> is an absolute path to the file. For example, <code>require('/home/marco/foo.js')</code> will load the file at <code>/home/marco/foo.js</code>.</p>
<p>A module prefixed with <code>'./'</code> is relative to the file calling <code>require()</code>. That is, <code>circle.js</code> must be in the same directory as <code>foo.js</code> for <code>require('./circle')</code> to find it.</p>
<p>Without a leading '/' or './' to indicate a file, the module is either a "core module" or is loaded from a <code>node_modules</code> folder.</p>
<p>If the given path does not exist, <code>require()</code> will throw an Error with its <code>code</code> property set to <code>'MODULE_NOT_FOUND'</code>.</p>
<h2>Loading from <code>node_modules</code> Folders<a id="all_loading_from_node_modules_folders" class="mark" href="#all_loading_from_node_modules_folders">#</a></h2>
<p>If the module identifier passed to <code>require()</code> is not a native module, and does not begin with <code>'/'</code>, <code>'../'</code>, or <code>'./'</code>, then node starts at the parent directory of the current module, and adds <code>/node_modules</code>, and attempts to load the module from that location.</p>
<p>If it is not found there, then it moves to the parent directory, and so on, until the root of the file system is reached.</p>
<p>For example, if the file at <code>'/home/ry/projects/foo.js'</code> called <code>require('bar.js')</code>, then node would look in the following locations, in this order:</p>
<ul>
<li><code>/home/ry/projects/node_modules/bar.js</code></li>
<li><code>/home/ry/node_modules/bar.js</code></li>
<li><code>/home/node_modules/bar.js</code></li>
<li><code>/node_modules/bar.js</code></li>
</ul>
<p>This allows programs to localize their dependencies, so that they do not clash.</p>
<p>You can require specific files or sub modules distributed with a module by including a path suffix after the module name. For instance <code>require('example-module/path/to/file')</code> would resolve <code>path/to/file</code> relative to where <code>example-module</code> is located. The suffixed path follows the same module resolution semantics.</p>
<h2>Folders as Modules<a id="all_folders_as_modules" class="mark" href="#all_folders_as_modules">#</a></h2>
<p>It is convenient to organize programs and libraries into self-contained directories, and then provide a single entry point to that library. There are three ways in which a folder may be passed to <code>require()</code> as an argument.</p>
<p>The first is to create a <code>package.json</code> file in the root of the folder, which specifies a <code>main</code> module. An example package.json file might look like this:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> <span class="sh_string">"name"</span> <span class="sh_symbol">:</span> <span class="sh_string">"some-library"</span><span class="sh_symbol">,</span>
  <span class="sh_string">"main"</span> <span class="sh_symbol">:</span> <span class="sh_string">"./lib/some-library.js"</span> <span class="sh_cbracket">}</span></code></pre>
<p>If this was in a folder at <code>./some-library</code>, then <code>require('./some-library')</code> would attempt to load <code>./some-library/lib/some-library.js</code>.</p>
<p>This is the extent of Node's awareness of package.json files.</p>
<p>If there is no package.json file present in the directory, then node will attempt to load an <code>index.js</code> or <code>index.node</code> file out of that directory. For example, if there was no package.json file in the above example, then <code>require('./some-library')</code> would attempt to load:</p>
<ul>
<li><code>./some-library/index.js</code></li>
<li><code>./some-library/index.node</code></li>
</ul>
<h2>Caching<a id="all_caching" class="mark" href="#all_caching">#</a></h2>
<p>Modules are cached after the first time they are loaded. This means (among other things) that every call to <code>require('foo')</code> will get exactly the same object returned, if it would resolve to the same file.</p>
<p>Multiple calls to <code>require('foo')</code> may not cause the module code to be executed multiple times. This is an important feature. With it, "partially done" objects can be returned, thus allowing transitive dependencies to be loaded even when they would cause cycles.</p>
<p>If you want to have a module execute code multiple times, then export a function, and call that function.</p>
<h3>Module Caching Caveats<a id="all_module_caching_caveats" class="mark" href="#all_module_caching_caveats">#</a></h3>
<p>Modules are cached based on their resolved filename. Since modules may resolve to a different filename based on the location of the calling module (loading from <code>node_modules</code> folders), it is not a <em>guarantee</em> that <code>require('foo')</code> will always return the exact same object, if it would resolve to different files.</p>
<h2>The <code>module</code> Object<a id="all_the_module_object" class="mark" href="#all_the_module_object">#</a></h2>
<ul>
<li>{Object}</li>
</ul>
<p>In each module, the <code>module</code> free variable is a reference to the object representing the current module. For convenience, <code>module.exports</code> is also accessible via the <code>exports</code> module-global. <code>module</code> isn't actually a global but rather local to each module.</p>
<h3>module.exports<a id="all_module_exports" class="mark" href="#all_module_exports">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Object</span></li>
</ul>
</div>
<p>The <code>module.exports</code> object is created by the Module system. Sometimes this is not acceptable; many want their module to be an instance of some class. To do this, assign the desired export object to <code>module.exports</code>. Note that assigning the desired object to <code>exports</code> will simply rebind the local <code>exports</code> variable, which is probably not what you want to do.</p>
<p>For example suppose we were making a module called <code>a.js</code></p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> EventEmitter <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'events'</span><span class="sh_symbol">).</span>EventEmitter<span class="sh_symbol">;</span>

module<span class="sh_symbol">.</span>exports <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">EventEmitter</span><span class="sh_symbol">();</span>

<span class="sh_comment">// Do some work, and after some time emit</span>
<span class="sh_comment">// the 'ready' event from the module itself.</span>
<span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  module<span class="sh_symbol">.</span>exports<span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">'ready'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span></code></pre>
<p>Then in another file we could do</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> a <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./a'</span><span class="sh_symbol">);</span>
a<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'ready'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'module a is ready'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Note that assignment to <code>module.exports</code> must be done immediately. It cannot be done in any callbacks. This does not work:</p>
<p>x.js:</p>
<pre class="sh_sourceCode"><code><span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  module<span class="sh_symbol">.</span>exports <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> a<span class="sh_symbol">:</span> <span class="sh_string">"hello"</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span></code></pre>
<p>y.js:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> x <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./x'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>x<span class="sh_symbol">.</span>a<span class="sh_symbol">);</span></code></pre>
<h4>exports alias<a id="all_exports_alias" class="mark" href="#all_exports_alias">#</a></h4>
<p>The <code>exports</code> variable that is available within a module starts as a reference to <code>module.exports</code>. As with any variable, if you assign a new value to it, it is no longer bound to the previous value.</p>
<p>To illustrate the behaviour, imagine this hypothetical implementation of <code>require()</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">function</span> <span class="sh_function">require</span><span class="sh_symbol">(...)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// ...</span>
  <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>module<span class="sh_symbol">,</span> exports<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// Your module code here</span>
    exports <span class="sh_symbol">=</span> some_func<span class="sh_symbol">;</span>        <span class="sh_comment">// re-assigns exports, exports is no longer</span>
                                <span class="sh_comment">// a shortcut, and nothing is exported.</span>
    module<span class="sh_symbol">.</span>exports <span class="sh_symbol">=</span> some_func<span class="sh_symbol">;</span> <span class="sh_comment">// makes your module export 0</span>
  <span class="sh_cbracket">}</span> <span class="sh_symbol">(</span>module<span class="sh_symbol">,</span> module<span class="sh_symbol">.</span>exports<span class="sh_symbol">);</span>
  <span class="sh_keyword">return</span> module<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span></code></pre>
<p>As a guideline, if the relationship between <code>exports</code> and <code>module.exports</code> seems like magic to you, ignore <code>exports</code> and only use <code>module.exports</code>.</p>
<h3>module.require(id)<a id="all_module_require_id" class="mark" href="#all_module_require_id">#</a></h3>
<div class="signature">
<ul>
<li><code>id</code> <span class="type">String</span></li>
<li>Return: <span class="type">Object</span> <code>module.exports</code> from the resolved module</li>
</ul>
</div>
<p>The <code>module.require</code> method provides a way to load a module as if <code>require()</code> was called from the original module.</p>
<p>Note that in order to do this, you must get a reference to the <code>module</code> object. Since <code>require()</code> returns the <code>module.exports</code>, and the <code>module</code> is typically <em>only</em> available within a specific module's code, it must be explicitly exported in order to be used.</p>
<h3>module.id<a id="all_module_id" class="mark" href="#all_module_id">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">String</span></li>
</ul>
</div>
<p>The identifier for the module. Typically this is the fully resolved filename.</p>
<h3>module.filename<a id="all_module_filename" class="mark" href="#all_module_filename">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">String</span></li>
</ul>
</div>
<p>The fully resolved filename to the module.</p>
<h3>module.loaded<a id="all_module_loaded" class="mark" href="#all_module_loaded">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Boolean</span></li>
</ul>
</div>
<p>Whether or not the module is done loading, or is in the process of loading.</p>
<h3>module.parent<a id="all_module_parent" class="mark" href="#all_module_parent">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Module Object</span></li>
</ul>
</div>
<p>The module that required this one.</p>
<h3>module.children<a id="all_module_children" class="mark" href="#all_module_children">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Array</span></li>
</ul>
</div>
<p>The module objects required by this one.</p>
<h2>All Together...<a id="all_all_together" class="mark" href="#all_all_together">#</a></h2>
<p>To get the exact filename that will be loaded when <code>require()</code> is called, use the <code>require.resolve()</code> function.</p>
<p>Putting together all of the above, here is the high-level algorithm in pseudocode of what require.resolve does:</p>
<pre class="sh_sourceCode"><code><span class="sh_function">require</span><span class="sh_symbol">(</span>X<span class="sh_symbol">)</span> from module at path Y
<span class="sh_number">1</span><span class="sh_symbol">.</span> If X is a core module<span class="sh_symbol">,</span>
   a<span class="sh_symbol">.</span> <span class="sh_keyword">return</span> the core module
   b<span class="sh_symbol">.</span> STOP
<span class="sh_number">2</span><span class="sh_symbol">.</span> If X begins <span class="sh_keyword">with</span> <span class="sh_string">'./'</span> or <span class="sh_string">'/'</span> or <span class="sh_string">'../'</span>
   a<span class="sh_symbol">.</span> <span class="sh_function">LOAD_AS_FILE</span><span class="sh_symbol">(</span>Y <span class="sh_symbol">+</span> X<span class="sh_symbol">)</span>
   b<span class="sh_symbol">.</span> <span class="sh_function">LOAD_AS_DIRECTORY</span><span class="sh_symbol">(</span>Y <span class="sh_symbol">+</span> X<span class="sh_symbol">)</span>
<span class="sh_number">3</span><span class="sh_symbol">.</span> <span class="sh_function">LOAD_NODE_MODULES</span><span class="sh_symbol">(</span>X<span class="sh_symbol">,</span> <span class="sh_function">dirname</span><span class="sh_symbol">(</span>Y<span class="sh_symbol">))</span>
<span class="sh_number">4</span><span class="sh_symbol">.</span> THROW <span class="sh_string">"not found"</span>

<span class="sh_function">LOAD_AS_FILE</span><span class="sh_symbol">(</span>X<span class="sh_symbol">)</span>
<span class="sh_number">1</span><span class="sh_symbol">.</span> If X is a file<span class="sh_symbol">,</span> load X as JavaScript text<span class="sh_symbol">.</span>  STOP
<span class="sh_number">2</span><span class="sh_symbol">.</span> If X<span class="sh_symbol">.</span>js is a file<span class="sh_symbol">,</span> load X<span class="sh_symbol">.</span>js as JavaScript text<span class="sh_symbol">.</span>  STOP
<span class="sh_number">3</span><span class="sh_symbol">.</span> If X<span class="sh_symbol">.</span>json is a file<span class="sh_symbol">,</span> parse X<span class="sh_symbol">.</span>json to a JavaScript <span class="sh_predef_func">Object</span><span class="sh_symbol">.</span>  STOP
<span class="sh_number">4</span><span class="sh_symbol">.</span> If X<span class="sh_symbol">.</span>node is a file<span class="sh_symbol">,</span> load X<span class="sh_symbol">.</span>node as binary addon<span class="sh_symbol">.</span>  STOP

<span class="sh_function">LOAD_AS_DIRECTORY</span><span class="sh_symbol">(</span>X<span class="sh_symbol">)</span>
<span class="sh_number">1</span><span class="sh_symbol">.</span> If <span class="sh_normal">X</span><span class="sh_symbol">/</span>package<span class="sh_symbol">.</span>json is a file<span class="sh_symbol">,</span>
   a<span class="sh_symbol">.</span> Parse <span class="sh_normal">X</span><span class="sh_symbol">/</span>package<span class="sh_symbol">.</span>json<span class="sh_symbol">,</span> and look <span class="sh_keyword">for</span> <span class="sh_string">"main"</span> field<span class="sh_symbol">.</span>
   b<span class="sh_symbol">.</span> let M <span class="sh_symbol">=</span> X <span class="sh_symbol">+</span> <span class="sh_symbol">(</span>json main field<span class="sh_symbol">)</span>
   c<span class="sh_symbol">.</span> <span class="sh_function">LOAD_AS_FILE</span><span class="sh_symbol">(</span>M<span class="sh_symbol">)</span>
<span class="sh_number">2</span><span class="sh_symbol">.</span> If <span class="sh_normal">X</span><span class="sh_symbol">/</span>index<span class="sh_symbol">.</span>js is a file<span class="sh_symbol">,</span> load <span class="sh_normal">X</span><span class="sh_symbol">/</span>index<span class="sh_symbol">.</span>js as JavaScript text<span class="sh_symbol">.</span>  STOP
<span class="sh_number">3</span><span class="sh_symbol">.</span> If <span class="sh_normal">X</span><span class="sh_symbol">/</span>index<span class="sh_symbol">.</span>json is a file<span class="sh_symbol">,</span> parse <span class="sh_normal">X</span><span class="sh_symbol">/</span>index<span class="sh_symbol">.</span>json to a JavaScript object<span class="sh_symbol">.</span> STOP
<span class="sh_number">4</span><span class="sh_symbol">.</span> If <span class="sh_normal">X</span><span class="sh_symbol">/</span>index<span class="sh_symbol">.</span>node is a file<span class="sh_symbol">,</span> load <span class="sh_normal">X</span><span class="sh_symbol">/</span>index<span class="sh_symbol">.</span>node as binary addon<span class="sh_symbol">.</span>  STOP

<span class="sh_function">LOAD_NODE_MODULES</span><span class="sh_symbol">(</span>X<span class="sh_symbol">,</span> START<span class="sh_symbol">)</span>
<span class="sh_number">1</span><span class="sh_symbol">.</span> let DIRS<span class="sh_symbol">=</span><span class="sh_function">NODE_MODULES_PATHS</span><span class="sh_symbol">(</span>START<span class="sh_symbol">)</span>
<span class="sh_number">2</span><span class="sh_symbol">.</span> <span class="sh_keyword">for</span> each DIR <span class="sh_keyword">in</span> DIRS<span class="sh_symbol">:</span>
   a<span class="sh_symbol">.</span> <span class="sh_function">LOAD_AS_FILE</span><span class="sh_symbol">(</span><span class="sh_normal">DIR</span><span class="sh_symbol">/</span>X<span class="sh_symbol">)</span>
   b<span class="sh_symbol">.</span> <span class="sh_function">LOAD_AS_DIRECTORY</span><span class="sh_symbol">(</span><span class="sh_normal">DIR</span><span class="sh_symbol">/</span>X<span class="sh_symbol">)</span>

<span class="sh_function">NODE_MODULES_PATHS</span><span class="sh_symbol">(</span>START<span class="sh_symbol">)</span>
<span class="sh_number">1</span><span class="sh_symbol">.</span> let PARTS <span class="sh_symbol">=</span> path <span class="sh_function">split</span><span class="sh_symbol">(</span>START<span class="sh_symbol">)</span>
<span class="sh_number">2</span><span class="sh_symbol">.</span> let I <span class="sh_symbol">=</span> count of PARTS <span class="sh_symbol">-</span> <span class="sh_number">1</span>
<span class="sh_number">3</span><span class="sh_symbol">.</span> let DIRS <span class="sh_symbol">=</span> <span class="sh_symbol">[]</span>
<span class="sh_number">4</span><span class="sh_symbol">.</span> <span class="sh_keyword">while</span> I <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
   a<span class="sh_symbol">.</span> <span class="sh_keyword">if</span> PARTS<span class="sh_symbol">[</span>I<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_string">"node_modules"</span> CONTINUE
   c<span class="sh_symbol">.</span> DIR <span class="sh_symbol">=</span> path <span class="sh_function">join</span><span class="sh_symbol">(</span>PARTS<span class="sh_symbol">[</span><span class="sh_number">0</span> <span class="sh_symbol">..</span> I<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> <span class="sh_string">"node_modules"</span><span class="sh_symbol">)</span>
   b<span class="sh_symbol">.</span> DIRS <span class="sh_symbol">=</span> DIRS <span class="sh_symbol">+</span> DIR
   c<span class="sh_symbol">.</span> let I <span class="sh_symbol">=</span> I <span class="sh_symbol">-</span> <span class="sh_number">1</span>
<span class="sh_number">5</span><span class="sh_symbol">.</span> <span class="sh_keyword">return</span> DIRS</code></pre>
<h2>Loading from the global folders<a id="all_loading_from_the_global_folders" class="mark" href="#all_loading_from_the_global_folders">#</a></h2>
<p>If the <code>NODE_PATH</code> environment variable is set to a colon-delimited list of absolute paths, then node will search those paths for modules if they are not found elsewhere. (Note: On Windows, <code>NODE_PATH</code> is delimited by semicolons instead of colons.)</p>
<p>Additionally, node will search in the following locations:</p>
<ul>
<li>1: <code>$HOME/.node_modules</code></li>
<li>2: <code>$HOME/.node_libraries</code></li>
<li>3: <code>$PREFIX/lib/node</code></li>
</ul>
<p>Where <code>$HOME</code> is the user's home directory, and <code>$PREFIX</code> is node's configured <code>node_prefix</code>.</p>
<p>These are mostly for historic reasons. You are highly encouraged to place your dependencies locally in <code>node_modules</code> folders. They will be loaded faster, and more reliably.</p>
<h2>Accessing the main module<a id="all_accessing_the_main_module" class="mark" href="#all_accessing_the_main_module">#</a></h2>
<p>When a file is run directly from Node, <code>require.main</code> is set to its <code>module</code>. That means that you can determine whether a file has been run directly by testing</p>
<pre class="sh_sourceCode"><code>require<span class="sh_symbol">.</span>main <span class="sh_symbol">===</span> module</code></pre>
<p>For a file <code>foo.js</code>, this will be <code>true</code> if run via <code>node foo.js</code>, but <code>false</code> if run by <code>require('./foo')</code>.</p>
<p>Because <code>module</code> provides a <code>filename</code> property (normally equivalent to <code>__filename</code>), the entry point of the current application can be obtained by checking <code>require.main.filename</code>.</p>
<h2>Addenda: Package Manager Tips<a id="all_addenda_package_manager_tips" class="mark" href="#all_addenda_package_manager_tips">#</a></h2>
<p>The semantics of Node's <code>require()</code> function were designed to be general enough to support a number of sane directory structures. Package manager programs such as <code>dpkg</code>, <code>rpm</code>, and <code>npm</code> will hopefully find it possible to build native packages from Node modules without modification.</p>
<p>Below we give a suggested directory structure that could work:</p>
<p>Let's say that we wanted to have the folder at <code>/usr/lib/node/&lt;some-package&gt;/&lt;some-version&gt;</code> hold the contents of a specific version of a package.</p>
<p>Packages can depend on one another. In order to install package <code>foo</code>, you may have to install a specific version of package <code>bar</code>. The <code>bar</code> package may itself have dependencies, and in some cases, these dependencies may even collide or form cycles.</p>
<p>Since Node looks up the <code>realpath</code> of any modules it loads (that is, resolves symlinks), and then looks for their dependencies in the <code>node_modules</code> folders as described above, this situation is very simple to resolve with the following architecture:</p>
<ul>
<li><code>/usr/lib/node/foo/1.2.3/</code> - Contents of the <code>foo</code> package, version 1.2.3.</li>
<li><code>/usr/lib/node/bar/4.3.2/</code> - Contents of the <code>bar</code> package that <code>foo</code> depends on.</li>
<li><code>/usr/lib/node/foo/1.2.3/node_modules/bar</code> - Symbolic link to <code>/usr/lib/node/bar/4.3.2/</code>.</li>
<li><code>/usr/lib/node/bar/4.3.2/node_modules/*</code> - Symbolic links to the packages that <code>bar</code> depends on.</li>
</ul>
<p>Thus, even if a cycle is encountered, or if there are dependency conflicts, every module will be able to get a version of its dependency that it can use.</p>
<p>When the code in the <code>foo</code> package does <code>require('bar')</code>, it will get the version that is symlinked into <code>/usr/lib/node/foo/1.2.3/node_modules/bar</code>. Then, when the code in the <code>bar</code> package calls <code>require('quux')</code>, it'll get the version that is symlinked into <code>/usr/lib/node/bar/4.3.2/node_modules/quux</code>.</p>
<p>Furthermore, to make the module lookup process even more optimal, rather than putting packages directly in <code>/usr/lib/node</code>, we could put them in <code>/usr/lib/node_modules/&lt;name&gt;/&lt;version&gt;</code>. Then node will not bother looking for missing dependencies in <code>/usr/node_modules</code> or <code>/node_modules</code>.</p>
<p>In order to make modules available to the node REPL, it might be useful to also add the <code>/usr/lib/node_modules</code> folder to the <code>$NODE_PATH</code> environment variable. Since the module lookups using <code>node_modules</code> folders are all relative, and based on the real path of the files making the calls to <code>require()</code>, the packages themselves can be anywhere.</p>
<h1>Addons<a id="all_addons" class="mark" href="#all_addons">#</a></h1>
<p>Addons are dynamically linked shared objects. They can provide glue to C and C++ libraries. The API (at the moment) is rather complex, involving knowledge of several libraries:</p>
<ul>
<li>
<p>V8 JavaScript, a C++ library. Used for interfacing with JavaScript: creating objects, calling functions, etc. Documented mostly in the <code>v8.h</code> header file (<code>deps/v8/include/v8.h</code> in the Node source tree), which is also available <a href="http://izs.me/v8-docs/main.html">online</a>.</p>
</li>
<li>
<p><a href="https://github.com/joyent/libuv">libuv</a>, C event loop library. Anytime one needs to wait for a file descriptor to become readable, wait for a timer, or wait for a signal to be received one will need to interface with libuv. That is, if you perform any I/O, libuv will need to be used.</p>
</li>
<li>
<p>Internal Node libraries. Most importantly is the <code>node::ObjectWrap</code> class which you will likely want to derive from.</p>
</li>
<li>
<p>Others. Look in <code>deps/</code> for what else is available.</p>
</li>
</ul>
<p>Node statically compiles all its dependencies into the executable. When compiling your module, you don't need to worry about linking to any of these libraries.</p>
<p>All of the following examples are available for <a href="https://github.com/rvagg/node-addon-examples">download</a> and may be used as a starting-point for your own Addon.</p>
<h2>Hello world<a id="all_hello_world" class="mark" href="#all_hello_world">#</a></h2>
<p>To get started let's make a small Addon which is the C++ equivalent of the following JavaScript code:</p>
<pre class="sh_sourceCode"><code>module<span class="sh_symbol">.</span>exports<span class="sh_symbol">.</span>hello <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span> <span class="sh_keyword">return</span> <span class="sh_string">'world'</span><span class="sh_symbol">;</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span></code></pre>
<p>First we create a file <code>hello.cc</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// hello.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>

using namespace v8<span class="sh_symbol">;</span>

void <span class="sh_function">Method</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>
  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span><span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"world"</span><span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">init</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">NODE_SET_METHOD</span><span class="sh_symbol">(</span>exports<span class="sh_symbol">,</span> <span class="sh_string">"hello"</span><span class="sh_symbol">,</span> Method<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">,</span> init<span class="sh_symbol">)</span></code></pre>
<p>Note that all Node addons must export an initialization function:</p>
<pre class="sh_sourceCode"><code>void <span class="sh_function">Initialize</span> <span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">);</span>
<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>module_name<span class="sh_symbol">,</span> Initialize<span class="sh_symbol">)</span></code></pre>
<p>There is no semi-colon after <code>NODE_MODULE</code> as it's not a function (see <code>node.h</code>).</p>
<p>The <code>module_name</code> needs to match the filename of the final binary (minus the .node suffix).</p>
<p>The source code needs to be built into <code>addon.node</code>, the binary Addon. To do this we create a file called <code>binding.gyp</code> which describes the configuration to build your module in a JSON-like format. This file gets compiled by <a href="https://github.com/TooTallNate/node-gyp">node-gyp</a>.</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span>
  <span class="sh_string">"targets"</span><span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
    <span class="sh_cbracket">{</span>
      <span class="sh_string">"target_name"</span><span class="sh_symbol">:</span> <span class="sh_string">"addon"</span><span class="sh_symbol">,</span>
      <span class="sh_string">"sources"</span><span class="sh_symbol">:</span> <span class="sh_symbol">[</span> <span class="sh_string">"hello.cc"</span> <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span></code></pre>
<p>The next step is to generate the appropriate project build files for the current platform. Use <code>node-gyp configure</code> for that.</p>
<p>Now you will have either a <code>Makefile</code> (on Unix platforms) or a <code>vcxproj</code> file (on Windows) in the <code>build/</code> directory. Next invoke the <code>node-gyp build</code> command.</p>
<p>Now you have your compiled <code>.node</code> bindings file! The compiled bindings end up in <code>build/Release/</code>.</p>
<p>You can now use the binary addon in a Node project <code>hello.js</code> by pointing <code>require</code> to the recently built <code>hello.node</code> module:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// hello.js</span>
<span class="sh_keyword">var</span> addon <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./build/Release/addon'</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">.</span><span class="sh_function">hello</span><span class="sh_symbol">());</span> <span class="sh_comment">// 'world'</span></code></pre>
<p>Please see patterns below for further information or</p>
<p><a href="https://github.com/arturadib/node-qt">https://github.com/arturadib/node-qt</a> for an example in production.</p>
<h2>Addon patterns<a id="all_addon_patterns" class="mark" href="#all_addon_patterns">#</a></h2>
<p>Below are some addon patterns to help you get started. Consult the online <a href="http://izs.me/v8-docs/main.html">v8 reference</a> for help with the various v8 calls, and v8's <a href="http://code.google.com/apis/v8/embed.html">Embedder's Guide</a> for an explanation of several concepts used such as handles, scopes, function templates, etc.</p>
<p>In order to use these examples you need to compile them using <code>node-gyp</code>. Create the following <code>binding.gyp</code> file:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span>
  <span class="sh_string">"targets"</span><span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
    <span class="sh_cbracket">{</span>
      <span class="sh_string">"target_name"</span><span class="sh_symbol">:</span> <span class="sh_string">"addon"</span><span class="sh_symbol">,</span>
      <span class="sh_string">"sources"</span><span class="sh_symbol">:</span> <span class="sh_symbol">[</span> <span class="sh_string">"addon.cc"</span> <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span></code></pre>
<p>In cases where there is more than one <code>.cc</code> file, simply add the file name to the <code>sources</code> array, e.g.:</p>
<pre class="sh_sourceCode"><code><span class="sh_string">"sources"</span><span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">"addon.cc"</span><span class="sh_symbol">,</span> <span class="sh_string">"myexample.cc"</span><span class="sh_symbol">]</span></code></pre>
<p>Now that you have your <code>binding.gyp</code> ready, you can configure and build the addon:</p>
<pre class="sh_sourceCode"><code>$ node<span class="sh_symbol">-</span>gyp configure build</code></pre>
<h3>Function arguments<a id="all_function_arguments" class="mark" href="#all_function_arguments">#</a></h3>
<p>The following pattern illustrates how to read arguments from JavaScript function calls and return a result. This is the main and only needed source <code>addon.cc</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// addon.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>

using namespace v8<span class="sh_symbol">;</span>

void <span class="sh_function">Add</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">Length</span><span class="sh_symbol">()</span> <span class="sh_symbol">&lt;</span> <span class="sh_number">2</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    isolate<span class="sh_symbol">-&gt;</span><span class="sh_function">ThrowException</span><span class="sh_symbol">(</span>Exception<span class="sh_symbol">::</span><span class="sh_predef_func">TypeError</span><span class="sh_symbol">(</span>
        <span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"Wrong number of arguments"</span><span class="sh_symbol">)));</span>
    <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span>

  <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span>args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">IsNumber</span><span class="sh_symbol">()</span> <span class="sh_symbol">||</span> <span class="sh_symbol">!</span>args<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">IsNumber</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
    isolate<span class="sh_symbol">-&gt;</span><span class="sh_function">ThrowException</span><span class="sh_symbol">(</span>Exception<span class="sh_symbol">::</span><span class="sh_predef_func">TypeError</span><span class="sh_symbol">(</span>
        <span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"Wrong arguments"</span><span class="sh_symbol">)));</span>
    <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span>

  double value <span class="sh_symbol">=</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">NumberValue</span><span class="sh_symbol">()</span> <span class="sh_symbol">+</span> args<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">NumberValue</span><span class="sh_symbol">();</span>
  Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Number</span><span class="sh_symbol">&gt;</span> num <span class="sh_symbol">=</span> <span class="sh_predef_func">Number</span><span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> value<span class="sh_symbol">);</span>

  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>num<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">Init</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">NODE_SET_METHOD</span><span class="sh_symbol">(</span>exports<span class="sh_symbol">,</span> <span class="sh_string">"add"</span><span class="sh_symbol">,</span> Add<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">,</span> Init<span class="sh_symbol">)</span></code></pre>
<p>You can test it with the following JavaScript snippet:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// test.js</span>
<span class="sh_keyword">var</span> addon <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./build/Release/addon'</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> <span class="sh_string">'This should be eight:'</span><span class="sh_symbol">,</span> addon<span class="sh_symbol">.</span><span class="sh_function">add</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span><span class="sh_number">5</span><span class="sh_symbol">)</span> <span class="sh_symbol">);</span></code></pre>
<h3>Callbacks<a id="all_callbacks" class="mark" href="#all_callbacks">#</a></h3>
<p>You can pass JavaScript functions to a C++ function and execute them from there. Here's <code>addon.cc</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// addon.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>

using namespace v8<span class="sh_symbol">;</span>

void <span class="sh_function">RunCallback</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> cb <span class="sh_symbol">=</span> Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;::</span><span class="sh_function">Cast</span><span class="sh_symbol">(</span>args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]);</span>
  <span class="sh_keyword">const</span> unsigned argc <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
  Local<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;</span> argv<span class="sh_symbol">[</span>argc<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> <span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"hello world"</span><span class="sh_symbol">)</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
  cb<span class="sh_symbol">-&gt;</span><span class="sh_function">Call</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">-&gt;</span><span class="sh_function">GetCurrentContext</span><span class="sh_symbol">()-&gt;</span><span class="sh_function">Global</span><span class="sh_symbol">(),</span> argc<span class="sh_symbol">,</span> argv<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">Init</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">,</span> Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> module<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">NODE_SET_METHOD</span><span class="sh_symbol">(</span>module<span class="sh_symbol">,</span> <span class="sh_string">"exports"</span><span class="sh_symbol">,</span> RunCallback<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">,</span> Init<span class="sh_symbol">)</span></code></pre>
<p>Note that this example uses a two-argument form of <code>Init()</code> that receives the full <code>module</code> object as the second argument. This allows the addon to completely overwrite <code>exports</code> with a single function instead of adding the function as a property of <code>exports</code>.</p>
<p>To test it run the following JavaScript snippet:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// test.js</span>
<span class="sh_keyword">var</span> addon <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./build/Release/addon'</span><span class="sh_symbol">);</span>

<span class="sh_function">addon</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>msg<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>msg<span class="sh_symbol">);</span> <span class="sh_comment">// 'hello world'</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Object factory<a id="all_object_factory" class="mark" href="#all_object_factory">#</a></h3>
<p>You can create and return new objects from within a C++ function with this <code>addon.cc</code> pattern, which returns an object with property <code>msg</code> that echoes the string passed to <code>createObject()</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// addon.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>

using namespace v8<span class="sh_symbol">;</span>

void <span class="sh_function">CreateObject</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> obj <span class="sh_symbol">=</span> <span class="sh_predef_func">Object</span><span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>
  obj<span class="sh_symbol">-&gt;</span><span class="sh_function">Set</span><span class="sh_symbol">(</span><span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"msg"</span><span class="sh_symbol">),</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">ToString</span><span class="sh_symbol">());</span>

  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>obj<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">Init</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">,</span> Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> module<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">NODE_SET_METHOD</span><span class="sh_symbol">(</span>module<span class="sh_symbol">,</span> <span class="sh_string">"exports"</span><span class="sh_symbol">,</span> CreateObject<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">,</span> Init<span class="sh_symbol">)</span></code></pre>
<p>To test it in JavaScript:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// test.js</span>
<span class="sh_keyword">var</span> addon <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./build/Release/addon'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> obj1 <span class="sh_symbol">=</span> <span class="sh_function">addon</span><span class="sh_symbol">(</span><span class="sh_string">'hello'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> obj2 <span class="sh_symbol">=</span> <span class="sh_function">addon</span><span class="sh_symbol">(</span><span class="sh_string">'world'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>obj1<span class="sh_symbol">.</span>msg<span class="sh_symbol">+</span><span class="sh_string">' '</span><span class="sh_symbol">+</span>obj2<span class="sh_symbol">.</span>msg<span class="sh_symbol">);</span> <span class="sh_comment">// 'hello world'</span></code></pre>
<h3>Function factory<a id="all_function_factory" class="mark" href="#all_function_factory">#</a></h3>
<p>This pattern illustrates how to create and return a JavaScript function that wraps a C++ function:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// addon.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>

using namespace v8<span class="sh_symbol">;</span>

void <span class="sh_function">MyFunction</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>
  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span><span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"hello world"</span><span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">CreateFunction</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  Local<span class="sh_symbol">&lt;</span>FunctionTemplate<span class="sh_symbol">&gt;</span> tpl <span class="sh_symbol">=</span> FunctionTemplate<span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> MyFunction<span class="sh_symbol">);</span>
  Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> fn <span class="sh_symbol">=</span> tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">GetFunction</span><span class="sh_symbol">();</span>

  <span class="sh_comment">// omit this to make it anonymous</span>
  fn<span class="sh_symbol">-&gt;</span><span class="sh_function">SetName</span><span class="sh_symbol">(</span><span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"theFunction"</span><span class="sh_symbol">));</span>

  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>fn<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">Init</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">,</span> Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> module<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">NODE_SET_METHOD</span><span class="sh_symbol">(</span>module<span class="sh_symbol">,</span> <span class="sh_string">"exports"</span><span class="sh_symbol">,</span> CreateFunction<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">,</span> Init<span class="sh_symbol">)</span></code></pre>
<p>To test:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// test.js</span>
<span class="sh_keyword">var</span> addon <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./build/Release/addon'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> fn <span class="sh_symbol">=</span> <span class="sh_function">addon</span><span class="sh_symbol">();</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_function">fn</span><span class="sh_symbol">());</span> <span class="sh_comment">// 'hello world'</span></code></pre>
<h3>Wrapping C++ objects<a id="all_wrapping_c_objects" class="mark" href="#all_wrapping_c_objects">#</a></h3>
<p>Here we will create a wrapper for a C++ object/class <code>MyObject</code> that can be instantiated in JavaScript through the <code>new</code> operator. First prepare the main module <code>addon.cc</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// addon.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_string">"myobject.h"</span>

using namespace v8<span class="sh_symbol">;</span>

void <span class="sh_function">InitAll</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  MyObject<span class="sh_symbol">::</span><span class="sh_function">Init</span><span class="sh_symbol">(</span>exports<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">,</span> InitAll<span class="sh_symbol">)</span></code></pre>
<p>Then in <code>myobject.h</code> make your wrapper inherit from <code>node::ObjectWrap</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// myobject.h</span>
#ifndef MYOBJECT_H
#define MYOBJECT_H

#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_symbol">&lt;</span>node_object_wrap<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>

<span class="sh_keyword">class</span> MyObject <span class="sh_symbol">:</span> <span class="sh_keyword">public</span> node<span class="sh_symbol">::</span>ObjectWrap <span class="sh_cbracket">{</span>
 <span class="sh_keyword">public</span><span class="sh_symbol">:</span>
  <span class="sh_keyword">static</span> void <span class="sh_function">Init</span><span class="sh_symbol">(</span>v8<span class="sh_symbol">::</span>Handle<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">);</span>

 <span class="sh_keyword">private</span><span class="sh_symbol">:</span>
  explicit <span class="sh_function">MyObject</span><span class="sh_symbol">(</span>double value <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
  <span class="sh_symbol">~</span><span class="sh_function">MyObject</span><span class="sh_symbol">();</span>

  <span class="sh_keyword">static</span> void <span class="sh_function">New</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> v8<span class="sh_symbol">::</span>FunctionCallbackInfo<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">);</span>
  <span class="sh_keyword">static</span> void <span class="sh_function">PlusOne</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> v8<span class="sh_symbol">::</span>FunctionCallbackInfo<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">);</span>
  <span class="sh_keyword">static</span> v8<span class="sh_symbol">::</span>Persistent<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> constructor<span class="sh_symbol">;</span>
  double value_<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

#endif</code></pre>
<p>And in <code>myobject.cc</code> implement the various methods that you want to expose. Here we expose the method <code>plusOne</code> by adding it to the constructor's prototype:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// myobject.cc</span>
#include <span class="sh_string">"myobject.h"</span>

using namespace v8<span class="sh_symbol">;</span>

Persistent<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> MyObject<span class="sh_symbol">::</span>constructor<span class="sh_symbol">;</span>

MyObject<span class="sh_symbol">::</span><span class="sh_function">MyObject</span><span class="sh_symbol">(</span>double value<span class="sh_symbol">)</span> <span class="sh_symbol">:</span> <span class="sh_function">value_</span><span class="sh_symbol">(</span>value<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
<span class="sh_cbracket">}</span>

MyObject<span class="sh_symbol">::~</span><span class="sh_function">MyObject</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">Init</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>

  <span class="sh_comment">// Prepare constructor template</span>
  Local<span class="sh_symbol">&lt;</span>FunctionTemplate<span class="sh_symbol">&gt;</span> tpl <span class="sh_symbol">=</span> FunctionTemplate<span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> New<span class="sh_symbol">);</span>
  tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">SetClassName</span><span class="sh_symbol">(</span><span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"MyObject"</span><span class="sh_symbol">));</span>
  tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">InstanceTemplate</span><span class="sh_symbol">()-&gt;</span><span class="sh_function">SetInternalFieldCount</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span>

  <span class="sh_comment">// Prototype</span>
  <span class="sh_function">NODE_SET_PROTOTYPE_METHOD</span><span class="sh_symbol">(</span>tpl<span class="sh_symbol">,</span> <span class="sh_string">"plusOne"</span><span class="sh_symbol">,</span> PlusOne<span class="sh_symbol">);</span>

  constructor<span class="sh_symbol">.</span><span class="sh_function">Reset</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">GetFunction</span><span class="sh_symbol">());</span>
  exports<span class="sh_symbol">-&gt;</span><span class="sh_function">Set</span><span class="sh_symbol">(</span><span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"MyObject"</span><span class="sh_symbol">),</span>
               tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">GetFunction</span><span class="sh_symbol">());</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">IsConstructCall</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// Invoked as constructor: `new MyObject(...)`</span>
    double value <span class="sh_symbol">=</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">IsUndefined</span><span class="sh_symbol">()</span> <span class="sh_symbol">?</span> <span class="sh_number">0</span> <span class="sh_symbol">:</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">NumberValue</span><span class="sh_symbol">();</span>
    MyObject<span class="sh_symbol">*</span> obj <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">MyObject</span><span class="sh_symbol">(</span>value<span class="sh_symbol">);</span>
    obj<span class="sh_symbol">-&gt;</span><span class="sh_function">Wrap</span><span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">This</span><span class="sh_symbol">());</span>
    args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">This</span><span class="sh_symbol">());</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// Invoked as plain function `MyObject(...)`, turn into construct call.</span>
    <span class="sh_keyword">const</span> int argc <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    Local<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;</span> argv<span class="sh_symbol">[</span>argc<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
    Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> cons <span class="sh_symbol">=</span> Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> constructor<span class="sh_symbol">);</span>
    args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>cons<span class="sh_symbol">-&gt;</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span>argc<span class="sh_symbol">,</span> argv<span class="sh_symbol">));</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">PlusOne</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  MyObject<span class="sh_symbol">*</span> obj <span class="sh_symbol">=</span> ObjectWrap<span class="sh_symbol">::</span>Unwrap<span class="sh_symbol">&lt;</span>MyObject<span class="sh_symbol">&gt;(</span>args<span class="sh_symbol">.</span><span class="sh_function">Holder</span><span class="sh_symbol">());</span>
  obj<span class="sh_symbol">-&gt;</span>value_ <span class="sh_symbol">+=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>

  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span><span class="sh_predef_func">Number</span><span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> obj<span class="sh_symbol">-&gt;</span>value_<span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span></code></pre>
<p>Test it with:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// test.js</span>
<span class="sh_keyword">var</span> addon <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./build/Release/addon'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> obj <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> addon<span class="sh_symbol">.</span><span class="sh_function">MyObject</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 11</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 12</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 13</span></code></pre>
<h3>Factory of wrapped objects<a id="all_factory_of_wrapped_objects" class="mark" href="#all_factory_of_wrapped_objects">#</a></h3>
<p>This is useful when you want to be able to create native objects without explicitly instantiating them with the <code>new</code> operator in JavaScript, e.g.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> obj <span class="sh_symbol">=</span> addon<span class="sh_symbol">.</span><span class="sh_function">createObject</span><span class="sh_symbol">();</span>
<span class="sh_comment">// instead of:</span>
<span class="sh_comment">// var obj = new addon.Object();</span></code></pre>
<p>Let's register our <code>createObject</code> method in <code>addon.cc</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// addon.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_string">"myobject.h"</span>

using namespace v8<span class="sh_symbol">;</span>

void <span class="sh_function">CreateObject</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>
  MyObject<span class="sh_symbol">::</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span>args<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">InitAll</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">,</span> Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> module<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  MyObject<span class="sh_symbol">::</span><span class="sh_function">Init</span><span class="sh_symbol">();</span>

  <span class="sh_function">NODE_SET_METHOD</span><span class="sh_symbol">(</span>module<span class="sh_symbol">,</span> <span class="sh_string">"exports"</span><span class="sh_symbol">,</span> CreateObject<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">,</span> InitAll<span class="sh_symbol">)</span></code></pre>
<p>In <code>myobject.h</code> we now introduce the static method <code>NewInstance</code> that takes care of instantiating the object (i.e. it does the job of <code>new</code> in JavaScript):</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// myobject.h</span>
#ifndef MYOBJECT_H
#define MYOBJECT_H

#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_symbol">&lt;</span>node_object_wrap<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>

<span class="sh_keyword">class</span> MyObject <span class="sh_symbol">:</span> <span class="sh_keyword">public</span> node<span class="sh_symbol">::</span>ObjectWrap <span class="sh_cbracket">{</span>
 <span class="sh_keyword">public</span><span class="sh_symbol">:</span>
  <span class="sh_keyword">static</span> void <span class="sh_function">Init</span><span class="sh_symbol">();</span>
  <span class="sh_keyword">static</span> void <span class="sh_function">NewInstance</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> v8<span class="sh_symbol">::</span>FunctionCallbackInfo<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">);</span>

 <span class="sh_keyword">private</span><span class="sh_symbol">:</span>
  explicit <span class="sh_function">MyObject</span><span class="sh_symbol">(</span>double value <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
  <span class="sh_symbol">~</span><span class="sh_function">MyObject</span><span class="sh_symbol">();</span>

  <span class="sh_keyword">static</span> void <span class="sh_function">New</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> v8<span class="sh_symbol">::</span>FunctionCallbackInfo<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">);</span>
  <span class="sh_keyword">static</span> void <span class="sh_function">PlusOne</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> v8<span class="sh_symbol">::</span>FunctionCallbackInfo<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">);</span>
  <span class="sh_keyword">static</span> v8<span class="sh_symbol">::</span>Persistent<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> constructor<span class="sh_symbol">;</span>
  double value_<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

#endif</code></pre>
<p>The implementation is similar to the above in <code>myobject.cc</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// myobject.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_string">"myobject.h"</span>

using namespace v8<span class="sh_symbol">;</span>

Persistent<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> MyObject<span class="sh_symbol">::</span>constructor<span class="sh_symbol">;</span>

MyObject<span class="sh_symbol">::</span><span class="sh_function">MyObject</span><span class="sh_symbol">(</span>double value<span class="sh_symbol">)</span> <span class="sh_symbol">:</span> <span class="sh_function">value_</span><span class="sh_symbol">(</span>value<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
<span class="sh_cbracket">}</span>

MyObject<span class="sh_symbol">::~</span><span class="sh_function">MyObject</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">Init</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  <span class="sh_comment">// Prepare constructor template</span>
  Local<span class="sh_symbol">&lt;</span>FunctionTemplate<span class="sh_symbol">&gt;</span> tpl <span class="sh_symbol">=</span> FunctionTemplate<span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> New<span class="sh_symbol">);</span>
  tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">SetClassName</span><span class="sh_symbol">(</span><span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"MyObject"</span><span class="sh_symbol">));</span>
  tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">InstanceTemplate</span><span class="sh_symbol">()-&gt;</span><span class="sh_function">SetInternalFieldCount</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span>

  <span class="sh_comment">// Prototype</span>
  <span class="sh_function">NODE_SET_PROTOTYPE_METHOD</span><span class="sh_symbol">(</span>tpl<span class="sh_symbol">,</span> <span class="sh_string">"plusOne"</span><span class="sh_symbol">,</span> PlusOne<span class="sh_symbol">);</span>

  constructor<span class="sh_symbol">.</span><span class="sh_function">Reset</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">GetFunction</span><span class="sh_symbol">());</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">IsConstructCall</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// Invoked as constructor: `new MyObject(...)`</span>
    double value <span class="sh_symbol">=</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">IsUndefined</span><span class="sh_symbol">()</span> <span class="sh_symbol">?</span> <span class="sh_number">0</span> <span class="sh_symbol">:</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">NumberValue</span><span class="sh_symbol">();</span>
    MyObject<span class="sh_symbol">*</span> obj <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">MyObject</span><span class="sh_symbol">(</span>value<span class="sh_symbol">);</span>
    obj<span class="sh_symbol">-&gt;</span><span class="sh_function">Wrap</span><span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">This</span><span class="sh_symbol">());</span>
    args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">This</span><span class="sh_symbol">());</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// Invoked as plain function `MyObject(...)`, turn into construct call.</span>
    <span class="sh_keyword">const</span> int argc <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    Local<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;</span> argv<span class="sh_symbol">[</span>argc<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
    Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> cons <span class="sh_symbol">=</span> Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> constructor<span class="sh_symbol">);</span>
    args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>cons<span class="sh_symbol">-&gt;</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span>argc<span class="sh_symbol">,</span> argv<span class="sh_symbol">));</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  <span class="sh_keyword">const</span> unsigned argc <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
  Handle<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;</span> argv<span class="sh_symbol">[</span>argc<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
  Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> cons <span class="sh_symbol">=</span> Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> constructor<span class="sh_symbol">);</span>
  Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> instance <span class="sh_symbol">=</span> cons<span class="sh_symbol">-&gt;</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span>argc<span class="sh_symbol">,</span> argv<span class="sh_symbol">);</span>

  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>instance<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">PlusOne</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  MyObject<span class="sh_symbol">*</span> obj <span class="sh_symbol">=</span> ObjectWrap<span class="sh_symbol">::</span>Unwrap<span class="sh_symbol">&lt;</span>MyObject<span class="sh_symbol">&gt;(</span>args<span class="sh_symbol">.</span><span class="sh_function">Holder</span><span class="sh_symbol">());</span>
  obj<span class="sh_symbol">-&gt;</span>value_ <span class="sh_symbol">+=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>

  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span><span class="sh_predef_func">Number</span><span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> obj<span class="sh_symbol">-&gt;</span>value_<span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span></code></pre>
<p>Test it with:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// test.js</span>
<span class="sh_keyword">var</span> createObject <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./build/Release/addon'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> obj <span class="sh_symbol">=</span> <span class="sh_function">createObject</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 11</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 12</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 13</span>

<span class="sh_keyword">var</span> obj2 <span class="sh_symbol">=</span> <span class="sh_function">createObject</span><span class="sh_symbol">(</span><span class="sh_number">20</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj2<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 21</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj2<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 22</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> obj2<span class="sh_symbol">.</span><span class="sh_function">plusOne</span><span class="sh_symbol">()</span> <span class="sh_symbol">);</span> <span class="sh_comment">// 23</span></code></pre>
<h3>Passing wrapped objects around<a id="all_passing_wrapped_objects_around" class="mark" href="#all_passing_wrapped_objects_around">#</a></h3>
<p>In addition to wrapping and returning C++ objects, you can pass them around by unwrapping them with Node's <code>node::ObjectWrap::Unwrap</code> helper function. In the following <code>addon.cc</code> we introduce a function <code>add()</code> that can take on two <code>MyObject</code> objects:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// addon.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_symbol">&lt;</span>node_object_wrap<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_string">"myobject.h"</span>

using namespace v8<span class="sh_symbol">;</span>

void <span class="sh_function">CreateObject</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>
  MyObject<span class="sh_symbol">::</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span>args<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">Add</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  MyObject<span class="sh_symbol">*</span> obj1 <span class="sh_symbol">=</span> node<span class="sh_symbol">::</span>ObjectWrap<span class="sh_symbol">::</span>Unwrap<span class="sh_symbol">&lt;</span>MyObject<span class="sh_symbol">&gt;(</span>
      args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">ToObject</span><span class="sh_symbol">());</span>
  MyObject<span class="sh_symbol">*</span> obj2 <span class="sh_symbol">=</span> node<span class="sh_symbol">::</span>ObjectWrap<span class="sh_symbol">::</span>Unwrap<span class="sh_symbol">&lt;</span>MyObject<span class="sh_symbol">&gt;(</span>
      args<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">ToObject</span><span class="sh_symbol">());</span>

  double sum <span class="sh_symbol">=</span> obj1<span class="sh_symbol">-&gt;</span><span class="sh_function">value</span><span class="sh_symbol">()</span> <span class="sh_symbol">+</span> obj2<span class="sh_symbol">-&gt;</span><span class="sh_function">value</span><span class="sh_symbol">();</span>
  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span><span class="sh_predef_func">Number</span><span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> sum<span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span>

void <span class="sh_function">InitAll</span><span class="sh_symbol">(</span>Handle<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> exports<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  MyObject<span class="sh_symbol">::</span><span class="sh_function">Init</span><span class="sh_symbol">();</span>

  <span class="sh_function">NODE_SET_METHOD</span><span class="sh_symbol">(</span>exports<span class="sh_symbol">,</span> <span class="sh_string">"createObject"</span><span class="sh_symbol">,</span> CreateObject<span class="sh_symbol">);</span>
  <span class="sh_function">NODE_SET_METHOD</span><span class="sh_symbol">(</span>exports<span class="sh_symbol">,</span> <span class="sh_string">"add"</span><span class="sh_symbol">,</span> Add<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_function">NODE_MODULE</span><span class="sh_symbol">(</span>addon<span class="sh_symbol">,</span> InitAll<span class="sh_symbol">)</span></code></pre>
<p>To make things interesting we introduce a public method in <code>myobject.h</code> so we can probe private values after unwrapping the object:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// myobject.h</span>
#ifndef MYOBJECT_H
#define MYOBJECT_H

#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_symbol">&lt;</span>node_object_wrap<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>

<span class="sh_keyword">class</span> MyObject <span class="sh_symbol">:</span> <span class="sh_keyword">public</span> node<span class="sh_symbol">::</span>ObjectWrap <span class="sh_cbracket">{</span>
 <span class="sh_keyword">public</span><span class="sh_symbol">:</span>
  <span class="sh_keyword">static</span> void <span class="sh_function">Init</span><span class="sh_symbol">();</span>
  <span class="sh_keyword">static</span> void <span class="sh_function">NewInstance</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> v8<span class="sh_symbol">::</span>FunctionCallbackInfo<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">);</span>
  inline double <span class="sh_function">value</span><span class="sh_symbol">()</span> <span class="sh_keyword">const</span> <span class="sh_cbracket">{</span> <span class="sh_keyword">return</span> value_<span class="sh_symbol">;</span> <span class="sh_cbracket">}</span>

 <span class="sh_keyword">private</span><span class="sh_symbol">:</span>
  explicit <span class="sh_function">MyObject</span><span class="sh_symbol">(</span>double value <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
  <span class="sh_symbol">~</span><span class="sh_function">MyObject</span><span class="sh_symbol">();</span>

  <span class="sh_keyword">static</span> void <span class="sh_function">New</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> v8<span class="sh_symbol">::</span>FunctionCallbackInfo<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">);</span>
  <span class="sh_keyword">static</span> v8<span class="sh_symbol">::</span>Persistent<span class="sh_symbol">&lt;</span>v8<span class="sh_symbol">::</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> constructor<span class="sh_symbol">;</span>
  double value_<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

#endif</code></pre>
<p>The implementation of <code>myobject.cc</code> is similar as before:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// myobject.cc</span>
#include <span class="sh_symbol">&lt;</span>node<span class="sh_symbol">.</span>h<span class="sh_symbol">&gt;</span>
#include <span class="sh_string">"myobject.h"</span>

using namespace v8<span class="sh_symbol">;</span>

Persistent<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> MyObject<span class="sh_symbol">::</span>constructor<span class="sh_symbol">;</span>

MyObject<span class="sh_symbol">::</span><span class="sh_function">MyObject</span><span class="sh_symbol">(</span>double value<span class="sh_symbol">)</span> <span class="sh_symbol">:</span> <span class="sh_function">value_</span><span class="sh_symbol">(</span>value<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
<span class="sh_cbracket">}</span>

MyObject<span class="sh_symbol">::~</span><span class="sh_function">MyObject</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">Init</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>

  <span class="sh_comment">// Prepare constructor template</span>
  Local<span class="sh_symbol">&lt;</span>FunctionTemplate<span class="sh_symbol">&gt;</span> tpl <span class="sh_symbol">=</span> FunctionTemplate<span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> New<span class="sh_symbol">);</span>
  tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">SetClassName</span><span class="sh_symbol">(</span><span class="sh_predef_func">String</span><span class="sh_symbol">::</span><span class="sh_function">NewFromUtf8</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> <span class="sh_string">"MyObject"</span><span class="sh_symbol">));</span>
  tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">InstanceTemplate</span><span class="sh_symbol">()-&gt;</span><span class="sh_function">SetInternalFieldCount</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span>

  constructor<span class="sh_symbol">.</span><span class="sh_function">Reset</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> tpl<span class="sh_symbol">-&gt;</span><span class="sh_function">GetFunction</span><span class="sh_symbol">());</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">New</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">IsConstructCall</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// Invoked as constructor: `new MyObject(...)`</span>
    double value <span class="sh_symbol">=</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">IsUndefined</span><span class="sh_symbol">()</span> <span class="sh_symbol">?</span> <span class="sh_number">0</span> <span class="sh_symbol">:</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]-&gt;</span><span class="sh_function">NumberValue</span><span class="sh_symbol">();</span>
    MyObject<span class="sh_symbol">*</span> obj <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">MyObject</span><span class="sh_symbol">(</span>value<span class="sh_symbol">);</span>
    obj<span class="sh_symbol">-&gt;</span><span class="sh_function">Wrap</span><span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">This</span><span class="sh_symbol">());</span>
    args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>args<span class="sh_symbol">.</span><span class="sh_function">This</span><span class="sh_symbol">());</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// Invoked as plain function `MyObject(...)`, turn into construct call.</span>
    <span class="sh_keyword">const</span> int argc <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    Local<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;</span> argv<span class="sh_symbol">[</span>argc<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
    Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> cons <span class="sh_symbol">=</span> Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> constructor<span class="sh_symbol">);</span>
    args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>cons<span class="sh_symbol">-&gt;</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span>argc<span class="sh_symbol">,</span> argv<span class="sh_symbol">));</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>

void MyObject<span class="sh_symbol">::</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> FunctionCallbackInfo<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;&amp;</span> args<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Isolate<span class="sh_symbol">*</span> isolate <span class="sh_symbol">=</span> Isolate<span class="sh_symbol">::</span><span class="sh_function">GetCurrent</span><span class="sh_symbol">();</span>
  HandleScope <span class="sh_function">scope</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">);</span>

  <span class="sh_keyword">const</span> unsigned argc <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
  Handle<span class="sh_symbol">&lt;</span>Value<span class="sh_symbol">&gt;</span> argv<span class="sh_symbol">[</span>argc<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> args<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
  Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;</span> cons <span class="sh_symbol">=</span> Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Function</span><span class="sh_symbol">&gt;::</span><span class="sh_function">New</span><span class="sh_symbol">(</span>isolate<span class="sh_symbol">,</span> constructor<span class="sh_symbol">);</span>
  Local<span class="sh_symbol">&lt;</span><span class="sh_predef_func">Object</span><span class="sh_symbol">&gt;</span> instance <span class="sh_symbol">=</span> cons<span class="sh_symbol">-&gt;</span><span class="sh_function">NewInstance</span><span class="sh_symbol">(</span>argc<span class="sh_symbol">,</span> argv<span class="sh_symbol">);</span>

  args<span class="sh_symbol">.</span><span class="sh_function">GetReturnValue</span><span class="sh_symbol">().</span><span class="sh_function">Set</span><span class="sh_symbol">(</span>instance<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<p>Test it with:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// test.js</span>
<span class="sh_keyword">var</span> addon <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./build/Release/addon'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> obj1 <span class="sh_symbol">=</span> addon<span class="sh_symbol">.</span><span class="sh_function">createObject</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> obj2 <span class="sh_symbol">=</span> addon<span class="sh_symbol">.</span><span class="sh_function">createObject</span><span class="sh_symbol">(</span><span class="sh_number">20</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> result <span class="sh_symbol">=</span> addon<span class="sh_symbol">.</span><span class="sh_function">add</span><span class="sh_symbol">(</span>obj1<span class="sh_symbol">,</span> obj2<span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>result<span class="sh_symbol">);</span> <span class="sh_comment">// 30</span></code></pre>
<h1>process<a id="all_process_1" class="mark" href="#all_process_1">#</a></h1>
<p>The <code>process</code> object is a global object and can be accessed from anywhere. It is an instance of <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a>.</p>
<h2>Exit Codes<a id="all_exit_codes" class="mark" href="#all_exit_codes">#</a></h2>
<p>Node will normally exit with a <code>0</code> status code when no more async operations are pending. The following status codes are used in other cases:</p>
<ul>
<li><code>1</code> <strong>Uncaught Fatal Exception</strong> - There was an uncaught exception, and it was not handled by a domain or an <code>uncaughtException</code> event handler.</li>
<li><code>2</code> - Unused (reserved by Bash for builtin misuse)</li>
<li><code>3</code> <strong>Internal JavaScript Parse Error</strong> - The JavaScript source code internal in Node's bootstrapping process caused a parse error. This is extremely rare, and generally can only happen during development of Node itself.</li>
<li><code>4</code> <strong>Internal JavaScript Evaluation Failure</strong> - The JavaScript source code internal in Node's bootstrapping process failed to return a function value when evaluated. This is extremely rare, and generally can only happen during development of Node itself.</li>
<li><code>5</code> <strong>Fatal Error</strong> - There was a fatal unrecoverable error in V8. Typically a message will be printed to stderr with the prefix <code>FATAL ERROR</code>.</li>
<li><code>6</code> <strong>Non-function Internal Exception Handler</strong> - There was an uncaught exception, but the internal fatal exception handler function was somehow set to a non-function, and could not be called.</li>
<li><code>7</code> <strong>Internal Exception Handler Run-Time Failure</strong> - There was an uncaught exception, and the internal fatal exception handler function itself threw an error while attempting to handle it. This can happen, for example, if a <code>process.on('uncaughtException')</code> or <code>domain.on('error')</code> handler throws an error.</li>
<li><code>8</code> - Unused. In previous versions of Node, exit code 8 sometimes indicated an uncaught exception.</li>
<li><code>9</code> - <strong>Invalid Argument</strong> - Either an unknown option was specified, or an option requiring a value was provided without a value.</li>
<li><code>10</code> <strong>Internal JavaScript Run-Time Failure</strong> - The JavaScript source code internal in Node's bootstrapping process threw an error when the bootstrapping function was called. This is extremely rare, and generally can only happen during development of Node itself.</li>
<li><code>12</code> <strong>Invalid Debug Argument</strong> - The <code>--debug</code> and/or <code>--debug-brk</code> options were set, but an invalid port number was chosen.</li>
<li><code>&gt;128</code> <strong>Signal Exits</strong> - If Node receives a fatal signal such as <code>SIGKILL</code> or <code>SIGHUP</code>, then its exit code will be <code>128</code> plus the value of the signal code. This is a standard Unix practice, since exit codes are defined to be 7-bit integers, and signal exits set the high-order bit, and then contain the value of the signal code.</li>
</ul>
<h2>Event: 'exit'<a id="all_event_exit" class="mark" href="#all_event_exit">#</a></h2>
<p>Emitted when the process is about to exit. There is no way to prevent the exiting of the event loop at this point, and once all <code>exit</code> listeners have finished running the process will exit. Therefore you <strong>must</strong> only perform <strong>synchronous</strong> operations in this handler. This is a good hook to perform checks on the module's state (like for unit tests). The callback takes one argument, the code the process is exiting with.</p>
<p>Example of listening for <code>exit</code>:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>code<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// do *NOT* do this</span>
  <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'This will not run'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'About to exit with code:'</span><span class="sh_symbol">,</span> code<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Event: 'beforeExit'<a id="all_event_beforeexit" class="mark" href="#all_event_beforeexit">#</a></h2>
<p>This event is emitted when node empties it's event loop and has nothing else to schedule. Normally, node exits when there is no work scheduled, but a listener for 'beforeExit' can make asynchronous calls, and cause node to continue.</p>
<p>'beforeExit' is not emitted for conditions causing explicit termination, such as <code>process.exit()</code> or uncaught exceptions, and should not be used as an alternative to the 'exit' event unless the intention is to schedule more work.</p>
<h2>Event: 'uncaughtException'<a id="all_event_uncaughtexception" class="mark" href="#all_event_uncaughtexception">#</a></h2>
<p>Emitted when an exception bubbles all the way back to the event loop. If a listener is added for this exception, the default action (which is to print a stack trace and exit) will not occur.</p>
<p>Example of listening for <code>uncaughtException</code>:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'uncaughtException'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Caught exception: '</span> <span class="sh_symbol">+</span> err<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'This will still run.'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">500</span><span class="sh_symbol">);</span>

<span class="sh_comment">// Intentionally cause an exception, but don't catch it.</span>
<span class="sh_function">nonexistentFunc</span><span class="sh_symbol">();</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'This will not run.'</span><span class="sh_symbol">);</span></code></pre>
<p>Note that <code>uncaughtException</code> is a very crude mechanism for exception handling.</p>
<p>Don't use it, use <a href="https://nodejs.org/api/domain.html">domains</a> instead. If you do use it, restart your application after every unhandled exception!</p>
<p>Do <em>not</em> use it as the node.js equivalent of <code>On Error Resume Next</code>. An unhandled exception means your application - and by extension node.js itself - is in an undefined state. Blindly resuming means <em>anything</em> could happen.</p>
<p>Think of resuming as pulling the power cord when you are upgrading your system. Nine out of ten times nothing happens - but the 10th time, your system is bust.</p>
<p>You have been warned.</p>
<h2>Signal Events<a id="all_signal_events" class="mark" href="#all_signal_events">#</a></h2>
<p>Emitted when the processes receives a signal. See sigaction(2) for a list of standard POSIX signal names such as SIGINT, SIGHUP, etc.</p>
<p>Example of listening for <code>SIGINT</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// Start reading from stdin so we don't exit.</span>
process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">resume</span><span class="sh_symbol">();</span>

process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'SIGINT'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Got SIGINT.  Press Control-D to exit.'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>An easy way to send the <code>SIGINT</code> signal is with <code>Control-C</code> in most terminal programs.</p>
<p>Note:</p>
<ul>
<li><code>SIGUSR1</code> is reserved by node.js to start the debugger. It's possible to install a listener but that won't stop the debugger from starting.</li>
<li><code>SIGTERM</code> and <code>SIGINT</code> have default handlers on non-Windows platforms that resets the terminal mode before exiting with code <code>128 + signal number</code>. If one of these signals has a listener installed, its default behaviour will be removed (node will no longer exit).</li>
<li><code>SIGPIPE</code> is ignored by default, it can have a listener installed.</li>
<li><code>SIGHUP</code> is generated on Windows when the console window is closed, and on other platforms under various similar conditions, see signal(7). It can have a listener installed, however node will be unconditionally terminated by Windows about 10 seconds later. On non-Windows platforms, the default behaviour of <code>SIGHUP</code> is to terminate node, but once a listener has been installed its default behaviour will be removed.</li>
<li><code>SIGTERM</code> is not supported on Windows, it can be listened on.</li>
<li><code>SIGINT</code> from the terminal is supported on all platforms, and can usually be generated with <code>CTRL+C</code> (though this may be configurable). It is not generated when terminal raw mode is enabled.</li>
<li><code>SIGBREAK</code> is delivered on Windows when <code>CTRL+BREAK</code> is pressed, on non-Windows platforms it can be listened on, but there is no way to send or generate it.</li>
<li><code>SIGWINCH</code> is delivered when the console has been resized. On Windows, this will only happen on write to the console when the cursor is being moved, or when a readable tty is used in raw mode.</li>
<li><code>SIGKILL</code> cannot have a listener installed, it will unconditionally terminate node on all platforms.</li>
<li><code>SIGSTOP</code> cannot have a listener installed.</li>
</ul>
<p>Note that Windows does not support sending Signals, but node offers some emulation with <code>process.kill()</code>, and <code>child_process.kill()</code>: - Sending signal <code>0</code> can be used to search for the existence of a process - Sending <code>SIGINT</code>, <code>SIGTERM</code>, and <code>SIGKILL</code> cause the unconditional exit of the target process.</p>
<h2>process.stdout<a id="all_process_stdout" class="mark" href="#all_process_stdout">#</a></h2>
<p>A <code>Writable Stream</code> to <code>stdout</code> (on fd <code>1</code>).</p>
<p>Example: the definition of <code>console.log</code></p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span>log <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>d<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>d <span class="sh_symbol">+</span> <span class="sh_string">'</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span></code></pre>
<p><code>process.stderr</code> and <code>process.stdout</code> are unlike other streams in Node in that they cannot be closed (<code>end()</code> will throw), they never emit the <code>finish</code> event and that writes are usually blocking.</p>
<ul>
<li>They are blocking in the case that they refer to regular files or TTY file descriptors.</li>
<li>In the case they refer to pipes:
<ul>
<li>They are blocking in Linux/Unix.</li>
<li>They are non-blocking like other streams in Windows.</li>
</ul>
</li>
</ul>
<p>To check if Node is being run in a TTY context, read the <code>isTTY</code> property on <code>process.stderr</code>, <code>process.stdout</code>, or <code>process.stdin</code>:</p>
<pre class="sh_sourceCode"><code>$ node <span class="sh_symbol">-</span>p <span class="sh_string">"Boolean(process.stdin.isTTY)"</span>
<span class="sh_keyword">true</span>
$ echo <span class="sh_string">"foo"</span> <span class="sh_symbol">|</span> node <span class="sh_symbol">-</span>p <span class="sh_string">"Boolean(process.stdin.isTTY)"</span>
<span class="sh_keyword">false</span>

$ node <span class="sh_symbol">-</span>p <span class="sh_string">"Boolean(process.stdout.isTTY)"</span>
<span class="sh_keyword">true</span>
$ node <span class="sh_symbol">-</span>p <span class="sh_string">"Boolean(process.stdout.isTTY)"</span> <span class="sh_symbol">|</span> cat
<span class="sh_keyword">false</span></code></pre>
<p>See <a href="https://nodejs.org/api/tty.html#tty_tty">the tty docs</a> for more information.</p>
<h2>process.stderr<a id="all_process_stderr" class="mark" href="#all_process_stderr">#</a></h2>
<p>A writable stream to stderr (on fd <code>2</code>).</p>
<p><code>process.stderr</code> and <code>process.stdout</code> are unlike other streams in Node in that they cannot be closed (<code>end()</code> will throw), they never emit the <code>finish</code> event and that writes are usually blocking.</p>
<ul>
<li>They are blocking in the case that they refer to regular files or TTY file descriptors.</li>
<li>In the case they refer to pipes:
<ul>
<li>They are blocking in Linux/Unix.</li>
<li>They are non-blocking like other streams in Windows.</li>
</ul>
</li>
</ul>
<h2>process.stdin<a id="all_process_stdin" class="mark" href="#all_process_stdin">#</a></h2>
<p>A <code>Readable Stream</code> for stdin (on fd <code>0</code>).</p>
<p>Example of opening standard input and listening for both events:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">setEncoding</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>

process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'readable'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> chunk <span class="sh_symbol">=</span> process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">read</span><span class="sh_symbol">();</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>chunk <span class="sh_symbol">!==</span> <span class="sh_keyword">null</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'data: '</span> <span class="sh_symbol">+</span> chunk<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>As a Stream, <code>process.stdin</code> can also be used in "old" mode that is compatible with scripts written for node prior v0.10. For more information see <a href="https://nodejs.org/api/stream.html#stream_compatibility_with_older_node_versions">Stream compatibility</a>.</p>
<p>In "old" Streams mode the stdin stream is paused by default, so one must call <code>process.stdin.resume()</code> to read from it. Note also that calling <code>process.stdin.resume()</code> itself would switch stream to "old" mode.</p>
<p>If you are starting a new project you should prefer a more recent "new" Streams mode over "old" one.</p>
<h2>process.argv<a id="all_process_argv" class="mark" href="#all_process_argv">#</a></h2>
<p>An array containing the command line arguments. The first element will be 'node', the second element will be the name of the JavaScript file. The next elements will be any additional command line arguments.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// print process.argv</span>
process<span class="sh_symbol">.</span>argv<span class="sh_symbol">.</span><span class="sh_function">forEach</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>val<span class="sh_symbol">,</span> index<span class="sh_symbol">,</span> array<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>index <span class="sh_symbol">+</span> <span class="sh_string">': '</span> <span class="sh_symbol">+</span> val<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>This will generate:</p>
<pre class="sh_sourceCode"><code>$ node process<span class="sh_number">-2</span><span class="sh_symbol">.</span>js one two<span class="sh_symbol">=</span>three four
<span class="sh_number">0</span><span class="sh_symbol">:</span> node
<span class="sh_number">1</span><span class="sh_symbol">:</span> <span class="sh_regexp">/Users/m</span><span class="sh_normal">jr</span><span class="sh_symbol">/</span><span class="sh_normal">work</span><span class="sh_symbol">/</span><span class="sh_normal">node</span><span class="sh_symbol">/</span>process<span class="sh_number">-2</span><span class="sh_symbol">.</span>js
<span class="sh_number">2</span><span class="sh_symbol">:</span> one
<span class="sh_number">3</span><span class="sh_symbol">:</span> two<span class="sh_symbol">=</span>three
<span class="sh_number">4</span><span class="sh_symbol">:</span> four</code></pre>
<h2>process.execPath<a id="all_process_execpath" class="mark" href="#all_process_execpath">#</a></h2>
<p>This is the absolute pathname of the executable that started the process.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_regexp">/usr/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>node</code></pre>
<h2>process.execArgv<a id="all_process_execargv" class="mark" href="#all_process_execargv">#</a></h2>
<p>This is the set of node-specific command line options from the executable that started the process. These options do not show up in <code>process.argv</code>, and do not include the node executable, the name of the script, or any options following the script name. These options are useful in order to spawn child processes with the same execution environment as the parent.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>$ node <span class="sh_symbol">--</span>harmony script<span class="sh_symbol">.</span>js <span class="sh_symbol">--</span>version</code></pre>
<p>results in process.execArgv:</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">[</span><span class="sh_string">'--harmony'</span><span class="sh_symbol">]</span></code></pre>
<p>and process.argv:</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">[</span><span class="sh_string">'/usr/local/bin/node'</span><span class="sh_symbol">,</span> <span class="sh_string">'script.js'</span><span class="sh_symbol">,</span> <span class="sh_string">'--version'</span><span class="sh_symbol">]</span></code></pre>
<h2>process.abort()<a id="all_process_abort" class="mark" href="#all_process_abort">#</a></h2>
<p>This causes node to emit an abort. This will cause node to exit and generate a core file.</p>
<h2>process.chdir(directory)<a id="all_process_chdir_directory" class="mark" href="#all_process_chdir_directory">#</a></h2>
<p>Changes the current working directory of the process or throws an exception if that fails.</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Starting directory: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">cwd</span><span class="sh_symbol">());</span>
<span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
  process<span class="sh_symbol">.</span><span class="sh_function">chdir</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp'</span><span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'New directory: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">cwd</span><span class="sh_symbol">());</span>
<span class="sh_cbracket">}</span>
<span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'chdir: '</span> <span class="sh_symbol">+</span> err<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>process.cwd()<a id="all_process_cwd" class="mark" href="#all_process_cwd">#</a></h2>
<p>Returns the current working directory of the process.</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Current directory: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">cwd</span><span class="sh_symbol">());</span></code></pre>
<h2>process.env<a id="all_process_env" class="mark" href="#all_process_env">#</a></h2>
<p>An object containing the user environment. See environ(7).</p>
<p>An example of this object looks like:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> TERM<span class="sh_symbol">:</span> <span class="sh_string">'xterm-256color'</span><span class="sh_symbol">,</span>
  SHELL<span class="sh_symbol">:</span> <span class="sh_string">'/usr/local/bin/bash'</span><span class="sh_symbol">,</span>
  USER<span class="sh_symbol">:</span> <span class="sh_string">'maciej'</span><span class="sh_symbol">,</span>
  PATH<span class="sh_symbol">:</span> <span class="sh_string">'~/.bin/:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin'</span><span class="sh_symbol">,</span>
  PWD<span class="sh_symbol">:</span> <span class="sh_string">'/Users/maciej'</span><span class="sh_symbol">,</span>
  EDITOR<span class="sh_symbol">:</span> <span class="sh_string">'vim'</span><span class="sh_symbol">,</span>
  SHLVL<span class="sh_symbol">:</span> <span class="sh_string">'1'</span><span class="sh_symbol">,</span>
  HOME<span class="sh_symbol">:</span> <span class="sh_string">'/Users/maciej'</span><span class="sh_symbol">,</span>
  LOGNAME<span class="sh_symbol">:</span> <span class="sh_string">'maciej'</span><span class="sh_symbol">,</span>
  _<span class="sh_symbol">:</span> <span class="sh_string">'/usr/local/bin/node'</span> <span class="sh_cbracket">}</span></code></pre>
<p>You can write to this object, but changes won't be reflected outside of your process. That means that the following won't work:</p>
<pre class="sh_sourceCode"><code>node <span class="sh_symbol">-</span>e <span class="sh_string">'process.env.foo = "bar"'</span> <span class="sh_symbol">&amp;&amp;</span> echo $foo</code></pre>
<p>But this will:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span>env<span class="sh_symbol">.</span>foo <span class="sh_symbol">=</span> <span class="sh_string">'bar'</span><span class="sh_symbol">;</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>env<span class="sh_symbol">.</span>foo<span class="sh_symbol">);</span></code></pre>
<h2>process.exit([code])<a id="all_process_exit_code" class="mark" href="#all_process_exit_code">#</a></h2>
<p>Ends the process with the specified <code>code</code>. If omitted, exit uses the 'success' code <code>0</code>.</p>
<p>To exit with a 'failure' code:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span><span class="sh_function">exit</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span></code></pre>
<p>The shell that executed node should see the exit code as 1.</p>
<h2>process.exitCode<a id="all_process_exitcode" class="mark" href="#all_process_exitcode">#</a></h2>
<p>A number which will be the process exit code, when the process either exits gracefully, or is exited via <code>process.exit()</code> without specifying a code.</p>
<p>Specifying a code to <code>process.exit(code)</code> will override any previous setting of <code>process.exitCode</code>.</p>
<h2>process.getgid()<a id="all_process_getgid" class="mark" href="#all_process_getgid">#</a></h2>
<p>Note: this function is only available on POSIX platforms (i.e. not Windows, Android)</p>
<p>Gets the group identity of the process. (See getgid(2).) This is the numerical group id, not the group name.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">if</span> <span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>getgid<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Current gid: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">getgid</span><span class="sh_symbol">());</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>process.setgid(id)<a id="all_process_setgid_id" class="mark" href="#all_process_setgid_id">#</a></h2>
<p>Note: this function is only available on POSIX platforms (i.e. not Windows, Android)</p>
<p>Sets the group identity of the process. (See setgid(2).) This accepts either a numerical ID or a groupname string. If a groupname is specified, this method blocks while resolving it to a numerical ID.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">if</span> <span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>getgid <span class="sh_symbol">&amp;&amp;</span> process<span class="sh_symbol">.</span>setgid<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Current gid: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">getgid</span><span class="sh_symbol">());</span>
  <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
    process<span class="sh_symbol">.</span><span class="sh_function">setgid</span><span class="sh_symbol">(</span><span class="sh_number">501</span><span class="sh_symbol">);</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'New gid: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">getgid</span><span class="sh_symbol">());</span>
  <span class="sh_cbracket">}</span>
  <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Failed to set gid: '</span> <span class="sh_symbol">+</span> err<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>process.getuid()<a id="all_process_getuid" class="mark" href="#all_process_getuid">#</a></h2>
<p>Note: this function is only available on POSIX platforms (i.e. not Windows, Android)</p>
<p>Gets the user identity of the process. (See getuid(2).) This is the numerical userid, not the username.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">if</span> <span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>getuid<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Current uid: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">getuid</span><span class="sh_symbol">());</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>process.setuid(id)<a id="all_process_setuid_id" class="mark" href="#all_process_setuid_id">#</a></h2>
<p>Note: this function is only available on POSIX platforms (i.e. not Windows, Android)</p>
<p>Sets the user identity of the process. (See setuid(2).) This accepts either a numerical ID or a username string. If a username is specified, this method blocks while resolving it to a numerical ID.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">if</span> <span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>getuid <span class="sh_symbol">&amp;&amp;</span> process<span class="sh_symbol">.</span>setuid<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Current uid: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">getuid</span><span class="sh_symbol">());</span>
  <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
    process<span class="sh_symbol">.</span><span class="sh_function">setuid</span><span class="sh_symbol">(</span><span class="sh_number">501</span><span class="sh_symbol">);</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'New uid: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span><span class="sh_function">getuid</span><span class="sh_symbol">());</span>
  <span class="sh_cbracket">}</span>
  <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Failed to set uid: '</span> <span class="sh_symbol">+</span> err<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>process.getgroups()<a id="all_process_getgroups" class="mark" href="#all_process_getgroups">#</a></h2>
<p>Note: this function is only available on POSIX platforms (i.e. not Windows, Android)</p>
<p>Returns an array with the supplementary group IDs. POSIX leaves it unspecified if the effective group ID is included but node.js ensures it always is.</p>
<h2>process.setgroups(groups)<a id="all_process_setgroups_groups" class="mark" href="#all_process_setgroups_groups">#</a></h2>
<p>Note: this function is only available on POSIX platforms (i.e. not Windows, Android)</p>
<p>Sets the supplementary group IDs. This is a privileged operation, meaning you need to be root or have the CAP_SETGID capability.</p>
<p>The list can contain group IDs, group names or both.</p>
<h2>process.initgroups(user, extra_group)<a id="all_process_initgroups_user_extra_group" class="mark" href="#all_process_initgroups_user_extra_group">#</a></h2>
<p>Note: this function is only available on POSIX platforms (i.e. not Windows, Android)</p>
<p>Reads /etc/group and initializes the group access list, using all groups of which the user is a member. This is a privileged operation, meaning you need to be root or have the CAP_SETGID capability.</p>
<p><code>user</code> is a user name or user ID. <code>extra_group</code> is a group name or group ID.</p>
<p>Some care needs to be taken when dropping privileges. Example:</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span><span class="sh_function">getgroups</span><span class="sh_symbol">());</span>         <span class="sh_comment">// [ 0 ]</span>
process<span class="sh_symbol">.</span><span class="sh_function">initgroups</span><span class="sh_symbol">(</span><span class="sh_string">'bnoordhuis'</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span>   <span class="sh_comment">// switch user</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span><span class="sh_function">getgroups</span><span class="sh_symbol">());</span>         <span class="sh_comment">// [ 27, 30, 46, 1000, 0 ]</span>
process<span class="sh_symbol">.</span><span class="sh_function">setgid</span><span class="sh_symbol">(</span><span class="sh_number">1000</span><span class="sh_symbol">);</span>                     <span class="sh_comment">// drop root gid</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span><span class="sh_function">getgroups</span><span class="sh_symbol">());</span>         <span class="sh_comment">// [ 27, 30, 46, 1000 ]</span></code></pre>
<h2>process.version<a id="all_process_version" class="mark" href="#all_process_version">#</a></h2>
<p>A compiled-in property that exposes <code>NODE_VERSION</code>.</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Version: '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span>version<span class="sh_symbol">);</span></code></pre>
<h2>process.versions<a id="all_process_versions" class="mark" href="#all_process_versions">#</a></h2>
<p>A property exposing version strings of node and its dependencies.</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>versions<span class="sh_symbol">);</span></code></pre>
<p>Will print something like:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> http_parser<span class="sh_symbol">:</span> <span class="sh_string">'1.0'</span><span class="sh_symbol">,</span>
  node<span class="sh_symbol">:</span> <span class="sh_string">'0.10.4'</span><span class="sh_symbol">,</span>
  v8<span class="sh_symbol">:</span> <span class="sh_string">'3.14.5.8'</span><span class="sh_symbol">,</span>
  ares<span class="sh_symbol">:</span> <span class="sh_string">'1.9.0-DEV'</span><span class="sh_symbol">,</span>
  uv<span class="sh_symbol">:</span> <span class="sh_string">'0.10.3'</span><span class="sh_symbol">,</span>
  zlib<span class="sh_symbol">:</span> <span class="sh_string">'1.2.3'</span><span class="sh_symbol">,</span>
  modules<span class="sh_symbol">:</span> <span class="sh_string">'11'</span><span class="sh_symbol">,</span>
  openssl<span class="sh_symbol">:</span> <span class="sh_string">'1.0.1e'</span> <span class="sh_cbracket">}</span></code></pre>
<h2>process.config<a id="all_process_config" class="mark" href="#all_process_config">#</a></h2>
<p>An Object containing the JavaScript representation of the configure options that were used to compile the current node executable. This is the same as the "config.gypi" file that was produced when running the <code>./configure</code> script.</p>
<p>An example of the possible output looks like:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> target_defaults<span class="sh_symbol">:</span>
   <span class="sh_cbracket">{</span> cflags<span class="sh_symbol">:</span> <span class="sh_symbol">[],</span>
     default_configuration<span class="sh_symbol">:</span> <span class="sh_string">'Release'</span><span class="sh_symbol">,</span>
     defines<span class="sh_symbol">:</span> <span class="sh_symbol">[],</span>
     include_dirs<span class="sh_symbol">:</span> <span class="sh_symbol">[],</span>
     libraries<span class="sh_symbol">:</span> <span class="sh_symbol">[]</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  variables<span class="sh_symbol">:</span>
   <span class="sh_cbracket">{</span> host_arch<span class="sh_symbol">:</span> <span class="sh_string">'x64'</span><span class="sh_symbol">,</span>
     node_install_npm<span class="sh_symbol">:</span> <span class="sh_string">'true'</span><span class="sh_symbol">,</span>
     node_prefix<span class="sh_symbol">:</span> <span class="sh_string">''</span><span class="sh_symbol">,</span>
     node_shared_cares<span class="sh_symbol">:</span> <span class="sh_string">'false'</span><span class="sh_symbol">,</span>
     node_shared_http_parser<span class="sh_symbol">:</span> <span class="sh_string">'false'</span><span class="sh_symbol">,</span>
     node_shared_libuv<span class="sh_symbol">:</span> <span class="sh_string">'false'</span><span class="sh_symbol">,</span>
     node_shared_v8<span class="sh_symbol">:</span> <span class="sh_string">'false'</span><span class="sh_symbol">,</span>
     node_shared_zlib<span class="sh_symbol">:</span> <span class="sh_string">'false'</span><span class="sh_symbol">,</span>
     node_use_dtrace<span class="sh_symbol">:</span> <span class="sh_string">'false'</span><span class="sh_symbol">,</span>
     node_use_openssl<span class="sh_symbol">:</span> <span class="sh_string">'true'</span><span class="sh_symbol">,</span>
     node_shared_openssl<span class="sh_symbol">:</span> <span class="sh_string">'false'</span><span class="sh_symbol">,</span>
     strict_aliasing<span class="sh_symbol">:</span> <span class="sh_string">'true'</span><span class="sh_symbol">,</span>
     target_arch<span class="sh_symbol">:</span> <span class="sh_string">'x64'</span><span class="sh_symbol">,</span>
     v8_use_snapshot<span class="sh_symbol">:</span> <span class="sh_string">'true'</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span></code></pre>
<h2>process.kill(pid[, signal])<a id="all_process_kill_pid_signal" class="mark" href="#all_process_kill_pid_signal">#</a></h2>
<p>Send a signal to a process. <code>pid</code> is the process id and <code>signal</code> is the string describing the signal to send. Signal names are strings like 'SIGINT' or 'SIGHUP'. If omitted, the signal will be 'SIGTERM'. See <a href="#process_signal_events">Signal Events</a> and kill(2) for more information.</p>
<p>Will throw an error if target does not exist, and as a special case, a signal of <code>0</code> can be used to test for the existence of a process.</p>
<p>Note that just because the name of this function is <code>process.kill</code>, it is really just a signal sender, like the <code>kill</code> system call. The signal sent may do something other than kill the target process.</p>
<p>Example of sending a signal to yourself:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'SIGHUP'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Got SIGHUP signal.'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Exiting.'</span><span class="sh_symbol">);</span>
  process<span class="sh_symbol">.</span><span class="sh_function">exit</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">100</span><span class="sh_symbol">);</span>

process<span class="sh_symbol">.</span><span class="sh_function">kill</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>pid<span class="sh_symbol">,</span> <span class="sh_string">'SIGHUP'</span><span class="sh_symbol">);</span></code></pre>
<p>Note: When SIGUSR1 is received by Node.js it starts the debugger, see <a href="#process_signal_events">Signal Events</a>.</p>
<h2>process.pid<a id="all_process_pid" class="mark" href="#all_process_pid">#</a></h2>
<p>The PID of the process.</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'This process is pid '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span>pid<span class="sh_symbol">);</span></code></pre>
<h2>process.title<a id="all_process_title" class="mark" href="#all_process_title">#</a></h2>
<p>Getter/setter to set what is displayed in 'ps'.</p>
<p>When used as a setter, the maximum length is platform-specific and probably short.</p>
<p>On Linux and OS X, it's limited to the size of the binary name plus the length of the command line arguments because it overwrites the argv memory.</p>
<p>v0.8 allowed for longer process title strings by also overwriting the environ memory but that was potentially insecure/confusing in some (rather obscure) cases.</p>
<h2>process.arch<a id="all_process_arch" class="mark" href="#all_process_arch">#</a></h2>
<p>What processor architecture you're running on: <code>'arm'</code>, <code>'ia32'</code>, or <code>'x64'</code>.</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'This processor architecture is '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span>arch<span class="sh_symbol">);</span></code></pre>
<h2>process.platform<a id="all_process_platform" class="mark" href="#all_process_platform">#</a></h2>
<p>What platform you're running on: <code>'darwin'</code>, <code>'freebsd'</code>, <code>'linux'</code>, <code>'sunos'</code> or <code>'win32'</code></p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'This platform is '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span>platform<span class="sh_symbol">);</span></code></pre>
<h2>process.memoryUsage()<a id="all_process_memoryusage" class="mark" href="#all_process_memoryusage">#</a></h2>
<p>Returns an object describing the memory usage of the Node process measured in bytes.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span><span class="sh_function">memoryUsage</span><span class="sh_symbol">()));</span></code></pre>
<p>This will generate:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> rss<span class="sh_symbol">:</span> <span class="sh_number">4935680</span><span class="sh_symbol">,</span>
  heapTotal<span class="sh_symbol">:</span> <span class="sh_number">1826816</span><span class="sh_symbol">,</span>
  heapUsed<span class="sh_symbol">:</span> <span class="sh_number">650472</span> <span class="sh_cbracket">}</span></code></pre>
<p><code>heapTotal</code> and <code>heapUsed</code> refer to V8's memory usage.</p>
<h2>process.nextTick(callback)<a id="all_process_nexttick_callback" class="mark" href="#all_process_nexttick_callback">#</a></h2>
<div class="signature">
<ul>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Once the current event loop turn runs to completion, call the callback function.</p>
<p>This is <em>not</em> a simple alias to <code>setTimeout(fn, 0)</code>, it's much more efficient. It runs before any additional I/O events (including timers) fire in subsequent ticks of the event loop.</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'start'</span><span class="sh_symbol">);</span>
process<span class="sh_symbol">.</span><span class="sh_function">nextTick</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'nextTick callback'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'scheduled'</span><span class="sh_symbol">);</span>
<span class="sh_comment">// Output:</span>
<span class="sh_comment">// start</span>
<span class="sh_comment">// scheduled</span>
<span class="sh_comment">// nextTick callback</span></code></pre>
<p>This is important in developing APIs where you want to give the user the chance to assign event handlers after an object has been constructed, but before any I/O has occurred.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">function</span> <span class="sh_function">MyThing</span><span class="sh_symbol">(</span>options<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">setupOptions</span><span class="sh_symbol">(</span>options<span class="sh_symbol">);</span>

  process<span class="sh_symbol">.</span><span class="sh_function">nextTick</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">startDoingStuff</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">.</span><span class="sh_function">bind</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span>

<span class="sh_keyword">var</span> thing <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">MyThing</span><span class="sh_symbol">();</span>
thing<span class="sh_symbol">.</span><span class="sh_function">getReadyForStuff</span><span class="sh_symbol">();</span>

<span class="sh_comment">// thing.startDoingStuff() gets called now, not before.</span></code></pre>
<p>It is very important for APIs to be either 100% synchronous or 100% asynchronous. Consider this example:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// WARNING!  DO NOT USE!  BAD UNSAFE HAZARD!</span>
<span class="sh_keyword">function</span> <span class="sh_function">maybeSync</span><span class="sh_symbol">(</span>arg<span class="sh_symbol">,</span> cb<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>arg<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_function">cb</span><span class="sh_symbol">();</span>
    <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span>

  fs<span class="sh_symbol">.</span><span class="sh_function">stat</span><span class="sh_symbol">(</span><span class="sh_string">'file'</span><span class="sh_symbol">,</span> cb<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<p>This API is hazardous. If you do this:</p>
<pre class="sh_sourceCode"><code><span class="sh_function">maybeSync</span><span class="sh_symbol">(</span><span class="sh_keyword">true</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">foo</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_function">bar</span><span class="sh_symbol">();</span></code></pre>
<p>then it's not clear whether <code>foo()</code> or <code>bar()</code> will be called first.</p>
<p>This approach is much better:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">function</span> <span class="sh_function">definitelyAsync</span><span class="sh_symbol">(</span>arg<span class="sh_symbol">,</span> cb<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>arg<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    process<span class="sh_symbol">.</span><span class="sh_function">nextTick</span><span class="sh_symbol">(</span>cb<span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span>

  fs<span class="sh_symbol">.</span><span class="sh_function">stat</span><span class="sh_symbol">(</span><span class="sh_string">'file'</span><span class="sh_symbol">,</span> cb<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<p>Note: the nextTick queue is completely drained on each pass of the event loop <strong>before</strong> additional I/O is processed. As a result, recursively setting nextTick callbacks will block any I/O from happening, just like a <code>while(true);</code> loop.</p>
<h2>process.umask([mask])<a id="all_process_umask_mask" class="mark" href="#all_process_umask_mask">#</a></h2>
<p>Sets or reads the process's file mode creation mask. Child processes inherit the mask from the parent process. Returns the old mask if <code>mask</code> argument is given, otherwise returns the current mask.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> oldmask<span class="sh_symbol">,</span> newmask <span class="sh_symbol">=</span> <span class="sh_number">0022</span><span class="sh_symbol">;</span>

oldmask <span class="sh_symbol">=</span> process<span class="sh_symbol">.</span><span class="sh_function">umask</span><span class="sh_symbol">(</span>newmask<span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Changed umask from: '</span> <span class="sh_symbol">+</span> oldmask<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span>
            <span class="sh_string">' to '</span> <span class="sh_symbol">+</span> newmask<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">));</span></code></pre>
<h2>process.uptime()<a id="all_process_uptime" class="mark" href="#all_process_uptime">#</a></h2>
<p>Number of seconds Node has been running.</p>
<h2>process.hrtime()<a id="all_process_hrtime" class="mark" href="#all_process_hrtime">#</a></h2>
<p>Returns the current high-resolution real time in a <code>[seconds, nanoseconds]</code> tuple Array. It is relative to an arbitrary time in the past. It is not related to the time of day and therefore not subject to clock drift. The primary use is for measuring performance between intervals.</p>
<p>You may pass in the result of a previous call to <code>process.hrtime()</code> to get a diff reading, useful for benchmarks and measuring intervals:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> time <span class="sh_symbol">=</span> process<span class="sh_symbol">.</span><span class="sh_function">hrtime</span><span class="sh_symbol">();</span>
<span class="sh_comment">// [ 1800216, 25 ]</span>

<span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> diff <span class="sh_symbol">=</span> process<span class="sh_symbol">.</span><span class="sh_function">hrtime</span><span class="sh_symbol">(</span>time<span class="sh_symbol">);</span>
  <span class="sh_comment">// [ 1, 552 ]</span>

  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'benchmark took %d nanoseconds'</span><span class="sh_symbol">,</span> diff<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">*</span> <span class="sh_number">1e9</span> <span class="sh_symbol">+</span> diff<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]);</span>
  <span class="sh_comment">// benchmark took 1000000527 nanoseconds</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span></code></pre>
<h2>process.mainModule<a id="all_process_mainmodule" class="mark" href="#all_process_mainmodule">#</a></h2>
<p>Alternate way to retrieve <a href="https://nodejs.org/api/modules.html#modules_accessing_the_main_module"><code>require.main</code></a>. The difference is that if the main module changes at runtime, <code>require.main</code> might still refer to the original main module in modules that were required before the change occurred. Generally it's safe to assume that the two refer to the same module.</p>
<p>As with <code>require.main</code>, it will be <code>undefined</code> if there was no entry script.</p>
<h1>util<a id="all_util" class="mark" href="#all_util">#</a></h1>
<pre class="api_stability_4 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">4</span> <span class="sh_symbol">-</span> API Frozen</pre>
<p>These functions are in the module <code>'util'</code>. Use <code>require('util')</code> to access them.</p>
<p>The <code>util</code> module is primarily designed to support the needs of Node's internal APIs. Many of these utilities are useful for your own programs. If you find that these functions are lacking for your purposes, however, you are encouraged to write your own utilities. We are not interested in any future additions to the <code>util</code> module that are unnecessary for Node's internal functionality.</p>
<h2>util.debuglog(section)<a id="all_util_debuglog_section" class="mark" href="#all_util_debuglog_section">#</a></h2>
<div class="signature">
<ul>
<li><code>section</code> <span class="type">String</span> The section of the program to be debugged</li>
<li>Returns: <span class="type">Function</span> The logging function</li>
</ul>
</div>
<p>This is used to create a function which conditionally writes to stderr based on the existence of a <code>NODE_DEBUG</code> environment variable. If the <code>section</code> name appears in that environment variable, then the returned function will be similar to <code>console.error()</code>. If not, then the returned function is a no-op.</p>
<p>For example:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> debuglog <span class="sh_symbol">=</span> util<span class="sh_symbol">.</span><span class="sh_function">debuglog</span><span class="sh_symbol">(</span><span class="sh_string">'foo'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> bar <span class="sh_symbol">=</span> <span class="sh_number">123</span><span class="sh_symbol">;</span>
<span class="sh_function">debuglog</span><span class="sh_symbol">(</span><span class="sh_string">'hello from foo [%d]'</span><span class="sh_symbol">,</span> bar<span class="sh_symbol">);</span></code></pre>
<p>If this program is run with <code>NODE_DEBUG=foo</code> in the environment, then it will output something like:</p>
<pre class="sh_sourceCode"><code>FOO <span class="sh_number">3245</span><span class="sh_symbol">:</span> hello from foo <span class="sh_symbol">[</span><span class="sh_number">123</span><span class="sh_symbol">]</span></code></pre>
<p>where <code>3245</code> is the process id. If it is not run with that environment variable set, then it will not print anything.</p>
<p>You may separate multiple <code>NODE_DEBUG</code> environment variables with a comma. For example, <code>NODE_DEBUG=fs,net,tls</code>.</p>
<h2>util.format(format[, ...])<a id="all_util_format_format" class="mark" href="#all_util_format_format">#</a></h2>
<p>Returns a formatted string using the first argument as a <code>printf</code>-like format.</p>
<p>The first argument is a string that contains zero or more <em>placeholders</em>. Each placeholder is replaced with the converted value from its corresponding argument. Supported placeholders are:</p>
<ul>
<li><code>%s</code> - String.</li>
<li><code>%d</code> - Number (both integer and float).</li>
<li><code>%j</code> - JSON. Replaced with the string <code>'[Circular]'</code> if the argument
<pre class="sh_sourceCode"><code>   contains circular references<span class="sh_symbol">.</span></code></pre>
</li>
<li><code>%</code> - single percent sign (<code>'%'</code>). This does not consume an argument.</li>
</ul>
<p>If the placeholder does not have a corresponding argument, the placeholder is not replaced.</p>
<pre class="sh_sourceCode"><code>util<span class="sh_symbol">.</span><span class="sh_function">format</span><span class="sh_symbol">(</span><span class="sh_string">'%s:%s'</span><span class="sh_symbol">,</span> <span class="sh_string">'foo'</span><span class="sh_symbol">);</span> <span class="sh_comment">// 'foo:%s'</span></code></pre>
<p>If there are more arguments than placeholders, the extra arguments are converted to strings with <code>util.inspect()</code> and these strings are concatenated, delimited by a space.</p>
<pre class="sh_sourceCode"><code>util<span class="sh_symbol">.</span><span class="sh_function">format</span><span class="sh_symbol">(</span><span class="sh_string">'%s:%s'</span><span class="sh_symbol">,</span> <span class="sh_string">'foo'</span><span class="sh_symbol">,</span> <span class="sh_string">'bar'</span><span class="sh_symbol">,</span> <span class="sh_string">'baz'</span><span class="sh_symbol">);</span> <span class="sh_comment">// 'foo:bar baz'</span></code></pre>
<p>If the first argument is not a format string then <code>util.format()</code> returns a string that is the concatenation of all its arguments separated by spaces. Each argument is converted to a string with <code>util.inspect()</code>.</p>
<pre class="sh_sourceCode"><code>util<span class="sh_symbol">.</span><span class="sh_function">format</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">);</span> <span class="sh_comment">// '1 2 3'</span></code></pre>
<h2>util.log(string)<a id="all_util_log_string" class="mark" href="#all_util_log_string">#</a></h2>
<p>Output with timestamp on <code>stdout</code>.</p>
<pre class="sh_sourceCode"><code><span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">).</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Timestamped message.'</span><span class="sh_symbol">);</span></code></pre>
<h2>util.inspect(object[, options])<a id="all_util_inspect_object_options" class="mark" href="#all_util_inspect_object_options">#</a></h2>
<p>Return a string representation of <code>object</code>, which is useful for debugging.</p>
<p>An optional <em>options</em> object may be passed that alters certain aspects of the formatted string:</p>
<ul>
<li>
<p><code>showHidden</code> - if <code>true</code> then the object's non-enumerable properties will be shown too. Defaults to <code>false</code>.</p>
</li>
<li>
<p><code>depth</code> - tells <code>inspect</code> how many times to recurse while formatting the object. This is useful for inspecting large complicated objects. Defaults to <code>2</code>. To make it recurse indefinitely pass <code>null</code>.</p>
</li>
<li>
<p><code>colors</code> - if <code>true</code>, then the output will be styled with ANSI color codes. Defaults to <code>false</code>. Colors are customizable, see below.</p>
</li>
<li>
<p><code>customInspect</code> - if <code>false</code>, then custom <code>inspect(depth, opts)</code> functions defined on the objects being inspected won't be called. Defaults to <code>true</code>.</p>
</li>
</ul>
<p>Example of inspecting all properties of the <code>util</code> object:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>util<span class="sh_symbol">,</span> <span class="sh_cbracket">{</span> showHidden<span class="sh_symbol">:</span> <span class="sh_keyword">true</span><span class="sh_symbol">,</span> depth<span class="sh_symbol">:</span> <span class="sh_keyword">null</span> <span class="sh_cbracket">}</span><span class="sh_symbol">));</span></code></pre>
<p>Values may supply their own custom <code>inspect(depth, opts)</code> functions, when called they receive the current depth in the recursive inspection, as well as the options object passed to <code>util.inspect()</code>.</p>
<h3>Customizing <code>util.inspect</code> colors<a id="all_customizing_util_inspect_colors" class="mark" href="#all_customizing_util_inspect_colors">#</a></h3>
<p>Color output (if enabled) of <code>util.inspect</code> is customizable globally via <code>util.inspect.styles</code> and <code>util.inspect.colors</code> objects.</p>
<p><code>util.inspect.styles</code> is a map assigning each style a color from <code>util.inspect.colors</code>. Highlighted styles and their default values are: <em> <code>number</code> (yellow) </em> <code>boolean</code> (yellow) <em> <code>string</code> (green) </em> <code>date</code> (magenta) <em> <code>regexp</code> (red) </em> <code>null</code> (bold) <em> <code>undefined</code> (grey) </em> <code>special</code> - only function at this time (cyan) * <code>name</code> (intentionally no styling)</p>
<p>Predefined color codes are: <code>white</code>, <code>grey</code>, <code>black</code>, <code>blue</code>, <code>cyan</code>, <code>green</code>, <code>magenta</code>, <code>red</code> and <code>yellow</code>. There are also <code>bold</code>, <code>italic</code>, <code>underline</code> and <code>inverse</code> codes.</p>
<h3>Custom <code>inspect()</code> function on Objects<a id="all_custom_inspect_function_on_objects" class="mark" href="#all_custom_inspect_function_on_objects">#</a></h3>
<p>Objects also may define their own <code>inspect(depth)</code> function which <code>util.inspect()</code> will invoke and use the result of when inspecting the object:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> obj <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> name<span class="sh_symbol">:</span> <span class="sh_string">'nate'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
obj<span class="sh_symbol">.</span>inspect <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>depth<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">return</span> <span class="sh_string">'{'</span> <span class="sh_symbol">+</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>name <span class="sh_symbol">+</span> <span class="sh_string">'}'</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>obj<span class="sh_symbol">);</span>
  <span class="sh_comment">// "{nate}"</span></code></pre>
<p>You may also return another Object entirely, and the returned String will be formatted according to the returned Object. This is similar to how <code>JSON.stringify()</code> works:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> obj <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> foo<span class="sh_symbol">:</span> <span class="sh_string">'this will not show up in the inspect() output'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
obj<span class="sh_symbol">.</span>inspect <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>depth<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">return</span> <span class="sh_cbracket">{</span> bar<span class="sh_symbol">:</span> <span class="sh_string">'baz'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>obj<span class="sh_symbol">);</span>
  <span class="sh_comment">// "{ bar: 'baz' }"</span></code></pre>
<h2>util.isArray(object)<a id="all_util_isarray_object" class="mark" href="#all_util_isarray_object">#</a></h2>
<p>Internal alias for Array.isArray.</p>
<p>Returns <code>true</code> if the given "object" is an <code>Array</code>. <code>false</code> otherwise.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>

util<span class="sh_symbol">.</span><span class="sh_function">isArray</span><span class="sh_symbol">([])</span>
  <span class="sh_comment">// true</span>
util<span class="sh_symbol">.</span><span class="sh_function">isArray</span><span class="sh_symbol">(</span><span class="sh_keyword">new</span> <span class="sh_predef_func">Array</span><span class="sh_symbol">)</span>
  <span class="sh_comment">// true</span>
util<span class="sh_symbol">.</span><span class="sh_function">isArray</span><span class="sh_symbol">(</span><span class="sh_cbracket">{}</span><span class="sh_symbol">)</span>
  <span class="sh_comment">// false</span></code></pre>
<h2>util.isRegExp(object)<a id="all_util_isregexp_object" class="mark" href="#all_util_isregexp_object">#</a></h2>
<p>Returns <code>true</code> if the given "object" is a <code>RegExp</code>. <code>false</code> otherwise.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>

util<span class="sh_symbol">.</span><span class="sh_function">isRegExp</span><span class="sh_symbol">(</span><span class="sh_regexp">/some regexp/</span><span class="sh_symbol">)</span>
  <span class="sh_comment">// true</span>
util<span class="sh_symbol">.</span><span class="sh_function">isRegExp</span><span class="sh_symbol">(</span><span class="sh_keyword">new</span> <span class="sh_predef_func">RegExp</span><span class="sh_symbol">(</span><span class="sh_string">'another regexp'</span><span class="sh_symbol">))</span>
  <span class="sh_comment">// true</span>
util<span class="sh_symbol">.</span><span class="sh_function">isRegExp</span><span class="sh_symbol">(</span><span class="sh_cbracket">{}</span><span class="sh_symbol">)</span>
  <span class="sh_comment">// false</span></code></pre>
<h2>util.isDate(object)<a id="all_util_isdate_object" class="mark" href="#all_util_isdate_object">#</a></h2>
<p>Returns <code>true</code> if the given "object" is a <code>Date</code>. <code>false</code> otherwise.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>

util<span class="sh_symbol">.</span><span class="sh_function">isDate</span><span class="sh_symbol">(</span><span class="sh_keyword">new</span> <span class="sh_predef_func">Date</span><span class="sh_symbol">())</span>
  <span class="sh_comment">// true</span>
util<span class="sh_symbol">.</span><span class="sh_function">isDate</span><span class="sh_symbol">(</span><span class="sh_predef_func">Date</span><span class="sh_symbol">())</span>
  <span class="sh_comment">// false (without 'new' returns a String)</span>
util<span class="sh_symbol">.</span><span class="sh_function">isDate</span><span class="sh_symbol">(</span><span class="sh_cbracket">{}</span><span class="sh_symbol">)</span>
  <span class="sh_comment">// false</span></code></pre>
<h2>util.isError(object)<a id="all_util_iserror_object" class="mark" href="#all_util_iserror_object">#</a></h2>
<p>Returns <code>true</code> if the given "object" is an <code>Error</code>. <code>false</code> otherwise.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>

util<span class="sh_symbol">.</span><span class="sh_function">isError</span><span class="sh_symbol">(</span><span class="sh_keyword">new</span> <span class="sh_predef_func">Error</span><span class="sh_symbol">())</span>
  <span class="sh_comment">// true</span>
util<span class="sh_symbol">.</span><span class="sh_function">isError</span><span class="sh_symbol">(</span><span class="sh_keyword">new</span> <span class="sh_predef_func">TypeError</span><span class="sh_symbol">())</span>
  <span class="sh_comment">// true</span>
util<span class="sh_symbol">.</span><span class="sh_function">isError</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> name<span class="sh_symbol">:</span> <span class="sh_string">'Error'</span><span class="sh_symbol">,</span> message<span class="sh_symbol">:</span> <span class="sh_string">'an error occurred'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">)</span>
  <span class="sh_comment">// false</span></code></pre>
<h2>util.inherits(constructor, superConstructor)<a id="all_util_inherits_constructor_superconstructor" class="mark" href="#all_util_inherits_constructor_superconstructor">#</a></h2>
<p>Inherit the prototype methods from one <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/constructor">constructor</a> into another. The prototype of <code>constructor</code> will be set to a new object created from <code>superConstructor</code>.</p>
<p>As an additional convenience, <code>superConstructor</code> will be accessible through the <code>constructor.super_</code> property.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">"util"</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> events <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">"events"</span><span class="sh_symbol">);</span>

<span class="sh_keyword">function</span> <span class="sh_function">MyStream</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    events<span class="sh_symbol">.</span>EventEmitter<span class="sh_symbol">.</span><span class="sh_function">call</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

util<span class="sh_symbol">.</span><span class="sh_function">inherits</span><span class="sh_symbol">(</span>MyStream<span class="sh_symbol">,</span> events<span class="sh_symbol">.</span>EventEmitter<span class="sh_symbol">);</span>

MyStream<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>write <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">"data"</span><span class="sh_symbol">,</span> data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_keyword">var</span> stream <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">MyStream</span><span class="sh_symbol">();</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>stream <span class="sh_keyword">instanceof</span> events<span class="sh_symbol">.</span>EventEmitter<span class="sh_symbol">);</span> <span class="sh_comment">// true</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>MyStream<span class="sh_symbol">.</span>super_ <span class="sh_symbol">===</span> events<span class="sh_symbol">.</span>EventEmitter<span class="sh_symbol">);</span> <span class="sh_comment">// true</span>

stream<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">"data"</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Received data: "'</span> <span class="sh_symbol">+</span> data <span class="sh_symbol">+</span> <span class="sh_string">'"'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">)</span>
stream<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">"It works!"</span><span class="sh_symbol">);</span> <span class="sh_comment">// Received data: "It works!"</span></code></pre>
<h2>util.deprecate(function, string)<a id="all_util_deprecate_function_string" class="mark" href="#all_util_deprecate_function_string">#</a></h2>
<p>Marks that a method should not be used any more.</p>
<pre class="sh_sourceCode"><code>exports<span class="sh_symbol">.</span>puts <span class="sh_symbol">=</span> exports<span class="sh_symbol">.</span><span class="sh_function">deprecate</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> len <span class="sh_symbol">=</span> <span class="sh_predef_var">arguments</span><span class="sh_symbol">.</span>length<span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> len<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_predef_var">arguments</span><span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> <span class="sh_string">'</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_string">'util.puts: Use console.log instead'</span><span class="sh_symbol">)</span></code></pre>
<p>It returns a modified function which warns once by default. If <code>--no-deprecation</code> is set then this function is a NO-OP. If <code>--throw-deprecation</code> is set then the application will throw an exception if the deprecated API is used.</p>
<h2>util.debug(string)<a id="all_util_debug_string" class="mark" href="#all_util_debug_string">#</a></h2>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated<span class="sh_symbol">:</span> use console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">()</span> instead<span class="sh_symbol">.</span></pre>
<p>Deprecated predecessor of <code>console.error</code>.</p>
<h2>util.error([...])<a id="all_util_error" class="mark" href="#all_util_error">#</a></h2>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated<span class="sh_symbol">:</span> Use console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">()</span> instead<span class="sh_symbol">.</span></pre>
<p>Deprecated predecessor of <code>console.error</code>.</p>
<h2>util.puts([...])<a id="all_util_puts" class="mark" href="#all_util_puts">#</a></h2>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated<span class="sh_symbol">:</span> Use console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">()</span> instead<span class="sh_symbol">.</span></pre>
<p>Deprecated predecessor of <code>console.log</code>.</p>
<h2>util.print([...])<a id="all_util_print" class="mark" href="#all_util_print">#</a></h2>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated<span class="sh_symbol">:</span> Use <code>console<span class="sh_symbol">.</span>log</code> instead<span class="sh_symbol">.</span></pre>
<p>Deprecated predecessor of <code>console.log</code>.</p>
<h2>util.pump(readableStream, writableStream[, callback])<a id="all_util_pump_readablestream_writablestream_callback" class="mark" href="#all_util_pump_readablestream_writablestream_callback">#</a></h2>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated<span class="sh_symbol">:</span> Use readableStream<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>writableStream<span class="sh_symbol">)</span></pre>
<p>Deprecated predecessor of <code>stream.pipe()</code>.</p>
<h1>Events<a id="all_events" class="mark" href="#all_events">#</a></h1>
<pre class="api_stability_4 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">4</span> <span class="sh_symbol">-</span> API Frozen</pre>
<p>Many objects in Node emit events: a <code>net.Server</code> emits an event each time a peer connects to it, a <code>fs.readStream</code> emits an event when the file is opened. All objects which emit events are instances of <code>events.EventEmitter</code>. You can access this module by doing: <code>require("events");</code></p>
<p>Typically, event names are represented by a camel-cased string, however, there aren't any strict restrictions on that, as any string will be accepted.</p>
<p>Functions can then be attached to objects, to be executed when an event is emitted. These functions are called <em>listeners</em>. Inside a listener function, <code>this</code> refers to the <code>EventEmitter</code> that the listener was attached to.</p>
<h2>Class: events.EventEmitter<a id="all_class_events_eventemitter" class="mark" href="#all_class_events_eventemitter">#</a></h2>
<p>To access the EventEmitter class, <code>require('events').EventEmitter</code>.</p>
<p>When an <code>EventEmitter</code> instance experiences an error, the typical action is to emit an <code>'error'</code> event. Error events are treated as a special case in node. If there is no listener for it, then the default action is to print a stack trace and exit the program.</p>
<p>All EventEmitters emit the event <code>'newListener'</code> when new listeners are added and <code>'removeListener'</code> when a listener is removed.</p>
<h3>emitter.addListener(event, listener)<a id="all_emitter_addlistener_event_listener" class="mark" href="#all_emitter_addlistener_event_listener">#</a></h3>
<h3>emitter.on(event, listener)<a id="all_emitter_on_event_listener" class="mark" href="#all_emitter_on_event_listener">#</a></h3>
<p>Adds a listener to the end of the listeners array for the specified <code>event</code>. No checks are made to see if the <code>listener</code> has already been added. Multiple calls passing the same combination of <code>event</code> and <code>listener</code> will result in the <code>listener</code> being added multiple times.</p>
<pre class="sh_sourceCode"><code>server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>stream<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'someone connected!'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Returns emitter, so calls can be chained.</p>
<h3>emitter.once(event, listener)<a id="all_emitter_once_event_listener" class="mark" href="#all_emitter_once_event_listener">#</a></h3>
<p>Adds a <strong>one time</strong> listener for the event. This listener is invoked only the next time the event is fired, after which it is removed.</p>
<pre class="sh_sourceCode"><code>server<span class="sh_symbol">.</span><span class="sh_function">once</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>stream<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Ah, we have our first user!'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Returns emitter, so calls can be chained.</p>
<h3>emitter.removeListener(event, listener)<a id="all_emitter_removelistener_event_listener" class="mark" href="#all_emitter_removelistener_event_listener">#</a></h3>
<p>Remove a listener from the listener array for the specified event. <strong>Caution</strong>: changes array indices in the listener array behind the listener.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> callback <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>stream<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'someone connected!'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">,</span> callback<span class="sh_symbol">);</span>
<span class="sh_comment">// ...</span>
server<span class="sh_symbol">.</span><span class="sh_function">removeListener</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">,</span> callback<span class="sh_symbol">);</span></code></pre>
<p><code>removeListener</code> will remove, at most, one instance of a listener from the listener array. If any single listener has been added multiple times to the listener array for the specified <code>event</code>, then <code>removeListener</code> must be called multiple times to remove each instance.</p>
<p>Returns emitter, so calls can be chained.</p>
<h3>emitter.removeAllListeners([event])<a id="all_emitter_removealllisteners_event" class="mark" href="#all_emitter_removealllisteners_event">#</a></h3>
<p>Removes all listeners, or those of the specified event. It's not a good idea to remove listeners that were added elsewhere in the code, especially when it's on an emitter that you didn't create (e.g. sockets or file streams).</p>
<p>Returns emitter, so calls can be chained.</p>
<h3>emitter.setMaxListeners(n)<a id="all_emitter_setmaxlisteners_n" class="mark" href="#all_emitter_setmaxlisteners_n">#</a></h3>
<p>By default EventEmitters will print a warning if more than 10 listeners are added for a particular event. This is a useful default which helps finding memory leaks. Obviously not all Emitters should be limited to 10. This function allows that to be increased. Set to zero for unlimited.</p>
<p>Returns emitter, so calls can be chained.</p>
<h3>EventEmitter.defaultMaxListeners<a id="all_eventemitter_defaultmaxlisteners" class="mark" href="#all_eventemitter_defaultmaxlisteners">#</a></h3>
<p><code>emitter.setMaxListeners(n)</code> sets the maximum on a per-instance basis. This class property lets you set it for <em>all</em> <code>EventEmitter</code> instances, current and future, effective immediately. Use with care.</p>
<p>Note that <code>emitter.setMaxListeners(n)</code> still has precedence over <code>EventEmitter.defaultMaxListeners</code>.</p>
<h3>emitter.listeners(event)<a id="all_emitter_listeners_event" class="mark" href="#all_emitter_listeners_event">#</a></h3>
<p>Returns an array of listeners for the specified event.</p>
<pre class="sh_sourceCode"><code>server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>stream<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'someone connected!'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>server<span class="sh_symbol">.</span><span class="sh_function">listeners</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">)));</span> <span class="sh_comment">// [ [Function] ]</span></code></pre>
<h3>emitter.emit(event[, arg1][, arg2][, ...])<a id="all_emitter_emit_event_arg1_arg2" class="mark" href="#all_emitter_emit_event_arg1_arg2">#</a></h3>
<p>Execute each of the listeners in order with the supplied arguments.</p>
<p>Returns <code>true</code> if event had listeners, <code>false</code> otherwise.</p>
<h3>Class Method: EventEmitter.listenerCount(emitter, event)<a id="all_class_method_eventemitter_listenercount_emitter_event" class="mark" href="#all_class_method_eventemitter_listenercount_emitter_event">#</a></h3>
<p>Return the number of listeners for a given event.</p>
<h3>Event: 'newListener'<a id="all_event_newlistener" class="mark" href="#all_event_newlistener">#</a></h3>
<div class="signature">
<ul>
<li><code>event</code> <span class="type">String</span> The event name</li>
<li><code>listener</code> <span class="type">Function</span> The event handler function</li>
</ul>
</div>
<p>This event is emitted any time a listener is added. When this event is triggered, the listener may not yet have been added to the array of listeners for the <code>event</code>.</p>
<h3>Event: 'removeListener'<a id="all_event_removelistener" class="mark" href="#all_event_removelistener">#</a></h3>
<div class="signature">
<ul>
<li><code>event</code> <span class="type">String</span> The event name</li>
<li><code>listener</code> <span class="type">Function</span> The event handler function</li>
</ul>
</div>
<p>This event is emitted any time someone removes a listener. When this event is triggered, the listener may not yet have been removed from the array of listeners for the <code>event</code>.</p>
<h1>Domain<a id="all_domain" class="mark" href="#all_domain">#</a></h1>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable</pre>
<p>Domains provide a way to handle multiple different IO operations as a single group. If any of the event emitters or callbacks registered to a domain emit an <code>error</code> event, or throw an error, then the domain object will be notified, rather than losing the context of the error in the <code>process.on('uncaughtException')</code> handler, or causing the program to exit immediately with an error code.</p>
<h2>Warning: Don't Ignore Errors!<a id="all_warning_don_t_ignore_errors" class="mark" href="#all_warning_don_t_ignore_errors">#</a></h2>
<p>Domain error handlers are not a substitute for closing down your process when an error occurs.</p>
<p>By the very nature of how <code>throw</code> works in JavaScript, there is almost never any way to safely "pick up where you left off", without leaking references, or creating some other sort of undefined brittle state.</p>
<p>The safest way to respond to a thrown error is to shut down the process. Of course, in a normal web server, you might have many connections open, and it is not reasonable to abruptly shut those down because an error was triggered by someone else.</p>
<p>The better approach is send an error response to the request that triggered the error, while letting the others finish in their normal time, and stop listening for new requests in that worker.</p>
<p>In this way, <code>domain</code> usage goes hand-in-hand with the cluster module, since the master process can fork a new worker when a worker encounters an error. For node programs that scale to multiple machines, the terminating proxy or service registry can take note of the failure, and react accordingly.</p>
<p>For example, this is not a good idea:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// XXX WARNING!  BAD IDEA!</span>

<span class="sh_keyword">var</span> d <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'domain'</span><span class="sh_symbol">).</span><span class="sh_function">create</span><span class="sh_symbol">();</span>
d<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// The error won't crash the process, but what it does is worse!</span>
  <span class="sh_comment">// Though we've prevented abrupt process restarting, we are leaking</span>
  <span class="sh_comment">// resources like crazy if this ever happens.</span>
  <span class="sh_comment">// This is no better than process.on('uncaughtException')!</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'error, but oh well'</span><span class="sh_symbol">,</span> er<span class="sh_symbol">.</span>message<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
d<span class="sh_symbol">.</span><span class="sh_function">run</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">).</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_function">handleRequest</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span>PORT<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>By using the context of a domain, and the resilience of separating our program into multiple worker processes, we can react more appropriately, and handle errors with much greater safety.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// Much better!</span>

<span class="sh_keyword">var</span> cluster <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'cluster'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> PORT <span class="sh_symbol">=</span> <span class="sh_symbol">+</span>process<span class="sh_symbol">.</span>env<span class="sh_symbol">.</span>PORT <span class="sh_symbol">||</span> <span class="sh_number">1337</span><span class="sh_symbol">;</span>

<span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isMaster<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// In real life, you'd probably use more than just 2 workers,</span>
  <span class="sh_comment">// and perhaps not put the master and worker in the same file.</span>
  <span class="sh_comment">//</span>
  <span class="sh_comment">// You can also of course get a bit fancier about logging, and</span>
  <span class="sh_comment">// implement whatever custom logic you need to prevent DoS</span>
  <span class="sh_comment">// attacks and other bad behavior.</span>
  <span class="sh_comment">//</span>
  <span class="sh_comment">// See the options in the cluster documentation.</span>
  <span class="sh_comment">//</span>
  <span class="sh_comment">// The important thing is that the master does very little,</span>
  <span class="sh_comment">// increasing our resilience to unexpected errors.</span>

  cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
  cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>

  cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'disconnect'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'disconnect!'</span><span class="sh_symbol">);</span>
    cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// the worker</span>
  <span class="sh_comment">//</span>
  <span class="sh_comment">// This is where we put our bugs!</span>

  <span class="sh_keyword">var</span> domain <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'domain'</span><span class="sh_symbol">);</span>

  <span class="sh_comment">// See the cluster documentation for more details about using</span>
  <span class="sh_comment">// worker processes to serve requests.  How it works, caveats, etc.</span>

  <span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">).</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">var</span> d <span class="sh_symbol">=</span> domain<span class="sh_symbol">.</span><span class="sh_function">create</span><span class="sh_symbol">();</span>
    d<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> er<span class="sh_symbol">.</span>stack<span class="sh_symbol">);</span>

      <span class="sh_comment">// Note: we're in dangerous territory!</span>
      <span class="sh_comment">// By definition, something unexpected occurred,</span>
      <span class="sh_comment">// which we probably didn't want.</span>
      <span class="sh_comment">// Anything can happen now!  Be very careful!</span>

      <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
        <span class="sh_comment">// make sure we close down within 30 seconds</span>
        <span class="sh_keyword">var</span> killtimer <span class="sh_symbol">=</span> <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
          process<span class="sh_symbol">.</span><span class="sh_function">exit</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">30000</span><span class="sh_symbol">);</span>
        <span class="sh_comment">// But don't keep the process open just for that!</span>
        killtimer<span class="sh_symbol">.</span><span class="sh_function">unref</span><span class="sh_symbol">();</span>

        <span class="sh_comment">// stop taking new requests.</span>
        server<span class="sh_symbol">.</span><span class="sh_function">close</span><span class="sh_symbol">();</span>

        <span class="sh_comment">// Let the master know we're dead.  This will trigger a</span>
        <span class="sh_comment">// 'disconnect' in the cluster master, and then it will fork</span>
        <span class="sh_comment">// a new worker.</span>
        cluster<span class="sh_symbol">.</span>worker<span class="sh_symbol">.</span><span class="sh_function">disconnect</span><span class="sh_symbol">();</span>

        <span class="sh_comment">// try to send an error to the request that triggered the problem</span>
        res<span class="sh_symbol">.</span>statusCode <span class="sh_symbol">=</span> <span class="sh_number">500</span><span class="sh_symbol">;</span>
        res<span class="sh_symbol">.</span><span class="sh_function">setHeader</span><span class="sh_symbol">(</span><span class="sh_string">'content-type'</span><span class="sh_symbol">,</span> <span class="sh_string">'text/plain'</span><span class="sh_symbol">);</span>
        res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'Oops, there was a problem!</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>er2<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_comment">// oh well, not much we can do at this point.</span>
        console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'Error sending 500!'</span><span class="sh_symbol">,</span> er2<span class="sh_symbol">.</span>stack<span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

    <span class="sh_comment">// Because req and res were created before this domain existed,</span>
    <span class="sh_comment">// we need to explicitly add them.</span>
    <span class="sh_comment">// See the explanation of implicit vs explicit binding below.</span>
    d<span class="sh_symbol">.</span><span class="sh_function">add</span><span class="sh_symbol">(</span>req<span class="sh_symbol">);</span>
    d<span class="sh_symbol">.</span><span class="sh_function">add</span><span class="sh_symbol">(</span>res<span class="sh_symbol">);</span>

    <span class="sh_comment">// Now run the handler function in the domain.</span>
    d<span class="sh_symbol">.</span><span class="sh_function">run</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
      <span class="sh_function">handleRequest</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span>PORT<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_comment">// This part isn't important.  Just an example routing thing.</span>
<span class="sh_comment">// You'd put your fancy application logic here.</span>
<span class="sh_keyword">function</span> <span class="sh_function">handleRequest</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">switch</span><span class="sh_symbol">(</span>req<span class="sh_symbol">.</span>url<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">case</span> <span class="sh_string">'/error'</span><span class="sh_symbol">:</span>
      <span class="sh_comment">// We do some async stuff, and then...</span>
      <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
        <span class="sh_comment">// Whoops!</span>
        flerb<span class="sh_symbol">.</span><span class="sh_function">bark</span><span class="sh_symbol">();</span>
      <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
      <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">default</span><span class="sh_symbol">:</span>
      res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'ok'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>Additions to Error objects<a id="all_additions_to_error_objects" class="mark" href="#all_additions_to_error_objects">#</a></h2>
<p>Any time an Error object is routed through a domain, a few extra fields are added to it.</p>
<ul>
<li><code>error.domain</code> The domain that first handled the error.</li>
<li><code>error.domainEmitter</code> The event emitter that emitted an 'error' event with the error object.</li>
<li><code>error.domainBound</code> The callback function which was bound to the domain, and passed an error as its first argument.</li>
<li><code>error.domainThrown</code> A boolean indicating whether the error was thrown, emitted, or passed to a bound callback function.</li>
</ul>
<h2>Implicit Binding<a id="all_implicit_binding" class="mark" href="#all_implicit_binding">#</a></h2>
<p>If domains are in use, then all <strong>new</strong> EventEmitter objects (including Stream objects, requests, responses, etc.) will be implicitly bound to the active domain at the time of their creation.</p>
<p>Additionally, callbacks passed to lowlevel event loop requests (such as to fs.open, or other callback-taking methods) will automatically be bound to the active domain. If they throw, then the domain will catch the error.</p>
<p>In order to prevent excessive memory usage, Domain objects themselves are not implicitly added as children of the active domain. If they were, then it would be too easy to prevent request and response objects from being properly garbage collected.</p>
<p>If you <em>want</em> to nest Domain objects as children of a parent Domain, then you must explicitly add them.</p>
<p>Implicit binding routes thrown errors and <code>'error'</code> events to the Domain's <code>error</code> event, but does not register the EventEmitter on the Domain, so <code>domain.dispose()</code> will not shut down the EventEmitter. Implicit binding only takes care of thrown errors and <code>'error'</code> events.</p>
<h2>Explicit Binding<a id="all_explicit_binding" class="mark" href="#all_explicit_binding">#</a></h2>
<p>Sometimes, the domain in use is not the one that ought to be used for a specific event emitter. Or, the event emitter could have been created in the context of one domain, but ought to instead be bound to some other domain.</p>
<p>For example, there could be one domain in use for an HTTP server, but perhaps we would like to have a separate domain to use for each request.</p>
<p>That is possible via explicit binding.</p>
<p>For example:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// create a top-level domain for the server</span>
<span class="sh_keyword">var</span> serverDomain <span class="sh_symbol">=</span> domain<span class="sh_symbol">.</span><span class="sh_function">create</span><span class="sh_symbol">();</span>

serverDomain<span class="sh_symbol">.</span><span class="sh_function">run</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// server is created in the scope of serverDomain</span>
  http<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// req and res are also created in the scope of serverDomain</span>
    <span class="sh_comment">// however, we'd prefer to have a separate domain for each request.</span>
    <span class="sh_comment">// create it first thing, and add req and res to it.</span>
    <span class="sh_keyword">var</span> reqd <span class="sh_symbol">=</span> domain<span class="sh_symbol">.</span><span class="sh_function">create</span><span class="sh_symbol">();</span>
    reqd<span class="sh_symbol">.</span><span class="sh_function">add</span><span class="sh_symbol">(</span>req<span class="sh_symbol">);</span>
    reqd<span class="sh_symbol">.</span><span class="sh_function">add</span><span class="sh_symbol">(</span>res<span class="sh_symbol">);</span>
    reqd<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'Error'</span><span class="sh_symbol">,</span> er<span class="sh_symbol">,</span> req<span class="sh_symbol">.</span>url<span class="sh_symbol">);</span>
      <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
        res<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">500</span><span class="sh_symbol">);</span>
        res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'Error occurred, sorry.'</span><span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'Error sending 500'</span><span class="sh_symbol">,</span> er<span class="sh_symbol">,</span> req<span class="sh_symbol">.</span>url<span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>domain.create()<a id="all_domain_create" class="mark" href="#all_domain_create">#</a></h2>
<div class="signature">
<ul>
<li>return: <span class="type">Domain</span></li>
</ul>
</div>
<p>Returns a new Domain object.</p>
<h2>Class: Domain<a id="all_class_domain" class="mark" href="#all_class_domain">#</a></h2>
<p>The Domain class encapsulates the functionality of routing errors and uncaught exceptions to the active Domain object.</p>
<p>Domain is a child class of <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a>. To handle the errors that it catches, listen to its <code>error</code> event.</p>
<h3>domain.run(fn)<a id="all_domain_run_fn" class="mark" href="#all_domain_run_fn">#</a></h3>
<div class="signature">
<ul>
<li><code>fn</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Run the supplied function in the context of the domain, implicitly binding all event emitters, timers, and lowlevel requests that are created in that context.</p>
<p>This is the most basic way to use a domain.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> d <span class="sh_symbol">=</span> domain<span class="sh_symbol">.</span><span class="sh_function">create</span><span class="sh_symbol">();</span>
d<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'Caught error!'</span><span class="sh_symbol">,</span> er<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
d<span class="sh_symbol">.</span><span class="sh_function">run</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  process<span class="sh_symbol">.</span><span class="sh_function">nextTick</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span> <span class="sh_comment">// simulating some various async stuff</span>
      fs<span class="sh_symbol">.</span><span class="sh_function">open</span><span class="sh_symbol">(</span><span class="sh_string">'non-existent file'</span><span class="sh_symbol">,</span> <span class="sh_string">'r'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>er<span class="sh_symbol">,</span> fd<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> er<span class="sh_symbol">;</span>
        <span class="sh_comment">// proceed...</span>
      <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">100</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>In this example, the <code>d.on('error')</code> handler will be triggered, rather than crashing the program.</p>
<h3>domain.members<a id="all_domain_members" class="mark" href="#all_domain_members">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Array</span></li>
</ul>
</div>
<p>An array of timers and event emitters that have been explicitly added to the domain.</p>
<h3>domain.add(emitter)<a id="all_domain_add_emitter" class="mark" href="#all_domain_add_emitter">#</a></h3>
<div class="signature">
<ul>
<li><code>emitter</code> <span class="type">EventEmitter | Timer</span> emitter or timer to be added to the domain</li>
</ul>
</div>
<p>Explicitly adds an emitter to the domain. If any event handlers called by the emitter throw an error, or if the emitter emits an <code>error</code> event, it will be routed to the domain's <code>error</code> event, just like with implicit binding.</p>
<p>This also works with timers that are returned from <code>setInterval</code> and <code>setTimeout</code>. If their callback function throws, it will be caught by the domain 'error' handler.</p>
<p>If the Timer or EventEmitter was already bound to a domain, it is removed from that one, and bound to this one instead.</p>
<h3>domain.remove(emitter)<a id="all_domain_remove_emitter" class="mark" href="#all_domain_remove_emitter">#</a></h3>
<div class="signature">
<ul>
<li><code>emitter</code> <span class="type">EventEmitter | Timer</span> emitter or timer to be removed from the domain</li>
</ul>
</div>
<p>The opposite of <code>domain.add(emitter)</code>. Removes domain handling from the specified emitter.</p>
<h3>domain.bind(callback)<a id="all_domain_bind_callback" class="mark" href="#all_domain_bind_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>callback</code> <span class="type">Function</span> The callback function</li>
<li>return: <span class="type">Function</span> The bound function</li>
</ul>
</div>
<p>The returned function will be a wrapper around the supplied callback function. When the returned function is called, any errors that are thrown will be routed to the domain's <code>error</code> event.</p>
<h4>Example<a id="all_example" class="mark" href="#all_example">#</a></h4>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> d <span class="sh_symbol">=</span> domain<span class="sh_symbol">.</span><span class="sh_function">create</span><span class="sh_symbol">();</span>

<span class="sh_keyword">function</span> <span class="sh_function">readSomeFile</span><span class="sh_symbol">(</span>filename<span class="sh_symbol">,</span> cb<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  fs<span class="sh_symbol">.</span><span class="sh_function">readFile</span><span class="sh_symbol">(</span>filename<span class="sh_symbol">,</span> <span class="sh_string">'utf8'</span><span class="sh_symbol">,</span> d<span class="sh_symbol">.</span><span class="sh_function">bind</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>er<span class="sh_symbol">,</span> data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// if this throws, it will also be passed to the domain</span>
    <span class="sh_keyword">return</span> <span class="sh_function">cb</span><span class="sh_symbol">(</span>er<span class="sh_symbol">,</span> data <span class="sh_symbol">?</span> JSON<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_symbol">:</span> <span class="sh_keyword">null</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span>

d<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// an error occurred somewhere.</span>
  <span class="sh_comment">// if we throw it now, it will crash the program</span>
  <span class="sh_comment">// with the normal line number and stack message.</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>domain.intercept(callback)<a id="all_domain_intercept_callback" class="mark" href="#all_domain_intercept_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>callback</code> <span class="type">Function</span> The callback function</li>
<li>return: <span class="type">Function</span> The intercepted function</li>
</ul>
</div>
<p>This method is almost identical to <code>domain.bind(callback)</code>. However, in addition to catching thrown errors, it will also intercept <code>Error</code> objects sent as the first argument to the function.</p>
<p>In this way, the common <code>if (er) return callback(er);</code> pattern can be replaced with a single error handler in a single place.</p>
<h4>Example<a id="all_example_1" class="mark" href="#all_example_1">#</a></h4>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> d <span class="sh_symbol">=</span> domain<span class="sh_symbol">.</span><span class="sh_function">create</span><span class="sh_symbol">();</span>

<span class="sh_keyword">function</span> <span class="sh_function">readSomeFile</span><span class="sh_symbol">(</span>filename<span class="sh_symbol">,</span> cb<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  fs<span class="sh_symbol">.</span><span class="sh_function">readFile</span><span class="sh_symbol">(</span>filename<span class="sh_symbol">,</span> <span class="sh_string">'utf8'</span><span class="sh_symbol">,</span> d<span class="sh_symbol">.</span><span class="sh_function">intercept</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// note, the first argument is never passed to the</span>
    <span class="sh_comment">// callback since it is assumed to be the 'Error' argument</span>
    <span class="sh_comment">// and thus intercepted by the domain.</span>

    <span class="sh_comment">// if this throws, it will also be passed to the domain</span>
    <span class="sh_comment">// so the error-handling logic can be moved to the 'error'</span>
    <span class="sh_comment">// event on the domain instead of being repeated throughout</span>
    <span class="sh_comment">// the program.</span>
    <span class="sh_keyword">return</span> <span class="sh_function">cb</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">,</span> JSON<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span>data<span class="sh_symbol">));</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span>

d<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// an error occurred somewhere.</span>
  <span class="sh_comment">// if we throw it now, it will crash the program</span>
  <span class="sh_comment">// with the normal line number and stack message.</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>domain.enter()<a id="all_domain_enter" class="mark" href="#all_domain_enter">#</a></h3>
<p>The <code>enter</code> method is plumbing used by the <code>run</code>, <code>bind</code>, and <code>intercept</code> methods to set the active domain. It sets <code>domain.active</code> and <code>process.domain</code> to the domain, and implicitly pushes the domain onto the domain stack managed by the domain module (see <code>domain.exit()</code> for details on the domain stack). The call to <code>enter</code> delimits the beginning of a chain of asynchronous calls and I/O operations bound to a domain.</p>
<p>Calling <code>enter</code> changes only the active domain, and does not alter the domain itself. <code>Enter</code> and <code>exit</code> can be called an arbitrary number of times on a single domain.</p>
<p>If the domain on which <code>enter</code> is called has been disposed, <code>enter</code> will return without setting the domain.</p>
<h3>domain.exit()<a id="all_domain_exit" class="mark" href="#all_domain_exit">#</a></h3>
<p>The <code>exit</code> method exits the current domain, popping it off the domain stack. Any time execution is going to switch to the context of a different chain of asynchronous calls, it's important to ensure that the current domain is exited. The call to <code>exit</code> delimits either the end of or an interruption to the chain of asynchronous calls and I/O operations bound to a domain.</p>
<p>If there are multiple, nested domains bound to the current execution context, <code>exit</code> will exit any domains nested within this domain.</p>
<p>Calling <code>exit</code> changes only the active domain, and does not alter the domain itself. <code>Enter</code> and <code>exit</code> can be called an arbitrary number of times on a single domain.</p>
<p>If the domain on which <code>exit</code> is called has been disposed, <code>exit</code> will return without exiting the domain.</p>
<h3>domain.dispose()<a id="all_domain_dispose" class="mark" href="#all_domain_dispose">#</a></h3>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated<span class="sh_symbol">.</span>  Please recover from failed IO actions
explicitly via error event handlers set on the domain<span class="sh_symbol">.</span></pre>
<p>Once <code>dispose</code> has been called, the domain will no longer be used by callbacks bound into the domain via <code>run</code>, <code>bind</code>, or <code>intercept</code>, and a <code>dispose</code> event is emitted.</p>
<h1>Buffer<a id="all_buffer" class="mark" href="#all_buffer">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>Pure JavaScript is Unicode friendly but not nice to binary data. When dealing with TCP streams or the file system, it's necessary to handle octet streams. Node has several strategies for manipulating, creating, and consuming octet streams.</p>
<p>Raw data is stored in instances of the <code>Buffer</code> class. A <code>Buffer</code> is similar to an array of integers but corresponds to a raw memory allocation outside the V8 heap. A <code>Buffer</code> cannot be resized.</p>
<p>The <code>Buffer</code> class is a global, making it very rare that one would need to ever <code>require('buffer')</code>.</p>
<p>Converting between Buffers and JavaScript string objects requires an explicit encoding method. Here are the different string encodings.</p>
<ul>
<li>
<p><code>'ascii'</code> - for 7 bit ASCII data only. This encoding method is very fast, and will strip the high bit if set.</p>
</li>
<li>
<p><code>'utf8'</code> - Multibyte encoded Unicode characters. Many web pages and other document formats use UTF-8.</p>
</li>
<li>
<p><code>'utf16le'</code> - 2 or 4 bytes, little endian encoded Unicode characters. Surrogate pairs (U+10000 to U+10FFFF) are supported.</p>
</li>
<li>
<p><code>'ucs2'</code> - Alias of <code>'utf16le'</code>.</p>
</li>
<li>
<p><code>'base64'</code> - Base64 string encoding.</p>
</li>
<li>
<p><code>'binary'</code> - A way of encoding raw binary data into strings by using only the first 8 bits of each character. This encoding method is deprecated and should be avoided in favor of <code>Buffer</code> objects where possible. This encoding will be removed in future versions of Node.</p>
</li>
<li>
<p><code>'hex'</code> - Encode each byte as two hexadecimal characters.</p>
</li>
</ul>
<p>Creating a typed array from a <code>Buffer</code> works with the following caveats:</p>
<ol>
<li>
<p>The buffer's memory is copied, not shared.</p>
</li>
<li>
<p>The buffer's memory is interpreted as an array, not a byte array. That is, <code>new Uint32Array(new Buffer([1,2,3,4]))</code> creates a 4-element <code>Uint32Array</code> with elements <code>[1,2,3,4]</code>, not an <code>Uint32Array</code> with a single element <code>[0x1020304]</code> or <code>[0x4030201]</code>.</p>
</li>
</ol>
<p>NOTE: Node.js v0.8 simply retained a reference to the buffer in <code>array.buffer</code> instead of cloning it.</p>
<p>While more efficient, it introduces subtle incompatibilities with the typed arrays specification. <code>ArrayBuffer#slice()</code> makes a copy of the slice while <code>Buffer#slice()</code> creates a view.</p>
<h2>Class: Buffer<a id="all_class_buffer_1" class="mark" href="#all_class_buffer_1">#</a></h2>
<p>The Buffer class is a global type for dealing with binary data directly. It can be constructed in a variety of ways.</p>
<h3>new Buffer(size)<a id="all_new_buffer_size" class="mark" href="#all_new_buffer_size">#</a></h3>
<div class="signature">
<ul>
<li><code>size</code> Number</li>
</ul>
</div>
<p>Allocates a new buffer of <code>size</code> octets. Note, <code>size</code> must be no more than <a href="https://nodejs.org/api/smalloc.html#smalloc_smalloc_kmaxlength">kMaxLength</a>. Otherwise, a <code>RangeError</code> will be thrown here.</p>
<h3>new Buffer(array)<a id="all_new_buffer_array" class="mark" href="#all_new_buffer_array">#</a></h3>
<div class="signature">
<ul>
<li><code>array</code> Array</li>
</ul>
</div>
<p>Allocates a new buffer using an <code>array</code> of octets.</p>
<h3>new Buffer(buffer)<a id="all_new_buffer_buffer" class="mark" href="#all_new_buffer_buffer">#</a></h3>
<div class="signature">
<ul>
<li><code>buffer</code> <span class="type">Buffer</span></li>
</ul>
</div>
<p>Copies the passed <code>buffer</code> data onto a new <code>Buffer</code> instance.</p>
<h3>new Buffer(str[, encoding])<a id="all_new_buffer_str_encoding" class="mark" href="#all_new_buffer_str_encoding">#</a></h3>
<div class="signature">
<ul>
<li><code>str</code> String - string to encode.</li>
<li><code>encoding</code> String - encoding to use, Optional.</li>
</ul>
</div>
<p>Allocates a new buffer containing the given <code>str</code>. <code>encoding</code> defaults to <code>'utf8'</code>.</p>
<h3>Class Method: Buffer.isEncoding(encoding)<a id="all_class_method_buffer_isencoding_encoding" class="mark" href="#all_class_method_buffer_isencoding_encoding">#</a></h3>
<div class="signature">
<ul>
<li><code>encoding</code> <span class="type">String</span> The encoding string to test</li>
</ul>
</div>
<p>Returns true if the <code>encoding</code> is a valid encoding argument, or false otherwise.</p>
<h3>Class Method: Buffer.isBuffer(obj)<a id="all_class_method_buffer_isbuffer_obj" class="mark" href="#all_class_method_buffer_isbuffer_obj">#</a></h3>
<div class="signature">
<ul>
<li><code>obj</code> Object</li>
<li>Return: Boolean</li>
</ul>
</div>
<p>Tests if <code>obj</code> is a <code>Buffer</code>.</p>
<h3>Class Method: Buffer.byteLength(string[, encoding])<a id="all_class_method_buffer_bytelength_string_encoding" class="mark" href="#all_class_method_buffer_bytelength_string_encoding">#</a></h3>
<div class="signature">
<ul>
<li><code>string</code> String</li>
<li><code>encoding</code> String, Optional, Default: 'utf8'</li>
<li>Return: Number</li>
</ul>
</div>
<p>Gives the actual byte length of a string. <code>encoding</code> defaults to <code>'utf8'</code>. This is not the same as <code>String.prototype.length</code> since that returns the number of <em>characters</em> in a string.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>str <span class="sh_symbol">=</span> <span class="sh_string">'</span><span class="sh_specialchar">\u</span><span class="sh_string">00bd + </span><span class="sh_specialchar">\u</span><span class="sh_string">00bc = </span><span class="sh_specialchar">\u</span><span class="sh_string">00be'</span><span class="sh_symbol">;</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>str <span class="sh_symbol">+</span> <span class="sh_string">": "</span> <span class="sh_symbol">+</span> str<span class="sh_symbol">.</span>length <span class="sh_symbol">+</span> <span class="sh_string">" characters, "</span> <span class="sh_symbol">+</span>
  Buffer<span class="sh_symbol">.</span><span class="sh_function">byteLength</span><span class="sh_symbol">(</span>str<span class="sh_symbol">,</span> <span class="sh_string">'utf8'</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_string">" bytes"</span><span class="sh_symbol">);</span>

<span class="sh_comment">// &frac12; + &frac14; = &frac34;: 9 characters, 12 bytes</span></code></pre>
<h3>Class Method: Buffer.concat(list[, totalLength])<a id="all_class_method_buffer_concat_list_totallength" class="mark" href="#all_class_method_buffer_concat_list_totallength">#</a></h3>
<div class="signature">
<ul>
<li><code>list</code> <span class="type">Array</span> List of Buffer objects to concat</li>
<li><code>totalLength</code> <span class="type">Number</span> Total length of the buffers when concatenated</li>
</ul>
</div>
<p>Returns a buffer which is the result of concatenating all the buffers in the list together.</p>
<p>If the list has no items, or if the totalLength is 0, then it returns a zero-length buffer.</p>
<p>If the list has exactly one item, then the first item of the list is returned.</p>
<p>If the list has more than one item, then a new Buffer is created.</p>
<p>If totalLength is not provided, it is read from the buffers in the list. However, this adds an additional loop to the function, so it is faster to provide the length explicitly.</p>
<h3>Class Method: Buffer.compare(buf1, buf2)<a id="all_class_method_buffer_compare_buf1_buf2" class="mark" href="#all_class_method_buffer_compare_buf1_buf2">#</a></h3>
<div class="signature">
<ul>
<li><code>buf1</code> <span class="type">Buffer</span></li>
<li><code>buf2</code> <span class="type">Buffer</span></li>
</ul>
</div>
<p>The same as <a href="#buffer_buf_compare_otherbuffer"><code>buf1.compare(buf2)</code></a>. Useful for sorting an Array of Buffers:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> arr <span class="sh_symbol">=</span> <span class="sh_symbol">[</span><span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_string">'1234'</span><span class="sh_symbol">),</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_string">'0123'</span><span class="sh_symbol">)];</span>
arr<span class="sh_symbol">.</span><span class="sh_function">sort</span><span class="sh_symbol">(</span>Buffer<span class="sh_symbol">.</span>compare<span class="sh_symbol">);</span></code></pre>
<h3>buf.length<a id="all_buf_length" class="mark" href="#all_buf_length">#</a></h3>
<div class="signature">
<ul>
<li>Number</li>
</ul>
</div>
<p>The size of the buffer in bytes. Note that this is not necessarily the size of the contents. <code>length</code> refers to the amount of memory allocated for the buffer object. It does not change when the contents of the buffer are changed.</p>
<pre class="sh_sourceCode"><code>buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">1234</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">"some string"</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">"ascii"</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span>

<span class="sh_comment">// 1234</span>
<span class="sh_comment">// 1234</span></code></pre>
<p>While the <code>length</code> property is not immutable, changing the value of <code>length</code> can result in undefined and inconsistent behavior. Applications that wish to modify the length of a buffer should therefore treat <code>length</code> as read-only and use <code>buf.slice</code> to create a new buffer.</p>
<pre class="sh_sourceCode"><code>buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">"abcdefghj"</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">"ascii"</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span> <span class="sh_comment">// 10</span>
buf <span class="sh_symbol">=</span> buf<span class="sh_symbol">.</span><span class="sh_function">slice</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span><span class="sh_number">5</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span> <span class="sh_comment">// 5</span></code></pre>
<h3>buf.write(string[, offset][, length][, encoding])<a id="all_buf_write_string_offset_length_encoding" class="mark" href="#all_buf_write_string_offset_length_encoding">#</a></h3>
<div class="signature">
<ul>
<li><code>string</code> String - data to be written to buffer</li>
<li><code>offset</code> Number, Optional, Default: 0</li>
<li><code>length</code> Number, Optional, Default: <code>buffer.length - offset</code></li>
<li><code>encoding</code> String, Optional, Default: 'utf8'</li>
</ul>
</div>
<p>Writes <code>string</code> to the buffer at <code>offset</code> using the given encoding. <code>offset</code> defaults to <code>0</code>, <code>encoding</code> defaults to <code>'utf8'</code>. <code>length</code> is the number of bytes to write. Returns number of octets written. If <code>buffer</code> did not contain enough space to fit the entire string, it will write a partial amount of the string. <code>length</code> defaults to <code>buffer.length - offset</code>. The method will not write partial characters.</p>
<pre class="sh_sourceCode"><code>buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">256</span><span class="sh_symbol">);</span>
len <span class="sh_symbol">=</span> buf<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'</span><span class="sh_specialchar">\u</span><span class="sh_string">00bd + </span><span class="sh_specialchar">\u</span><span class="sh_string">00bc = </span><span class="sh_specialchar">\u</span><span class="sh_string">00be'</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>len <span class="sh_symbol">+</span> <span class="sh_string">" bytes: "</span> <span class="sh_symbol">+</span> buf<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> len<span class="sh_symbol">));</span></code></pre>
<h3>buf.writeUIntLE(value, offset, byteLength[, noAssert])<a id="all_buf_writeuintle_value_offset_bytelength_noassert" class="mark" href="#all_buf_writeuintle_value_offset_bytelength_noassert">#</a></h3>
<h3>buf.writeUIntBE(value, offset, byteLength[, noAssert])<a id="all_buf_writeuintbe_value_offset_bytelength_noassert" class="mark" href="#all_buf_writeuintbe_value_offset_bytelength_noassert">#</a></h3>
<h3>buf.writeIntLE(value, offset, byteLength[, noAssert])<a id="all_buf_writeintle_value_offset_bytelength_noassert" class="mark" href="#all_buf_writeintle_value_offset_bytelength_noassert">#</a></h3>
<h3>buf.writeIntBE(value, offset, byteLength[, noAssert])<a id="all_buf_writeintbe_value_offset_bytelength_noassert" class="mark" href="#all_buf_writeintbe_value_offset_bytelength_noassert">#</a></h3>
<ul>
<li><code>value</code> {Number} Bytes to be written to buffer</li>
<li><code>offset</code> {Number} <code>0 &lt;= offset &lt;= buf.length</code></li>
<li><code>byteLength</code> {Number} <code>0 &lt; byteLength &lt;= 6</code></li>
<li><code>noAssert</code> {Boolean} Default: false</li>
<li>Return: {Number}</li>
</ul>
<p>Writes <code>value</code> to the buffer at the specified <code>offset</code> and <code>byteLength</code>. Supports up to 48 bits of accuracy. For example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> b <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">6</span><span class="sh_symbol">);</span>
b<span class="sh_symbol">.</span><span class="sh_function">writeUIntBE</span><span class="sh_symbol">(</span><span class="sh_number">0x1234567890ab</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">);</span>
<span class="sh_comment">// &lt;Buffer 12 34 56 78 90 ab&gt;</span></code></pre>
<p>Set <code>noAssert</code> to <code>true</code> to skip validation of <code>value</code> and <code>offset</code>. Defaults to <code>false</code>.</p>
<h3>buf.readUIntLE(offset, byteLength[, noAssert])<a id="all_buf_readuintle_offset_bytelength_noassert" class="mark" href="#all_buf_readuintle_offset_bytelength_noassert">#</a></h3>
<h3>buf.readUIntBE(offset, byteLength[, noAssert])<a id="all_buf_readuintbe_offset_bytelength_noassert" class="mark" href="#all_buf_readuintbe_offset_bytelength_noassert">#</a></h3>
<h3>buf.readIntLE(offset, byteLength[, noAssert])<a id="all_buf_readintle_offset_bytelength_noassert" class="mark" href="#all_buf_readintle_offset_bytelength_noassert">#</a></h3>
<h3>buf.readIntBE(offset, byteLength[, noAssert])<a id="all_buf_readintbe_offset_bytelength_noassert" class="mark" href="#all_buf_readintbe_offset_bytelength_noassert">#</a></h3>
<ul>
<li><code>offset</code> {Number} <code>0 &lt;= offset &lt;= buf.length</code></li>
<li><code>byteLength</code> {Number} <code>0 &lt; byteLength &lt;= 6</code></li>
<li><code>noAssert</code> {Boolean} Default: false</li>
<li>Return: {Number}</li>
</ul>
<p>A generalized version of all numeric read methods. Supports up to 48 bits of accuracy. For example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> b <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">6</span><span class="sh_symbol">);</span>
b<span class="sh_symbol">.</span><span class="sh_function">writeUint16LE</span><span class="sh_symbol">(</span><span class="sh_number">0x90ab</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
b<span class="sh_symbol">.</span><span class="sh_function">writeUInt32LE</span><span class="sh_symbol">(</span><span class="sh_number">0x12345678</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>
b<span class="sh_symbol">.</span><span class="sh_function">readUIntLE</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">).</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_number">16</span><span class="sh_symbol">);</span>  <span class="sh_comment">// Specify 6 bytes (48 bits)</span>
<span class="sh_comment">// output: '1234567890ab'</span></code></pre>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<h3>buf.toString([encoding][, start][, end])<a id="all_buf_tostring_encoding_start_end" class="mark" href="#all_buf_tostring_encoding_start_end">#</a></h3>
<div class="signature">
<ul>
<li><code>encoding</code> String, Optional, Default: 'utf8'</li>
<li><code>start</code> Number, Optional, Default: 0</li>
<li><code>end</code> Number, Optional, Default: <code>buffer.length</code></li>
</ul>
</div>
<p>Decodes and returns a string from buffer data encoded using the specified character set encoding. If <code>encoding</code> is <code>undefined</code> or <code>null</code>, then <code>encoding</code> defaults to <code>'utf8'. The </code>start<code> and </code>end<code> parameters default to </code>0<code> and </code>buffer.length<code> when </code>undefined`.</p>
<pre class="sh_sourceCode"><code>buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">26</span><span class="sh_symbol">);</span>
<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span> <span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">26</span> <span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  buf<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> i <span class="sh_symbol">+</span> <span class="sh_number">97</span><span class="sh_symbol">;</span> <span class="sh_comment">// 97 is ASCII a</span>
<span class="sh_cbracket">}</span>
buf<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'ascii'</span><span class="sh_symbol">);</span> <span class="sh_comment">// outputs: abcdefghijklmnopqrstuvwxyz</span>
buf<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'ascii'</span><span class="sh_symbol">,</span><span class="sh_number">0</span><span class="sh_symbol">,</span><span class="sh_number">5</span><span class="sh_symbol">);</span> <span class="sh_comment">// outputs: abcde</span>
buf<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">,</span><span class="sh_number">0</span><span class="sh_symbol">,</span><span class="sh_number">5</span><span class="sh_symbol">);</span> <span class="sh_comment">// outputs: abcde</span>
buf<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_predef_var">undefined</span><span class="sh_symbol">,</span><span class="sh_number">0</span><span class="sh_symbol">,</span><span class="sh_number">5</span><span class="sh_symbol">);</span> <span class="sh_comment">// encoding defaults to 'utf8', outputs abcde</span></code></pre>
<p>See <code>buffer.write()</code> example, above.</p>
<h3>buf.toJSON()<a id="all_buf_tojson" class="mark" href="#all_buf_tojson">#</a></h3>
<p>Returns a JSON-representation of the Buffer instance. <code>JSON.stringify</code> implicitly calls this function when stringifying a Buffer instance.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_string">'test'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> json <span class="sh_symbol">=</span> JSON<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>json<span class="sh_symbol">);</span>
<span class="sh_comment">// '{"type":"Buffer","data":[116,101,115,116]}'</span>

<span class="sh_keyword">var</span> copy <span class="sh_symbol">=</span> JSON<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span>json<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>key<span class="sh_symbol">,</span> value<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">return</span> value <span class="sh_symbol">&amp;&amp;</span> value<span class="sh_symbol">.</span>type <span class="sh_symbol">===</span> <span class="sh_string">'Buffer'</span>
      <span class="sh_symbol">?</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span>value<span class="sh_symbol">.</span>data<span class="sh_symbol">)</span>
      <span class="sh_symbol">:</span> value<span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>copy<span class="sh_symbol">);</span>
<span class="sh_comment">// &lt;Buffer 74 65 73 74&gt;</span></code></pre>
<h3>buf[index]<a id="all_buf_index" class="mark" href="#all_buf_index">#</a></h3>
<p>Get and set the octet at <code>index</code>. The values refer to individual bytes, so the legal range is between <code>0x00</code> and <code>0xFF</code> hex or <code>0</code> and <code>255</code>.</p>
<p>Example: copy an ASCII string into a buffer, one byte at a time:</p>
<pre class="sh_sourceCode"><code>str <span class="sh_symbol">=</span> <span class="sh_string">"node.js"</span><span class="sh_symbol">;</span>
buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span>str<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> str<span class="sh_symbol">.</span>length <span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  buf<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> str<span class="sh_symbol">.</span><span class="sh_function">charCodeAt</span><span class="sh_symbol">(</span>i<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

<span class="sh_comment">// node.js</span></code></pre>
<h3>buf.equals(otherBuffer)<a id="all_buf_equals_otherbuffer" class="mark" href="#all_buf_equals_otherbuffer">#</a></h3>
<div class="signature">
<ul>
<li><code>otherBuffer</code> <span class="type">Buffer</span></li>
</ul>
</div>
<p>Returns a boolean of whether <code>this</code> and <code>otherBuffer</code> have the same bytes.</p>
<h3>buf.compare(otherBuffer)<a id="all_buf_compare_otherbuffer" class="mark" href="#all_buf_compare_otherbuffer">#</a></h3>
<div class="signature">
<ul>
<li><code>otherBuffer</code> <span class="type">Buffer</span></li>
</ul>
</div>
<p>Returns a number indicating whether <code>this</code> comes before or after or is the same as the <code>otherBuffer</code> in sort order.</p>
<h3>buf.copy(targetBuffer[, targetStart][, sourceStart][, sourceEnd])<a id="all_buf_copy_targetbuffer_targetstart_sourcestart_sourceend" class="mark" href="#all_buf_copy_targetbuffer_targetstart_sourcestart_sourceend">#</a></h3>
<div class="signature">
<ul>
<li><code>targetBuffer</code> Buffer object - Buffer to copy into</li>
<li><code>targetStart</code> Number, Optional, Default: 0</li>
<li><code>sourceStart</code> Number, Optional, Default: 0</li>
<li><code>sourceEnd</code> Number, Optional, Default: <code>buffer.length</code></li>
</ul>
</div>
<p>Copies data from a region of this buffer to a region in the target buffer even if the target memory region overlaps with the source. If <code>undefined</code> the <code>targetStart</code> and <code>sourceStart</code> parameters default to <code>0</code> while <code>sourceEnd</code> defaults to <code>buffer.length</code>.</p>
<p>Example: build two Buffers, then copy <code>buf1</code> from byte 16 through byte 19 into <code>buf2</code>, starting at the 8th byte in <code>buf2</code>.</p>
<pre class="sh_sourceCode"><code>buf1 <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">26</span><span class="sh_symbol">);</span>
buf2 <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">26</span><span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span> <span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">26</span> <span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  buf1<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> i <span class="sh_symbol">+</span> <span class="sh_number">97</span><span class="sh_symbol">;</span> <span class="sh_comment">// 97 is ASCII a</span>
  buf2<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">33</span><span class="sh_symbol">;</span> <span class="sh_comment">// ASCII !</span>
<span class="sh_cbracket">}</span>

buf1<span class="sh_symbol">.</span><span class="sh_function">copy</span><span class="sh_symbol">(</span>buf2<span class="sh_symbol">,</span> <span class="sh_number">8</span><span class="sh_symbol">,</span> <span class="sh_number">16</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf2<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'ascii'</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">25</span><span class="sh_symbol">));</span>

<span class="sh_comment">// !!!!!!!!qrst!!!!!!!!!!!!!</span></code></pre>
<p>Example: Build a single buffer, then copy data from one region to an overlapping region in the same buffer</p>
<pre class="sh_sourceCode"><code>buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">26</span><span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span> <span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">26</span> <span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  buf<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> i <span class="sh_symbol">+</span> <span class="sh_number">97</span><span class="sh_symbol">;</span> <span class="sh_comment">// 97 is ASCII a</span>
<span class="sh_cbracket">}</span>

buf<span class="sh_symbol">.</span><span class="sh_function">copy</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">10</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">());</span>

<span class="sh_comment">// efghijghijklmnopqrstuvwxyz</span></code></pre>
<h3>buf.slice([start][, end])<a id="all_buf_slice_start_end" class="mark" href="#all_buf_slice_start_end">#</a></h3>
<div class="signature">
<ul>
<li><code>start</code> Number, Optional, Default: 0</li>
<li><code>end</code> Number, Optional, Default: <code>buffer.length</code></li>
</ul>
</div>
<p>Returns a new buffer which references the same memory as the old, but offset and cropped by the <code>start</code> (defaults to <code>0</code>) and <code>end</code> (defaults to <code>buffer.length</code>) indexes. Negative indexes start from the end of the buffer.</p>
<p><strong>Modifying the new buffer slice will modify memory in the original buffer!</strong></p>
<p>Example: build a Buffer with the ASCII alphabet, take a slice, then modify one byte from the original Buffer.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf1 <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">26</span><span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span> <span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">26</span> <span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  buf1<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> i <span class="sh_symbol">+</span> <span class="sh_number">97</span><span class="sh_symbol">;</span> <span class="sh_comment">// 97 is ASCII a</span>
<span class="sh_cbracket">}</span>

<span class="sh_keyword">var</span> buf2 <span class="sh_symbol">=</span> buf1<span class="sh_symbol">.</span><span class="sh_function">slice</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf2<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'ascii'</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> buf2<span class="sh_symbol">.</span>length<span class="sh_symbol">));</span>
buf1<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">33</span><span class="sh_symbol">;</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf2<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'ascii'</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> buf2<span class="sh_symbol">.</span>length<span class="sh_symbol">));</span>

<span class="sh_comment">// abc</span>
<span class="sh_comment">// !bc</span></code></pre>
<h3>buf.readUInt8(offset[, noAssert])<a id="all_buf_readuint8_offset_noassert" class="mark" href="#all_buf_readuint8_offset_noassert">#</a></h3>
<div class="signature">
<ul>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
<li>Return: Number</li>
</ul>
</div>
<p>Reads an unsigned 8 bit integer from the buffer at the specified offset.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>

buf<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x3</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x4</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x23</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x42</span><span class="sh_symbol">;</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span>ii <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> ii <span class="sh_symbol">&lt;</span> buf<span class="sh_symbol">.</span>length<span class="sh_symbol">;</span> ii<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt8</span><span class="sh_symbol">(</span>ii<span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span>

<span class="sh_comment">// 0x3</span>
<span class="sh_comment">// 0x4</span>
<span class="sh_comment">// 0x23</span>
<span class="sh_comment">// 0x42</span></code></pre>
<h3>buf.readUInt16LE(offset[, noAssert])<a id="all_buf_readuint16le_offset_noassert" class="mark" href="#all_buf_readuint16le_offset_noassert">#</a></h3>
<h3>buf.readUInt16BE(offset[, noAssert])<a id="all_buf_readuint16be_offset_noassert" class="mark" href="#all_buf_readuint16be_offset_noassert">#</a></h3>
<ul>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
<li>Return: Number</li>
</ul>
<p>Reads an unsigned 16 bit integer from the buffer at the specified offset with specified endian format.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>

buf<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x3</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x4</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x23</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x42</span><span class="sh_symbol">;</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt16BE</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">));</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt16LE</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">));</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt16BE</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">));</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt16LE</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">));</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt16BE</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">));</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt16LE</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">));</span>

<span class="sh_comment">// 0x0304</span>
<span class="sh_comment">// 0x0403</span>
<span class="sh_comment">// 0x0423</span>
<span class="sh_comment">// 0x2304</span>
<span class="sh_comment">// 0x2342</span>
<span class="sh_comment">// 0x4223</span></code></pre>
<h3>buf.readUInt32LE(offset[, noAssert])<a id="all_buf_readuint32le_offset_noassert" class="mark" href="#all_buf_readuint32le_offset_noassert">#</a></h3>
<h3>buf.readUInt32BE(offset[, noAssert])<a id="all_buf_readuint32be_offset_noassert" class="mark" href="#all_buf_readuint32be_offset_noassert">#</a></h3>
<ul>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
<li>Return: Number</li>
</ul>
<p>Reads an unsigned 32 bit integer from the buffer at the specified offset with specified endian format.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>

buf<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x3</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x4</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x23</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x42</span><span class="sh_symbol">;</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt32BE</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">));</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readUInt32LE</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">));</span>

<span class="sh_comment">// 0x03042342</span>
<span class="sh_comment">// 0x42230403</span></code></pre>
<h3>buf.readInt8(offset[, noAssert])<a id="all_buf_readint8_offset_noassert" class="mark" href="#all_buf_readint8_offset_noassert">#</a></h3>
<div class="signature">
<ul>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
<li>Return: Number</li>
</ul>
</div>
<p>Reads a signed 8 bit integer from the buffer at the specified offset.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<p>Works as <code>buffer.readUInt8</code>, except buffer contents are treated as two's complement signed values.</p>
<h3>buf.readInt16LE(offset[, noAssert])<a id="all_buf_readint16le_offset_noassert" class="mark" href="#all_buf_readint16le_offset_noassert">#</a></h3>
<h3>buf.readInt16BE(offset[, noAssert])<a id="all_buf_readint16be_offset_noassert" class="mark" href="#all_buf_readint16be_offset_noassert">#</a></h3>
<ul>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
<li>Return: Number</li>
</ul>
<p>Reads a signed 16 bit integer from the buffer at the specified offset with specified endian format.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<p>Works as <code>buffer.readUInt16*</code>, except buffer contents are treated as two's complement signed values.</p>
<h3>buf.readInt32LE(offset[, noAssert])<a id="all_buf_readint32le_offset_noassert" class="mark" href="#all_buf_readint32le_offset_noassert">#</a></h3>
<h3>buf.readInt32BE(offset[, noAssert])<a id="all_buf_readint32be_offset_noassert" class="mark" href="#all_buf_readint32be_offset_noassert">#</a></h3>
<ul>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
<li>Return: Number</li>
</ul>
<p>Reads a signed 32 bit integer from the buffer at the specified offset with specified endian format.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<p>Works as <code>buffer.readUInt32*</code>, except buffer contents are treated as two's complement signed values.</p>
<h3>buf.readFloatLE(offset[, noAssert])<a id="all_buf_readfloatle_offset_noassert" class="mark" href="#all_buf_readfloatle_offset_noassert">#</a></h3>
<h3>buf.readFloatBE(offset[, noAssert])<a id="all_buf_readfloatbe_offset_noassert" class="mark" href="#all_buf_readfloatbe_offset_noassert">#</a></h3>
<ul>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
<li>Return: Number</li>
</ul>
<p>Reads a 32 bit float from the buffer at the specified offset with specified endian format.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>

buf<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x00</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x00</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x80</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x3f</span><span class="sh_symbol">;</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readFloatLE</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">));</span>

<span class="sh_comment">// 0x01</span></code></pre>
<h3>buf.readDoubleLE(offset[, noAssert])<a id="all_buf_readdoublele_offset_noassert" class="mark" href="#all_buf_readdoublele_offset_noassert">#</a></h3>
<h3>buf.readDoubleBE(offset[, noAssert])<a id="all_buf_readdoublebe_offset_noassert" class="mark" href="#all_buf_readdoublebe_offset_noassert">#</a></h3>
<ul>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
<li>Return: Number</li>
</ul>
<p>Reads a 64 bit double from the buffer at the specified offset with specified endian format.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>offset</code>. This means that <code>offset</code> may be beyond the end of the buffer. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">);</span>

buf<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x55</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x55</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x55</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x55</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">4</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x55</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">5</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x55</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">6</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0xd5</span><span class="sh_symbol">;</span>
buf<span class="sh_symbol">[</span><span class="sh_number">7</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0x3f</span><span class="sh_symbol">;</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span><span class="sh_function">readDoubleLE</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">));</span>

<span class="sh_comment">// 0.3333333333333333</span></code></pre>
<h3>buf.writeUInt8(value, offset[, noAssert])<a id="all_buf_writeuint8_value_offset_noassert" class="mark" href="#all_buf_writeuint8_value_offset_noassert">#</a></h3>
<div class="signature">
<ul>
<li><code>value</code> Number</li>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
</ul>
</div>
<p>Writes <code>value</code> to the buffer at the specified offset. Note, <code>value</code> must be a valid unsigned 8 bit integer.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>value</code> and <code>offset</code>. This means that <code>value</code> may be too large for the specific function and <code>offset</code> may be beyond the end of the buffer leading to the values being silently dropped. This should not be used unless you are certain of correctness. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt8</span><span class="sh_symbol">(</span><span class="sh_number">0x3</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt8</span><span class="sh_symbol">(</span><span class="sh_number">0x4</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt8</span><span class="sh_symbol">(</span><span class="sh_number">0x23</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt8</span><span class="sh_symbol">(</span><span class="sh_number">0x42</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

<span class="sh_comment">// &lt;Buffer 03 04 23 42&gt;</span></code></pre>
<h3>buf.writeUInt16LE(value, offset[, noAssert])<a id="all_buf_writeuint16le_value_offset_noassert" class="mark" href="#all_buf_writeuint16le_value_offset_noassert">#</a></h3>
<h3>buf.writeUInt16BE(value, offset[, noAssert])<a id="all_buf_writeuint16be_value_offset_noassert" class="mark" href="#all_buf_writeuint16be_value_offset_noassert">#</a></h3>
<ul>
<li><code>value</code> Number</li>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
</ul>
<p>Writes <code>value</code> to the buffer at the specified offset with specified endian format. Note, <code>value</code> must be a valid unsigned 16 bit integer.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>value</code> and <code>offset</code>. This means that <code>value</code> may be too large for the specific function and <code>offset</code> may be beyond the end of the buffer leading to the values being silently dropped. This should not be used unless you are certain of correctness. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt16BE</span><span class="sh_symbol">(</span><span class="sh_number">0xdead</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt16BE</span><span class="sh_symbol">(</span><span class="sh_number">0xbeef</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt16LE</span><span class="sh_symbol">(</span><span class="sh_number">0xdead</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt16LE</span><span class="sh_symbol">(</span><span class="sh_number">0xbeef</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

<span class="sh_comment">// &lt;Buffer de ad be ef&gt;</span>
<span class="sh_comment">// &lt;Buffer ad de ef be&gt;</span></code></pre>
<h3>buf.writeUInt32LE(value, offset[, noAssert])<a id="all_buf_writeuint32le_value_offset_noassert" class="mark" href="#all_buf_writeuint32le_value_offset_noassert">#</a></h3>
<h3>buf.writeUInt32BE(value, offset[, noAssert])<a id="all_buf_writeuint32be_value_offset_noassert" class="mark" href="#all_buf_writeuint32be_value_offset_noassert">#</a></h3>
<ul>
<li><code>value</code> Number</li>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
</ul>
<p>Writes <code>value</code> to the buffer at the specified offset with specified endian format. Note, <code>value</code> must be a valid unsigned 32 bit integer.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>value</code> and <code>offset</code>. This means that <code>value</code> may be too large for the specific function and <code>offset</code> may be beyond the end of the buffer leading to the values being silently dropped. This should not be used unless you are certain of correctness. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt32BE</span><span class="sh_symbol">(</span><span class="sh_number">0xfeedface</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

buf<span class="sh_symbol">.</span><span class="sh_function">writeUInt32LE</span><span class="sh_symbol">(</span><span class="sh_number">0xfeedface</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

<span class="sh_comment">// &lt;Buffer fe ed fa ce&gt;</span>
<span class="sh_comment">// &lt;Buffer ce fa ed fe&gt;</span></code></pre>
<h3>buf.writeInt8(value, offset[, noAssert])<a id="all_buf_writeint8_value_offset_noassert" class="mark" href="#all_buf_writeint8_value_offset_noassert">#</a></h3>
<div class="signature">
<ul>
<li><code>value</code> Number</li>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
</ul>
</div>
<p>Writes <code>value</code> to the buffer at the specified offset. Note, <code>value</code> must be a valid signed 8 bit integer.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>value</code> and <code>offset</code>. This means that <code>value</code> may be too large for the specific function and <code>offset</code> may be beyond the end of the buffer leading to the values being silently dropped. This should not be used unless you are certain of correctness. Defaults to <code>false</code>.</p>
<p>Works as <code>buffer.writeUInt8</code>, except value is written out as a two's complement signed integer into <code>buffer</code>.</p>
<h3>buf.writeInt16LE(value, offset[, noAssert])<a id="all_buf_writeint16le_value_offset_noassert" class="mark" href="#all_buf_writeint16le_value_offset_noassert">#</a></h3>
<h3>buf.writeInt16BE(value, offset[, noAssert])<a id="all_buf_writeint16be_value_offset_noassert" class="mark" href="#all_buf_writeint16be_value_offset_noassert">#</a></h3>
<ul>
<li><code>value</code> Number</li>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
</ul>
<p>Writes <code>value</code> to the buffer at the specified offset with specified endian format. Note, <code>value</code> must be a valid signed 16 bit integer.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>value</code> and <code>offset</code>. This means that <code>value</code> may be too large for the specific function and <code>offset</code> may be beyond the end of the buffer leading to the values being silently dropped. This should not be used unless you are certain of correctness. Defaults to <code>false</code>.</p>
<p>Works as <code>buffer.writeUInt16*</code>, except value is written out as a two's complement signed integer into <code>buffer</code>.</p>
<h3>buf.writeInt32LE(value, offset[, noAssert])<a id="all_buf_writeint32le_value_offset_noassert" class="mark" href="#all_buf_writeint32le_value_offset_noassert">#</a></h3>
<h3>buf.writeInt32BE(value, offset[, noAssert])<a id="all_buf_writeint32be_value_offset_noassert" class="mark" href="#all_buf_writeint32be_value_offset_noassert">#</a></h3>
<ul>
<li><code>value</code> Number</li>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
</ul>
<p>Writes <code>value</code> to the buffer at the specified offset with specified endian format. Note, <code>value</code> must be a valid signed 32 bit integer.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>value</code> and <code>offset</code>. This means that <code>value</code> may be too large for the specific function and <code>offset</code> may be beyond the end of the buffer leading to the values being silently dropped. This should not be used unless you are certain of correctness. Defaults to <code>false</code>.</p>
<p>Works as <code>buffer.writeUInt32*</code>, except value is written out as a two's complement signed integer into <code>buffer</code>.</p>
<h3>buf.writeFloatLE(value, offset[, noAssert])<a id="all_buf_writefloatle_value_offset_noassert" class="mark" href="#all_buf_writefloatle_value_offset_noassert">#</a></h3>
<h3>buf.writeFloatBE(value, offset[, noAssert])<a id="all_buf_writefloatbe_value_offset_noassert" class="mark" href="#all_buf_writefloatbe_value_offset_noassert">#</a></h3>
<ul>
<li><code>value</code> Number</li>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
</ul>
<p>Writes <code>value</code> to the buffer at the specified offset with specified endian format. Note, behavior is unspecified if <code>value</code> is not a 32 bit float.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>value</code> and <code>offset</code>. This means that <code>value</code> may be too large for the specific function and <code>offset</code> may be beyond the end of the buffer leading to the values being silently dropped. This should not be used unless you are certain of correctness. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeFloatBE</span><span class="sh_symbol">(</span><span class="sh_number">0xcafebabe</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

buf<span class="sh_symbol">.</span><span class="sh_function">writeFloatLE</span><span class="sh_symbol">(</span><span class="sh_number">0xcafebabe</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

<span class="sh_comment">// &lt;Buffer 4f 4a fe bb&gt;</span>
<span class="sh_comment">// &lt;Buffer bb fe 4a 4f&gt;</span></code></pre>
<h3>buf.writeDoubleLE(value, offset[, noAssert])<a id="all_buf_writedoublele_value_offset_noassert" class="mark" href="#all_buf_writedoublele_value_offset_noassert">#</a></h3>
<h3>buf.writeDoubleBE(value, offset[, noAssert])<a id="all_buf_writedoublebe_value_offset_noassert" class="mark" href="#all_buf_writedoublebe_value_offset_noassert">#</a></h3>
<ul>
<li><code>value</code> Number</li>
<li><code>offset</code> Number</li>
<li><code>noAssert</code> Boolean, Optional, Default: false</li>
</ul>
<p>Writes <code>value</code> to the buffer at the specified offset with specified endian format. Note, <code>value</code> must be a valid 64 bit double.</p>
<p>Set <code>noAssert</code> to true to skip validation of <code>value</code> and <code>offset</code>. This means that <code>value</code> may be too large for the specific function and <code>offset</code> may be beyond the end of the buffer leading to the values being silently dropped. This should not be used unless you are certain of correctness. Defaults to <code>false</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">);</span>
buf<span class="sh_symbol">.</span><span class="sh_function">writeDoubleBE</span><span class="sh_symbol">(</span><span class="sh_number">0xdeadbeefcafebabe</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

buf<span class="sh_symbol">.</span><span class="sh_function">writeDoubleLE</span><span class="sh_symbol">(</span><span class="sh_number">0xdeadbeefcafebabe</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>

<span class="sh_comment">// &lt;Buffer 43 eb d5 b7 dd f9 5f d7&gt;</span>
<span class="sh_comment">// &lt;Buffer d7 5f f9 dd b7 d5 eb 43&gt;</span></code></pre>
<h3>buf.fill(value[, offset][, end])<a id="all_buf_fill_value_offset_end" class="mark" href="#all_buf_fill_value_offset_end">#</a></h3>
<div class="signature">
<ul>
<li><code>value</code></li>
<li><code>offset</code> Number, Optional</li>
<li><code>end</code> Number, Optional</li>
</ul>
</div>
<p>Fills the buffer with the specified value. If the <code>offset</code> (defaults to <code>0</code>) and <code>end</code> (defaults to <code>buffer.length</code>) are not given it will fill the entire buffer.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> b <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_number">50</span><span class="sh_symbol">);</span>
b<span class="sh_symbol">.</span><span class="sh_function">fill</span><span class="sh_symbol">(</span><span class="sh_string">"h"</span><span class="sh_symbol">);</span></code></pre>
<h2>buffer.INSPECT_MAX_BYTES<a id="all_buffer_inspect_max_bytes" class="mark" href="#all_buffer_inspect_max_bytes">#</a></h2>
<div class="signature">
<ul>
<li>Number, Default: 50</li>
</ul>
</div>
<p>How many bytes will be returned when <code>buffer.inspect()</code> is called. This can be overridden by user modules.</p>
<p>Note that this is a property on the buffer module returned by <code>require('buffer')</code>, not on the Buffer global, or a buffer instance.</p>
<h2>Class: SlowBuffer<a id="all_class_slowbuffer" class="mark" href="#all_class_slowbuffer">#</a></h2>
<p>Returns an un-pooled <code>Buffer</code>.</p>
<p>In order to avoid the garbage collection overhead of creating many individually allocated Buffers, by default allocations under 4KB are sliced from a single larger allocated object. This approach improves both performance and memory usage since v8 does not need to track and cleanup as many <code>Persistent</code> objects.</p>
<p>In the case where a developer may need to retain a small chunk of memory from a pool for an indeterminate amount of time it may be appropriate to create an un-pooled Buffer instance using SlowBuffer and copy out the relevant bits.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// need to keep around a few small chunks of memory</span>
<span class="sh_keyword">var</span> store <span class="sh_symbol">=</span> <span class="sh_symbol">[];</span>

socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'readable'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> data <span class="sh_symbol">=</span> socket<span class="sh_symbol">.</span><span class="sh_function">read</span><span class="sh_symbol">();</span>
  <span class="sh_comment">// allocate for retained data</span>
  <span class="sh_keyword">var</span> sb <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">SlowBuffer</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">);</span>
  <span class="sh_comment">// copy the data into the new allocation</span>
  data<span class="sh_symbol">.</span><span class="sh_function">copy</span><span class="sh_symbol">(</span>sb<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">10</span><span class="sh_symbol">);</span>
  store<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>sb<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Though this should used sparingly and only be a last resort <em>after</em> a developer has actively observed undue memory retention in their applications.</p>
<h1>Stream<a id="all_stream" class="mark" href="#all_stream">#</a></h1>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable</pre>
<p>A stream is an abstract interface implemented by various objects in Node. For example a <a href="https://nodejs.org/api/http.html#http_http_incomingmessage">request to an HTTP server</a> is a stream, as is <a href="https://nodejs.org/api/process.html#process_process_stdout">stdout</a>. Streams are readable, writable, or both. All streams are instances of <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a></p>
<p>You can load the Stream base classes by doing <code>require('stream')</code>. There are base classes provided for <a href="#stream_class_stream_readable">Readable</a> streams, <a href="#stream_class_stream_writable">Writable</a> streams, <a href="#stream_class_stream_duplex">Duplex</a> streams, and <a href="#stream_class_stream_transform">Transform</a> streams.</p>
<p>This document is split up into 3 sections. The first explains the parts of the API that you need to be aware of to use streams in your programs. If you never implement a streaming API yourself, you can stop there.</p>
<p>The second section explains the parts of the API that you need to use if you implement your own custom streams yourself. The API is designed to make this easy for you to do.</p>
<p>The third section goes into more depth about how streams work, including some of the internal mechanisms and functions that you should probably not modify unless you definitely know what you are doing.</p>
<h2>API for Stream Consumers<a id="all_api_for_stream_consumers" class="mark" href="#all_api_for_stream_consumers">#</a></h2>
<p>Streams can be either <a href="#stream_class_stream_readable">Readable</a>, <a href="#stream_class_stream_writable">Writable</a>, or both (<a href="#stream_class_stream_duplex">Duplex</a>).</p>
<p>All streams are EventEmitters, but they also have other custom methods and properties depending on whether they are Readable, Writable, or Duplex.</p>
<p>If a stream is both Readable and Writable, then it implements all of the methods and events below. So, a <a href="#stream_class_stream_duplex">Duplex</a> or <a href="#stream_class_stream_transform">Transform</a> stream is fully described by this API, though their implementation may be somewhat different.</p>
<p>It is not necessary to implement Stream interfaces in order to consume streams in your programs. If you <strong>are</strong> implementing streaming interfaces in your own program, please also refer to <a href="#stream_api_for_stream_implementors">API for Stream Implementors</a> below.</p>
<p>Almost all Node programs, no matter how simple, use Streams in some way. Here is an example of using Streams in a Node program:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> http<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// req is an http.IncomingMessage, which is a Readable Stream</span>
  <span class="sh_comment">// res is an http.ServerResponse, which is a Writable Stream</span>

  <span class="sh_keyword">var</span> body <span class="sh_symbol">=</span> <span class="sh_string">''</span><span class="sh_symbol">;</span>
  <span class="sh_comment">// we want to get the data as utf8 strings</span>
  <span class="sh_comment">// If you don't set an encoding, then you'll get Buffer objects</span>
  req<span class="sh_symbol">.</span><span class="sh_function">setEncoding</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>

  <span class="sh_comment">// Readable streams emit 'data' events once a listener is added</span>
  req<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    body <span class="sh_symbol">+=</span> chunk<span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

  <span class="sh_comment">// the end event tells you that you have entire body</span>
  req<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">var</span> data <span class="sh_symbol">=</span> JSON<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span>body<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_comment">// uh oh!  bad json!</span>
      res<span class="sh_symbol">.</span>statusCode <span class="sh_symbol">=</span> <span class="sh_number">400</span><span class="sh_symbol">;</span>
      <span class="sh_keyword">return</span> res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'error: '</span> <span class="sh_symbol">+</span> er<span class="sh_symbol">.</span>message<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>

    <span class="sh_comment">// write back something interesting to the user:</span>
    res<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_keyword">typeof</span> data<span class="sh_symbol">);</span>
    res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">);</span>

<span class="sh_comment">// $ curl localhost:1337 -d '{}'</span>
<span class="sh_comment">// object</span>
<span class="sh_comment">// $ curl localhost:1337 -d '"foo"'</span>
<span class="sh_comment">// string</span>
<span class="sh_comment">// $ curl localhost:1337 -d 'not json'</span>
<span class="sh_comment">// error: Unexpected token o</span></code></pre>
<h3>Class: stream.Readable<a id="all_class_stream_readable" class="mark" href="#all_class_stream_readable">#</a></h3>
<p>The Readable stream interface is the abstraction for a <em>source</em> of data that you are reading from. In other words, data comes <em>out</em> of a Readable stream.</p>
<p>A Readable stream will not start emitting data until you indicate that you are ready to receive it.</p>
<p>Readable streams have two "modes": a <strong>flowing mode</strong> and a <strong>paused mode</strong>. When in flowing mode, data is read from the underlying system and provided to your program as fast as possible. In paused mode, you must explicitly call <code>stream.read()</code> to get chunks of data out. Streams start out in paused mode.</p>
<p><strong>Note</strong>: If no data event handlers are attached, and there are no <a href="#stream_readable_pipe_destination_options"><code>pipe()</code></a> destinations, and the stream is switched into flowing mode, then data will be lost.</p>
<p>You can switch to flowing mode by doing any of the following:</p>
<ul>
<li>Adding a <a href="#stream_event_data"><code>'data'</code> event</a> handler to listen for data.</li>
<li>Calling the <a href="#stream_readable_resume"><code>resume()</code></a> method to explicitly open the flow.</li>
<li>Calling the <a href="#stream_readable_pipe_destination_options"><code>pipe()</code></a> method to send the data to a <a href="#stream_class_stream_writable">Writable</a>.</li>
</ul>
<p>You can switch back to paused mode by doing either of the following:</p>
<ul>
<li>If there are no pipe destinations, by calling the <a href="#stream_readable_pause"><code>pause()</code></a> method.</li>
<li>If there are pipe destinations, by removing any <a href="#stream_event_data"><code>'data'</code> event</a> handlers, and removing all pipe destinations by calling the <a href="#stream_readable_unpipe_destination"><code>unpipe()</code></a> method.</li>
</ul>
<p>Note that, for backwards compatibility reasons, removing <code>'data'</code> event handlers will <strong>not</strong> automatically pause the stream. Also, if there are piped destinations, then calling <code>pause()</code> will not guarantee that the stream will <em>remain</em> paused once those destinations drain and ask for more data.</p>
<p>Examples of readable streams include:</p>
<ul>
<li><a href="https://nodejs.org/api/http.html#http_http_incomingmessage">http responses, on the client</a></li>
<li><a href="https://nodejs.org/api/http.html#http_http_incomingmessage">http requests, on the server</a></li>
<li><a href="https://nodejs.org/api/fs.html#fs_class_fs_readstream">fs read streams</a></li>
<li><a href="https://nodejs.org/api/zlib.html">zlib streams</a></li>
<li><a href="https://nodejs.org/api/crypto.html">crypto streams</a></li>
<li><a href="https://nodejs.org/api/net.html#net_class_net_socket">tcp sockets</a></li>
<li><a href="https://nodejs.org/api/child_process.html#child_process_child_stdout">child process stdout and stderr</a></li>
<li><a href="https://nodejs.org/api/process.html#process_process_stdin">process.stdin</a></li>
</ul>
<h4>Event: 'readable'<a id="all_event_readable" class="mark" href="#all_event_readable">#</a></h4>
<p>When a chunk of data can be read from the stream, it will emit a <code>'readable'</code> event.</p>
<p>In some cases, listening for a <code>'readable'</code> event will cause some data to be read into the internal buffer from the underlying system, if it hadn't already.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
readable<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'readable'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// there is some data to read now</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Once the internal buffer is drained, a <code>readable</code> event will fire again when more data is available.</p>
<h4>Event: 'data'<a id="all_event_data" class="mark" href="#all_event_data">#</a></h4>
<div class="signature">
<ul>
<li><code>chunk</code> <span class="type">Buffer | String</span> The chunk of data.</li>
</ul>
</div>
<p>Attaching a <code>data</code> event listener to a stream that has not been explicitly paused will switch the stream into flowing mode. Data will then be passed as soon as it is available.</p>
<p>If you just want to get all the data out of the stream as fast as possible, this is the best way to do so.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
readable<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'got %d bytes of data'</span><span class="sh_symbol">,</span> chunk<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h4>Event: 'end'<a id="all_event_end" class="mark" href="#all_event_end">#</a></h4>
<p>This event fires when there will be no more data to read.</p>
<p>Note that the <code>end</code> event <strong>will not fire</strong> unless the data is completely consumed. This can be done by switching into flowing mode, or by calling <code>read()</code> repeatedly until you get to the end.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
readable<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'got %d bytes of data'</span><span class="sh_symbol">,</span> chunk<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
readable<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'there will be no more data.'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h4>Event: 'close'<a id="all_event_close" class="mark" href="#all_event_close">#</a></h4>
<p>Emitted when the underlying resource (for example, the backing file descriptor) has been closed. Not all streams will emit this.</p>
<h4>Event: 'error'<a id="all_event_error" class="mark" href="#all_event_error">#</a></h4>
<div class="signature">
<ul>
<li><span class="type">Error Object</span></li>
</ul>
</div>
<p>Emitted if there was an error receiving data.</p>
<h4>readable.read([size])<a id="all_readable_read_size" class="mark" href="#all_readable_read_size">#</a></h4>
<div class="signature">
<ul>
<li><code>size</code> <span class="type">Number</span> Optional argument to specify how much data to read.</li>
<li>Return <span class="type">String | Buffer | null</span></li>
</ul>
</div>
<p>The <code>read()</code> method pulls some data out of the internal buffer and returns it. If there is no data available, then it will return <code>null</code>.</p>
<p>If you pass in a <code>size</code> argument, then it will return that many bytes. If <code>size</code> bytes are not available, then it will return <code>null</code>.</p>
<p>If you do not specify a <code>size</code> argument, then it will return all the data in the internal buffer.</p>
<p>This method should only be called in paused mode. In flowing mode, this method is called automatically until the internal buffer is drained.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
readable<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'readable'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> chunk<span class="sh_symbol">;</span>
  <span class="sh_keyword">while</span> <span class="sh_symbol">(</span><span class="sh_keyword">null</span> <span class="sh_symbol">!==</span> <span class="sh_symbol">(</span>chunk <span class="sh_symbol">=</span> readable<span class="sh_symbol">.</span><span class="sh_function">read</span><span class="sh_symbol">()))</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'got %d bytes of data'</span><span class="sh_symbol">,</span> chunk<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>If this method returns a data chunk, then it will also trigger the emission of a <a href="#stream_event_data"><code>'data'</code> event</a>.</p>
<h4>readable.setEncoding(encoding)<a id="all_readable_setencoding_encoding" class="mark" href="#all_readable_setencoding_encoding">#</a></h4>
<div class="signature">
<ul>
<li><code>encoding</code> <span class="type">String</span> The encoding to use.</li>
<li>Return: <code>this</code></li>
</ul>
</div>
<p>Call this function to cause the stream to return strings of the specified encoding instead of Buffer objects. For example, if you do <code>readable.setEncoding('utf8')</code>, then the output data will be interpreted as UTF-8 data, and returned as strings. If you do <code>readable.setEncoding('hex')</code>, then the data will be encoded in hexadecimal string format.</p>
<p>This properly handles multi-byte characters that would otherwise be potentially mangled if you simply pulled the Buffers directly and called <code>buf.toString(encoding)</code> on them. If you want to read the data as strings, always use this method.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
readable<span class="sh_symbol">.</span><span class="sh_function">setEncoding</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
readable<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  assert<span class="sh_symbol">.</span><span class="sh_function">equal</span><span class="sh_symbol">(</span><span class="sh_keyword">typeof</span> chunk<span class="sh_symbol">,</span> <span class="sh_string">'string'</span><span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'got %d characters of string data'</span><span class="sh_symbol">,</span> chunk<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h4>readable.resume()<a id="all_readable_resume" class="mark" href="#all_readable_resume">#</a></h4>
<div class="signature">
<ul>
<li>Return: <code>this</code></li>
</ul>
</div>
<p>This method will cause the readable stream to resume emitting <code>data</code> events.</p>
<p>This method will switch the stream into flowing mode. If you do <em>not</em> want to consume the data from a stream, but you <em>do</em> want to get to its <code>end</code> event, you can call <a href="#stream_readable_resume"><code>readable.resume()</code></a> to open the flow of data.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
readable<span class="sh_symbol">.</span><span class="sh_function">resume</span><span class="sh_symbol">();</span>
readable<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'got to the end, but did not read anything'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h4>readable.pause()<a id="all_readable_pause" class="mark" href="#all_readable_pause">#</a></h4>
<div class="signature">
<ul>
<li>Return: <code>this</code></li>
</ul>
</div>
<p>This method will cause a stream in flowing mode to stop emitting <code>data</code> events, switching out of flowing mode. Any data that becomes available will remain in the internal buffer.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
readable<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'got %d bytes of data'</span><span class="sh_symbol">,</span> chunk<span class="sh_symbol">.</span>length<span class="sh_symbol">);</span>
  readable<span class="sh_symbol">.</span><span class="sh_function">pause</span><span class="sh_symbol">();</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'there will be no more data for 1 second'</span><span class="sh_symbol">);</span>
  <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'now data will start flowing again'</span><span class="sh_symbol">);</span>
    readable<span class="sh_symbol">.</span><span class="sh_function">resume</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h4>readable.isPaused()<a id="all_readable_ispaused" class="mark" href="#all_readable_ispaused">#</a></h4>
<div class="signature">
<ul>
<li>Return: <code>Boolean</code></li>
</ul>
</div>
<p>This method returns whether or not the <code>readable</code> has been <strong>explicitly</strong> paused by client code (using <code>readable.pause()</code> without a corresponding <code>readable.resume()</code>).</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> stream<span class="sh_symbol">.</span>Readable

readable<span class="sh_symbol">.</span><span class="sh_function">isPaused</span><span class="sh_symbol">()</span> <span class="sh_comment">// === false</span>
readable<span class="sh_symbol">.</span><span class="sh_function">pause</span><span class="sh_symbol">()</span>
readable<span class="sh_symbol">.</span><span class="sh_function">isPaused</span><span class="sh_symbol">()</span> <span class="sh_comment">// === true</span>
readable<span class="sh_symbol">.</span><span class="sh_function">resume</span><span class="sh_symbol">()</span>
readable<span class="sh_symbol">.</span><span class="sh_function">isPaused</span><span class="sh_symbol">()</span> <span class="sh_comment">// === false</span></code></pre>
<h4>readable.pipe(destination[, options])<a id="all_readable_pipe_destination_options" class="mark" href="#all_readable_pipe_destination_options">#</a></h4>
<div class="signature">
<ul>
<li><code>destination</code> <span class="type"><a href="#stream_class_stream_writable">Writable</a> Stream</span> The destination for writing data</li>
<li><code>options</code> <span class="type">Object</span> Pipe options
<ul>
<li><code>end</code> <span class="type">Boolean</span> End the writer when the reader ends. Default = <code>true</code></li>
</ul>
</li>
</ul>
</div>
<p>This method pulls all the data out of a readable stream, and writes it to the supplied destination, automatically managing the flow so that the destination is not overwhelmed by a fast readable stream.</p>
<p>Multiple destinations can be piped to safely.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
<span class="sh_keyword">var</span> writable <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createWriteStream</span><span class="sh_symbol">(</span><span class="sh_string">'file.txt'</span><span class="sh_symbol">);</span>
<span class="sh_comment">// All the data from readable goes into 'file.txt'</span>
readable<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>writable<span class="sh_symbol">);</span></code></pre>
<p>This function returns the destination stream, so you can set up pipe chains like so:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> r <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createReadStream</span><span class="sh_symbol">(</span><span class="sh_string">'file.txt'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> z <span class="sh_symbol">=</span> zlib<span class="sh_symbol">.</span><span class="sh_function">createGzip</span><span class="sh_symbol">();</span>
<span class="sh_keyword">var</span> w <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createWriteStream</span><span class="sh_symbol">(</span><span class="sh_string">'file.txt.gz'</span><span class="sh_symbol">);</span>
r<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>z<span class="sh_symbol">).</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>w<span class="sh_symbol">);</span></code></pre>
<p>For example, emulating the Unix <code>cat</code> command:</p>
<pre class="sh_sourceCode"><code class="javascript">process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">);</span></code></pre>
<p>By default <a href="#stream_writable_end_chunk_encoding_callback"><code>end()</code></a> is called on the destination when the source stream emits <code>end</code>, so that <code>destination</code> is no longer writable. Pass <code>{ end: false }</code> as <code>options</code> to keep the destination stream open.</p>
<p>This keeps <code>writer</code> open so that "Goodbye" can be written at the end.</p>
<pre class="sh_sourceCode"><code class="javascript">reader<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>writer<span class="sh_symbol">,</span> <span class="sh_cbracket">{</span> end<span class="sh_symbol">:</span> <span class="sh_keyword">false</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
reader<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  writer<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'Goodbye</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Note that <code>process.stderr</code> and <code>process.stdout</code> are never closed until the process exits, regardless of the specified options.</p>
<h4>readable.unpipe([destination])<a id="all_readable_unpipe_destination" class="mark" href="#all_readable_unpipe_destination">#</a></h4>
<div class="signature">
<ul>
<li><code>destination</code> <span class="type"><a href="#stream_class_stream_writable">Writable</a> Stream</span> Optional specific stream to unpipe</li>
</ul>
</div>
<p>This method will remove the hooks set up for a previous <code>pipe()</code> call.</p>
<p>If the destination is not specified, then all pipes are removed.</p>
<p>If the destination is specified, but no pipe is set up for it, then this is a no-op.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> readable <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
<span class="sh_keyword">var</span> writable <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createWriteStream</span><span class="sh_symbol">(</span><span class="sh_string">'file.txt'</span><span class="sh_symbol">);</span>
<span class="sh_comment">// All the data from readable goes into 'file.txt',</span>
<span class="sh_comment">// but only for the first second</span>
readable<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>writable<span class="sh_symbol">);</span>
<span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'stop writing to file.txt'</span><span class="sh_symbol">);</span>
  readable<span class="sh_symbol">.</span><span class="sh_function">unpipe</span><span class="sh_symbol">(</span>writable<span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'manually close the file stream'</span><span class="sh_symbol">);</span>
  writable<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span></code></pre>
<h4>readable.unshift(chunk)<a id="all_readable_unshift_chunk" class="mark" href="#all_readable_unshift_chunk">#</a></h4>
<div class="signature">
<ul>
<li><code>chunk</code> <span class="type">Buffer | String</span> Chunk of data to unshift onto the read queue</li>
</ul>
</div>
<p>This is useful in certain cases where a stream is being consumed by a parser, which needs to "un-consume" some data that it has optimistically pulled out of the source, so that the stream can be passed on to some other party.</p>
<p>If you find that you must often call <code>stream.unshift(chunk)</code> in your programs, consider implementing a <a href="#stream_class_stream_transform">Transform</a> stream instead. (See API for Stream Implementors, below.)</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// Pull off a header delimited by \n\n</span>
<span class="sh_comment">// use unshift() if we get too much</span>
<span class="sh_comment">// Call the callback with (error, header, stream)</span>
<span class="sh_keyword">var</span> StringDecoder <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'string_decoder'</span><span class="sh_symbol">).</span>StringDecoder<span class="sh_symbol">;</span>
<span class="sh_keyword">function</span> <span class="sh_function">parseHeader</span><span class="sh_symbol">(</span>stream<span class="sh_symbol">,</span> callback<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  stream<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> callback<span class="sh_symbol">);</span>
  stream<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'readable'</span><span class="sh_symbol">,</span> onReadable<span class="sh_symbol">);</span>
  <span class="sh_keyword">var</span> decoder <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringDecoder</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
  <span class="sh_keyword">var</span> header <span class="sh_symbol">=</span> <span class="sh_string">''</span><span class="sh_symbol">;</span>
  <span class="sh_keyword">function</span> <span class="sh_function">onReadable</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">var</span> chunk<span class="sh_symbol">;</span>
    <span class="sh_keyword">while</span> <span class="sh_symbol">(</span><span class="sh_keyword">null</span> <span class="sh_symbol">!==</span> <span class="sh_symbol">(</span>chunk <span class="sh_symbol">=</span> stream<span class="sh_symbol">.</span><span class="sh_function">read</span><span class="sh_symbol">()))</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">var</span> str <span class="sh_symbol">=</span> decoder<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">);</span>
      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>str<span class="sh_symbol">.</span><span class="sh_function">match</span><span class="sh_symbol">(</span><span class="sh_regexp">/\n\n/</span><span class="sh_symbol">))</span> <span class="sh_cbracket">{</span>
        <span class="sh_comment">// found the header boundary</span>
        <span class="sh_keyword">var</span> split <span class="sh_symbol">=</span> str<span class="sh_symbol">.</span><span class="sh_function">split</span><span class="sh_symbol">(</span><span class="sh_regexp">/\n\n/</span><span class="sh_symbol">);</span>
        header <span class="sh_symbol">+=</span> split<span class="sh_symbol">.</span><span class="sh_function">shift</span><span class="sh_symbol">();</span>
        <span class="sh_keyword">var</span> remaining <span class="sh_symbol">=</span> split<span class="sh_symbol">.</span><span class="sh_function">join</span><span class="sh_symbol">(</span><span class="sh_string">'</span><span class="sh_specialchar">\n\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
        <span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span>remaining<span class="sh_symbol">,</span> <span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
        <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>buf<span class="sh_symbol">.</span>length<span class="sh_symbol">)</span>
          stream<span class="sh_symbol">.</span><span class="sh_function">unshift</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>
        stream<span class="sh_symbol">.</span><span class="sh_function">removeListener</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> callback<span class="sh_symbol">);</span>
        stream<span class="sh_symbol">.</span><span class="sh_function">removeListener</span><span class="sh_symbol">(</span><span class="sh_string">'readable'</span><span class="sh_symbol">,</span> onReadable<span class="sh_symbol">);</span>
        <span class="sh_comment">// now the body of the message can be read from the stream.</span>
        <span class="sh_function">callback</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">,</span> header<span class="sh_symbol">,</span> stream<span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
        <span class="sh_comment">// still reading the header.</span>
        header <span class="sh_symbol">+=</span> str<span class="sh_symbol">;</span>
      <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span></code></pre>
<h4>readable.wrap(stream)<a id="all_readable_wrap_stream" class="mark" href="#all_readable_wrap_stream">#</a></h4>
<div class="signature">
<ul>
<li><code>stream</code> <span class="type">Stream</span> An "old style" readable stream</li>
</ul>
</div>
<p>Versions of Node prior to v0.10 had streams that did not implement the entire Streams API as it is today. (See "Compatibility" below for more information.)</p>
<p>If you are using an older Node library that emits <code>'data'</code> events and has a <a href="#stream_readable_pause"><code>pause()</code></a> method that is advisory only, then you can use the <code>wrap()</code> method to create a <a href="#stream_class_stream_readable">Readable</a> stream that uses the old stream as its data source.</p>
<p>You will very rarely ever need to call this function, but it exists as a convenience for interacting with old Node programs and libraries.</p>
<p>For example:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> OldReader <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./old-api-module.js'</span><span class="sh_symbol">).</span>OldReader<span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> oreader <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> OldReader<span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> Readable <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'stream'</span><span class="sh_symbol">).</span>Readable<span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> myReader <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Readable</span><span class="sh_symbol">().</span><span class="sh_function">wrap</span><span class="sh_symbol">(</span>oreader<span class="sh_symbol">);</span>

myReader<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'readable'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  myReader<span class="sh_symbol">.</span><span class="sh_function">read</span><span class="sh_symbol">();</span> <span class="sh_comment">// etc.</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Class: stream.Writable<a id="all_class_stream_writable" class="mark" href="#all_class_stream_writable">#</a></h3>
<p>The Writable stream interface is an abstraction for a <em>destination</em> that you are writing data <em>to</em>.</p>
<p>Examples of writable streams include:</p>
<ul>
<li><a href="https://nodejs.org/api/http.html#http_class_http_clientrequest">http requests, on the client</a></li>
<li><a href="https://nodejs.org/api/http.html#http_class_http_serverresponse">http responses, on the server</a></li>
<li><a href="https://nodejs.org/api/fs.html#fs_class_fs_writestream">fs write streams</a></li>
<li><a href="https://nodejs.org/api/zlib.html">zlib streams</a></li>
<li><a href="https://nodejs.org/api/crypto.html">crypto streams</a></li>
<li><a href="https://nodejs.org/api/net.html#net_class_net_socket">tcp sockets</a></li>
<li><a href="https://nodejs.org/api/child_process.html#child_process_child_stdin">child process stdin</a></li>
<li><a href="https://nodejs.org/api/process.html#process_process_stdout">process.stdout</a>, <a href="https://nodejs.org/api/process.html#process_process_stderr">process.stderr</a></li>
</ul>
<h4>writable.write(chunk[, encoding][, callback])<a id="all_writable_write_chunk_encoding_callback" class="mark" href="#all_writable_write_chunk_encoding_callback">#</a></h4>
<div class="signature">
<ul>
<li><code>chunk</code> <span class="type">String | Buffer</span> The data to write</li>
<li><code>encoding</code> <span class="type">String</span> The encoding, if <code>chunk</code> is a String</li>
<li><code>callback</code> <span class="type">Function</span> Callback for when this chunk of data is flushed</li>
<li>Returns: <span class="type">Boolean</span> True if the data was handled completely.</li>
</ul>
</div>
<p>This method writes some data to the underlying system, and calls the supplied callback once the data has been fully handled.</p>
<p>The return value indicates if you should continue writing right now. If the data had to be buffered internally, then it will return <code>false</code>. Otherwise, it will return <code>true</code>.</p>
<p>This return value is strictly advisory. You MAY continue to write, even if it returns <code>false</code>. However, writes will be buffered in memory, so it is best not to do this excessively. Instead, wait for the <code>drain</code> event before writing more data.</p>
<h4>Event: 'drain'<a id="all_event_drain" class="mark" href="#all_event_drain">#</a></h4>
<p>If a <a href="#stream_writable_write_chunk_encoding_callback"><code>writable.write(chunk)</code></a> call returns false, then the <code>drain</code> event will indicate when it is appropriate to begin writing more data to the stream.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// Write the data to the supplied writable stream 1MM times.</span>
<span class="sh_comment">// Be attentive to back-pressure.</span>
<span class="sh_keyword">function</span> <span class="sh_function">writeOneMillionTimes</span><span class="sh_symbol">(</span>writer<span class="sh_symbol">,</span> data<span class="sh_symbol">,</span> encoding<span class="sh_symbol">,</span> callback<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">1000000</span><span class="sh_symbol">;</span>
  <span class="sh_function">write</span><span class="sh_symbol">();</span>
  <span class="sh_keyword">function</span> <span class="sh_function">write</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">var</span> ok <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">do</span> <span class="sh_cbracket">{</span>
      i <span class="sh_symbol">-=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>i <span class="sh_symbol">===</span> <span class="sh_number">0</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_comment">// last time!</span>
        writer<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>data<span class="sh_symbol">,</span> encoding<span class="sh_symbol">,</span> callback<span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
        <span class="sh_comment">// see if we should continue, or wait</span>
        <span class="sh_comment">// don't pass the callback, because we're not done yet.</span>
        ok <span class="sh_symbol">=</span> writer<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>data<span class="sh_symbol">,</span> encoding<span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span> <span class="sh_keyword">while</span> <span class="sh_symbol">(</span>i <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span> <span class="sh_symbol">&amp;&amp;</span> ok<span class="sh_symbol">);</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>i <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_comment">// had to stop early!</span>
      <span class="sh_comment">// write some more once it drains</span>
      writer<span class="sh_symbol">.</span><span class="sh_function">once</span><span class="sh_symbol">(</span><span class="sh_string">'drain'</span><span class="sh_symbol">,</span> write<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span></code></pre>
<h4>writable.cork()<a id="all_writable_cork" class="mark" href="#all_writable_cork">#</a></h4>
<p>Forces buffering of all writes.</p>
<p>Buffered data will be flushed either at <code>.uncork()</code> or at <code>.end()</code> call.</p>
<h4>writable.uncork()<a id="all_writable_uncork" class="mark" href="#all_writable_uncork">#</a></h4>
<p>Flush all data, buffered since <code>.cork()</code> call.</p>
<h4>writable.setDefaultEncoding(encoding)<a id="all_writable_setdefaultencoding_encoding" class="mark" href="#all_writable_setdefaultencoding_encoding">#</a></h4>
<div class="signature">
<ul>
<li><code>encoding</code> <span class="type">String</span> The new default encoding</li>
<li>Return: <code>Boolean</code></li>
</ul>
</div>
<p>Sets the default encoding for a writable stream. Returns <code>true</code> if the encoding is valid and is set. Otherwise returns <code>false</code>.</p>
<h4>writable.end([chunk][, encoding][, callback])<a id="all_writable_end_chunk_encoding_callback" class="mark" href="#all_writable_end_chunk_encoding_callback">#</a></h4>
<div class="signature">
<ul>
<li><code>chunk</code> <span class="type">String | Buffer</span> Optional data to write</li>
<li><code>encoding</code> <span class="type">String</span> The encoding, if <code>chunk</code> is a String</li>
<li><code>callback</code> <span class="type">Function</span> Optional callback for when the stream is finished</li>
</ul>
</div>
<p>Call this method when no more data will be written to the stream. If supplied, the callback is attached as a listener on the <code>finish</code> event.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// write 'hello, ' and then end with 'world!'</span>
<span class="sh_keyword">var</span> file <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createWriteStream</span><span class="sh_symbol">(</span><span class="sh_string">'example.txt'</span><span class="sh_symbol">);</span>
file<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'hello, '</span><span class="sh_symbol">);</span>
file<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'world!'</span><span class="sh_symbol">);</span></code></pre>
<p>Calling <a href="#stream_writable_write_chunk_encoding_callback"><code>write()</code></a> after calling <a href="#stream_writable_end_chunk_encoding_callback"><code>end()</code></a> will raise an error:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// end with 'world!' and then write with 'hello, ' will raise an error</span>
<span class="sh_keyword">var</span> file <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createWriteStream</span><span class="sh_symbol">(</span><span class="sh_string">'example.txt'</span><span class="sh_symbol">);</span>
file<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'world!'</span><span class="sh_symbol">);</span>
file<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'hello, '</span><span class="sh_symbol">);</span></code></pre>
<h4>Event: 'finish'<a id="all_event_finish" class="mark" href="#all_event_finish">#</a></h4>
<p>When the <a href="#stream_writable_end_chunk_encoding_callback"><code>end()</code></a> method has been called, and all data has been flushed to the underlying system, this event is emitted.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> writer <span class="sh_symbol">=</span> <span class="sh_function">getWritableStreamSomehow</span><span class="sh_symbol">();</span>
<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">100</span><span class="sh_symbol">;</span> i <span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  writer<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'hello, #'</span> <span class="sh_symbol">+</span> i <span class="sh_symbol">+</span> <span class="sh_string">'!</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>
writer<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'this is the end</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
writer<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'finish'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'all writes are now complete.'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h4>Event: 'pipe'<a id="all_event_pipe" class="mark" href="#all_event_pipe">#</a></h4>
<div class="signature">
<ul>
<li><code>src</code> <span class="type"><a href="#stream_class_stream_readable">Readable</a> Stream</span> source stream that is piping to this writable</li>
</ul>
</div>
<p>This is emitted whenever the <code>pipe()</code> method is called on a readable stream, adding this writable to its set of destinations.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> writer <span class="sh_symbol">=</span> <span class="sh_function">getWritableStreamSomehow</span><span class="sh_symbol">();</span>
<span class="sh_keyword">var</span> reader <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
writer<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'pipe'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>src<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'something is piping into the writer'</span><span class="sh_symbol">);</span>
  assert<span class="sh_symbol">.</span><span class="sh_function">equal</span><span class="sh_symbol">(</span>src<span class="sh_symbol">,</span> reader<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
reader<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>writer<span class="sh_symbol">);</span></code></pre>
<h4>Event: 'unpipe'<a id="all_event_unpipe" class="mark" href="#all_event_unpipe">#</a></h4>
<div class="signature">
<ul>
<li><code>src</code> <span class="type"><a href="#stream_class_stream_readable">Readable</a> Stream</span> The source stream that <a href="#stream_readable_unpipe_destination">unpiped</a> this writable</li>
</ul>
</div>
<p>This is emitted whenever the <a href="#stream_readable_unpipe_destination"><code>unpipe()</code></a> method is called on a readable stream, removing this writable from its set of destinations.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> writer <span class="sh_symbol">=</span> <span class="sh_function">getWritableStreamSomehow</span><span class="sh_symbol">();</span>
<span class="sh_keyword">var</span> reader <span class="sh_symbol">=</span> <span class="sh_function">getReadableStreamSomehow</span><span class="sh_symbol">();</span>
writer<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'unpipe'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>src<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">'something has stopped piping into the writer'</span><span class="sh_symbol">);</span>
  assert<span class="sh_symbol">.</span><span class="sh_function">equal</span><span class="sh_symbol">(</span>src<span class="sh_symbol">,</span> reader<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
reader<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>writer<span class="sh_symbol">);</span>
reader<span class="sh_symbol">.</span><span class="sh_function">unpipe</span><span class="sh_symbol">(</span>writer<span class="sh_symbol">);</span></code></pre>
<h4>Event: 'error'<a id="all_event_error_1" class="mark" href="#all_event_error_1">#</a></h4>
<div class="signature">
<ul>
<li><span class="type">Error object</span></li>
</ul>
</div>
<p>Emitted if there was an error when writing or piping data.</p>
<h3>Class: stream.Duplex<a id="all_class_stream_duplex" class="mark" href="#all_class_stream_duplex">#</a></h3>
<p>Duplex streams are streams that implement both the <a href="#stream_class_stream_readable">Readable</a> and <a href="#stream_class_stream_writable">Writable</a> interfaces. See above for usage.</p>
<p>Examples of Duplex streams include:</p>
<ul>
<li><a href="https://nodejs.org/api/net.html#net_class_net_socket">tcp sockets</a></li>
<li><a href="https://nodejs.org/api/zlib.html">zlib streams</a></li>
<li><a href="https://nodejs.org/api/crypto.html">crypto streams</a></li>
</ul>
<h3>Class: stream.Transform<a id="all_class_stream_transform" class="mark" href="#all_class_stream_transform">#</a></h3>
<p>Transform streams are <a href="#stream_class_stream_duplex">Duplex</a> streams where the output is in some way computed from the input. They implement both the <a href="#stream_class_stream_readable">Readable</a> and <a href="#stream_class_stream_writable">Writable</a> interfaces. See above for usage.</p>
<p>Examples of Transform streams include:</p>
<ul>
<li><a href="https://nodejs.org/api/zlib.html">zlib streams</a></li>
<li><a href="https://nodejs.org/api/crypto.html">crypto streams</a></li>
</ul>
<h2>API for Stream Implementors<a id="all_api_for_stream_implementors" class="mark" href="#all_api_for_stream_implementors">#</a></h2>
<p>To implement any sort of stream, the pattern is the same:</p>
<ol>
<li>Extend the appropriate parent class in your own subclass. (The <a href="https://nodejs.org/api/util.html#util_util_inherits_constructor_superconstructor"><code>util.inherits</code></a> method is particularly helpful for this.)</li>
<li>Call the appropriate parent class constructor in your constructor, to be sure that the internal mechanisms are set up properly.</li>
<li>Implement one or more specific methods, as detailed below.</li>
</ol>
<p>The class to extend and the method(s) to implement depend on the sort of stream class you are writing:</p>
<table>
<thead>
<tr>
<th>
<p>Use-case</p>
</th>
<th>
<p>Class</p>
</th>
<th>
<p>Method(s) to implement</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>Reading only</p>
</td>
<td>
<p><a href="#stream_class_stream_readable_1">Readable</a></p>
</td>
<td>
<p><code><a href="#stream_readable_read_size_1">_read</a></code></p>
</td>
</tr>
<tr>
<td>
<p>Writing only</p>
</td>
<td>
<p><a href="#stream_class_stream_writable_1">Writable</a></p>
</td>
<td>
<p><code><a href="#stream_writable_write_chunk_encoding_callback_1">_write</a></code></p>
</td>
</tr>
<tr>
<td>
<p>Reading and writing</p>
</td>
<td>
<p><a href="#stream_class_stream_duplex_1">Duplex</a></p>
</td>
<td>
<p><code><a href="#stream_readable_read_size_1">_read</a></code>, <code><a href="#stream_writable_write_chunk_encoding_callback_1">_write</a></code></p>
</td>
</tr>
<tr>
<td>
<p>Operate on written data, then read the result</p>
</td>
<td>
<p><a href="#stream_class_stream_transform_1">Transform</a></p>
</td>
<td>
<p><code>_transform</code>, <code>_flush</code></p>
</td>
</tr>
</tbody>
</table>
<p>In your implementation code, it is very important to never call the methods described in <a href="#stream_api_for_stream_consumers">API for Stream Consumers</a> above. Otherwise, you can potentially cause adverse side effects in programs that consume your streaming interfaces.</p>
<h3>Class: stream.Readable<a id="all_class_stream_readable_1" class="mark" href="#all_class_stream_readable_1">#</a></h3>
<p><code>stream.Readable</code> is an abstract class designed to be extended with an underlying implementation of the <a href="#stream_readable_read_size_1"><code>_read(size)</code></a> method.</p>
<p>Please see above under <a href="#stream_api_for_stream_consumers">API for Stream Consumers</a> for how to consume streams in your programs. What follows is an explanation of how to implement Readable streams in your programs.</p>
<h4>Example: A Counting Stream<a id="all_example_a_counting_stream" class="mark" href="#all_example_a_counting_stream">#</a></h4>
<p>This is a basic example of a Readable stream. It emits the numerals from 1 to 1,000,000 in ascending order, and then ends.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> Readable <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'stream'</span><span class="sh_symbol">).</span>Readable<span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>
util<span class="sh_symbol">.</span><span class="sh_function">inherits</span><span class="sh_symbol">(</span>Counter<span class="sh_symbol">,</span> Readable<span class="sh_symbol">);</span>

<span class="sh_keyword">function</span> <span class="sh_function">Counter</span><span class="sh_symbol">(</span>opt<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Readable<span class="sh_symbol">.</span><span class="sh_function">call</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">,</span> opt<span class="sh_symbol">);</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_max <span class="sh_symbol">=</span> <span class="sh_number">1000000</span><span class="sh_symbol">;</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_index <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

Counter<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>_read <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_index<span class="sh_symbol">++;</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>i <span class="sh_symbol">&gt;</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_max<span class="sh_symbol">)</span>
    <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">);</span>
  <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">var</span> str <span class="sh_symbol">=</span> <span class="sh_string">''</span> <span class="sh_symbol">+</span> i<span class="sh_symbol">;</span>
    <span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span>str<span class="sh_symbol">,</span> <span class="sh_string">'ascii'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span></code></pre>
<h4>Example: SimpleProtocol v1 (Sub-optimal)<a id="all_example_simpleprotocol_v1_sub_optimal" class="mark" href="#all_example_simpleprotocol_v1_sub_optimal">#</a></h4>
<p>This is similar to the <code>parseHeader</code> function described above, but implemented as a custom stream. Also, note that this implementation does not convert the incoming data to a string.</p>
<p>However, this would be better implemented as a <a href="#stream_class_stream_transform">Transform</a> stream. See below for a better implementation.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// A parser for a simple data protocol.</span>
<span class="sh_comment">// The "header" is a JSON object, followed by 2 \n characters, and</span>
<span class="sh_comment">// then a message body.</span>
<span class="sh_comment">//</span>
<span class="sh_comment">// NOTE: This can be done more simply as a Transform stream!</span>
<span class="sh_comment">// Using Readable directly for this is sub-optimal.  See the</span>
<span class="sh_comment">// alternative example below under the Transform section.</span>

<span class="sh_keyword">var</span> Readable <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'stream'</span><span class="sh_symbol">).</span>Readable<span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>

util<span class="sh_symbol">.</span><span class="sh_function">inherits</span><span class="sh_symbol">(</span>SimpleProtocol<span class="sh_symbol">,</span> Readable<span class="sh_symbol">);</span>

<span class="sh_keyword">function</span> <span class="sh_function">SimpleProtocol</span><span class="sh_symbol">(</span>source<span class="sh_symbol">,</span> options<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(!(</span><span class="sh_keyword">this</span> <span class="sh_keyword">instanceof</span> SimpleProtocol<span class="sh_symbol">))</span>
    <span class="sh_keyword">return</span> <span class="sh_keyword">new</span> <span class="sh_function">SimpleProtocol</span><span class="sh_symbol">(</span>source<span class="sh_symbol">,</span> options<span class="sh_symbol">);</span>

  Readable<span class="sh_symbol">.</span><span class="sh_function">call</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">,</span> options<span class="sh_symbol">);</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_inBody <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_sawFirstCr <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>

  <span class="sh_comment">// source is a readable stream, such as a socket or file</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_source <span class="sh_symbol">=</span> source<span class="sh_symbol">;</span>

  <span class="sh_keyword">var</span> self <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">;</span>
  source<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    self<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

  <span class="sh_comment">// give it a kick whenever the source is readable</span>
  <span class="sh_comment">// read(0) will not consume any bytes</span>
  source<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'readable'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    self<span class="sh_symbol">.</span><span class="sh_function">read</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_rawHeader <span class="sh_symbol">=</span> <span class="sh_symbol">[];</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>header <span class="sh_symbol">=</span> <span class="sh_keyword">null</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

SimpleProtocol<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>_read <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>n<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>_inBody<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">var</span> chunk <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_source<span class="sh_symbol">.</span><span class="sh_function">read</span><span class="sh_symbol">();</span>

    <span class="sh_comment">// if the source doesn't have data, we don't have data yet.</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>chunk <span class="sh_symbol">===</span> <span class="sh_keyword">null</span><span class="sh_symbol">)</span>
      <span class="sh_keyword">return</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span><span class="sh_string">''</span><span class="sh_symbol">);</span>

    <span class="sh_comment">// check if the chunk has a \n\n</span>
    <span class="sh_keyword">var</span> split <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> chunk<span class="sh_symbol">.</span>length<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>chunk<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">===</span> <span class="sh_number">10</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> <span class="sh_comment">// '\n'</span>
        <span class="sh_keyword">if</span> <span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>_sawFirstCr<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
          split <span class="sh_symbol">=</span> i<span class="sh_symbol">;</span>
          <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
          <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_sawFirstCr <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_sawFirstCr <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
      <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>

    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>split <span class="sh_symbol">===</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_comment">// still waiting for the \n\n</span>
      <span class="sh_comment">// stash the chunk, and try again.</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_rawHeader<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">);</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span><span class="sh_string">''</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_inBody <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
      <span class="sh_keyword">var</span> h <span class="sh_symbol">=</span> chunk<span class="sh_symbol">.</span><span class="sh_function">slice</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> split<span class="sh_symbol">);</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_rawHeader<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>h<span class="sh_symbol">);</span>
      <span class="sh_keyword">var</span> header <span class="sh_symbol">=</span> Buffer<span class="sh_symbol">.</span><span class="sh_function">concat</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>_rawHeader<span class="sh_symbol">).</span><span class="sh_function">toString</span><span class="sh_symbol">();</span>
      <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">this</span><span class="sh_symbol">.</span>header <span class="sh_symbol">=</span> JSON<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span>header<span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">new</span> <span class="sh_predef_func">Error</span><span class="sh_symbol">(</span><span class="sh_string">'invalid simple protocol data'</span><span class="sh_symbol">));</span>
        <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
      <span class="sh_cbracket">}</span>
      <span class="sh_comment">// now, because we got some extra data, unshift the rest</span>
      <span class="sh_comment">// back into the read queue so that our consumer will see it.</span>
      <span class="sh_keyword">var</span> b <span class="sh_symbol">=</span> chunk<span class="sh_symbol">.</span><span class="sh_function">slice</span><span class="sh_symbol">(</span>split<span class="sh_symbol">);</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">unshift</span><span class="sh_symbol">(</span>b<span class="sh_symbol">);</span>

      <span class="sh_comment">// and let them know that we are done parsing the header.</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">'header'</span><span class="sh_symbol">,</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>header<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// from there on, just provide the data to our consumer.</span>
    <span class="sh_comment">// careful not to push(null), since that would indicate EOF.</span>
    <span class="sh_keyword">var</span> chunk <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_source<span class="sh_symbol">.</span><span class="sh_function">read</span><span class="sh_symbol">();</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_comment">// Usage:</span>
<span class="sh_comment">// var parser = new SimpleProtocol(source);</span>
<span class="sh_comment">// Now parser is a readable stream that will emit 'header'</span>
<span class="sh_comment">// with the parsed header data.</span></code></pre>
<h4>new stream.Readable([options])<a id="all_new_stream_readable_options" class="mark" href="#all_new_stream_readable_options">#</a></h4>
<div class="signature">
<ul>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>highWaterMark</code> <span class="type">Number</span> The maximum number of bytes to store in the internal buffer before ceasing to read from the underlying resource. Default=16kb, or 16 for <code>objectMode</code> streams</li>
<li><code>encoding</code> <span class="type">String</span> If specified, then buffers will be decoded to strings using the specified encoding. Default=null</li>
<li><code>objectMode</code> <span class="type">Boolean</span> Whether this stream should behave as a stream of objects. Meaning that stream.read(n) returns a single value instead of a Buffer of size n. Default=false</li>
</ul>
</li>
</ul>
</div>
<p>In classes that extend the Readable class, make sure to call the Readable constructor so that the buffering settings can be properly initialized.</p>
<h4>readable._read(size)<a id="all_readable_read_size_1" class="mark" href="#all_readable_read_size_1">#</a></h4>
<div class="signature">
<ul>
<li><code>size</code> <span class="type">Number</span> Number of bytes to read asynchronously</li>
</ul>
</div>
<p>Note: <strong>Implement this function, but do NOT call it directly.</strong></p>
<p>This function should NOT be called directly. It should be implemented by child classes, and only called by the internal Readable class methods.</p>
<p>All Readable stream implementations must provide a <code>_read</code> method to fetch data from the underlying resource.</p>
<p>This method is prefixed with an underscore because it is internal to the class that defines it, and should not be called directly by user programs. However, you <strong>are</strong> expected to override this method in your own extension classes.</p>
<p>When data is available, put it into the read queue by calling <code>readable.push(chunk)</code>. If <code>push</code> returns false, then you should stop reading. When <code>_read</code> is called again, you should start pushing more data.</p>
<p>The <code>size</code> argument is advisory. Implementations where a "read" is a single call that returns data can use this to know how much data to fetch. Implementations where that is not relevant, such as TCP or TLS, may ignore this argument, and simply provide data whenever it becomes available. There is no need, for example to "wait" until <code>size</code> bytes are available before calling <a href="#stream_readable_push_chunk_encoding"><code>stream.push(chunk)</code></a>.</p>
<h4>readable.push(chunk[, encoding])<a id="all_readable_push_chunk_encoding" class="mark" href="#all_readable_push_chunk_encoding">#</a></h4>
<div class="signature">
<ul>
<li><code>chunk</code> <span class="type">Buffer | null | String</span> Chunk of data to push into the read queue</li>
<li><code>encoding</code> <span class="type">String</span> Encoding of String chunks. Must be a valid Buffer encoding, such as <code>'utf8'</code> or <code>'ascii'</code></li>
<li>return <span class="type">Boolean</span> Whether or not more pushes should be performed</li>
</ul>
</div>
<p>Note: <strong>This function should be called by Readable implementors, NOT by consumers of Readable streams.</strong></p>
<p>The <code>_read()</code> function will not be called again until at least one <code>push(chunk)</code> call is made.</p>
<p>The <code>Readable</code> class works by putting data into a read queue to be pulled out later by calling the <code>read()</code> method when the <code>'readable'</code> event fires.</p>
<p>The <code>push()</code> method will explicitly insert some data into the read queue. If it is called with <code>null</code> then it will signal the end of the data (EOF).</p>
<p>This API is designed to be as flexible as possible. For example, you may be wrapping a lower-level source which has some sort of pause/resume mechanism, and a data callback. In those cases, you could wrap the low-level source object by doing something like this:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// source is an object with readStop() and readStart() methods,</span>
<span class="sh_comment">// and an `ondata` member that gets called when it has data, and</span>
<span class="sh_comment">// an `onend` member that gets called when the data is over.</span>

util<span class="sh_symbol">.</span><span class="sh_function">inherits</span><span class="sh_symbol">(</span>SourceWrapper<span class="sh_symbol">,</span> Readable<span class="sh_symbol">);</span>

<span class="sh_keyword">function</span> <span class="sh_function">SourceWrapper</span><span class="sh_symbol">(</span>options<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  Readable<span class="sh_symbol">.</span><span class="sh_function">call</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">,</span> options<span class="sh_symbol">);</span>

  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_source <span class="sh_symbol">=</span> <span class="sh_function">getLowlevelSourceObject</span><span class="sh_symbol">();</span>
  <span class="sh_keyword">var</span> self <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">;</span>

  <span class="sh_comment">// Every time there's data, we push it into the internal buffer.</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_source<span class="sh_symbol">.</span>ondata <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// if push() returns false, then we need to stop reading from source</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span>self<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">))</span>
      self<span class="sh_symbol">.</span>_source<span class="sh_symbol">.</span><span class="sh_function">readStop</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

  <span class="sh_comment">// When the source ends, we push the EOF-signaling `null` chunk</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_source<span class="sh_symbol">.</span>onend <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    self<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

<span class="sh_comment">// _read will be called when the stream wants to pull more data in</span>
<span class="sh_comment">// the advisory size argument is ignored in this case.</span>
SourceWrapper<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>_read <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>size<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_source<span class="sh_symbol">.</span><span class="sh_function">readStart</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span></code></pre>
<h3>Class: stream.Writable<a id="all_class_stream_writable_1" class="mark" href="#all_class_stream_writable_1">#</a></h3>
<p><code>stream.Writable</code> is an abstract class designed to be extended with an underlying implementation of the <a href="#stream_writable_write_chunk_encoding_callback_1"><code>_write(chunk, encoding, callback)</code></a> method.</p>
<p>Please see above under <a href="#stream_api_for_stream_consumers">API for Stream Consumers</a> for how to consume writable streams in your programs. What follows is an explanation of how to implement Writable streams in your programs.</p>
<h4>new stream.Writable([options])<a id="all_new_stream_writable_options" class="mark" href="#all_new_stream_writable_options">#</a></h4>
<div class="signature">
<ul>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>highWaterMark</code> <span class="type">Number</span> Buffer level when <a href="#stream_writable_write_chunk_encoding_callback"><code>write()</code></a> starts returning false. Default=16kb, or 16 for <code>objectMode</code> streams</li>
<li><code>decodeStrings</code> <span class="type">Boolean</span> Whether or not to decode strings into Buffers before passing them to <a href="#stream_writable_write_chunk_encoding_callback_1"><code>_write()</code></a>. Default=true</li>
<li><code>objectMode</code> <span class="type">Boolean</span> Whether or not the <code>write(anyObj)</code> is a valid operation. If set you can write arbitrary data instead of only <code>Buffer</code> / <code>String</code> data. Default=false</li>
</ul>
</li>
</ul>
</div>
<p>In classes that extend the Writable class, make sure to call the constructor so that the buffering settings can be properly initialized.</p>
<h4>writable._write(chunk, encoding, callback)<a id="all_writable_write_chunk_encoding_callback_1" class="mark" href="#all_writable_write_chunk_encoding_callback_1">#</a></h4>
<div class="signature">
<ul>
<li><code>chunk</code> <span class="type">Buffer | String</span> The chunk to be written. Will always be a buffer unless the <code>decodeStrings</code> option was set to <code>false</code>.</li>
<li><code>encoding</code> <span class="type">String</span> If the chunk is a string, then this is the encoding type. Ignore if chunk is a buffer. Note that chunk will <strong>always</strong> be a buffer unless the <code>decodeStrings</code> option is explicitly set to <code>false</code>.</li>
<li><code>callback</code> <span class="type">Function</span> Call this function (optionally with an error argument) when you are done processing the supplied chunk.</li>
</ul>
</div>
<p>All Writable stream implementations must provide a <a href="#stream_writable_write_chunk_encoding_callback_1"><code>_write()</code></a> method to send data to the underlying resource.</p>
<p>Note: <strong>This function MUST NOT be called directly.</strong> It should be implemented by child classes, and called by the internal Writable class methods only.</p>
<p>Call the callback using the standard <code>callback(error)</code> pattern to signal that the write completed successfully or with an error.</p>
<p>If the <code>decodeStrings</code> flag is set in the constructor options, then <code>chunk</code> may be a string rather than a Buffer, and <code>encoding</code> will indicate the sort of string that it is. This is to support implementations that have an optimized handling for certain string data encodings. If you do not explicitly set the <code>decodeStrings</code> option to <code>false</code>, then you can safely ignore the <code>encoding</code> argument, and assume that <code>chunk</code> will always be a Buffer.</p>
<p>This method is prefixed with an underscore because it is internal to the class that defines it, and should not be called directly by user programs. However, you <strong>are</strong> expected to override this method in your own extension classes.</p>
<h3>writable._writev(chunks, callback)<a id="all_writable_writev_chunks_callback" class="mark" href="#all_writable_writev_chunks_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>chunks</code> <span class="type">Array</span> The chunks to be written. Each chunk has following format: <code>{ chunk: ..., encoding: ... }</code>.</li>
<li><code>callback</code> <span class="type">Function</span> Call this function (optionally with an error argument) when you are done processing the supplied chunks.</li>
</ul>
</div>
<p>Note: <strong>This function MUST NOT be called directly.</strong> It may be implemented by child classes, and called by the internal Writable class methods only.</p>
<p>This function is completely optional to implement. In most cases it is unnecessary. If implemented, it will be called with all the chunks that are buffered in the write queue.</p>
<h3>Class: stream.Duplex<a id="all_class_stream_duplex_1" class="mark" href="#all_class_stream_duplex_1">#</a></h3>
<p>A "duplex" stream is one that is both Readable and Writable, such as a TCP socket connection.</p>
<p>Note that <code>stream.Duplex</code> is an abstract class designed to be extended with an underlying implementation of the <code>_read(size)</code> and <a href="#stream_writable_write_chunk_encoding_callback_1"><code>_write(chunk, encoding, callback)</code></a> methods as you would with a Readable or Writable stream class.</p>
<p>Since JavaScript doesn't have multiple prototypal inheritance, this class prototypally inherits from Readable, and then parasitically from Writable. It is thus up to the user to implement both the lowlevel <code>_read(n)</code> method as well as the lowlevel <a href="#stream_writable_write_chunk_encoding_callback_1"><code>_write(chunk, encoding, callback)</code></a> method on extension duplex classes.</p>
<h4>new stream.Duplex(options)<a id="all_new_stream_duplex_options" class="mark" href="#all_new_stream_duplex_options">#</a></h4>
<div class="signature">
<ul>
<li><code>options</code> <span class="type">Object</span> Passed to both Writable and Readable constructors. Also has the following fields:
<ul>
<li><code>allowHalfOpen</code> <span class="type">Boolean</span> Default=true. If set to <code>false</code>, then the stream will automatically end the readable side when the writable side ends and vice versa.</li>
<li><code>readableObjectMode</code> <span class="type">Boolean</span> Default=false. Sets <code>objectMode</code> for readable side of the stream. Has no effect if <code>objectMode</code> is <code>true</code>.</li>
<li><code>writableObjectMode</code> <span class="type">Boolean</span> Default=false. Sets <code>objectMode</code> for writable side of the stream. Has no effect if <code>objectMode</code> is <code>true</code>.</li>
</ul>
</li>
</ul>
</div>
<p>In classes that extend the Duplex class, make sure to call the constructor so that the buffering settings can be properly initialized.</p>
<h3>Class: stream.Transform<a id="all_class_stream_transform_1" class="mark" href="#all_class_stream_transform_1">#</a></h3>
<p>A "transform" stream is a duplex stream where the output is causally connected in some way to the input, such as a <a href="https://nodejs.org/api/zlib.html">zlib</a> stream or a <a href="https://nodejs.org/api/crypto.html">crypto</a> stream.</p>
<p>There is no requirement that the output be the same size as the input, the same number of chunks, or arrive at the same time. For example, a Hash stream will only ever have a single chunk of output which is provided when the input is ended. A zlib stream will produce output that is either much smaller or much larger than its input.</p>
<p>Rather than implement the <a href="#stream_readable_read_size_1"><code>_read()</code></a> and <a href="#stream_writable_write_chunk_encoding_callback_1"><code>_write()</code></a> methods, Transform classes must implement the <code>_transform()</code> method, and may optionally also implement the <code>_flush()</code> method. (See below.)</p>
<h4>new stream.Transform([options])<a id="all_new_stream_transform_options" class="mark" href="#all_new_stream_transform_options">#</a></h4>
<div class="signature">
<ul>
<li><code>options</code> <span class="type">Object</span> Passed to both Writable and Readable constructors.</li>
</ul>
</div>
<p>In classes that extend the Transform class, make sure to call the constructor so that the buffering settings can be properly initialized.</p>
<h4>transform._transform(chunk, encoding, callback)<a id="all_transform_transform_chunk_encoding_callback" class="mark" href="#all_transform_transform_chunk_encoding_callback">#</a></h4>
<div class="signature">
<ul>
<li><code>chunk</code> <span class="type">Buffer | String</span> The chunk to be transformed. Will always be a buffer unless the <code>decodeStrings</code> option was set to <code>false</code>.</li>
<li><code>encoding</code> <span class="type">String</span> If the chunk is a string, then this is the encoding type. (Ignore if <code>decodeStrings</code> chunk is a buffer.)</li>
<li><code>callback</code> <span class="type">Function</span> Call this function (optionally with an error argument and data) when you are done processing the supplied chunk.</li>
</ul>
</div>
<p>Note: <strong>This function MUST NOT be called directly.</strong> It should be implemented by child classes, and called by the internal Transform class methods only.</p>
<p>All Transform stream implementations must provide a <code>_transform</code> method to accept input and produce output.</p>
<p><code>_transform</code> should do whatever has to be done in this specific Transform class, to handle the bytes being written, and pass them off to the readable portion of the interface. Do asynchronous I/O, process things, and so on.</p>
<p>Call <code>transform.push(outputChunk)</code> 0 or more times to generate output from this input chunk, depending on how much data you want to output as a result of this chunk.</p>
<p>Call the callback function only when the current chunk is completely consumed. Note that there may or may not be output as a result of any particular input chunk. If you supply as the second argument to the it will be passed to push method, in other words the following are equivalent:</p>
<pre class="sh_sourceCode"><code class="javascript">transform<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>_transform <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>data<span class="sh_symbol">,</span> encoding<span class="sh_symbol">,</span> callback<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>data<span class="sh_symbol">);</span>
  <span class="sh_function">callback</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

transform<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>_transform <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>data<span class="sh_symbol">,</span> encoding<span class="sh_symbol">,</span> callback<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">callback</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">,</span> data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<p>This method is prefixed with an underscore because it is internal to the class that defines it, and should not be called directly by user programs. However, you <strong>are</strong> expected to override this method in your own extension classes.</p>
<h4>transform._flush(callback)<a id="all_transform_flush_callback" class="mark" href="#all_transform_flush_callback">#</a></h4>
<div class="signature">
<ul>
<li><code>callback</code> <span class="type">Function</span> Call this function (optionally with an error argument) when you are done flushing any remaining data.</li>
</ul>
</div>
<p>Note: <strong>This function MUST NOT be called directly.</strong> It MAY be implemented by child classes, and if so, will be called by the internal Transform class methods only.</p>
<p>In some cases, your transform operation may need to emit a bit more data at the end of the stream. For example, a <code>Zlib</code> compression stream will store up some internal state so that it can optimally compress the output. At the end, however, it needs to do the best it can with what is left, so that the data will be complete.</p>
<p>In those cases, you can implement a <code>_flush</code> method, which will be called at the very end, after all the written data is consumed, but before emitting <code>end</code> to signal the end of the readable side. Just like with <code>_transform</code>, call <code>transform.push(chunk)</code> zero or more times, as appropriate, and call <code>callback</code> when the flush operation is complete.</p>
<p>This method is prefixed with an underscore because it is internal to the class that defines it, and should not be called directly by user programs. However, you <strong>are</strong> expected to override this method in your own extension classes.</p>
<h4>Events: 'finish' and 'end'<a id="all_events_finish_and_end" class="mark" href="#all_events_finish_and_end">#</a></h4>
<p>The <a href="#stream_event_finish"><code>finish</code></a> and <a href="#stream_event_end"><code>end</code></a> events are from the parent Writable and Readable classes respectively. The <code>finish</code> event is fired after <code>.end()</code> is called and all chunks have been processed by <code>_transform</code>, <code>end</code> is fired after all data has been output which is after the callback in <code>_flush</code> has been called.</p>
<h4>Example: <code>SimpleProtocol</code> parser v2<a id="all_example_simpleprotocol_parser_v2" class="mark" href="#all_example_simpleprotocol_parser_v2">#</a></h4>
<p>The example above of a simple protocol parser can be implemented simply by using the higher level <a href="#stream_class_stream_transform">Transform</a> stream class, similar to the <code>parseHeader</code> and <code>SimpleProtocol v1</code> examples above.</p>
<p>In this example, rather than providing the input as an argument, it would be piped into the parser, which is a more idiomatic Node stream approach.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> Transform <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'stream'</span><span class="sh_symbol">).</span>Transform<span class="sh_symbol">;</span>
util<span class="sh_symbol">.</span><span class="sh_function">inherits</span><span class="sh_symbol">(</span>SimpleProtocol<span class="sh_symbol">,</span> Transform<span class="sh_symbol">);</span>

<span class="sh_keyword">function</span> <span class="sh_function">SimpleProtocol</span><span class="sh_symbol">(</span>options<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(!(</span><span class="sh_keyword">this</span> <span class="sh_keyword">instanceof</span> SimpleProtocol<span class="sh_symbol">))</span>
    <span class="sh_keyword">return</span> <span class="sh_keyword">new</span> <span class="sh_function">SimpleProtocol</span><span class="sh_symbol">(</span>options<span class="sh_symbol">);</span>

  Transform<span class="sh_symbol">.</span><span class="sh_function">call</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">,</span> options<span class="sh_symbol">);</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_inBody <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_sawFirstCr <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_rawHeader <span class="sh_symbol">=</span> <span class="sh_symbol">[];</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>header <span class="sh_symbol">=</span> <span class="sh_keyword">null</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

SimpleProtocol<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>_transform <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">,</span> encoding<span class="sh_symbol">,</span> done<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>_inBody<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// check if the chunk has a \n\n</span>
    <span class="sh_keyword">var</span> split <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> chunk<span class="sh_symbol">.</span>length<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>chunk<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">===</span> <span class="sh_number">10</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> <span class="sh_comment">// '\n'</span>
        <span class="sh_keyword">if</span> <span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>_sawFirstCr<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
          split <span class="sh_symbol">=</span> i<span class="sh_symbol">;</span>
          <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
          <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_sawFirstCr <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_sawFirstCr <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
      <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>

    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>split <span class="sh_symbol">===</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_comment">// still waiting for the \n\n</span>
      <span class="sh_comment">// stash the chunk, and try again.</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_rawHeader<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_inBody <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
      <span class="sh_keyword">var</span> h <span class="sh_symbol">=</span> chunk<span class="sh_symbol">.</span><span class="sh_function">slice</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> split<span class="sh_symbol">);</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_rawHeader<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>h<span class="sh_symbol">);</span>
      <span class="sh_keyword">var</span> header <span class="sh_symbol">=</span> Buffer<span class="sh_symbol">.</span><span class="sh_function">concat</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>_rawHeader<span class="sh_symbol">).</span><span class="sh_function">toString</span><span class="sh_symbol">();</span>
      <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">this</span><span class="sh_symbol">.</span>header <span class="sh_symbol">=</span> JSON<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span>header<span class="sh_symbol">);</span>
      <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">new</span> <span class="sh_predef_func">Error</span><span class="sh_symbol">(</span><span class="sh_string">'invalid simple protocol data'</span><span class="sh_symbol">));</span>
        <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
      <span class="sh_cbracket">}</span>
      <span class="sh_comment">// and let them know that we are done parsing the header.</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">'header'</span><span class="sh_symbol">,</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>header<span class="sh_symbol">);</span>

      <span class="sh_comment">// now, because we got some extra data, emit this first.</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">.</span><span class="sh_function">slice</span><span class="sh_symbol">(</span>split<span class="sh_symbol">));</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// from there on, just provide the data to our consumer as-is.</span>
    <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
  <span class="sh_function">done</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_comment">// Usage:</span>
<span class="sh_comment">// var parser = new SimpleProtocol();</span>
<span class="sh_comment">// source.pipe(parser)</span>
<span class="sh_comment">// Now parser is a readable stream that will emit 'header'</span>
<span class="sh_comment">// with the parsed header data.</span></code></pre>
<h3>Class: stream.PassThrough<a id="all_class_stream_passthrough" class="mark" href="#all_class_stream_passthrough">#</a></h3>
<p>This is a trivial implementation of a <a href="#stream_class_stream_transform">Transform</a> stream that simply passes the input bytes across to the output. Its purpose is mainly for examples and testing, but there are occasionally use cases where it can come in handy as a building block for novel sorts of streams.</p>
<h2>Streams: Under the Hood<a id="all_streams_under_the_hood" class="mark" href="#all_streams_under_the_hood">#</a></h2>
<h3>Buffering<a id="all_buffering" class="mark" href="#all_buffering">#</a></h3>
<p>Both Writable and Readable streams will buffer data on an internal object called <code>_writableState.buffer</code> or <code>_readableState.buffer</code>, respectively.</p>
<p>The amount of data that will potentially be buffered depends on the <code>highWaterMark</code> option which is passed into the constructor.</p>
<p>Buffering in Readable streams happens when the implementation calls <a href="#stream_readable_push_chunk_encoding"><code>stream.push(chunk)</code></a>. If the consumer of the Stream does not call <code>stream.read()</code>, then the data will sit in the internal queue until it is consumed.</p>
<p>Buffering in Writable streams happens when the user calls <a href="#stream_writable_write_chunk_encoding_callback"><code>stream.write(chunk)</code></a> repeatedly, even when <code>write()</code> returns <code>false</code>.</p>
<p>The purpose of streams, especially with the <code>pipe()</code> method, is to limit the buffering of data to acceptable levels, so that sources and destinations of varying speed will not overwhelm the available memory.</p>
<h3><code>stream.read(0)</code><a id="all_stream_read_0" class="mark" href="#all_stream_read_0">#</a></h3>
<p>There are some cases where you want to trigger a refresh of the underlying readable stream mechanisms, without actually consuming any data. In that case, you can call <code>stream.read(0)</code>, which will always return null.</p>
<p>If the internal read buffer is below the <code>highWaterMark</code>, and the stream is not currently reading, then calling <code>read(0)</code> will trigger a low-level <code>_read</code> call.</p>
<p>There is almost never a need to do this. However, you will see some cases in Node's internals where this is done, particularly in the Readable stream class internals.</p>
<h3><code>stream.push('')</code><a id="all_stream_push" class="mark" href="#all_stream_push">#</a></h3>
<p>Pushing a zero-byte string or Buffer (when not in <a href="#stream_object_mode">Object mode</a>) has an interesting side effect. Because it <em>is</em> a call to <a href="#stream_readable_push_chunk_encoding"><code>stream.push()</code></a>, it will end the <code>reading</code> process. However, it does <em>not</em> add any data to the readable buffer, so there's nothing for a user to consume.</p>
<p>Very rarely, there are cases where you have no data to provide now, but the consumer of your stream (or, perhaps, another bit of your own code) will know when to check again, by calling <code>stream.read(0)</code>. In those cases, you <em>may</em> call <code>stream.push('')</code>.</p>
<p>So far, the only use case for this functionality is in the <a href="https://nodejs.org/api/tls.html#tls_class_cryptostream">tls.CryptoStream</a> class, which is deprecated in Node v0.12. If you find that you have to use <code>stream.push('')</code>, please consider another approach, because it almost certainly indicates that something is horribly wrong.</p>
<h3>Compatibility with Older Node Versions<a id="all_compatibility_with_older_node_versions" class="mark" href="#all_compatibility_with_older_node_versions">#</a></h3>
<p>In versions of Node prior to v0.10, the Readable stream interface was simpler, but also less powerful and less useful.</p>
<ul>
<li>Rather than waiting for you to call the <code>read()</code> method, <code>'data'</code> events would start emitting immediately. If you needed to do some I/O to decide how to handle data, then you had to store the chunks in some kind of buffer so that they would not be lost.</li>
<li>The <a href="#stream_readable_pause"><code>pause()</code></a> method was advisory, rather than guaranteed. This meant that you still had to be prepared to receive <code>'data'</code> events even when the stream was in a paused state.</li>
</ul>
<p>In Node v0.10, the Readable class described below was added. For backwards compatibility with older Node programs, Readable streams switch into "flowing mode" when a <code>'data'</code> event handler is added, or when the <a href="#stream_readable_resume"><code>resume()</code></a> method is called. The effect is that, even if you are not using the new <code>read()</code> method and <code>'readable'</code> event, you no longer have to worry about losing <code>'data'</code> chunks.</p>
<p>Most programs will continue to function normally. However, this introduces an edge case in the following conditions:</p>
<ul>
<li>No <a href="#stream_event_data"><code>'data'</code> event</a> handler is added.</li>
<li>The <a href="#stream_readable_resume"><code>resume()</code></a> method is never called.</li>
<li>The stream is not piped to any writable destination.</li>
</ul>
<p>For example, consider the following code:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// WARNING!  BROKEN!</span>
net<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>

  <span class="sh_comment">// we add an 'end' method, but never consume the data</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// It will never get here.</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'I got your message (but didnt read it)</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">);</span></code></pre>
<p>In versions of node prior to v0.10, the incoming message data would be simply discarded. However, in Node v0.10 and beyond, the socket will remain paused forever.</p>
<p>The workaround in this situation is to call the <code>resume()</code> method to start the flow of data:</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_comment">// Workaround</span>
net<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>

  socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'I got your message (but didnt read it)</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

  <span class="sh_comment">// start the flow of data, discarding it.</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">resume</span><span class="sh_symbol">();</span>

<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">);</span></code></pre>
<p>In addition to new Readable streams switching into flowing mode, pre-v0.10 style streams can be wrapped in a Readable class using the <code>wrap()</code> method.</p>
<h3>Object Mode<a id="all_object_mode" class="mark" href="#all_object_mode">#</a></h3>
<p>Normally, Streams operate on Strings and Buffers exclusively.</p>
<p>Streams that are in <strong>object mode</strong> can emit generic JavaScript values other than Buffers and Strings.</p>
<p>A Readable stream in object mode will always return a single item from a call to <code>stream.read(size)</code>, regardless of what the size argument is.</p>
<p>A Writable stream in object mode will always ignore the <code>encoding</code> argument to <code>stream.write(data, encoding)</code>.</p>
<p>The special value <code>null</code> still retains its special value for object mode streams. That is, for object mode readable streams, <code>null</code> as a return value from <code>stream.read()</code> indicates that there is no more data, and <a href="#stream_readable_push_chunk_encoding"><code>stream.push(null)</code></a> will signal the end of stream data (<code>EOF</code>).</p>
<p>No streams in Node core are object mode streams. This pattern is only used by userland streaming libraries.</p>
<p>You should set <code>objectMode</code> in your stream child class constructor on the options object. Setting <code>objectMode</code> mid-stream is not safe.</p>
<p>For Duplex streams <code>objectMode</code> can be set exclusively for readable or writable side with <code>readableObjectMode</code> and <code>writableObjectMode</code> respectively. These options can be used to implement parsers and serializers with Transform streams.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> StringDecoder <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'string_decoder'</span><span class="sh_symbol">).</span>StringDecoder<span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> Transform <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'stream'</span><span class="sh_symbol">).</span>Transform<span class="sh_symbol">;</span>
util<span class="sh_symbol">.</span><span class="sh_function">inherits</span><span class="sh_symbol">(</span>JSONParseStream<span class="sh_symbol">,</span> Transform<span class="sh_symbol">);</span>

<span class="sh_comment">// Gets \n-delimited JSON string data, and emits the parsed objects</span>
<span class="sh_keyword">function</span> <span class="sh_function">JSONParseStream</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(!(</span><span class="sh_keyword">this</span> <span class="sh_keyword">instanceof</span> JSONParseStream<span class="sh_symbol">))</span>
    <span class="sh_keyword">return</span> <span class="sh_keyword">new</span> <span class="sh_function">JSONParseStream</span><span class="sh_symbol">();</span>

  Transform<span class="sh_symbol">.</span><span class="sh_function">call</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span> readableObjectMode <span class="sh_symbol">:</span> <span class="sh_keyword">true</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_buffer <span class="sh_symbol">=</span> <span class="sh_string">''</span><span class="sh_symbol">;</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_decoder <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringDecoder</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

JSONParseStream<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>_transform <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">,</span> encoding<span class="sh_symbol">,</span> cb<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_buffer <span class="sh_symbol">+=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_decoder<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">);</span>
  <span class="sh_comment">// split on newlines</span>
  <span class="sh_keyword">var</span> lines <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_buffer<span class="sh_symbol">.</span><span class="sh_function">split</span><span class="sh_symbol">(</span><span class="sh_regexp">/\r?\n/</span><span class="sh_symbol">);</span>
  <span class="sh_comment">// keep the last partial line buffered</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_buffer <span class="sh_symbol">=</span> lines<span class="sh_symbol">.</span><span class="sh_function">pop</span><span class="sh_symbol">();</span>
  <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> l <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> l <span class="sh_symbol">&lt;</span> lines<span class="sh_symbol">.</span>length<span class="sh_symbol">;</span> l<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">var</span> line <span class="sh_symbol">=</span> lines<span class="sh_symbol">[</span>l<span class="sh_symbol">];</span>
    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">var</span> obj <span class="sh_symbol">=</span> JSON<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span>line<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> er<span class="sh_symbol">);</span>
      <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_comment">// push the parsed object out to the readable consumer</span>
    <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>obj<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
  <span class="sh_function">cb</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

JSONParseStream<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span><span class="sh_symbol">.</span>_flush <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>cb<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// Just handle any leftover</span>
  <span class="sh_keyword">var</span> rem <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>_buffer<span class="sh_symbol">.</span><span class="sh_function">trim</span><span class="sh_symbol">();</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>rem<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">var</span> obj <span class="sh_symbol">=</span> JSON<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span>rem<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>er<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> er<span class="sh_symbol">);</span>
      <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_comment">// push the parsed object out to the readable consumer</span>
    <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span>obj<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
  <span class="sh_function">cb</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span></code></pre>
<h1>Crypto<a id="all_crypto" class="mark" href="#all_crypto">#</a></h1>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable<span class="sh_symbol">;</span> API changes are being discussed <span class="sh_keyword">for</span>
future versions<span class="sh_symbol">.</span>  Breaking changes will be minimized<span class="sh_symbol">.</span>  See below<span class="sh_symbol">.</span></pre>
<p>Use <code>require('crypto')</code> to access this module.</p>
<p>The crypto module offers a way of encapsulating secure credentials to be used as part of a secure HTTPS net or http connection.</p>
<p>It also offers a set of wrappers for OpenSSL's hash, hmac, cipher, decipher, sign and verify methods.</p>
<h2>crypto.setEngine(engine[, flags])<a id="all_crypto_setengine_engine_flags" class="mark" href="#all_crypto_setengine_engine_flags">#</a></h2>
<p>Load and set engine for some/all OpenSSL functions (selected by flags).</p>
<p><code>engine</code> could be either an id or a path to the to the engine's shared library.</p>
<p><code>flags</code> is optional and has <code>ENGINE_METHOD_ALL</code> value by default. It could take one of or mix of following flags (defined in <code>constants</code> module):</p>
<ul>
<li><code>ENGINE_METHOD_RSA</code></li>
<li><code>ENGINE_METHOD_DSA</code></li>
<li><code>ENGINE_METHOD_DH</code></li>
<li><code>ENGINE_METHOD_RAND</code></li>
<li><code>ENGINE_METHOD_ECDH</code></li>
<li><code>ENGINE_METHOD_ECDSA</code></li>
<li><code>ENGINE_METHOD_CIPHERS</code></li>
<li><code>ENGINE_METHOD_DIGESTS</code></li>
<li><code>ENGINE_METHOD_STORE</code></li>
<li><code>ENGINE_METHOD_PKEY_METH</code></li>
<li><code>ENGINE_METHOD_PKEY_ASN1_METH</code></li>
<li><code>ENGINE_METHOD_ALL</code></li>
<li><code>ENGINE_METHOD_NONE</code></li>
</ul>
<h2>crypto.getCiphers()<a id="all_crypto_getciphers" class="mark" href="#all_crypto_getciphers">#</a></h2>
<p>Returns an array with the names of the supported ciphers.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> ciphers <span class="sh_symbol">=</span> crypto<span class="sh_symbol">.</span><span class="sh_function">getCiphers</span><span class="sh_symbol">();</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>ciphers<span class="sh_symbol">);</span> <span class="sh_comment">// ['AES-128-CBC', 'AES-128-CBC-HMAC-SHA1', ...]</span></code></pre>
<h2>crypto.getHashes()<a id="all_crypto_gethashes" class="mark" href="#all_crypto_gethashes">#</a></h2>
<p>Returns an array with the names of the supported hash algorithms.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> hashes <span class="sh_symbol">=</span> crypto<span class="sh_symbol">.</span><span class="sh_function">getHashes</span><span class="sh_symbol">();</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>hashes<span class="sh_symbol">);</span> <span class="sh_comment">// ['sha', 'sha1', 'sha1WithRSAEncryption', ...]</span></code></pre>
<h2>crypto.createCredentials(details)<a id="all_crypto_createcredentials_details" class="mark" href="#all_crypto_createcredentials_details">#</a></h2>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated<span class="sh_symbol">.</span> Use <a href="https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_details">tls<span class="sh_symbol">.</span>createSecureContext</a> instead<span class="sh_symbol">.</span></pre>
<p>Creates a credentials object, with the optional details being a dictionary with keys:</p>
<ul>
<li><code>pfx</code> : A string or buffer holding the PFX or PKCS12 encoded private key, certificate and CA certificates</li>
<li><code>key</code> : A string holding the PEM encoded private key</li>
<li><code>passphrase</code> : A string of passphrase for the private key or pfx</li>
<li><code>cert</code> : A string holding the PEM encoded certificate</li>
<li><code>ca</code> : Either a string or list of strings of PEM encoded CA certificates to trust.</li>
<li><code>crl</code> : Either a string or list of strings of PEM encoded CRLs (Certificate Revocation List)</li>
<li><code>ciphers</code>: A string describing the ciphers to use or exclude. Consult <a href="http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT">http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT</a> for details on the format.</li>
</ul>
<p>If no 'ca' details are given, then node.js will use the default publicly trusted list of CAs as given in</p>
<p><a href="http://mxr.mozilla.org/mozilla/source/security/nss/lib/ckfw/builtins/certdata.txt">http://mxr.mozilla.org/mozilla/source/security/nss/lib/ckfw/builtins/certdata.txt</a>.</p>
<h2>crypto.createHash(algorithm)<a id="all_crypto_createhash_algorithm" class="mark" href="#all_crypto_createhash_algorithm">#</a></h2>
<p>Creates and returns a hash object, a cryptographic hash with the given algorithm which can be used to generate hash digests.</p>
<p><code>algorithm</code> is dependent on the available algorithms supported by the version of OpenSSL on the platform. Examples are <code>'sha1'</code>, <code>'md5'</code>, <code>'sha256'</code>, <code>'sha512'</code>, etc. On recent releases, <code>openssl list-message-digest-algorithms</code> will display the available digest algorithms.</p>
<p>Example: this program that takes the sha1 sum of a file</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> filename <span class="sh_symbol">=</span> process<span class="sh_symbol">.</span>argv<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">];</span>
<span class="sh_keyword">var</span> crypto <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'crypto'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> shasum <span class="sh_symbol">=</span> crypto<span class="sh_symbol">.</span><span class="sh_function">createHash</span><span class="sh_symbol">(</span><span class="sh_string">'sha1'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> s <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">ReadStream</span><span class="sh_symbol">(</span>filename<span class="sh_symbol">);</span>
s<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>d<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  shasum<span class="sh_symbol">.</span><span class="sh_function">update</span><span class="sh_symbol">(</span>d<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

s<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> d <span class="sh_symbol">=</span> shasum<span class="sh_symbol">.</span><span class="sh_function">digest</span><span class="sh_symbol">(</span><span class="sh_string">'hex'</span><span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>d <span class="sh_symbol">+</span> <span class="sh_string">'  '</span> <span class="sh_symbol">+</span> filename<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Class: Hash<a id="all_class_hash" class="mark" href="#all_class_hash">#</a></h2>
<p>The class for creating hash digests of data.</p>
<p>It is a <a href="https://nodejs.org/api/stream.html">stream</a> that is both readable and writable. The written data is used to compute the hash. Once the writable side of the stream is ended, use the <code>read()</code> method to get the computed hash digest. The legacy <code>update</code> and <code>digest</code> methods are also supported.</p>
<p>Returned by <code>crypto.createHash</code>.</p>
<h3>hash.update(data[, input_encoding])<a id="all_hash_update_data_input_encoding" class="mark" href="#all_hash_update_data_input_encoding">#</a></h3>
<p>Updates the hash content with the given <code>data</code>, the encoding of which is given in <code>input_encoding</code> and can be <code>'utf8'</code>, <code>'ascii'</code> or <code>'binary'</code>. If no encoding is provided and the input is a string an encoding of <code>'binary'</code> is enforced. If <code>data</code> is a <code>Buffer</code> then <code>input_encoding</code> is ignored.</p>
<p>This can be called many times with new data as it is streamed.</p>
<h3>hash.digest([encoding])<a id="all_hash_digest_encoding" class="mark" href="#all_hash_digest_encoding">#</a></h3>
<p>Calculates the digest of all of the passed data to be hashed. The <code>encoding</code> can be <code>'hex'</code>, <code>'binary'</code> or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<p>Note: <code>hash</code> object can not be used after <code>digest()</code> method has been called.</p>
<h2>crypto.createHmac(algorithm, key)<a id="all_crypto_createhmac_algorithm_key" class="mark" href="#all_crypto_createhmac_algorithm_key">#</a></h2>
<p>Creates and returns a hmac object, a cryptographic hmac with the given algorithm and key.</p>
<p>It is a <a href="https://nodejs.org/api/stream.html">stream</a> that is both readable and writable. The written data is used to compute the hmac. Once the writable side of the stream is ended, use the <code>read()</code> method to get the computed digest. The legacy <code>update</code> and <code>digest</code> methods are also supported.</p>
<p><code>algorithm</code> is dependent on the available algorithms supported by OpenSSL - see createHash above. <code>key</code> is the hmac key to be used.</p>
<h2>Class: Hmac<a id="all_class_hmac" class="mark" href="#all_class_hmac">#</a></h2>
<p>Class for creating cryptographic hmac content.</p>
<p>Returned by <code>crypto.createHmac</code>.</p>
<h3>hmac.update(data)<a id="all_hmac_update_data" class="mark" href="#all_hmac_update_data">#</a></h3>
<p>Update the hmac content with the given <code>data</code>. This can be called many times with new data as it is streamed.</p>
<h3>hmac.digest([encoding])<a id="all_hmac_digest_encoding" class="mark" href="#all_hmac_digest_encoding">#</a></h3>
<p>Calculates the digest of all of the passed data to the hmac. The <code>encoding</code> can be <code>'hex'</code>, <code>'binary'</code> or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<p>Note: <code>hmac</code> object can not be used after <code>digest()</code> method has been called.</p>
<h2>crypto.createCipher(algorithm, password)<a id="all_crypto_createcipher_algorithm_password" class="mark" href="#all_crypto_createcipher_algorithm_password">#</a></h2>
<p>Creates and returns a cipher object, with the given algorithm and password.</p>
<p><code>algorithm</code> is dependent on OpenSSL, examples are <code>'aes192'</code>, etc. On recent releases, <code>openssl list-cipher-algorithms</code> will display the available cipher algorithms. <code>password</code> is used to derive key and IV, which must be a <code>'binary'</code> encoded string or a <a href="https://nodejs.org/api/buffer.html">buffer</a>.</p>
<p>It is a <a href="https://nodejs.org/api/stream.html">stream</a> that is both readable and writable. The written data is used to compute the hash. Once the writable side of the stream is ended, use the <code>read()</code> method to get the enciphered contents. The legacy <code>update</code> and <code>final</code> methods are also supported.</p>
<p>Note: <code>createCipher</code> derives keys with the OpenSSL function <a href="https://www.openssl.org/docs/crypto/EVP_BytesToKey.html">EVP_BytesToKey</a> with the digest algorithm set to MD5, one iteration, and no salt. The lack of salt allows dictionary attacks as the same password always creates the same key. The low iteration count and non-cryptographically secure hash algorithm allow passwords to be tested very rapidly.</p>
<p>In line with OpenSSL's recommendation to use pbkdf2 instead of EVP_BytesToKey it is recommended you derive a key and iv yourself with <a href="#crypto_crypto_pbkdf2_password_salt_iterations_keylen_callback">crypto.pbkdf2</a> and to then use <a href="#crypto_crypto_createcipheriv_algorithm_key_iv">createCipheriv()</a> to create the cipher stream.</p>
<h2>crypto.createCipheriv(algorithm, key, iv)<a id="all_crypto_createcipheriv_algorithm_key_iv" class="mark" href="#all_crypto_createcipheriv_algorithm_key_iv">#</a></h2>
<p>Creates and returns a cipher object, with the given algorithm, key and iv.</p>
<p><code>algorithm</code> is the same as the argument to <code>createCipher()</code>. <code>key</code> is the raw key used by the algorithm. <code>iv</code> is an <a href="http://en.wikipedia.org/wiki/Initialization_vector">initialization vector</a>.</p>
<p><code>key</code> and <code>iv</code> must be <code>'binary'</code> encoded strings or <a href="https://nodejs.org/api/buffer.html">buffers</a>.</p>
<h2>Class: Cipher<a id="all_class_cipher" class="mark" href="#all_class_cipher">#</a></h2>
<p>Class for encrypting data.</p>
<p>Returned by <code>crypto.createCipher</code> and <code>crypto.createCipheriv</code>.</p>
<p>Cipher objects are <a href="https://nodejs.org/api/stream.html">streams</a> that are both readable and writable. The written plain text data is used to produce the encrypted data on the readable side. The legacy <code>update</code> and <code>final</code> methods are also supported.</p>
<h3>cipher.update(data[, input_encoding][, output_encoding])<a id="all_cipher_update_data_input_encoding_output_encoding" class="mark" href="#all_cipher_update_data_input_encoding_output_encoding">#</a></h3>
<p>Updates the cipher with <code>data</code>, the encoding of which is given in <code>input_encoding</code> and can be <code>'utf8'</code>, <code>'ascii'</code> or <code>'binary'</code>. If no encoding is provided, then a buffer is expected. If <code>data</code> is a <code>Buffer</code> then <code>input_encoding</code> is ignored.</p>
<p>The <code>output_encoding</code> specifies the output format of the enciphered data, and can be <code>'binary'</code>, <code>'base64'</code> or <code>'hex'</code>. If no encoding is provided, then a buffer is returned.</p>
<p>Returns the enciphered contents, and can be called many times with new data as it is streamed.</p>
<h3>cipher.final([output_encoding])<a id="all_cipher_final_output_encoding" class="mark" href="#all_cipher_final_output_encoding">#</a></h3>
<p>Returns any remaining enciphered contents, with <code>output_encoding</code> being one of: <code>'binary'</code>, <code>'base64'</code> or <code>'hex'</code>. If no encoding is provided, then a buffer is returned.</p>
<p>Note: <code>cipher</code> object can not be used after <code>final()</code> method has been called.</p>
<h3>cipher.setAutoPadding(auto_padding=true)<a id="all_cipher_setautopadding_auto_padding_true" class="mark" href="#all_cipher_setautopadding_auto_padding_true">#</a></h3>
<p>You can disable automatic padding of the input data to block size. If <code>auto_padding</code> is false, the length of the entire input data must be a multiple of the cipher's block size or <code>final</code> will fail. Useful for non-standard padding, e.g. using <code>0x0</code> instead of PKCS padding. You must call this before <code>cipher.final</code>.</p>
<h3>cipher.getAuthTag()<a id="all_cipher_getauthtag" class="mark" href="#all_cipher_getauthtag">#</a></h3>
<p>For authenticated encryption modes (currently supported: GCM), this method returns a <code>Buffer</code> that represents the <em>authentication tag</em> that has been computed from the given data. Should be called after encryption has been completed using the <code>final</code> method!</p>
<h3>cipher.setAAD(buffer)<a id="all_cipher_setaad_buffer" class="mark" href="#all_cipher_setaad_buffer">#</a></h3>
<p>For authenticated encryption modes (currently supported: GCM), this method sets the value used for the additional authenticated data (AAD) input parameter.</p>
<h2>crypto.createDecipher(algorithm, password)<a id="all_crypto_createdecipher_algorithm_password" class="mark" href="#all_crypto_createdecipher_algorithm_password">#</a></h2>
<p>Creates and returns a decipher object, with the given algorithm and key. This is the mirror of the <a href="#crypto_crypto_createcipher_algorithm_password">createCipher()</a> above.</p>
<h2>crypto.createDecipheriv(algorithm, key, iv)<a id="all_crypto_createdecipheriv_algorithm_key_iv" class="mark" href="#all_crypto_createdecipheriv_algorithm_key_iv">#</a></h2>
<p>Creates and returns a decipher object, with the given algorithm, key and iv. This is the mirror of the <a href="#crypto_crypto_createcipheriv_algorithm_key_iv">createCipheriv()</a> above.</p>
<h2>Class: Decipher<a id="all_class_decipher" class="mark" href="#all_class_decipher">#</a></h2>
<p>Class for decrypting data.</p>
<p>Returned by <code>crypto.createDecipher</code> and <code>crypto.createDecipheriv</code>.</p>
<p>Decipher objects are <a href="https://nodejs.org/api/stream.html">streams</a> that are both readable and writable. The written enciphered data is used to produce the plain-text data on the the readable side. The legacy <code>update</code> and <code>final</code> methods are also supported.</p>
<h3>decipher.update(data[, input_encoding][, output_encoding])<a id="all_decipher_update_data_input_encoding_output_encoding" class="mark" href="#all_decipher_update_data_input_encoding_output_encoding">#</a></h3>
<p>Updates the decipher with <code>data</code>, which is encoded in <code>'binary'</code>, <code>'base64'</code> or <code>'hex'</code>. If no encoding is provided, then a buffer is expected. If <code>data</code> is a <code>Buffer</code> then <code>input_encoding</code> is ignored.</p>
<p>The <code>output_decoding</code> specifies in what format to return the deciphered plaintext: <code>'binary'</code>, <code>'ascii'</code> or <code>'utf8'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>decipher.final([output_encoding])<a id="all_decipher_final_output_encoding" class="mark" href="#all_decipher_final_output_encoding">#</a></h3>
<p>Returns any remaining plaintext which is deciphered, with <code>output_encoding</code> being one of: <code>'binary'</code>, <code>'ascii'</code> or <code>'utf8'</code>. If no encoding is provided, then a buffer is returned.</p>
<p>Note: <code>decipher</code> object can not be used after <code>final()</code> method has been called.</p>
<h3>decipher.setAutoPadding(auto_padding=true)<a id="all_decipher_setautopadding_auto_padding_true" class="mark" href="#all_decipher_setautopadding_auto_padding_true">#</a></h3>
<p>You can disable auto padding if the data has been encrypted without standard block padding to prevent <code>decipher.final</code> from checking and removing it. Can only work if the input data's length is a multiple of the ciphers block size. You must call this before streaming data to <code>decipher.update</code>.</p>
<h3>decipher.setAuthTag(buffer)<a id="all_decipher_setauthtag_buffer" class="mark" href="#all_decipher_setauthtag_buffer">#</a></h3>
<p>For authenticated encryption modes (currently supported: GCM), this method must be used to pass in the received <em>authentication tag</em>. If no tag is provided or if the ciphertext has been tampered with, <code>final</code> will throw, thus indicating that the ciphertext should be discarded due to failed authentication.</p>
<h3>decipher.setAAD(buffer)<a id="all_decipher_setaad_buffer" class="mark" href="#all_decipher_setaad_buffer">#</a></h3>
<p>For authenticated encryption modes (currently supported: GCM), this method sets the value used for the additional authenticated data (AAD) input parameter.</p>
<h2>crypto.createSign(algorithm)<a id="all_crypto_createsign_algorithm" class="mark" href="#all_crypto_createsign_algorithm">#</a></h2>
<p>Creates and returns a signing object, with the given algorithm. On recent OpenSSL releases, <code>openssl list-public-key-algorithms</code> will display the available signing algorithms. Examples are <code>'RSA-SHA256'</code>.</p>
<h2>Class: Sign<a id="all_class_sign" class="mark" href="#all_class_sign">#</a></h2>
<p>Class for generating signatures.</p>
<p>Returned by <code>crypto.createSign</code>.</p>
<p>Sign objects are writable <a href="https://nodejs.org/api/stream.html">streams</a>. The written data is used to generate the signature. Once all of the data has been written, the <code>sign</code> method will return the signature. The legacy <code>update</code> method is also supported.</p>
<h3>sign.update(data)<a id="all_sign_update_data" class="mark" href="#all_sign_update_data">#</a></h3>
<p>Updates the sign object with data. This can be called many times with new data as it is streamed.</p>
<h3>sign.sign(private_key[, output_format])<a id="all_sign_sign_private_key_output_format" class="mark" href="#all_sign_sign_private_key_output_format">#</a></h3>
<p>Calculates the signature on all the updated data passed through the sign.</p>
<p><code>private_key</code> can be an object or a string. If <code>private_key</code> is a string, it is treated as the key with no passphrase.</p>
<p><code>private_key</code>:</p>
<ul>
<li><code>key</code> : A string holding the PEM encoded private key</li>
<li><code>passphrase</code> : A string of passphrase for the private key</li>
</ul>
<p>Returns the signature in <code>output_format</code> which can be <code>'binary'</code>, <code>'hex'</code> or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<p>Note: <code>sign</code> object can not be used after <code>sign()</code> method has been called.</p>
<h2>crypto.createVerify(algorithm)<a id="all_crypto_createverify_algorithm" class="mark" href="#all_crypto_createverify_algorithm">#</a></h2>
<p>Creates and returns a verification object, with the given algorithm. This is the mirror of the signing object above.</p>
<h2>Class: Verify<a id="all_class_verify" class="mark" href="#all_class_verify">#</a></h2>
<p>Class for verifying signatures.</p>
<p>Returned by <code>crypto.createVerify</code>.</p>
<p>Verify objects are writable <a href="https://nodejs.org/api/stream.html">streams</a>. The written data is used to validate against the supplied signature. Once all of the data has been written, the <code>verify</code> method will return true if the supplied signature is valid. The legacy <code>update</code> method is also supported.</p>
<h3>verifier.update(data)<a id="all_verifier_update_data" class="mark" href="#all_verifier_update_data">#</a></h3>
<p>Updates the verifier object with data. This can be called many times with new data as it is streamed.</p>
<h3>verifier.verify(object, signature[, signature_format])<a id="all_verifier_verify_object_signature_signature_format" class="mark" href="#all_verifier_verify_object_signature_signature_format">#</a></h3>
<p>Verifies the signed data by using the <code>object</code> and <code>signature</code>. <code>object</code> is a string containing a PEM encoded object, which can be one of RSA public key, DSA public key, or X.509 certificate. <code>signature</code> is the previously calculated signature for the data, in the <code>signature_format</code> which can be <code>'binary'</code>, <code>'hex'</code> or <code>'base64'</code>. If no encoding is specified, then a buffer is expected.</p>
<p>Returns true or false depending on the validity of the signature for the data and public key.</p>
<p>Note: <code>verifier</code> object can not be used after <code>verify()</code> method has been called.</p>
<h2>crypto.createDiffieHellman(prime_length[, generator])<a id="all_crypto_creatediffiehellman_prime_length_generator" class="mark" href="#all_crypto_creatediffiehellman_prime_length_generator">#</a></h2>
<p>Creates a Diffie-Hellman key exchange object and generates a prime of <code>prime_length</code> bits and using an optional specific numeric <code>generator</code>. If no <code>generator</code> is specified, then <code>2</code> is used.</p>
<h2>crypto.createDiffieHellman(prime[, prime_encoding][, generator][, generator_encoding])<a id="all_crypto_creatediffiehellman_prime_prime_encoding_generator_generator_encoding" class="mark" href="#all_crypto_creatediffiehellman_prime_prime_encoding_generator_generator_encoding">#</a></h2>
<p>Creates a Diffie-Hellman key exchange object using the supplied <code>prime</code> and an optional specific <code>generator</code>. <code>generator</code> can be a number, string, or Buffer. If no <code>generator</code> is specified, then <code>2</code> is used. <code>prime_encoding</code> and <code>generator_encoding</code> can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no <code>prime_encoding</code> is specified, then a Buffer is expected for <code>prime</code>. If no <code>generator_encoding</code> is specified, then a Buffer is expected for <code>generator</code>.</p>
<h2>Class: DiffieHellman<a id="all_class_diffiehellman" class="mark" href="#all_class_diffiehellman">#</a></h2>
<p>The class for creating Diffie-Hellman key exchanges.</p>
<p>Returned by <code>crypto.createDiffieHellman</code>.</p>
<h3>diffieHellman.verifyError<a id="all_diffiehellman_verifyerror" class="mark" href="#all_diffiehellman_verifyerror">#</a></h3>
<p>A bit field containing any warnings and/or errors as a result of a check performed during initialization. The following values are valid for this property (defined in <code>constants</code> module):</p>
<ul>
<li><code>DH_CHECK_P_NOT_SAFE_PRIME</code></li>
<li><code>DH_CHECK_P_NOT_PRIME</code></li>
<li><code>DH_UNABLE_TO_CHECK_GENERATOR</code></li>
<li><code>DH_NOT_SUITABLE_GENERATOR</code></li>
</ul>
<h3>diffieHellman.generateKeys([encoding])<a id="all_diffiehellman_generatekeys_encoding" class="mark" href="#all_diffiehellman_generatekeys_encoding">#</a></h3>
<p>Generates private and public Diffie-Hellman key values, and returns the public key in the specified encoding. This key should be transferred to the other party. Encoding can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>diffieHellman.computeSecret(other_public_key[, input_encoding][, output_encoding])<a id="all_diffiehellman_computesecret_other_public_key_input_encoding_output_encoding" class="mark" href="#all_diffiehellman_computesecret_other_public_key_input_encoding_output_encoding">#</a></h3>
<p>Computes the shared secret using <code>other_public_key</code> as the other party's public key and returns the computed shared secret. Supplied key is interpreted using specified <code>input_encoding</code>, and secret is encoded using specified <code>output_encoding</code>. Encodings can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If the input encoding is not provided, then a buffer is expected.</p>
<p>If no output encoding is given, then a buffer is returned.</p>
<h3>diffieHellman.getPrime([encoding])<a id="all_diffiehellman_getprime_encoding" class="mark" href="#all_diffiehellman_getprime_encoding">#</a></h3>
<p>Returns the Diffie-Hellman prime in the specified encoding, which can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>diffieHellman.getGenerator([encoding])<a id="all_diffiehellman_getgenerator_encoding" class="mark" href="#all_diffiehellman_getgenerator_encoding">#</a></h3>
<p>Returns the Diffie-Hellman generator in the specified encoding, which can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>diffieHellman.getPublicKey([encoding])<a id="all_diffiehellman_getpublickey_encoding" class="mark" href="#all_diffiehellman_getpublickey_encoding">#</a></h3>
<p>Returns the Diffie-Hellman public key in the specified encoding, which can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>diffieHellman.getPrivateKey([encoding])<a id="all_diffiehellman_getprivatekey_encoding" class="mark" href="#all_diffiehellman_getprivatekey_encoding">#</a></h3>
<p>Returns the Diffie-Hellman private key in the specified encoding, which can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>diffieHellman.setPublicKey(public_key[, encoding])<a id="all_diffiehellman_setpublickey_public_key_encoding" class="mark" href="#all_diffiehellman_setpublickey_public_key_encoding">#</a></h3>
<p>Sets the Diffie-Hellman public key. Key encoding can be <code>'binary'</code>, <code>'hex'</code> or <code>'base64'</code>. If no encoding is provided, then a buffer is expected.</p>
<h3>diffieHellman.setPrivateKey(private_key[, encoding])<a id="all_diffiehellman_setprivatekey_private_key_encoding" class="mark" href="#all_diffiehellman_setprivatekey_private_key_encoding">#</a></h3>
<p>Sets the Diffie-Hellman private key. Key encoding can be <code>'binary'</code>, <code>'hex'</code> or <code>'base64'</code>. If no encoding is provided, then a buffer is expected.</p>
<h2>crypto.getDiffieHellman(group_name)<a id="all_crypto_getdiffiehellman_group_name" class="mark" href="#all_crypto_getdiffiehellman_group_name">#</a></h2>
<p>Creates a predefined Diffie-Hellman key exchange object. The supported groups are: <code>'modp1'</code>, <code>'modp2'</code>, <code>'modp5'</code> (defined in <a href="http://www.rfc-editor.org/rfc/rfc2412.txt">RFC 2412</a>) and <code>'modp14'</code>, <code>'modp15'</code>, <code>'modp16'</code>, <code>'modp17'</code>, <code>'modp18'</code> (defined in <a href="http://www.rfc-editor.org/rfc/rfc3526.txt">RFC 3526</a>). The returned object mimics the interface of objects created by <a href="#crypto_crypto_creatediffiehellman_prime_encoding">crypto.createDiffieHellman()</a> above, but will not allow to change the keys (with <a href="#crypto_diffiehellman_setpublickey_public_key_encoding">diffieHellman.setPublicKey()</a> for example). The advantage of using this routine is that the parties don't have to generate nor exchange group modulus beforehand, saving both processor and communication time.</p>
<p>Example (obtaining a shared secret):</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> crypto <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'crypto'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> alice <span class="sh_symbol">=</span> crypto<span class="sh_symbol">.</span><span class="sh_function">getDiffieHellman</span><span class="sh_symbol">(</span><span class="sh_string">'modp5'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> bob <span class="sh_symbol">=</span> crypto<span class="sh_symbol">.</span><span class="sh_function">getDiffieHellman</span><span class="sh_symbol">(</span><span class="sh_string">'modp5'</span><span class="sh_symbol">);</span>

alice<span class="sh_symbol">.</span><span class="sh_function">generateKeys</span><span class="sh_symbol">();</span>
bob<span class="sh_symbol">.</span><span class="sh_function">generateKeys</span><span class="sh_symbol">();</span>

<span class="sh_keyword">var</span> alice_secret <span class="sh_symbol">=</span> alice<span class="sh_symbol">.</span><span class="sh_function">computeSecret</span><span class="sh_symbol">(</span>bob<span class="sh_symbol">.</span><span class="sh_function">getPublicKey</span><span class="sh_symbol">(),</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_string">'hex'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> bob_secret <span class="sh_symbol">=</span> bob<span class="sh_symbol">.</span><span class="sh_function">computeSecret</span><span class="sh_symbol">(</span>alice<span class="sh_symbol">.</span><span class="sh_function">getPublicKey</span><span class="sh_symbol">(),</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_string">'hex'</span><span class="sh_symbol">);</span>

<span class="sh_comment">/* alice_secret and bob_secret should be the same */</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>alice_secret <span class="sh_symbol">==</span> bob_secret<span class="sh_symbol">);</span></code></pre>
<h2>crypto.createECDH(curve_name)<a id="all_crypto_createecdh_curve_name" class="mark" href="#all_crypto_createecdh_curve_name">#</a></h2>
<p>Creates a Elliptic Curve (EC) Diffie-Hellman key exchange object using a predefined curve specified by <code>curve_name</code> string.</p>
<h2>Class: ECDH<a id="all_class_ecdh" class="mark" href="#all_class_ecdh">#</a></h2>
<p>The class for creating EC Diffie-Hellman key exchanges.</p>
<p>Returned by <code>crypto.createECDH</code>.</p>
<h3>ECDH.generateKeys([encoding[, format]])<a id="all_ecdh_generatekeys_encoding_format" class="mark" href="#all_ecdh_generatekeys_encoding_format">#</a></h3>
<p>Generates private and public EC Diffie-Hellman key values, and returns the public key in the specified format and encoding. This key should be transferred to the other party.</p>
<p>Format specifies point encoding and can be <code>'compressed'</code>, <code>'uncompressed'</code>, or <code>'hybrid'</code>. If no format is provided - the point will be returned in <code>'uncompressed'</code> format.</p>
<p>Encoding can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>ECDH.computeSecret(other_public_key[, input_encoding][, output_encoding])<a id="all_ecdh_computesecret_other_public_key_input_encoding_output_encoding" class="mark" href="#all_ecdh_computesecret_other_public_key_input_encoding_output_encoding">#</a></h3>
<p>Computes the shared secret using <code>other_public_key</code> as the other party's public key and returns the computed shared secret. Supplied key is interpreted using specified <code>input_encoding</code>, and secret is encoded using specified <code>output_encoding</code>. Encodings can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If the input encoding is not provided, then a buffer is expected.</p>
<p>If no output encoding is given, then a buffer is returned.</p>
<h3>ECDH.getPublicKey([encoding[, format]])<a id="all_ecdh_getpublickey_encoding_format" class="mark" href="#all_ecdh_getpublickey_encoding_format">#</a></h3>
<p>Returns the EC Diffie-Hellman public key in the specified encoding and format.</p>
<p>Format specifies point encoding and can be <code>'compressed'</code>, <code>'uncompressed'</code>, or <code>'hybrid'</code>. If no format is provided - the point will be returned in <code>'uncompressed'</code> format.</p>
<p>Encoding can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>ECDH.getPrivateKey([encoding])<a id="all_ecdh_getprivatekey_encoding" class="mark" href="#all_ecdh_getprivatekey_encoding">#</a></h3>
<p>Returns the EC Diffie-Hellman private key in the specified encoding, which can be <code>'binary'</code>, <code>'hex'</code>, or <code>'base64'</code>. If no encoding is provided, then a buffer is returned.</p>
<h3>ECDH.setPublicKey(public_key[, encoding])<a id="all_ecdh_setpublickey_public_key_encoding" class="mark" href="#all_ecdh_setpublickey_public_key_encoding">#</a></h3>
<p>Sets the EC Diffie-Hellman public key. Key encoding can be <code>'binary'</code>, <code>'hex'</code> or <code>'base64'</code>. If no encoding is provided, then a buffer is expected.</p>
<h3>ECDH.setPrivateKey(private_key[, encoding])<a id="all_ecdh_setprivatekey_private_key_encoding" class="mark" href="#all_ecdh_setprivatekey_private_key_encoding">#</a></h3>
<p>Sets the EC Diffie-Hellman private key. Key encoding can be <code>'binary'</code>, <code>'hex'</code> or <code>'base64'</code>. If no encoding is provided, then a buffer is expected.</p>
<p>Example (obtaining a shared secret):</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> crypto <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'crypto'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> alice <span class="sh_symbol">=</span> crypto<span class="sh_symbol">.</span><span class="sh_function">createECDH</span><span class="sh_symbol">(</span><span class="sh_string">'secp256k1'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> bob <span class="sh_symbol">=</span> crypto<span class="sh_symbol">.</span><span class="sh_function">createECDH</span><span class="sh_symbol">(</span><span class="sh_string">'secp256k1'</span><span class="sh_symbol">);</span>

alice<span class="sh_symbol">.</span><span class="sh_function">generateKeys</span><span class="sh_symbol">();</span>
bob<span class="sh_symbol">.</span><span class="sh_function">generateKeys</span><span class="sh_symbol">();</span>

<span class="sh_keyword">var</span> alice_secret <span class="sh_symbol">=</span> alice<span class="sh_symbol">.</span><span class="sh_function">computeSecret</span><span class="sh_symbol">(</span>bob<span class="sh_symbol">.</span><span class="sh_function">getPublicKey</span><span class="sh_symbol">(),</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_string">'hex'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> bob_secret <span class="sh_symbol">=</span> bob<span class="sh_symbol">.</span><span class="sh_function">computeSecret</span><span class="sh_symbol">(</span>alice<span class="sh_symbol">.</span><span class="sh_function">getPublicKey</span><span class="sh_symbol">(),</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_string">'hex'</span><span class="sh_symbol">);</span>

<span class="sh_comment">/* alice_secret and bob_secret should be the same */</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>alice_secret <span class="sh_symbol">==</span> bob_secret<span class="sh_symbol">);</span></code></pre>
<h2>crypto.pbkdf2(password, salt, iterations, keylen[, digest], callback)<a id="all_crypto_pbkdf2_password_salt_iterations_keylen_digest_callback" class="mark" href="#all_crypto_pbkdf2_password_salt_iterations_keylen_digest_callback">#</a></h2>
<p>Asynchronous PBKDF2 function. Applies the selected HMAC digest function (default: SHA1) to derive a key of the requested length from the password, salt and number of iterations. The callback gets two arguments: <code>(err, derivedKey)</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>crypto<span class="sh_symbol">.</span><span class="sh_function">pbkdf2</span><span class="sh_symbol">(</span><span class="sh_string">'secret'</span><span class="sh_symbol">,</span> <span class="sh_string">'salt'</span><span class="sh_symbol">,</span> <span class="sh_number">4096</span><span class="sh_symbol">,</span> <span class="sh_number">512</span><span class="sh_symbol">,</span> <span class="sh_string">'sha256'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> key<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span>
    <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>key<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'hex'</span><span class="sh_symbol">));</span>  <span class="sh_comment">// 'c5e478d...1469e50'</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>You can get a list of supported digest functions with <a href="#crypto_crypto_gethashes">crypto.getHashes()</a>.</p>
<h2>crypto.pbkdf2Sync(password, salt, iterations, keylen[, digest])<a id="all_crypto_pbkdf2sync_password_salt_iterations_keylen_digest" class="mark" href="#all_crypto_pbkdf2sync_password_salt_iterations_keylen_digest">#</a></h2>
<p>Synchronous PBKDF2 function. Returns derivedKey or throws error.</p>
<h2>crypto.randomBytes(size[, callback])<a id="all_crypto_randombytes_size_callback" class="mark" href="#all_crypto_randombytes_size_callback">#</a></h2>
<p>Generates cryptographically strong pseudo-random data. Usage:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// async</span>
crypto<span class="sh_symbol">.</span><span class="sh_function">randomBytes</span><span class="sh_symbol">(</span><span class="sh_number">256</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>ex<span class="sh_symbol">,</span> buf<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>ex<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> ex<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Have %d bytes of random data: %s'</span><span class="sh_symbol">,</span> buf<span class="sh_symbol">.</span>length<span class="sh_symbol">,</span> buf<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// sync</span>
<span class="sh_keyword">try</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> buf <span class="sh_symbol">=</span> crypto<span class="sh_symbol">.</span><span class="sh_function">randomBytes</span><span class="sh_symbol">(</span><span class="sh_number">256</span><span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Have %d bytes of random data: %s'</span><span class="sh_symbol">,</span> buf<span class="sh_symbol">.</span>length<span class="sh_symbol">,</span> buf<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>ex<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// handle error</span>
  <span class="sh_comment">// most likely, entropy sources are drained</span>
<span class="sh_cbracket">}</span></code></pre>
<p>NOTE: Will throw error or invoke callback with error, if there is not enough accumulated entropy to generate cryptographically strong data. In other words, <code>crypto.randomBytes</code> without callback will not block even if all entropy sources are drained.</p>
<h2>crypto.pseudoRandomBytes(size[, callback])<a id="all_crypto_pseudorandombytes_size_callback" class="mark" href="#all_crypto_pseudorandombytes_size_callback">#</a></h2>
<p>Generates <em>non</em>-cryptographically strong pseudo-random data. The data returned will be unique if it is sufficiently long, but is not necessarily unpredictable. For this reason, the output of this function should never be used where unpredictability is important, such as in the generation of encryption keys.</p>
<p>Usage is otherwise identical to <code>crypto.randomBytes</code>.</p>
<h2>Class: Certificate<a id="all_class_certificate" class="mark" href="#all_class_certificate">#</a></h2>
<p>The class used for working with signed public key &amp; challenges. The most common usage for this series of functions is when dealing with the <code>&lt;keygen&gt;</code> element. <a href="http://www.openssl.org/docs/apps/spkac.html">http://www.openssl.org/docs/apps/spkac.html</a></p>
<p>Returned by <code>crypto.Certificate</code>.</p>
<h3>Certificate.verifySpkac(spkac)<a id="all_certificate_verifyspkac_spkac" class="mark" href="#all_certificate_verifyspkac_spkac">#</a></h3>
<p>Returns true of false based on the validity of the SPKAC.</p>
<h3>Certificate.exportChallenge(spkac)<a id="all_certificate_exportchallenge_spkac" class="mark" href="#all_certificate_exportchallenge_spkac">#</a></h3>
<p>Exports the encoded public key from the supplied SPKAC.</p>
<h3>Certificate.exportPublicKey(spkac)<a id="all_certificate_exportpublickey_spkac" class="mark" href="#all_certificate_exportpublickey_spkac">#</a></h3>
<p>Exports the encoded challenge associated with the SPKAC.</p>
<h2>crypto.publicEncrypt(public_key, buffer)<a id="all_crypto_publicencrypt_public_key_buffer" class="mark" href="#all_crypto_publicencrypt_public_key_buffer">#</a></h2>
<p>Encrypts <code>buffer</code> with <code>public_key</code>. Only RSA is currently supported.</p>
<p><code>public_key</code> can be an object or a string. If <code>public_key</code> is a string, it is treated as the key with no passphrase and will use <code>RSA_PKCS1_OAEP_PADDING</code>.</p>
<p><code>public_key</code>:</p>
<ul>
<li><code>key</code> : A string holding the PEM encoded private key</li>
<li><code>padding</code> : An optional padding value, one of the following:
<ul>
<li><code>constants.RSA_NO_PADDING</code></li>
<li><code>constants.RSA_PKCS1_PADDING</code></li>
<li><code>constants.RSA_PKCS1_OAEP_PADDING</code></li>
</ul>
</li>
</ul>
<p>NOTE: All paddings are defined in <code>constants</code> module.</p>
<h2>crypto.privateDecrypt(private_key, buffer)<a id="all_crypto_privatedecrypt_private_key_buffer" class="mark" href="#all_crypto_privatedecrypt_private_key_buffer">#</a></h2>
<p>Decrypts <code>buffer</code> with <code>private_key</code>.</p>
<p><code>private_key</code> can be an object or a string. If <code>private_key</code> is a string, it is treated as the key with no passphrase and will use <code>RSA_PKCS1_OAEP_PADDING</code>.</p>
<p><code>private_key</code>:</p>
<ul>
<li><code>key</code> : A string holding the PEM encoded private key</li>
<li><code>passphrase</code> : An optional string of passphrase for the private key</li>
<li><code>padding</code> : An optional padding value, one of the following:
<ul>
<li><code>constants.RSA_NO_PADDING</code></li>
<li><code>constants.RSA_PKCS1_PADDING</code></li>
<li><code>constants.RSA_PKCS1_OAEP_PADDING</code></li>
</ul>
</li>
</ul>
<p>NOTE: All paddings are defined in <code>constants</code> module.</p>
<h2>crypto.DEFAULT_ENCODING<a id="all_crypto_default_encoding" class="mark" href="#all_crypto_default_encoding">#</a></h2>
<p>The default encoding to use for functions that can take either strings or buffers. The default value is <code>'buffer'</code>, which makes it default to using Buffer objects. This is here to make the crypto module more easily compatible with legacy programs that expected <code>'binary'</code> to be the default encoding.</p>
<p>Note that new programs will probably expect buffers, so only use this as a temporary measure.</p>
<h2>Recent API Changes<a id="all_recent_api_changes" class="mark" href="#all_recent_api_changes">#</a></h2>
<p>The Crypto module was added to Node before there was the concept of a unified Stream API, and before there were Buffer objects for handling binary data.</p>
<p>As such, the streaming classes don't have the typical methods found on other Node classes, and many methods accepted and returned Binary-encoded strings by default rather than Buffers. This was changed to use Buffers by default instead.</p>
<p>This is a breaking change for some use cases, but not all.</p>
<p>For example, if you currently use the default arguments to the Sign class, and then pass the results to the Verify class, without ever inspecting the data, then it will continue to work as before. Where you once got a binary string and then presented the binary string to the Verify object, you'll now get a Buffer, and present the Buffer to the Verify object.</p>
<p>However, if you were doing things with the string data that will not work properly on Buffers (such as, concatenating them, storing in databases, etc.), or you are passing binary strings to the crypto functions without an encoding argument, then you will need to start providing encoding arguments to specify which encoding you'd like to use. To switch to the previous style of using binary strings by default, set the <code>crypto.DEFAULT_ENCODING</code> field to 'binary'. Note that new programs will probably expect buffers, so only use this as a temporary measure.</p>
<h1>TLS (SSL)<a id="all_tls_ssl" class="mark" href="#all_tls_ssl">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>Use <code>require('tls')</code> to access this module.</p>
<p>The <code>tls</code> module uses OpenSSL to provide Transport Layer Security and/or Secure Socket Layer: encrypted stream communication.</p>
<p>TLS/SSL is a public/private key infrastructure. Each client and each server must have a private key. A private key is created like this:</p>
<pre class="sh_sourceCode"><code>openssl genrsa <span class="sh_symbol">-</span>out ryans<span class="sh_symbol">-</span>key<span class="sh_symbol">.</span>pem <span class="sh_number">2048</span></code></pre>
<p>All servers and some clients need to have a certificate. Certificates are public keys signed by a Certificate Authority or self-signed. The first step to getting a certificate is to create a "Certificate Signing Request" (CSR) file. This is done with:</p>
<pre class="sh_sourceCode"><code>openssl req <span class="sh_symbol">-</span><span class="sh_keyword">new</span> <span class="sh_symbol">-</span>sha256 <span class="sh_symbol">-</span>key ryans<span class="sh_symbol">-</span>key<span class="sh_symbol">.</span>pem <span class="sh_symbol">-</span>out ryans<span class="sh_symbol">-</span>csr<span class="sh_symbol">.</span>pem</code></pre>
<p>To create a self-signed certificate with the CSR, do this:</p>
<pre class="sh_sourceCode"><code>openssl x509 <span class="sh_symbol">-</span>req <span class="sh_symbol">-</span><span class="sh_keyword">in</span> ryans<span class="sh_symbol">-</span>csr<span class="sh_symbol">.</span>pem <span class="sh_symbol">-</span>signkey ryans<span class="sh_symbol">-</span>key<span class="sh_symbol">.</span>pem <span class="sh_symbol">-</span>out ryans<span class="sh_symbol">-</span>cert<span class="sh_symbol">.</span>pem</code></pre>
<p>Alternatively you can send the CSR to a Certificate Authority for signing.</p>
<p>(TODO: docs on creating a CA, for now interested users should just look at <code>test/fixtures/keys/Makefile</code> in the Node source code)</p>
<p>To create .pfx or .p12, do this:</p>
<pre class="sh_sourceCode"><code>openssl pkcs12 <span class="sh_symbol">-</span><span class="sh_keyword">export</span> <span class="sh_symbol">-</span><span class="sh_keyword">in</span> agent5<span class="sh_symbol">-</span>cert<span class="sh_symbol">.</span>pem <span class="sh_symbol">-</span>inkey agent5<span class="sh_symbol">-</span>key<span class="sh_symbol">.</span>pem <span class="sh_symbol">\</span>
    <span class="sh_symbol">-</span>certfile ca<span class="sh_symbol">-</span>cert<span class="sh_symbol">.</span>pem <span class="sh_symbol">-</span>out agent5<span class="sh_symbol">.</span>pfx</code></pre>
<ul>
<li><code>in</code>: certificate</li>
<li><code>inkey</code>: private key</li>
<li><code>certfile</code>: all CA certs concatenated in one file like <code>cat ca1-cert.pem ca2-cert.pem &gt; ca-cert.pem</code></li>
</ul>
<h2>Protocol support<a id="all_protocol_support" class="mark" href="#all_protocol_support">#</a></h2>
<p>Node.js is compiled with SSLv2 and SSLv3 protocol support by default, but these protocols are <strong>disabled</strong>. They are considered insecure and could be easily compromised as was shown by <a href="https://access.redhat.com/articles/1232123">CVE-2014-3566</a>. However, in some situations, it may cause problems with legacy clients/servers (such as Internet Explorer 6). If you wish to enable SSLv2 or SSLv3, run node with the <code>--enable-ssl2</code> or <code>--enable-ssl3</code> flag respectively. In future versions of Node.js SSLv2 and SSLv3 will not be compiled in by default.</p>
<p>There is a way to force node into using SSLv3 or SSLv2 only mode by explicitly specifying <code>secureProtocol</code> to <code>'SSLv3_method'</code> or <code>'SSLv2_method'</code>.</p>
<p>The default protocol method Node.js uses is <code>SSLv23_method</code> which would be more accurately named <code>AutoNegotiate_method</code>. This method will try and negotiate from the highest level down to whatever the client supports. To provide a secure default, Node.js (since v0.10.33) explicitly disables the use of SSLv3 and SSLv2 by setting the <code>secureOptions</code> to be <code>SSL_OP_NO_SSLv3|SSL_OP_NO_SSLv2</code> (again, unless you have passed <code>--enable-ssl3</code>, or <code>--enable-ssl2</code>, or <code>SSLv3_method</code> as <code>secureProtocol</code>).</p>
<p>If you have set <code>secureOptions</code> to anything, we will not override your options.</p>
<p>The ramifications of this behavior change:</p>
<ul>
<li>If your application is behaving as a secure server, clients who are <code>SSLv3</code> only will now not be able to appropriately negotiate a connection and will be refused. In this case your server will emit a <code>clientError</code> event. The error message will include <code>'wrong version number'</code>.</li>
<li>If your application is behaving as a secure client and communicating with a server that doesn't support methods more secure than SSLv3 then your connection won't be able to negotiate and will fail. In this case your client will emit a an <code>error</code> event. The error message will include <code>'wrong version number'</code>.</li>
</ul>
<h2>Client-initiated renegotiation attack mitigation<a id="all_client_initiated_renegotiation_attack_mitigation" class="mark" href="#all_client_initiated_renegotiation_attack_mitigation">#</a></h2>
<p>The TLS protocol lets the client renegotiate certain aspects of the TLS session. Unfortunately, session renegotiation requires a disproportional amount of server-side resources, which makes it a potential vector for denial-of-service attacks.</p>
<p>To mitigate this, renegotiations are limited to three times every 10 minutes. An error is emitted on the <a href="#tls_class_tls_tlssocket">tls.TLSSocket</a> instance when the threshold is exceeded. The limits are configurable:</p>
<ul>
<li>
<p><code>tls.CLIENT_RENEG_LIMIT</code>: renegotiation limit, default is 3.</p>
</li>
<li>
<p><code>tls.CLIENT_RENEG_WINDOW</code>: renegotiation window in seconds, default is 10 minutes.</p>
</li>
</ul>
<p>Don't change the defaults unless you know what you are doing.</p>
<p>To test your server, connect to it with <code>openssl s_client -connect address:port</code> and tap <code>R&lt;CR&gt;</code> (that's the letter <code>R</code> followed by a carriage return) a few times.</p>
<h2>NPN and SNI<a id="all_npn_and_sni" class="mark" href="#all_npn_and_sni">#</a></h2>
<p>NPN (Next Protocol Negotiation) and SNI (Server Name Indication) are TLS handshake extensions allowing you:</p>
<ul>
<li>NPN - to use one TLS server for multiple protocols (HTTP, SPDY)</li>
<li>SNI - to use one TLS server for multiple hostnames with different SSL certificates.</li>
</ul>
<h2>Perfect Forward Secrecy<a id="all_perfect_forward_secrecy" class="mark" href="#all_perfect_forward_secrecy">#</a></h2>
<p>The term "<a href="http://en.wikipedia.org/wiki/Perfect_forward_secrecy">Forward Secrecy</a>" or "Perfect Forward Secrecy" describes a feature of key-agreement (i.e. key-exchange) methods. Practically it means that even if the private key of a (your) server is compromised, communication can only be decrypted by eavesdroppers if they manage to obtain the key-pair specifically generated for each session.</p>
<p>This is achieved by randomly generating a key pair for key-agreement on every handshake (in contrary to the same key for all sessions). Methods implementing this technique, thus offering Perfect Forward Secrecy, are called "ephemeral".</p>
<p>Currently two methods are commonly used to achieve Perfect Forward Secrecy (note the character "E" appended to the traditional abbreviations):</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange">DHE</a> - An ephemeral version of the Diffie Hellman key-agreement protocol.</li>
<li><a href="https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman">ECDHE</a> - An ephemeral version of the Elliptic Curve Diffie Hellman key-agreement protocol.</li>
</ul>
<p>Ephemeral methods may have some performance drawbacks, because key generation is expensive.</p>
<h2>tls.getCiphers()<a id="all_tls_getciphers" class="mark" href="#all_tls_getciphers">#</a></h2>
<p>Returns an array with the names of the supported SSL ciphers.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> ciphers <span class="sh_symbol">=</span> tls<span class="sh_symbol">.</span><span class="sh_function">getCiphers</span><span class="sh_symbol">();</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>ciphers<span class="sh_symbol">);</span> <span class="sh_comment">// ['AES128-SHA', 'AES256-SHA', ...]</span></code></pre>
<h2>tls.createServer(options[, secureConnectionListener])<a id="all_tls_createserver_options_secureconnectionlistener" class="mark" href="#all_tls_createserver_options_secureconnectionlistener">#</a></h2>
<p>Creates a new <a href="#tls_class_tls_server">tls.Server</a>. The <code>connectionListener</code> argument is automatically set as a listener for the <a href="#tls_event_secureconnection">secureConnection</a> event. The <code>options</code> object has these possibilities:</p>
<ul>
<li>
<p><code>pfx</code>: A string or <code>Buffer</code> containing the private key, certificate and CA certs of the server in PFX or PKCS12 format. (Mutually exclusive with the <code>key</code>, <code>cert</code> and <code>ca</code> options.)</p>
</li>
<li>
<p><code>key</code>: A string or <code>Buffer</code> containing the private key of the server in PEM format. (Could be an array of keys). (Required)</p>
</li>
<li>
<p><code>passphrase</code>: A string of passphrase for the private key or pfx.</p>
</li>
<li>
<p><code>cert</code>: A string or <code>Buffer</code> containing the certificate key of the server in PEM format. (Could be an array of certs). (Required)</p>
</li>
<li>
<p><code>ca</code>: An array of strings or <code>Buffer</code>s of trusted certificates in PEM format. If this is omitted several well known "root" CAs will be used, like VeriSign. These are used to authorize connections.</p>
</li>
<li>
<p><code>crl</code> : Either a string or list of strings of PEM encoded CRLs (Certificate Revocation List)</p>
</li>
<li>
<p><code>ciphers</code>: A string describing the ciphers to use or exclude.</p>
<p>To mitigate <a href="http://blog.ivanristic.com/2011/10/mitigating-the-beast-attack-on-tls.html">BEAST attacks</a> it is recommended that you use this option in conjunction with the <code>honorCipherOrder</code> option described below to prioritize the non-CBC cipher.</p>
<p>Defaults to <code>ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:AES128-GCM-SHA256:RC4:HIGH:!MD5:!aNULL</code>. Consult the <a href="http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT">OpenSSL cipher list format documentation</a> for details on the format.</p>
<p><code>ECDHE-RSA-AES128-SHA256</code>, <code>DHE-RSA-AES128-SHA256</code> and <code>AES128-GCM-SHA256</code> are TLS v1.2 ciphers and used when Node.js is linked against OpenSSL 1.0.1 or newer, such as the bundled version of OpenSSL. Note that it is still possible for a TLS v1.2 client to negotiate a weaker cipher unless <code>honorCipherOrder</code> is enabled.</p>
<p><code>RC4</code> is used as a fallback for clients that speak on older version of the TLS protocol. <code>RC4</code> has in recent years come under suspicion and should be considered compromised for anything that is truly sensitive. It is speculated that state-level actors possess the ability to break it.</p>
<p><strong>NOTE</strong>: Previous revisions of this section suggested <code>AES256-SHA</code> as an acceptable cipher. Unfortunately, <code>AES256-SHA</code> is a CBC cipher and therefore susceptible to <a href="http://blog.ivanristic.com/2011/10/mitigating-the-beast-attack-on-tls.html">BEAST attacks</a>. Do <em>not</em> use it.</p>
</li>
<li>
<p><code>ecdhCurve</code>: A string describing a named curve to use for ECDH key agreement or false to disable ECDH.</p>
<p>Defaults to <code>prime256v1</code>. Consult <a href="http://www.rfc-editor.org/rfc/rfc4492.txt">RFC 4492</a> for more details.</p>
</li>
<li>
<p><code>dhparam</code>: DH parameter file to use for DHE key agreement. Use <code>openssl dhparam</code> command to create it. If the file is invalid to load, it is silently discarded.</p>
</li>
<li>
<p><code>handshakeTimeout</code>: Abort the connection if the SSL/TLS handshake does not finish in this many milliseconds. The default is 120 seconds.</p>
<p>A <code>'clientError'</code> is emitted on the <code>tls.Server</code> object whenever a handshake times out.</p>
</li>
<li>
<p><code>honorCipherOrder</code> : When choosing a cipher, use the server's preferences instead of the client preferences.</p>
<p>Although, this option is disabled by default, it is <em>recommended</em> that you use this option in conjunction with the <code>ciphers</code> option to mitigate BEAST attacks.</p>
<p>Note: If SSLv2 is used, the server will send its list of preferences to the client, and the client chooses the cipher. Support for SSLv2 is disabled unless node.js was configured with <code>./configure --with-sslv2</code>.</p>
</li>
<li>
<p><code>requestCert</code>: If <code>true</code> the server will request a certificate from clients that connect and attempt to verify that certificate. Default: <code>false</code>.</p>
</li>
<li>
<p><code>rejectUnauthorized</code>: If <code>true</code> the server will reject any connection which is not authorized with the list of supplied CAs. This option only has an effect if <code>requestCert</code> is <code>true</code>. Default: <code>false</code>.</p>
</li>
<li>
<p><code>checkServerIdentity(servername, cert)</code>: Provide an override for checking server's hostname against the certificate. Should return an error if verification fails. Return <code>undefined</code> if passing.</p>
</li>
<li>
<p><code>NPNProtocols</code>: An array or <code>Buffer</code> of possible NPN protocols. (Protocols should be ordered by their priority).</p>
</li>
<li>
<p><code>SNICallback(servername, cb)</code>: A function that will be called if client supports SNI TLS extension. Two argument will be passed to it: <code>servername</code>, and <code>cb</code>. <code>SNICallback</code> should invoke <code>cb(null, ctx)</code>, where <code>ctx</code> is a SecureContext instance. (You can use <code>tls.createSecureContext(...)</code> to get proper SecureContext). If <code>SNICallback</code> wasn't provided - default callback with high-level API will be used (see below).</p>
</li>
<li>
<p><code>sessionTimeout</code>: An integer specifying the seconds after which TLS session identifiers and TLS session tickets created by the server are timed out. See <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_timeout.html">SSL_CTX_set_timeout</a> for more details.</p>
</li>
<li>
<p><code>ticketKeys</code>: A 48-byte <code>Buffer</code> instance consisting of 16-byte prefix, 16-byte hmac key, 16-byte AES key. You could use it to accept tls session tickets on multiple instances of tls server.</p>
<p>NOTE: Automatically shared between <code>cluster</code> module workers.</p>
</li>
<li>
<p><code>sessionIdContext</code>: A string containing an opaque identifier for session resumption. If <code>requestCert</code> is <code>true</code>, the default is MD5 hash value generated from command-line. Otherwise, the default is not provided.</p>
</li>
<li>
<p><code>secureProtocol</code>: The SSL method to use, e.g. <code>SSLv3_method</code> to force SSL version 3. The possible values depend on your installation of OpenSSL and are defined in the constant <a href="http://www.openssl.org/docs/ssl/ssl.html#DEALING_WITH_PROTOCOL_METHODS">SSL_METHODS</a>.</p>
</li>
<li>
<p><code>secureOptions</code>: Set server options. For example, to disable the SSLv3 protocol set the <code>SSL_OP_NO_SSLv3</code> flag. See <a href="https://www.openssl.org/docs/ssl/SSL_CTX_set_options.html">SSL_CTX_set_options</a> for all available options.</p>
</li>
</ul>
<p>Here is a simple example echo server:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> tls <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'tls'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  key<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'server-key.pem'</span><span class="sh_symbol">),</span>
  cert<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'server-cert.pem'</span><span class="sh_symbol">),</span>

  <span class="sh_comment">// This is necessary only if using the client certificate authentication.</span>
  requestCert<span class="sh_symbol">:</span> <span class="sh_keyword">true</span><span class="sh_symbol">,</span>

  <span class="sh_comment">// This is necessary only if the client uses the self-signed certificate.</span>
  ca<span class="sh_symbol">:</span> <span class="sh_symbol">[</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'client-cert.pem'</span><span class="sh_symbol">)</span> <span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> tls<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'server connected'</span><span class="sh_symbol">,</span>
              socket<span class="sh_symbol">.</span>authorized <span class="sh_symbol">?</span> <span class="sh_string">'authorized'</span> <span class="sh_symbol">:</span> <span class="sh_string">'unauthorized'</span><span class="sh_symbol">);</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">"welcome!</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">);</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">setEncoding</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'server bound'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Or</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> tls <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'tls'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  pfx<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'server.pfx'</span><span class="sh_symbol">),</span>

  <span class="sh_comment">// This is necessary only if using the client certificate authentication.</span>
  requestCert<span class="sh_symbol">:</span> <span class="sh_keyword">true</span><span class="sh_symbol">,</span>

<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> tls<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'server connected'</span><span class="sh_symbol">,</span>
              socket<span class="sh_symbol">.</span>authorized <span class="sh_symbol">?</span> <span class="sh_string">'authorized'</span> <span class="sh_symbol">:</span> <span class="sh_string">'unauthorized'</span><span class="sh_symbol">);</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">"welcome!</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">);</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">setEncoding</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'server bound'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>You can test this server by connecting to it with <code>openssl s_client</code>:</p>
<pre class="sh_sourceCode"><code>openssl s_client <span class="sh_symbol">-</span>connect <span class="sh_number">127.0.0.1</span><span class="sh_symbol">:</span><span class="sh_number">8000</span></code></pre>
<h2>tls.connect(options[, callback])<a id="all_tls_connect_options_callback" class="mark" href="#all_tls_connect_options_callback">#</a></h2>
<h2>tls.connect(port[, host][, options][, callback])<a id="all_tls_connect_port_host_options_callback" class="mark" href="#all_tls_connect_port_host_options_callback">#</a></h2>
<p>Creates a new client connection to the given <code>port</code> and <code>host</code> (old API) or <code>options.port</code> and <code>options.host</code>. (If <code>host</code> is omitted, it defaults to <code>localhost</code>.) <code>options</code> should be an object which specifies:</p>
<ul>
<li>
<p><code>host</code>: Host the client should connect to</p>
</li>
<li>
<p><code>port</code>: Port the client should connect to</p>
</li>
<li>
<p><code>socket</code>: Establish secure connection on a given socket rather than creating a new socket. If this option is specified, <code>host</code> and <code>port</code> are ignored.</p>
</li>
<li>
<p><code>path</code>: Creates unix socket connection to path. If this option is specified, <code>host</code> and <code>port</code> are ignored.</p>
</li>
<li>
<p><code>ciphers</code>: A string describing the ciphers to use or exclude.</p>
<p>Defaults to <code>ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:AES128-GCM-SHA256:HIGH:!RC4:!MD5:!aNULL</code>. Consult the <a href="http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT">OpenSSL cipher list format documentation</a> for details on the format.</p>
<p>The full list of available ciphers can be obtained via <a href="#tls_tls_getciphers">tls.getCiphers</a>.</p>
<p><code>ECDHE-RSA-AES128-SHA256</code>, <code>DHE-RSA-AES128-SHA256</code> and <code>AES128-GCM-SHA256</code> are TLS v1.2 ciphers and used when Node.js is linked against OpenSSL 1.0.1 or newer, such as the bundled version of OpenSSL.</p>
</li>
<li>
<p><code>pfx</code>: A string or <code>Buffer</code> containing the private key, certificate and CA certs of the client in PFX or PKCS12 format.</p>
</li>
<li>
<p><code>key</code>: A string or <code>Buffer</code> containing the private key of the client in PEM format. (Could be an array of keys).</p>
</li>
<li>
<p><code>passphrase</code>: A string of passphrase for the private key or pfx.</p>
</li>
<li>
<p><code>cert</code>: A string or <code>Buffer</code> containing the certificate key of the client in PEM format. (Could be an array of certs).</p>
</li>
<li>
<p><code>ca</code>: An array of strings or <code>Buffer</code>s of trusted certificates in PEM format. If this is omitted several well known "root" CAs will be used, like VeriSign. These are used to authorize connections.</p>
</li>
<li>
<p><code>rejectUnauthorized</code>: If <code>true</code>, the server certificate is verified against the list of supplied CAs. An <code>'error'</code> event is emitted if verification fails; <code>err.code</code> contains the OpenSSL error code. Default: <code>true</code>.</p>
</li>
<li>
<p><code>NPNProtocols</code>: An array of strings or <code>Buffer</code>s containing supported NPN protocols. <code>Buffer</code>s should have following format: <code>0x05hello0x05world</code>, where first byte is next protocol name's length. (Passing array should usually be much simpler: <code>['hello', 'world']</code>.)</p>
</li>
<li>
<p><code>servername</code>: Servername for SNI (Server Name Indication) TLS extension.</p>
</li>
<li>
<p><code>secureProtocol</code>: The SSL method to use, e.g. <code>SSLv3_method</code> to force SSL version 3. The possible values depend on your installation of OpenSSL and are defined in the constant <a href="http://www.openssl.org/docs/ssl/ssl.html#DEALING_WITH_PROTOCOL_METHODS">SSL_METHODS</a>.</p>
</li>
<li>
<p><code>session</code>: A <code>Buffer</code> instance, containing TLS session.</p>
</li>
</ul>
<p>The <code>callback</code> parameter will be added as a listener for the <a href="#tls_event_secureconnect">'secureConnect'</a> event.</p>
<p><code>tls.connect()</code> returns a <a href="#tls_class_tls_tlssocket">tls.TLSSocket</a> object.</p>
<p>Here is an example of a client of echo server as described previously:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> tls <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'tls'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// These are necessary only if using the client certificate authentication</span>
  key<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'client-key.pem'</span><span class="sh_symbol">),</span>
  cert<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'client-cert.pem'</span><span class="sh_symbol">),</span>

  <span class="sh_comment">// This is necessary only if the server uses the self-signed certificate</span>
  ca<span class="sh_symbol">:</span> <span class="sh_symbol">[</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'server-cert.pem'</span><span class="sh_symbol">)</span> <span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> socket <span class="sh_symbol">=</span> tls<span class="sh_symbol">.</span><span class="sh_function">connect</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">,</span> options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'client connected'</span><span class="sh_symbol">,</span>
              socket<span class="sh_symbol">.</span>authorized <span class="sh_symbol">?</span> <span class="sh_string">'authorized'</span> <span class="sh_symbol">:</span> <span class="sh_string">'unauthorized'</span><span class="sh_symbol">);</span>
  process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">);</span>
  process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">resume</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
socket<span class="sh_symbol">.</span><span class="sh_function">setEncoding</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  server<span class="sh_symbol">.</span><span class="sh_function">close</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Or</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> tls <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'tls'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  pfx<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'client.pfx'</span><span class="sh_symbol">)</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> socket <span class="sh_symbol">=</span> tls<span class="sh_symbol">.</span><span class="sh_function">connect</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">,</span> options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'client connected'</span><span class="sh_symbol">,</span>
              socket<span class="sh_symbol">.</span>authorized <span class="sh_symbol">?</span> <span class="sh_string">'authorized'</span> <span class="sh_symbol">:</span> <span class="sh_string">'unauthorized'</span><span class="sh_symbol">);</span>
  process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">);</span>
  process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">resume</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
socket<span class="sh_symbol">.</span><span class="sh_function">setEncoding</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  server<span class="sh_symbol">.</span><span class="sh_function">close</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Class: tls.TLSSocket<a id="all_class_tls_tlssocket" class="mark" href="#all_class_tls_tlssocket">#</a></h2>
<p>Wrapper for instance of <a href="https://nodejs.org/api/net.html#net_class_net_socket">net.Socket</a>, replaces internal socket read/write routines to perform transparent encryption/decryption of incoming/outgoing data.</p>
<h2>new tls.TLSSocket(socket, options)<a id="all_new_tls_tlssocket_socket_options" class="mark" href="#all_new_tls_tlssocket_socket_options">#</a></h2>
<p>Construct a new TLSSocket object from existing TCP socket.</p>
<p><code>socket</code> is an instance of <a href="https://nodejs.org/api/net.html#net_class_net_socket">net.Socket</a></p>
<p><code>options</code> is an object that might contain following properties:</p>
<ul>
<li>
<p><code>secureContext</code>: An optional TLS context object from <code>tls.createSecureContext( ... )</code></p>
</li>
<li>
<p><code>isServer</code>: If true - TLS socket will be instantiated in server-mode</p>
</li>
<li>
<p><code>server</code>: An optional <a href="https://nodejs.org/api/net.html#net_class_net_server">net.Server</a> instance</p>
</li>
<li>
<p><code>requestCert</code>: Optional, see <a href="#tls_tls_createsecurepair_credentials_isserver_requestcert_rejectunauthorized">tls.createSecurePair</a></p>
</li>
<li>
<p><code>rejectUnauthorized</code>: Optional, see <a href="#tls_tls_createsecurepair_credentials_isserver_requestcert_rejectunauthorized">tls.createSecurePair</a></p>
</li>
<li>
<p><code>NPNProtocols</code>: Optional, see <a href="#tls_tls_createserver_options_secureconnectionlistener">tls.createServer</a></p>
</li>
<li>
<p><code>SNICallback</code>: Optional, see <a href="#tls_tls_createserver_options_secureconnectionlistener">tls.createServer</a></p>
</li>
<li>
<p><code>session</code>: Optional, a <code>Buffer</code> instance, containing TLS session</p>
</li>
<li>
<p><code>requestOCSP</code>: Optional, if <code>true</code> - OCSP status request extension would be added to client hello, and <code>OCSPResponse</code> event will be emitted on socket before establishing secure communication</p>
</li>
</ul>
<h2>tls.createSecureContext(details)<a id="all_tls_createsecurecontext_details" class="mark" href="#all_tls_createsecurecontext_details">#</a></h2>
<p>Creates a credentials object, with the optional details being a dictionary with keys:</p>
<ul>
<li><code>pfx</code> : A string or buffer holding the PFX or PKCS12 encoded private key, certificate and CA certificates</li>
<li><code>key</code> : A string holding the PEM encoded private key</li>
<li><code>passphrase</code> : A string of passphrase for the private key or pfx</li>
<li><code>cert</code> : A string holding the PEM encoded certificate</li>
<li><code>ca</code> : Either a string or list of strings of PEM encoded CA certificates to trust.</li>
<li><code>crl</code> : Either a string or list of strings of PEM encoded CRLs (Certificate Revocation List)</li>
<li><code>ciphers</code>: A string describing the ciphers to use or exclude. Consult <a href="http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT">http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT</a> for details on the format.</li>
<li><code>honorCipherOrder</code> : When choosing a cipher, use the server's preferences instead of the client preferences. For further details see <code>tls</code> module documentation.</li>
</ul>
<p>If no 'ca' details are given, then node.js will use the default publicly trusted list of CAs as given in</p>
<p><a href="http://mxr.mozilla.org/mozilla/source/security/nss/lib/ckfw/builtins/certdata.txt">http://mxr.mozilla.org/mozilla/source/security/nss/lib/ckfw/builtins/certdata.txt</a>.</p>
<h2>tls.createSecurePair([context][, isServer][, requestCert][, rejectUnauthorized])<a id="all_tls_createsecurepair_context_isserver_requestcert_rejectunauthorized" class="mark" href="#all_tls_createsecurepair_context_isserver_requestcert_rejectunauthorized">#</a></h2>
<p>Creates a new secure pair object with two streams, one of which reads/writes encrypted data, and one reads/writes cleartext data. Generally the encrypted one is piped to/from an incoming encrypted data stream, and the cleartext one is used as a replacement for the initial encrypted stream.</p>
<ul>
<li>
<p><code>credentials</code>: A secure context object from tls.createSecureContext( ... )</p>
</li>
<li>
<p><code>isServer</code>: A boolean indicating whether this tls connection should be opened as a server or a client.</p>
</li>
<li>
<p><code>requestCert</code>: A boolean indicating whether a server should request a certificate from a connecting client. Only applies to server connections.</p>
</li>
<li>
<p><code>rejectUnauthorized</code>: A boolean indicating whether a server should automatically reject clients with invalid certificates. Only applies to servers with <code>requestCert</code> enabled.</p>
</li>
</ul>
<p><code>tls.createSecurePair()</code> returns a SecurePair object with <code>cleartext</code> and <code>encrypted</code> stream properties.</p>
<p>NOTE: <code>cleartext</code> has the same APIs as <a href="#tls_class_tls_tlssocket">tls.TLSSocket</a></p>
<h2>Class: SecurePair<a id="all_class_securepair" class="mark" href="#all_class_securepair">#</a></h2>
<p>Returned by tls.createSecurePair.</p>
<h3>Event: 'secure'<a id="all_event_secure" class="mark" href="#all_event_secure">#</a></h3>
<p>The event is emitted from the SecurePair once the pair has successfully established a secure connection.</p>
<p>Similarly to the checking for the server 'secureConnection' event, pair.cleartext.authorized should be checked to confirm whether the certificate used properly authorized.</p>
<h2>Class: tls.Server<a id="all_class_tls_server" class="mark" href="#all_class_tls_server">#</a></h2>
<p>This class is a subclass of <code>net.Server</code> and has the same methods on it. Instead of accepting just raw TCP connections, this accepts encrypted connections using TLS or SSL.</p>
<h3>Event: 'secureConnection'<a id="all_event_secureconnection" class="mark" href="#all_event_secureconnection">#</a></h3>
<p><code>function (tlsSocket) {}</code></p>
<p>This event is emitted after a new connection has been successfully handshaked. The argument is an instance of <a href="#tls_class_tls_tlssocket">tls.TLSSocket</a>. It has all the common stream methods and events.</p>
<p><code>socket.authorized</code> is a boolean value which indicates if the client has verified by one of the supplied certificate authorities for the server. If <code>socket.authorized</code> is false, then <code>socket.authorizationError</code> is set to describe how authorization failed. Implied but worth mentioning: depending on the settings of the TLS server, you unauthorized connections may be accepted. <code>socket.npnProtocol</code> is a string containing selected NPN protocol. <code>socket.servername</code> is a string containing servername requested with SNI.</p>
<h3>Event: 'clientError'<a id="all_event_clienterror" class="mark" href="#all_event_clienterror">#</a></h3>
<p><code>function (exception, tlsSocket) { }</code></p>
<p>When a client connection emits an 'error' event before secure connection is established - it will be forwarded here.</p>
<p><code>tlsSocket</code> is the <a href="#tls_class_tls_tlssocket">tls.TLSSocket</a> that the error originated from.</p>
<h3>Event: 'newSession'<a id="all_event_newsession" class="mark" href="#all_event_newsession">#</a></h3>
<p><code>function (sessionId, sessionData, callback) { }</code></p>
<p>Emitted on creation of TLS session. May be used to store sessions in external storage. <code>callback</code> must be invoked eventually, otherwise no data will be sent or received from secure connection.</p>
<p>NOTE: adding this event listener will have an effect only on connections established after addition of event listener.</p>
<h3>Event: 'resumeSession'<a id="all_event_resumesession" class="mark" href="#all_event_resumesession">#</a></h3>
<p><code>function (sessionId, callback) { }</code></p>
<p>Emitted when client wants to resume previous TLS session. Event listener may perform lookup in external storage using given <code>sessionId</code>, and invoke <code>callback(null, sessionData)</code> once finished. If session can't be resumed (i.e. doesn't exist in storage) one may call <code>callback(null, null)</code>. Calling <code>callback(err)</code> will terminate incoming connection and destroy socket.</p>
<p>NOTE: adding this event listener will have an effect only on connections established after addition of event listener.</p>
<h3>Event: 'OCSPRequest'<a id="all_event_ocsprequest" class="mark" href="#all_event_ocsprequest">#</a></h3>
<p><code>function (certificate, issuer, callback) { }</code></p>
<p>Emitted when the client sends a certificate status request. You could parse server's current certificate to obtain OCSP url and certificate id, and after obtaining OCSP response invoke <code>callback(null, resp)</code>, where <code>resp</code> is a <code>Buffer</code> instance. Both <code>certificate</code> and <code>issuer</code> are a <code>Buffer</code> DER-representations of the primary and issuer's certificates. They could be used to obtain OCSP certificate id and OCSP endpoint url.</p>
<p>Alternatively, <code>callback(null, null)</code> could be called, meaning that there is no OCSP response.</p>
<p>Calling <code>callback(err)</code> will result in a <code>socket.destroy(err)</code> call.</p>
<p>Typical flow:</p>
<ol>
<li>Client connects to server and sends <code>OCSPRequest</code> to it (via status info extension in ClientHello.)</li>
<li>Server receives request and invokes <code>OCSPRequest</code> event listener if present</li>
<li>Server grabs OCSP url from either <code>certificate</code> or <code>issuer</code> and performs an <a href="http://en.wikipedia.org/wiki/OCSP_stapling">OCSP request</a> to the CA</li>
<li>Server receives <code>OCSPResponse</code> from CA and sends it back to client via <code>callback</code> argument</li>
<li>Client validates the response and either destroys socket or performs a handshake.</li>
</ol>
<p>NOTE: <code>issuer</code> could be null, if the certificate is self-signed or if the issuer is not in the root certificates list. (You could provide an issuer via <code>ca</code> option.)</p>
<p>NOTE: adding this event listener will have an effect only on connections established after addition of event listener.</p>
<p>NOTE: you may want to use some npm module like <a href="http://npmjs.org/package/asn1.js">asn1.js</a> to parse the certificates.</p>
<h3>server.listen(port[, host][, callback])<a id="all_server_listen_port_host_callback" class="mark" href="#all_server_listen_port_host_callback">#</a></h3>
<p>Begin accepting connections on the specified <code>port</code> and <code>host</code>. If the <code>host</code> is omitted, the server will accept connections directed to any IPv4 address (<code>INADDR_ANY</code>).</p>
<p>This function is asynchronous. The last parameter <code>callback</code> will be called when the server has been bound.</p>
<p>See <code>net.Server</code> for more information.</p>
<h3>server.close()<a id="all_server_close" class="mark" href="#all_server_close">#</a></h3>
<p>Stops the server from accepting new connections. This function is asynchronous, the server is finally closed when the server emits a <code>'close'</code> event.</p>
<h3>server.address()<a id="all_server_address" class="mark" href="#all_server_address">#</a></h3>
<p>Returns the bound address, the address family name and port of the server as reported by the operating system. See <a href="https://nodejs.org/api/net.html#net_server_address">net.Server.address()</a> for more information.</p>
<h3>server.addContext(hostname, context)<a id="all_server_addcontext_hostname_context" class="mark" href="#all_server_addcontext_hostname_context">#</a></h3>
<p>Add secure context that will be used if client request's SNI hostname is matching passed <code>hostname</code> (wildcards can be used). <code>context</code> can contain <code>key</code>, <code>cert</code>, <code>ca</code> and/or any other properties from <code>tls.createSecureContext</code> <code>options</code> argument.</p>
<h3>server.maxConnections<a id="all_server_maxconnections" class="mark" href="#all_server_maxconnections">#</a></h3>
<p>Set this property to reject connections when the server's connection count gets high.</p>
<h3>server.connections<a id="all_server_connections" class="mark" href="#all_server_connections">#</a></h3>
<p>The number of concurrent connections on the server.</p>
<h2>Class: CryptoStream<a id="all_class_cryptostream" class="mark" href="#all_class_cryptostream">#</a></h2>
<pre class="api_stability_0 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">-</span> Deprecated<span class="sh_symbol">.</span> Use tls<span class="sh_symbol">.</span>TLSSocket instead<span class="sh_symbol">.</span></pre>
<p>This is an encrypted stream.</p>
<h3>cryptoStream.bytesWritten<a id="all_cryptostream_byteswritten" class="mark" href="#all_cryptostream_byteswritten">#</a></h3>
<p>A proxy to the underlying socket's bytesWritten accessor, this will return the total bytes written to the socket, <em>including the TLS overhead</em>.</p>
<h2>Class: tls.TLSSocket<a id="all_class_tls_tlssocket_1" class="mark" href="#all_class_tls_tlssocket_1">#</a></h2>
<p>This is a wrapped version of <a href="https://nodejs.org/api/net.html#net_class_net_socket">net.Socket</a> that does transparent encryption of written data and all required TLS negotiation.</p>
<p>This instance implements a duplex <a href="https://nodejs.org/api/stream.html#stream_stream">Stream</a> interfaces. It has all the common stream methods and events.</p>
<h3>Event: 'secureConnect'<a id="all_event_secureconnect" class="mark" href="#all_event_secureconnect">#</a></h3>
<p>This event is emitted after a new connection has been successfully handshaked. The listener will be called no matter if the server's certificate was authorized or not. It is up to the user to test <code>tlsSocket.authorized</code> to see if the server certificate was signed by one of the specified CAs. If <code>tlsSocket.authorized === false</code> then the error can be found in <code>tlsSocket.authorizationError</code>. Also if NPN was used - you can check <code>tlsSocket.npnProtocol</code> for negotiated protocol.</p>
<h3>Event: 'OCSPResponse'<a id="all_event_ocspresponse" class="mark" href="#all_event_ocspresponse">#</a></h3>
<p><code>function (response) { }</code></p>
<p>This event will be emitted if <code>requestOCSP</code> option was set. <code>response</code> is a buffer object, containing server's OCSP response.</p>
<p>Traditionally, the <code>response</code> is a signed object from the server's CA that contains information about server's certificate revocation status.</p>
<h3>tlsSocket.encrypted<a id="all_tlssocket_encrypted" class="mark" href="#all_tlssocket_encrypted">#</a></h3>
<p>Static boolean value, always <code>true</code>. May be used to distinguish TLS sockets from regular ones.</p>
<h3>tlsSocket.authorized<a id="all_tlssocket_authorized" class="mark" href="#all_tlssocket_authorized">#</a></h3>
<p>A boolean that is <code>true</code> if the peer certificate was signed by one of the specified CAs, otherwise <code>false</code></p>
<h3>tlsSocket.authorizationError<a id="all_tlssocket_authorizationerror" class="mark" href="#all_tlssocket_authorizationerror">#</a></h3>
<p>The reason why the peer's certificate has not been verified. This property becomes available only when <code>tlsSocket.authorized === false</code>.</p>
<h3>tlsSocket.getPeerCertificate([ detailed ])<a id="all_tlssocket_getpeercertificate_detailed" class="mark" href="#all_tlssocket_getpeercertificate_detailed">#</a></h3>
<p>Returns an object representing the peer's certificate. The returned object has some properties corresponding to the field of the certificate. If <code>detailed</code> argument is <code>true</code> - the full chain with <code>issuer</code> property will be returned, if <code>false</code> - only the top certificate without <code>issuer</code> property.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> subject<span class="sh_symbol">:</span>
   <span class="sh_cbracket">{</span> C<span class="sh_symbol">:</span> <span class="sh_string">'UK'</span><span class="sh_symbol">,</span>
     ST<span class="sh_symbol">:</span> <span class="sh_string">'Acknack Ltd'</span><span class="sh_symbol">,</span>
     L<span class="sh_symbol">:</span> <span class="sh_string">'Rhys Jones'</span><span class="sh_symbol">,</span>
     O<span class="sh_symbol">:</span> <span class="sh_string">'node.js'</span><span class="sh_symbol">,</span>
     OU<span class="sh_symbol">:</span> <span class="sh_string">'Test TLS Certificate'</span><span class="sh_symbol">,</span>
     CN<span class="sh_symbol">:</span> <span class="sh_string">'localhost'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  issuerInfo<span class="sh_symbol">:</span>
   <span class="sh_cbracket">{</span> C<span class="sh_symbol">:</span> <span class="sh_string">'UK'</span><span class="sh_symbol">,</span>
     ST<span class="sh_symbol">:</span> <span class="sh_string">'Acknack Ltd'</span><span class="sh_symbol">,</span>
     L<span class="sh_symbol">:</span> <span class="sh_string">'Rhys Jones'</span><span class="sh_symbol">,</span>
     O<span class="sh_symbol">:</span> <span class="sh_string">'node.js'</span><span class="sh_symbol">,</span>
     OU<span class="sh_symbol">:</span> <span class="sh_string">'Test TLS Certificate'</span><span class="sh_symbol">,</span>
     CN<span class="sh_symbol">:</span> <span class="sh_string">'localhost'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  issuer<span class="sh_symbol">:</span>
   <span class="sh_cbracket">{</span> <span class="sh_symbol">...</span> another certificate <span class="sh_symbol">...</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  raw<span class="sh_symbol">:</span> <span class="sh_symbol">&lt;</span> RAW DER buffer <span class="sh_symbol">&gt;,</span>
  valid_from<span class="sh_symbol">:</span> <span class="sh_string">'Nov 11 09:52:22 2009 GMT'</span><span class="sh_symbol">,</span>
  valid_to<span class="sh_symbol">:</span> <span class="sh_string">'Nov  6 09:52:22 2029 GMT'</span><span class="sh_symbol">,</span>
  fingerprint<span class="sh_symbol">:</span> <span class="sh_string">'2A:7A:C2:DD:E5:F9:CC:53:72:35:99:7A:02:5A:71:38:52:EC:8A:DF'</span><span class="sh_symbol">,</span>
  serialNumber<span class="sh_symbol">:</span> <span class="sh_string">'B9B0D332A1AA5635'</span> <span class="sh_cbracket">}</span></code></pre>
<p>If the peer does not provide a certificate, it returns <code>null</code> or an empty object.</p>
<h3>tlsSocket.getCipher()<a id="all_tlssocket_getcipher" class="mark" href="#all_tlssocket_getcipher">#</a></h3>
<p>Returns an object representing the cipher name and the SSL/TLS protocol version of the current connection.</p>
<p>Example: { name: 'AES256-SHA', version: 'TLSv1/SSLv3' }</p>
<p>See SSL_CIPHER_get_name() and SSL_CIPHER_get_version() in <a href="http://www.openssl.org/docs/ssl/ssl.html#DEALING_WITH_CIPHERS">http://www.openssl.org/docs/ssl/ssl.html#DEALING_WITH_CIPHERS</a> for more information.</p>
<h3>tlsSocket.renegotiate(options, callback)<a id="all_tlssocket_renegotiate_options_callback" class="mark" href="#all_tlssocket_renegotiate_options_callback">#</a></h3>
<p>Initiate TLS renegotiation process. The <code>options</code> may contain the following fields: <code>rejectUnauthorized</code>, <code>requestCert</code> (See <a href="#tls_tls_createserver_options_secureconnectionlistener">tls.createServer</a> for details). <code>callback(err)</code> will be executed with <code>null</code> as <code>err</code>, once the renegotiation is successfully completed.</p>
<p>NOTE: Can be used to request peer's certificate after the secure connection has been established.</p>
<p>ANOTHER NOTE: When running as the server, socket will be destroyed with an error after <code>handshakeTimeout</code> timeout.</p>
<h3>tlsSocket.setMaxSendFragment(size)<a id="all_tlssocket_setmaxsendfragment_size" class="mark" href="#all_tlssocket_setmaxsendfragment_size">#</a></h3>
<p>Set maximum TLS fragment size (default and maximum value is: <code>16384</code>, minimum is: <code>512</code>). Returns <code>true</code> on success, <code>false</code> otherwise.</p>
<p>Smaller fragment size decreases buffering latency on the client: large fragments are buffered by the TLS layer until the entire fragment is received and its integrity is verified; large fragments can span multiple roundtrips, and their processing can be delayed due to packet loss or reordering. However, smaller fragments add extra TLS framing bytes and CPU overhead, which may decrease overall server throughput.</p>
<h3>tlsSocket.getSession()<a id="all_tlssocket_getsession" class="mark" href="#all_tlssocket_getsession">#</a></h3>
<p>Return ASN.1 encoded TLS session or <code>undefined</code> if none was negotiated. Could be used to speed up handshake establishment when reconnecting to the server.</p>
<h3>tlsSocket.getTLSTicket()<a id="all_tlssocket_gettlsticket" class="mark" href="#all_tlssocket_gettlsticket">#</a></h3>
<p>NOTE: Works only with client TLS sockets. Useful only for debugging, for session reuse provide <code>session</code> option to <code>tls.connect</code>.</p>
<p>Return TLS session ticket or <code>undefined</code> if none was negotiated.</p>
<h3>tlsSocket.address()<a id="all_tlssocket_address" class="mark" href="#all_tlssocket_address">#</a></h3>
<p>Returns the bound address, the address family name and port of the underlying socket as reported by the operating system. Returns an object with three properties, e.g. <code>{ port: 12346, family: 'IPv4', address: '127.0.0.1' }</code></p>
<h3>tlsSocket.remoteAddress<a id="all_tlssocket_remoteaddress" class="mark" href="#all_tlssocket_remoteaddress">#</a></h3>
<p>The string representation of the remote IP address. For example, <code>'74.125.127.100'</code> or <code>'2001:4860:a005::68'</code>.</p>
<h3>tlsSocket.remoteFamily<a id="all_tlssocket_remotefamily" class="mark" href="#all_tlssocket_remotefamily">#</a></h3>
<p>The string representation of the remote IP family. <code>'IPv4'</code> or <code>'IPv6'</code>.</p>
<h3>tlsSocket.remotePort<a id="all_tlssocket_remoteport" class="mark" href="#all_tlssocket_remoteport">#</a></h3>
<p>The numeric representation of the remote port. For example, <code>443</code>.</p>
<h3>tlsSocket.localAddress<a id="all_tlssocket_localaddress" class="mark" href="#all_tlssocket_localaddress">#</a></h3>
<p>The string representation of the local IP address.</p>
<h3>tlsSocket.localPort<a id="all_tlssocket_localport" class="mark" href="#all_tlssocket_localport">#</a></h3>
<p>The numeric representation of the local port.</p>
<h1>StringDecoder<a id="all_stringdecoder" class="mark" href="#all_stringdecoder">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>To use this module, do <code>require('string_decoder')</code>. StringDecoder decodes a buffer to a string. It is a simple interface to <code>buffer.toString()</code> but provides additional support for utf8.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> StringDecoder <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'string_decoder'</span><span class="sh_symbol">).</span>StringDecoder<span class="sh_symbol">;</span>
<span class="sh_keyword">var</span> decoder <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringDecoder</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> cent <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">([</span><span class="sh_number">0xC2</span><span class="sh_symbol">,</span> <span class="sh_number">0xA2</span><span class="sh_symbol">]);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>decoder<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>cent<span class="sh_symbol">));</span>

<span class="sh_keyword">var</span> euro <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">([</span><span class="sh_number">0xE2</span><span class="sh_symbol">,</span> <span class="sh_number">0x82</span><span class="sh_symbol">,</span> <span class="sh_number">0xAC</span><span class="sh_symbol">]);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>decoder<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>euro<span class="sh_symbol">));</span></code></pre>
<h2>Class: StringDecoder<a id="all_class_stringdecoder" class="mark" href="#all_class_stringdecoder">#</a></h2>
<p>Accepts a single argument, <code>encoding</code> which defaults to <code>utf8</code>.</p>
<h3>decoder.write(buffer)<a id="all_decoder_write_buffer" class="mark" href="#all_decoder_write_buffer">#</a></h3>
<p>Returns a decoded string.</p>
<h3>decoder.end()<a id="all_decoder_end" class="mark" href="#all_decoder_end">#</a></h3>
<p>Returns any trailing bytes that were left in the buffer.</p>
<h1>File System<a id="all_file_system" class="mark" href="#all_file_system">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>File I/O is provided by simple wrappers around standard POSIX functions. To use this module do <code>require('fs')</code>. All the methods have asynchronous and synchronous forms.</p>
<p>The asynchronous form always take a completion callback as its last argument. The arguments passed to the completion callback depend on the method, but the first argument is always reserved for an exception. If the operation was completed successfully, then the first argument will be <code>null</code> or <code>undefined</code>.</p>
<p>When using the synchronous form any exceptions are immediately thrown. You can use try/catch to handle exceptions or allow them to bubble up.</p>
<p>Here is an example of the asynchronous version:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

fs<span class="sh_symbol">.</span><span class="sh_function">unlink</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/hello'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'successfully deleted /tmp/hello'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Here is the synchronous version:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

fs<span class="sh_symbol">.</span><span class="sh_function">unlinkSync</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/hello'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'successfully deleted /tmp/hello'</span><span class="sh_symbol">);</span></code></pre>
<p>With the asynchronous methods there is no guaranteed ordering. So the following is prone to error:</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">rename</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/hello'</span><span class="sh_symbol">,</span> <span class="sh_string">'/tmp/world'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'renamed complete'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
fs<span class="sh_symbol">.</span><span class="sh_function">stat</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/world'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> stats<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'stats: '</span> <span class="sh_symbol">+</span> JSON<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span>stats<span class="sh_symbol">));</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>It could be that <code>fs.stat</code> is executed before <code>fs.rename</code>. The correct way to do this is to chain the callbacks.</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">rename</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/hello'</span><span class="sh_symbol">,</span> <span class="sh_string">'/tmp/world'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  fs<span class="sh_symbol">.</span><span class="sh_function">stat</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/world'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> stats<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'stats: '</span> <span class="sh_symbol">+</span> JSON<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span>stats<span class="sh_symbol">));</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>In busy processes, the programmer is <em>strongly encouraged</em> to use the asynchronous versions of these calls. The synchronous versions will block the entire process until they complete--halting all connections.</p>
<p>Relative path to filename can be used, remember however that this path will be relative to <code>process.cwd()</code>.</p>
<p>Most fs functions let you omit the callback argument. If you do, a default callback is used that rethrows errors. To get a trace to the original call site, set the NODE_DEBUG environment variable:</p>
<pre class="sh_sourceCode"><code>$ cat script<span class="sh_symbol">.</span>js
<span class="sh_keyword">function</span> <span class="sh_function">bad</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">).</span><span class="sh_function">readFile</span><span class="sh_symbol">(</span><span class="sh_string">'/'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>
<span class="sh_function">bad</span><span class="sh_symbol">();</span>

$ env NODE_DEBUG<span class="sh_symbol">=</span>fs node script<span class="sh_symbol">.</span>js
fs<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">66</span>
        <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
              <span class="sh_symbol">^</span>
<span class="sh_predef_func">Error</span><span class="sh_symbol">:</span> EISDIR<span class="sh_symbol">,</span> read
    at <span class="sh_function">rethrow</span> <span class="sh_symbol">(</span>fs<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">61</span><span class="sh_symbol">:</span><span class="sh_number">21</span><span class="sh_symbol">)</span>
    at <span class="sh_function">maybeCallback</span> <span class="sh_symbol">(</span>fs<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">79</span><span class="sh_symbol">:</span><span class="sh_number">42</span><span class="sh_symbol">)</span>
    at <span class="sh_predef_func">Object</span><span class="sh_symbol">.</span>fs<span class="sh_symbol">.</span><span class="sh_function">readFile</span> <span class="sh_symbol">(</span>fs<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">153</span><span class="sh_symbol">:</span><span class="sh_number">18</span><span class="sh_symbol">)</span>
    at <span class="sh_function">bad</span> <span class="sh_symbol">(</span><span class="sh_regexp">/path/</span><span class="sh_normal">to</span><span class="sh_symbol">/</span>script<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">2</span><span class="sh_symbol">:</span><span class="sh_number">17</span><span class="sh_symbol">)</span>
    at <span class="sh_predef_func">Object</span><span class="sh_symbol">.&lt;</span>anonymous<span class="sh_symbol">&gt;</span> <span class="sh_symbol">(</span><span class="sh_regexp">/path/</span><span class="sh_normal">to</span><span class="sh_symbol">/</span>script<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">5</span><span class="sh_symbol">:</span><span class="sh_number">1</span><span class="sh_symbol">)</span>
    <span class="sh_symbol">&lt;</span>etc<span class="sh_symbol">.&gt;</span></code></pre>
<h2>fs.rename(oldPath, newPath, callback)<a id="all_fs_rename_oldpath_newpath_callback" class="mark" href="#all_fs_rename_oldpath_newpath_callback">#</a></h2>
<p>Asynchronous rename(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.renameSync(oldPath, newPath)<a id="all_fs_renamesync_oldpath_newpath" class="mark" href="#all_fs_renamesync_oldpath_newpath">#</a></h2>
<p>Synchronous rename(2). Returns <code>undefined</code>.</p>
<h2>fs.ftruncate(fd, len, callback)<a id="all_fs_ftruncate_fd_len_callback" class="mark" href="#all_fs_ftruncate_fd_len_callback">#</a></h2>
<p>Asynchronous ftruncate(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.ftruncateSync(fd, len)<a id="all_fs_ftruncatesync_fd_len" class="mark" href="#all_fs_ftruncatesync_fd_len">#</a></h2>
<p>Synchronous ftruncate(2). Returns <code>undefined</code>.</p>
<h2>fs.truncate(path, len, callback)<a id="all_fs_truncate_path_len_callback" class="mark" href="#all_fs_truncate_path_len_callback">#</a></h2>
<p>Asynchronous truncate(2). No arguments other than a possible exception are given to the completion callback. A file descriptor can also be passed as the first argument. In this case, <code>fs.ftruncate()</code> is called.</p>
<h2>fs.truncateSync(path, len)<a id="all_fs_truncatesync_path_len" class="mark" href="#all_fs_truncatesync_path_len">#</a></h2>
<p>Synchronous truncate(2). Returns <code>undefined</code>.</p>
<h2>fs.chown(path, uid, gid, callback)<a id="all_fs_chown_path_uid_gid_callback" class="mark" href="#all_fs_chown_path_uid_gid_callback">#</a></h2>
<p>Asynchronous chown(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.chownSync(path, uid, gid)<a id="all_fs_chownsync_path_uid_gid" class="mark" href="#all_fs_chownsync_path_uid_gid">#</a></h2>
<p>Synchronous chown(2). Returns <code>undefined</code>.</p>
<h2>fs.fchown(fd, uid, gid, callback)<a id="all_fs_fchown_fd_uid_gid_callback" class="mark" href="#all_fs_fchown_fd_uid_gid_callback">#</a></h2>
<p>Asynchronous fchown(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.fchownSync(fd, uid, gid)<a id="all_fs_fchownsync_fd_uid_gid" class="mark" href="#all_fs_fchownsync_fd_uid_gid">#</a></h2>
<p>Synchronous fchown(2). Returns <code>undefined</code>.</p>
<h2>fs.lchown(path, uid, gid, callback)<a id="all_fs_lchown_path_uid_gid_callback" class="mark" href="#all_fs_lchown_path_uid_gid_callback">#</a></h2>
<p>Asynchronous lchown(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.lchownSync(path, uid, gid)<a id="all_fs_lchownsync_path_uid_gid" class="mark" href="#all_fs_lchownsync_path_uid_gid">#</a></h2>
<p>Synchronous lchown(2). Returns <code>undefined</code>.</p>
<h2>fs.chmod(path, mode, callback)<a id="all_fs_chmod_path_mode_callback" class="mark" href="#all_fs_chmod_path_mode_callback">#</a></h2>
<p>Asynchronous chmod(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.chmodSync(path, mode)<a id="all_fs_chmodsync_path_mode" class="mark" href="#all_fs_chmodsync_path_mode">#</a></h2>
<p>Synchronous chmod(2). Returns <code>undefined</code>.</p>
<h2>fs.fchmod(fd, mode, callback)<a id="all_fs_fchmod_fd_mode_callback" class="mark" href="#all_fs_fchmod_fd_mode_callback">#</a></h2>
<p>Asynchronous fchmod(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.fchmodSync(fd, mode)<a id="all_fs_fchmodsync_fd_mode" class="mark" href="#all_fs_fchmodsync_fd_mode">#</a></h2>
<p>Synchronous fchmod(2). Returns <code>undefined</code>.</p>
<h2>fs.lchmod(path, mode, callback)<a id="all_fs_lchmod_path_mode_callback" class="mark" href="#all_fs_lchmod_path_mode_callback">#</a></h2>
<p>Asynchronous lchmod(2). No arguments other than a possible exception are given to the completion callback.</p>
<p>Only available on Mac OS X.</p>
<h2>fs.lchmodSync(path, mode)<a id="all_fs_lchmodsync_path_mode" class="mark" href="#all_fs_lchmodsync_path_mode">#</a></h2>
<p>Synchronous lchmod(2). Returns <code>undefined</code>.</p>
<h2>fs.stat(path, callback)<a id="all_fs_stat_path_callback" class="mark" href="#all_fs_stat_path_callback">#</a></h2>
<p>Asynchronous stat(2). The callback gets two arguments <code>(err, stats)</code> where <code>stats</code> is a <a href="#fs_class_fs_stats">fs.Stats</a> object. See the <a href="#fs_class_fs_stats">fs.Stats</a> section below for more information.</p>
<h2>fs.lstat(path, callback)<a id="all_fs_lstat_path_callback" class="mark" href="#all_fs_lstat_path_callback">#</a></h2>
<p>Asynchronous lstat(2). The callback gets two arguments <code>(err, stats)</code> where <code>stats</code> is a <code>fs.Stats</code> object. <code>lstat()</code> is identical to <code>stat()</code>, except that if <code>path</code> is a symbolic link, then the link itself is stat-ed, not the file that it refers to.</p>
<h2>fs.fstat(fd, callback)<a id="all_fs_fstat_fd_callback" class="mark" href="#all_fs_fstat_fd_callback">#</a></h2>
<p>Asynchronous fstat(2). The callback gets two arguments <code>(err, stats)</code> where <code>stats</code> is a <code>fs.Stats</code> object. <code>fstat()</code> is identical to <code>stat()</code>, except that the file to be stat-ed is specified by the file descriptor <code>fd</code>.</p>
<h2>fs.statSync(path)<a id="all_fs_statsync_path" class="mark" href="#all_fs_statsync_path">#</a></h2>
<p>Synchronous stat(2). Returns an instance of <code>fs.Stats</code>.</p>
<h2>fs.lstatSync(path)<a id="all_fs_lstatsync_path" class="mark" href="#all_fs_lstatsync_path">#</a></h2>
<p>Synchronous lstat(2). Returns an instance of <code>fs.Stats</code>.</p>
<h2>fs.fstatSync(fd)<a id="all_fs_fstatsync_fd" class="mark" href="#all_fs_fstatsync_fd">#</a></h2>
<p>Synchronous fstat(2). Returns an instance of <code>fs.Stats</code>.</p>
<h2>fs.link(srcpath, dstpath, callback)<a id="all_fs_link_srcpath_dstpath_callback" class="mark" href="#all_fs_link_srcpath_dstpath_callback">#</a></h2>
<p>Asynchronous link(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.linkSync(srcpath, dstpath)<a id="all_fs_linksync_srcpath_dstpath" class="mark" href="#all_fs_linksync_srcpath_dstpath">#</a></h2>
<p>Synchronous link(2). Returns <code>undefined</code>.</p>
<h2>fs.symlink(srcpath, dstpath[, type], callback)<a id="all_fs_symlink_srcpath_dstpath_type_callback" class="mark" href="#all_fs_symlink_srcpath_dstpath_type_callback">#</a></h2>
<p>Asynchronous symlink(2). No arguments other than a possible exception are given to the completion callback. The <code>type</code> argument can be set to <code>'dir'</code>, <code>'file'</code>, or <code>'junction'</code> (default is <code>'file'</code>) and is only available on Windows (ignored on other platforms). Note that Windows junction points require the destination path to be absolute. When using <code>'junction'</code>, the <code>destination</code> argument will automatically be normalized to absolute path.</p>
<h2>fs.symlinkSync(srcpath, dstpath[, type])<a id="all_fs_symlinksync_srcpath_dstpath_type" class="mark" href="#all_fs_symlinksync_srcpath_dstpath_type">#</a></h2>
<p>Synchronous symlink(2). Returns <code>undefined</code>.</p>
<h2>fs.readlink(path, callback)<a id="all_fs_readlink_path_callback" class="mark" href="#all_fs_readlink_path_callback">#</a></h2>
<p>Asynchronous readlink(2). The callback gets two arguments <code>(err, linkString)</code>.</p>
<h2>fs.readlinkSync(path)<a id="all_fs_readlinksync_path" class="mark" href="#all_fs_readlinksync_path">#</a></h2>
<p>Synchronous readlink(2). Returns the symbolic link's string value.</p>
<h2>fs.realpath(path[, cache], callback)<a id="all_fs_realpath_path_cache_callback" class="mark" href="#all_fs_realpath_path_cache_callback">#</a></h2>
<p>Asynchronous realpath(2). The <code>callback</code> gets two arguments <code>(err, resolvedPath)</code>. May use <code>process.cwd</code> to resolve relative paths. <code>cache</code> is an object literal of mapped paths that can be used to force a specific path resolution or avoid additional <code>fs.stat</code> calls for known real paths.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> cache <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span><span class="sh_string">'/etc'</span><span class="sh_symbol">:</span><span class="sh_string">'/private/etc'</span><span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
fs<span class="sh_symbol">.</span><span class="sh_function">realpath</span><span class="sh_symbol">(</span><span class="sh_string">'/etc/passwd'</span><span class="sh_symbol">,</span> cache<span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> resolvedPath<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>resolvedPath<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>fs.realpathSync(path[, cache])<a id="all_fs_realpathsync_path_cache" class="mark" href="#all_fs_realpathsync_path_cache">#</a></h2>
<p>Synchronous realpath(2). Returns the resolved path.</p>
<h2>fs.unlink(path, callback)<a id="all_fs_unlink_path_callback" class="mark" href="#all_fs_unlink_path_callback">#</a></h2>
<p>Asynchronous unlink(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.unlinkSync(path)<a id="all_fs_unlinksync_path" class="mark" href="#all_fs_unlinksync_path">#</a></h2>
<p>Synchronous unlink(2). Returns <code>undefined</code>.</p>
<h2>fs.rmdir(path, callback)<a id="all_fs_rmdir_path_callback" class="mark" href="#all_fs_rmdir_path_callback">#</a></h2>
<p>Asynchronous rmdir(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.rmdirSync(path)<a id="all_fs_rmdirsync_path" class="mark" href="#all_fs_rmdirsync_path">#</a></h2>
<p>Synchronous rmdir(2). Returns <code>undefined</code>.</p>
<h2>fs.mkdir(path[, mode], callback)<a id="all_fs_mkdir_path_mode_callback" class="mark" href="#all_fs_mkdir_path_mode_callback">#</a></h2>
<p>Asynchronous mkdir(2). No arguments other than a possible exception are given to the completion callback. <code>mode</code> defaults to <code>0777</code>.</p>
<h2>fs.mkdirSync(path[, mode])<a id="all_fs_mkdirsync_path_mode" class="mark" href="#all_fs_mkdirsync_path_mode">#</a></h2>
<p>Synchronous mkdir(2). Returns <code>undefined</code>.</p>
<h2>fs.readdir(path, callback)<a id="all_fs_readdir_path_callback" class="mark" href="#all_fs_readdir_path_callback">#</a></h2>
<p>Asynchronous readdir(3). Reads the contents of a directory. The callback gets two arguments <code>(err, files)</code> where <code>files</code> is an array of the names of the files in the directory excluding <code>'.'</code> and <code>'..'</code>.</p>
<h2>fs.readdirSync(path)<a id="all_fs_readdirsync_path" class="mark" href="#all_fs_readdirsync_path">#</a></h2>
<p>Synchronous readdir(3). Returns an array of filenames excluding <code>'.'</code> and <code>'..'</code>.</p>
<h2>fs.close(fd, callback)<a id="all_fs_close_fd_callback" class="mark" href="#all_fs_close_fd_callback">#</a></h2>
<p>Asynchronous close(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.closeSync(fd)<a id="all_fs_closesync_fd" class="mark" href="#all_fs_closesync_fd">#</a></h2>
<p>Synchronous close(2). Returns <code>undefined</code>.</p>
<h2>fs.open(path, flags[, mode], callback)<a id="all_fs_open_path_flags_mode_callback" class="mark" href="#all_fs_open_path_flags_mode_callback">#</a></h2>
<p>Asynchronous file open. See open(2). <code>flags</code> can be:</p>
<ul>
<li>
<p><code>'r'</code> - Open file for reading. An exception occurs if the file does not exist.</p>
</li>
<li>
<p><code>'r+'</code> - Open file for reading and writing. An exception occurs if the file does not exist.</p>
</li>
<li>
<p><code>'rs'</code> - Open file for reading in synchronous mode. Instructs the operating system to bypass the local file system cache.</p>
<p>This is primarily useful for opening files on NFS mounts as it allows you to skip the potentially stale local cache. It has a very real impact on I/O performance so don't use this flag unless you need it.</p>
<p>Note that this doesn't turn <code>fs.open()</code> into a synchronous blocking call. If that's what you want then you should be using <code>fs.openSync()</code></p>
</li>
<li>
<p><code>'rs+'</code> - Open file for reading and writing, telling the OS to open it synchronously. See notes for <code>'rs'</code> about using this with caution.</p>
</li>
<li>
<p><code>'w'</code> - Open file for writing. The file is created (if it does not exist) or truncated (if it exists).</p>
</li>
<li>
<p><code>'wx'</code> - Like <code>'w'</code> but fails if <code>path</code> exists.</p>
</li>
<li>
<p><code>'w+'</code> - Open file for reading and writing. The file is created (if it does not exist) or truncated (if it exists).</p>
</li>
<li>
<p><code>'wx+'</code> - Like <code>'w+'</code> but fails if <code>path</code> exists.</p>
</li>
<li>
<p><code>'a'</code> - Open file for appending. The file is created if it does not exist.</p>
</li>
<li>
<p><code>'ax'</code> - Like <code>'a'</code> but fails if <code>path</code> exists.</p>
</li>
<li>
<p><code>'a+'</code> - Open file for reading and appending. The file is created if it does not exist.</p>
</li>
<li>
<p><code>'ax+'</code> - Like <code>'a+'</code> but fails if <code>path</code> exists.</p>
</li>
</ul>
<p><code>mode</code> sets the file mode (permission and sticky bits), but only if the file was created. It defaults to <code>0666</code>, readable and writeable.</p>
<p>The callback gets two arguments <code>(err, fd)</code>.</p>
<p>The exclusive flag <code>'x'</code> (<code>O_EXCL</code> flag in open(2)) ensures that <code>path</code> is newly created. On POSIX systems, <code>path</code> is considered to exist even if it is a symlink to a non-existent file. The exclusive flag may or may not work with network file systems.</p>
<p>On Linux, positional writes don't work when the file is opened in append mode. The kernel ignores the position argument and always appends the data to the end of the file.</p>
<h2>fs.openSync(path, flags[, mode])<a id="all_fs_opensync_path_flags_mode" class="mark" href="#all_fs_opensync_path_flags_mode">#</a></h2>
<p>Synchronous version of <code>fs.open()</code>. Returns an integer representing the file descriptor.</p>
<h2>fs.utimes(path, atime, mtime, callback)<a id="all_fs_utimes_path_atime_mtime_callback" class="mark" href="#all_fs_utimes_path_atime_mtime_callback">#</a></h2>
<p>Change file timestamps of the file referenced by the supplied path.</p>
<h2>fs.utimesSync(path, atime, mtime)<a id="all_fs_utimessync_path_atime_mtime" class="mark" href="#all_fs_utimessync_path_atime_mtime">#</a></h2>
<p>Synchronous version of <code>fs.utimes()</code>. Returns <code>undefined</code>.</p>
<h2>fs.futimes(fd, atime, mtime, callback)<a id="all_fs_futimes_fd_atime_mtime_callback" class="mark" href="#all_fs_futimes_fd_atime_mtime_callback">#</a></h2>
<p>Change the file timestamps of a file referenced by the supplied file descriptor.</p>
<h2>fs.futimesSync(fd, atime, mtime)<a id="all_fs_futimessync_fd_atime_mtime" class="mark" href="#all_fs_futimessync_fd_atime_mtime">#</a></h2>
<p>Synchronous version of <code>fs.futimes()</code>. Returns <code>undefined</code>.</p>
<h2>fs.fsync(fd, callback)<a id="all_fs_fsync_fd_callback" class="mark" href="#all_fs_fsync_fd_callback">#</a></h2>
<p>Asynchronous fsync(2). No arguments other than a possible exception are given to the completion callback.</p>
<h2>fs.fsyncSync(fd)<a id="all_fs_fsyncsync_fd" class="mark" href="#all_fs_fsyncsync_fd">#</a></h2>
<p>Synchronous fsync(2). Returns <code>undefined</code>.</p>
<h2>fs.write(fd, buffer, offset, length[, position], callback)<a id="all_fs_write_fd_buffer_offset_length_position_callback" class="mark" href="#all_fs_write_fd_buffer_offset_length_position_callback">#</a></h2>
<p>Write <code>buffer</code> to the file specified by <code>fd</code>.</p>
<p><code>offset</code> and <code>length</code> determine the part of the buffer to be written.</p>
<p><code>position</code> refers to the offset from the beginning of the file where this data should be written. If <code>typeof position !== 'number'</code>, the data will be written at the current position. See pwrite(2).</p>
<p>The callback will be given three arguments <code>(err, written, buffer)</code> where <code>written</code> specifies how many <em>bytes</em> were written from <code>buffer</code>.</p>
<p>Note that it is unsafe to use <code>fs.write</code> multiple times on the same file without waiting for the callback. For this scenario, <code>fs.createWriteStream</code> is strongly recommended.</p>
<p>On Linux, positional writes don't work when the file is opened in append mode. The kernel ignores the position argument and always appends the data to the end of the file.</p>
<h2>fs.write(fd, data[, position[, encoding]], callback)<a id="all_fs_write_fd_data_position_encoding_callback" class="mark" href="#all_fs_write_fd_data_position_encoding_callback">#</a></h2>
<p>Write <code>data</code> to the file specified by <code>fd</code>. If <code>data</code> is not a Buffer instance then the value will be coerced to a string.</p>
<p><code>position</code> refers to the offset from the beginning of the file where this data should be written. If <code>typeof position !== 'number'</code> the data will be written at the current position. See pwrite(2).</p>
<p><code>encoding</code> is the expected string encoding.</p>
<p>The callback will receive the arguments <code>(err, written, string)</code> where <code>written</code> specifies how many <em>bytes</em> the passed string required to be written. Note that bytes written is not the same as string characters. See <a href="https://nodejs.org/api/buffer.html#buffer_class_method_buffer_bytelength_string_encoding">Buffer.byteLength</a>.</p>
<p>Unlike when writing <code>buffer</code>, the entire string must be written. No substring may be specified. This is because the byte offset of the resulting data may not be the same as the string offset.</p>
<p>Note that it is unsafe to use <code>fs.write</code> multiple times on the same file without waiting for the callback. For this scenario, <code>fs.createWriteStream</code> is strongly recommended.</p>
<p>On Linux, positional writes don't work when the file is opened in append mode. The kernel ignores the position argument and always appends the data to the end of the file.</p>
<h2>fs.writeSync(fd, buffer, offset, length[, position])<a id="all_fs_writesync_fd_buffer_offset_length_position" class="mark" href="#all_fs_writesync_fd_buffer_offset_length_position">#</a></h2>
<h2>fs.writeSync(fd, data[, position[, encoding]])<a id="all_fs_writesync_fd_data_position_encoding" class="mark" href="#all_fs_writesync_fd_data_position_encoding">#</a></h2>
<p>Synchronous versions of <code>fs.write()</code>. Returns the number of bytes written.</p>
<h2>fs.read(fd, buffer, offset, length, position, callback)<a id="all_fs_read_fd_buffer_offset_length_position_callback" class="mark" href="#all_fs_read_fd_buffer_offset_length_position_callback">#</a></h2>
<p>Read data from the file specified by <code>fd</code>.</p>
<p><code>buffer</code> is the buffer that the data will be written to.</p>
<p><code>offset</code> is the offset in the buffer to start writing at.</p>
<p><code>length</code> is an integer specifying the number of bytes to read.</p>
<p><code>position</code> is an integer specifying where to begin reading from in the file. If <code>position</code> is <code>null</code>, data will be read from the current file position.</p>
<p>The callback is given the three arguments, <code>(err, bytesRead, buffer)</code>.</p>
<h2>fs.readSync(fd, buffer, offset, length, position)<a id="all_fs_readsync_fd_buffer_offset_length_position" class="mark" href="#all_fs_readsync_fd_buffer_offset_length_position">#</a></h2>
<p>Synchronous version of <code>fs.read</code>. Returns the number of <code>bytesRead</code>.</p>
<h2>fs.readFile(filename[, options], callback)<a id="all_fs_readfile_filename_options_callback" class="mark" href="#all_fs_readfile_filename_options_callback">#</a></h2>
<div class="signature">
<ul>
<li><code>filename</code> <span class="type">String</span></li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>encoding</code> <span class="type">String | Null</span> default = <code>null</code></li>
<li><code>flag</code> <span class="type">String</span> default = <code>'r'</code></li>
</ul>
</li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Asynchronously reads the entire contents of a file. Example:</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">readFile</span><span class="sh_symbol">(</span><span class="sh_string">'/etc/passwd'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>The callback is passed two arguments <code>(err, data)</code>, where <code>data</code> is the contents of the file.</p>
<p>If no encoding is specified, then the raw buffer is returned.</p>
<h2>fs.readFileSync(filename[, options])<a id="all_fs_readfilesync_filename_options" class="mark" href="#all_fs_readfilesync_filename_options">#</a></h2>
<p>Synchronous version of <code>fs.readFile</code>. Returns the contents of the <code>filename</code>.</p>
<p>If the <code>encoding</code> option is specified then this function returns a string. Otherwise it returns a buffer.</p>
<h2>fs.writeFile(filename, data[, options], callback)<a id="all_fs_writefile_filename_data_options_callback" class="mark" href="#all_fs_writefile_filename_data_options_callback">#</a></h2>
<div class="signature">
<ul>
<li><code>filename</code> <span class="type">String</span></li>
<li><code>data</code> <span class="type">String | Buffer</span></li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>encoding</code> <span class="type">String | Null</span> default = <code>'utf8'</code></li>
<li><code>mode</code> <span class="type">Number</span> default = <code>438</code> (aka <code>0666</code> in Octal)</li>
<li><code>flag</code> <span class="type">String</span> default = <code>'w'</code></li>
</ul>
</li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Asynchronously writes data to a file, replacing the file if it already exists. <code>data</code> can be a string or a buffer.</p>
<p>The <code>encoding</code> option is ignored if <code>data</code> is a buffer. It defaults to <code>'utf8'</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">writeFile</span><span class="sh_symbol">(</span><span class="sh_string">'message.txt'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello Node'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'It</span><span class="sh_specialchar">\'</span><span class="sh_string">s saved!'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>fs.writeFileSync(filename, data[, options])<a id="all_fs_writefilesync_filename_data_options" class="mark" href="#all_fs_writefilesync_filename_data_options">#</a></h2>
<p>The synchronous version of <code>fs.writeFile</code>. Returns <code>undefined</code>.</p>
<h2>fs.appendFile(filename, data[, options], callback)<a id="all_fs_appendfile_filename_data_options_callback" class="mark" href="#all_fs_appendfile_filename_data_options_callback">#</a></h2>
<div class="signature">
<ul>
<li><code>filename</code> <span class="type">String</span></li>
<li><code>data</code> <span class="type">String | Buffer</span></li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>encoding</code> <span class="type">String | Null</span> default = <code>'utf8'</code></li>
<li><code>mode</code> <span class="type">Number</span> default = <code>438</code> (aka <code>0666</code> in Octal)</li>
<li><code>flag</code> <span class="type">String</span> default = <code>'a'</code></li>
</ul>
</li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Asynchronously append data to a file, creating the file if it not yet exists. <code>data</code> can be a string or a buffer.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">appendFile</span><span class="sh_symbol">(</span><span class="sh_string">'message.txt'</span><span class="sh_symbol">,</span> <span class="sh_string">'data to append'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'The "data to append" was appended to file!'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>fs.appendFileSync(filename, data[, options])<a id="all_fs_appendfilesync_filename_data_options" class="mark" href="#all_fs_appendfilesync_filename_data_options">#</a></h2>
<p>The synchronous version of <code>fs.appendFile</code>. Returns <code>undefined</code>.</p>
<h2>fs.watchFile(filename[, options], listener)<a id="all_fs_watchfile_filename_options_listener" class="mark" href="#all_fs_watchfile_filename_options_listener">#</a></h2>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable<span class="sh_symbol">.</span>  Use fs<span class="sh_symbol">.</span>watch instead<span class="sh_symbol">,</span> <span class="sh_keyword">if</span> possible<span class="sh_symbol">.</span></pre>
<p>Watch for changes on <code>filename</code>. The callback <code>listener</code> will be called each time the file is accessed.</p>
<p>The second argument is optional. The <code>options</code> if provided should be an object containing two members a boolean, <code>persistent</code>, and <code>interval</code>. <code>persistent</code> indicates whether the process should continue to run as long as files are being watched. <code>interval</code> indicates how often the target should be polled, in milliseconds. The default is <code>{ persistent: true, interval: 5007 }</code>.</p>
<p>The <code>listener</code> gets two arguments the current stat object and the previous stat object:</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">watchFile</span><span class="sh_symbol">(</span><span class="sh_string">'message.text'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>curr<span class="sh_symbol">,</span> prev<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'the current mtime is: '</span> <span class="sh_symbol">+</span> curr<span class="sh_symbol">.</span>mtime<span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'the previous mtime was: '</span> <span class="sh_symbol">+</span> prev<span class="sh_symbol">.</span>mtime<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>These stat objects are instances of <code>fs.Stat</code>.</p>
<p>If you want to be notified when the file was modified, not just accessed you need to compare <code>curr.mtime</code> and <code>prev.mtime</code>.</p>
<h2>fs.unwatchFile(filename[, listener])<a id="all_fs_unwatchfile_filename_listener" class="mark" href="#all_fs_unwatchfile_filename_listener">#</a></h2>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable<span class="sh_symbol">.</span>  Use fs<span class="sh_symbol">.</span>watch instead<span class="sh_symbol">,</span> <span class="sh_keyword">if</span> possible<span class="sh_symbol">.</span></pre>
<p>Stop watching for changes on <code>filename</code>. If <code>listener</code> is specified, only that particular listener is removed. Otherwise, <em>all</em> listeners are removed and you have effectively stopped watching <code>filename</code>.</p>
<p>Calling <code>fs.unwatchFile()</code> with a filename that is not being watched is a no-op, not an error.</p>
<h2>fs.watch(filename[, options][, listener])<a id="all_fs_watch_filename_options_listener" class="mark" href="#all_fs_watch_filename_options_listener">#</a></h2>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable<span class="sh_symbol">.</span></pre>
<p>Watch for changes on <code>filename</code>, where <code>filename</code> is either a file or a directory. The returned object is a <a href="#fs_class_fs_fswatcher">fs.FSWatcher</a>.</p>
<p>The second argument is optional. The <code>options</code> if provided should be an object. The supported boolean members are <code>persistent</code> and <code>recursive</code>. <code>persistent</code> indicates whether the process should continue to run as long as files are being watched. <code>recursive</code> indicates whether all subdirectories should be watched, or only the current directory. This applies when a directory is specified, and only on supported platforms (See Caveats below).</p>
<p>The default is <code>{ persistent: true, recursive: false }</code>.</p>
<p>The listener callback gets two arguments <code>(event, filename)</code>. <code>event</code> is either 'rename' or 'change', and <code>filename</code> is the name of the file which triggered the event.</p>
<h3>Caveats<a id="all_caveats" class="mark" href="#all_caveats">#</a></h3>
<p>The <code>fs.watch</code> API is not 100% consistent across platforms, and is unavailable in some situations.</p>
<p>The recursive option is currently supported on OS X. Only FSEvents supports this type of file watching so it is unlikely any additional platforms will be added soon.</p>
<h4>Availability<a id="all_availability" class="mark" href="#all_availability">#</a></h4>
<p>This feature depends on the underlying operating system providing a way to be notified of filesystem changes.</p>
<ul>
<li>On Linux systems, this uses <code>inotify</code>.</li>
<li>On BSD systems, this uses <code>kqueue</code>.</li>
<li>On OS X, this uses <code>kqueue</code> for files and 'FSEvents' for directories.</li>
<li>On SunOS systems (including Solaris and SmartOS), this uses <code>event ports</code>.</li>
<li>On Windows systems, this feature depends on <code>ReadDirectoryChangesW</code>.</li>
</ul>
<p>If the underlying functionality is not available for some reason, then <code>fs.watch</code> will not be able to function. For example, watching files or directories on network file systems (NFS, SMB, etc.) often doesn't work reliably or at all.</p>
<p>You can still use <code>fs.watchFile</code>, which uses stat polling, but it is slower and less reliable.</p>
<h4>Filename Argument<a id="all_filename_argument" class="mark" href="#all_filename_argument">#</a></h4>
<p>Providing <code>filename</code> argument in the callback is not supported on every platform (currently it's only supported on Linux and Windows). Even on supported platforms <code>filename</code> is not always guaranteed to be provided. Therefore, don't assume that <code>filename</code> argument is always provided in the callback, and have some fallback logic if it is null.</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">watch</span><span class="sh_symbol">(</span><span class="sh_string">'somedir'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>event<span class="sh_symbol">,</span> filename<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'event is: '</span> <span class="sh_symbol">+</span> event<span class="sh_symbol">);</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>filename<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'filename provided: '</span> <span class="sh_symbol">+</span> filename<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'filename not provided'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>fs.exists(path, callback)<a id="all_fs_exists_path_callback" class="mark" href="#all_fs_exists_path_callback">#</a></h2>
<p>Test whether or not the given path exists by checking with the file system. Then call the <code>callback</code> argument with either true or false. Example:</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">exists</span><span class="sh_symbol">(</span><span class="sh_string">'/etc/passwd'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>exists<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  util<span class="sh_symbol">.</span><span class="sh_function">debug</span><span class="sh_symbol">(</span>exists <span class="sh_symbol">?</span> <span class="sh_string">"it's there"</span> <span class="sh_symbol">:</span> <span class="sh_string">"no passwd!"</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p><code>fs.exists()</code> is an anachronism and exists only for historical reasons. There should almost never be a reason to use it in your own code.</p>
<p>In particular, checking if a file exists before opening it is an anti-pattern that leaves you vulnerable to race conditions: another process may remove the file between the calls to <code>fs.exists()</code> and <code>fs.open()</code>. Just open the file and handle the error when it's not there.</p>
<p><code>fs.exists()</code> will be deprecated.</p>
<h2>fs.existsSync(path)<a id="all_fs_existssync_path" class="mark" href="#all_fs_existssync_path">#</a></h2>
<p>Synchronous version of <code>fs.exists()</code>. Returns <code>true</code> if the file exists, <code>false</code> otherwise.</p>
<p><code>fs.existsSync()</code> will be deprecated.</p>
<h2>fs.access(path[, mode], callback)<a id="all_fs_access_path_mode_callback" class="mark" href="#all_fs_access_path_mode_callback">#</a></h2>
<p>Tests a user's permissions for the file specified by <code>path</code>. <code>mode</code> is an optional integer that specifies the accessibility checks to be performed. The following constants define the possible values of <code>mode</code>. It is possible to create a mask consisting of the bitwise OR of two or more values.</p>
<ul>
<li><code>fs.F_OK</code> - File is visible to the calling process. This is useful for determining if a file exists, but says nothing about <code>rwx</code> permissions. Default if no <code>mode</code> is specified.</li>
<li><code>fs.R_OK</code> - File can be read by the calling process.</li>
<li><code>fs.W_OK</code> - File can be written by the calling process.</li>
<li><code>fs.X_OK</code> - File can be executed by the calling process. This has no effect on Windows (will behave like <code>fs.F_OK</code>).</li>
</ul>
<p>The final argument, <code>callback</code>, is a callback function that is invoked with a possible error argument. If any of the accessibility checks fail, the error argument will be populated. The following example checks if the file <code>/etc/passwd</code> can be read and written by the current process.</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">access</span><span class="sh_symbol">(</span><span class="sh_string">'/etc/passwd'</span><span class="sh_symbol">,</span> fs<span class="sh_symbol">.</span>R_OK <span class="sh_symbol">|</span> fs<span class="sh_symbol">.</span>W_OK<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  util<span class="sh_symbol">.</span><span class="sh_function">debug</span><span class="sh_symbol">(</span>err <span class="sh_symbol">?</span> <span class="sh_string">'no access!'</span> <span class="sh_symbol">:</span> <span class="sh_string">'can read/write'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>fs.accessSync(path[, mode])<a id="all_fs_accesssync_path_mode" class="mark" href="#all_fs_accesssync_path_mode">#</a></h2>
<p>Synchronous version of <code>fs.access</code>. This throws if any accessibility checks fail, and does nothing otherwise.</p>
<h2>Class: fs.Stats<a id="all_class_fs_stats" class="mark" href="#all_class_fs_stats">#</a></h2>
<p>Objects returned from <code>fs.stat()</code>, <code>fs.lstat()</code> and <code>fs.fstat()</code> and their synchronous counterparts are of this type.</p>
<ul>
<li><code>stats.isFile()</code></li>
<li><code>stats.isDirectory()</code></li>
<li><code>stats.isBlockDevice()</code></li>
<li><code>stats.isCharacterDevice()</code></li>
<li><code>stats.isSymbolicLink()</code> (only valid with <code>fs.lstat()</code>)</li>
<li><code>stats.isFIFO()</code></li>
<li><code>stats.isSocket()</code></li>
</ul>
<p>For a regular file <code>util.inspect(stats)</code> would return a string very similar to this:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> dev<span class="sh_symbol">:</span> <span class="sh_number">2114</span><span class="sh_symbol">,</span>
  ino<span class="sh_symbol">:</span> <span class="sh_number">48064969</span><span class="sh_symbol">,</span>
  mode<span class="sh_symbol">:</span> <span class="sh_number">33188</span><span class="sh_symbol">,</span>
  nlink<span class="sh_symbol">:</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
  uid<span class="sh_symbol">:</span> <span class="sh_number">85</span><span class="sh_symbol">,</span>
  gid<span class="sh_symbol">:</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>
  rdev<span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
  size<span class="sh_symbol">:</span> <span class="sh_number">527</span><span class="sh_symbol">,</span>
  blksize<span class="sh_symbol">:</span> <span class="sh_number">4096</span><span class="sh_symbol">,</span>
  blocks<span class="sh_symbol">:</span> <span class="sh_number">8</span><span class="sh_symbol">,</span>
  atime<span class="sh_symbol">:</span> Mon<span class="sh_symbol">,</span> <span class="sh_number">10</span> Oct <span class="sh_number">2011</span> <span class="sh_number">23</span><span class="sh_symbol">:</span><span class="sh_number">24</span><span class="sh_symbol">:</span><span class="sh_number">11</span> GMT<span class="sh_symbol">,</span>
  mtime<span class="sh_symbol">:</span> Mon<span class="sh_symbol">,</span> <span class="sh_number">10</span> Oct <span class="sh_number">2011</span> <span class="sh_number">23</span><span class="sh_symbol">:</span><span class="sh_number">24</span><span class="sh_symbol">:</span><span class="sh_number">11</span> GMT<span class="sh_symbol">,</span>
  ctime<span class="sh_symbol">:</span> Mon<span class="sh_symbol">,</span> <span class="sh_number">10</span> Oct <span class="sh_number">2011</span> <span class="sh_number">23</span><span class="sh_symbol">:</span><span class="sh_number">24</span><span class="sh_symbol">:</span><span class="sh_number">11</span> GMT<span class="sh_symbol">,</span>
  birthtime<span class="sh_symbol">:</span> Mon<span class="sh_symbol">,</span> <span class="sh_number">10</span> Oct <span class="sh_number">2011</span> <span class="sh_number">23</span><span class="sh_symbol">:</span><span class="sh_number">24</span><span class="sh_symbol">:</span><span class="sh_number">11</span> GMT <span class="sh_cbracket">}</span></code></pre>
<p>Please note that <code>atime</code>, <code>mtime</code>, <code>birthtime</code>, and <code>ctime</code> are instances of <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date">Date</a> object and to compare the values of these objects you should use appropriate methods. For most general uses <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/getTime">getTime()</a> will return the number of milliseconds elapsed since <em>1 January 1970 00:00:00 UTC</em> and this integer should be sufficient for any comparison, however there are additional methods which can be used for displaying fuzzy information. More details can be found in the <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date">MDN JavaScript Reference</a> page.</p>
<h3>Stat Time Values<a id="all_stat_time_values" class="mark" href="#all_stat_time_values">#</a></h3>
<p>The times in the stat object have the following semantics:</p>
<ul>
<li><code>atime</code> "Access Time" - Time when file data last accessed. Changed by the <code>mknod(2)</code>, <code>utimes(2)</code>, and <code>read(2)</code> system calls.</li>
<li><code>mtime</code> "Modified Time" - Time when file data last modified. Changed by the <code>mknod(2)</code>, <code>utimes(2)</code>, and <code>write(2)</code> system calls.</li>
<li><code>ctime</code> "Change Time" - Time when file status was last changed (inode data modification). Changed by the <code>chmod(2)</code>, <code>chown(2)</code>, <code>link(2)</code>, <code>mknod(2)</code>, <code>rename(2)</code>, <code>unlink(2)</code>, <code>utimes(2)</code>, <code>read(2)</code>, and <code>write(2)</code> system calls.</li>
<li><code>birthtime</code> "Birth Time" - Time of file creation. Set once when the file is created. On filesystems where birthtime is not available, this field may instead hold either the <code>ctime</code> or <code>1970-01-01T00:00Z</code> (ie, unix epoch timestamp <code>0</code>). On Darwin and other FreeBSD variants, also set if the <code>atime</code> is explicitly set to an earlier value than the current <code>birthtime</code> using the <code>utimes(2)</code> system call.</li>
</ul>
<p>Prior to Node v0.12, the <code>ctime</code> held the <code>birthtime</code> on Windows systems. Note that as of v0.12, <code>ctime</code> is not "creation time", and on Unix systems, it never was.</p>
<h2>fs.createReadStream(path[, options])<a id="all_fs_createreadstream_path_options" class="mark" href="#all_fs_createreadstream_path_options">#</a></h2>
<p>Returns a new ReadStream object (See <code>Readable Stream</code>).</p>
<p><code>options</code> is an object with the following defaults:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> flags<span class="sh_symbol">:</span> <span class="sh_string">'r'</span><span class="sh_symbol">,</span>
  encoding<span class="sh_symbol">:</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span>
  fd<span class="sh_symbol">:</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span>
  mode<span class="sh_symbol">:</span> <span class="sh_number">0666</span><span class="sh_symbol">,</span>
  autoClose<span class="sh_symbol">:</span> <span class="sh_keyword">true</span>
<span class="sh_cbracket">}</span></code></pre>
<p><code>options</code> can include <code>start</code> and <code>end</code> values to read a range of bytes from the file instead of the entire file. Both <code>start</code> and <code>end</code> are inclusive and start at 0. The <code>encoding</code> can be <code>'utf8'</code>, <code>'ascii'</code>, or <code>'base64'</code>.</p>
<p>If <code>fd</code> is specified, <code>ReadStream</code> will ignore the <code>path</code> argument and will use the specified file descriptor. This means that no <code>open</code> event will be emitted.</p>
<p>If <code>autoClose</code> is false, then the file descriptor won't be closed, even if there's an error. It is your responsibility to close it and make sure there's no file descriptor leak. If <code>autoClose</code> is set to true (default behavior), on <code>error</code> or <code>end</code> the file descriptor will be closed automatically.</p>
<p>An example to read the last 10 bytes of a file which is 100 bytes long:</p>
<pre class="sh_sourceCode"><code>fs<span class="sh_symbol">.</span><span class="sh_function">createReadStream</span><span class="sh_symbol">(</span><span class="sh_string">'sample.txt'</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span>start<span class="sh_symbol">:</span> <span class="sh_number">90</span><span class="sh_symbol">,</span> end<span class="sh_symbol">:</span> <span class="sh_number">99</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Class: fs.ReadStream<a id="all_class_fs_readstream" class="mark" href="#all_class_fs_readstream">#</a></h2>
<p><code>ReadStream</code> is a <a href="https://nodejs.org/api/stream.html#stream_class_stream_readable">Readable Stream</a>.</p>
<h3>Event: 'open'<a id="all_event_open" class="mark" href="#all_event_open">#</a></h3>
<div class="signature">
<ul>
<li><code>fd</code> <span class="type">Integer</span> file descriptor used by the ReadStream.</li>
</ul>
</div>
<p>Emitted when the ReadStream's file is opened.</p>
<h2>fs.createWriteStream(path[, options])<a id="all_fs_createwritestream_path_options" class="mark" href="#all_fs_createwritestream_path_options">#</a></h2>
<p>Returns a new WriteStream object (See <code>Writable Stream</code>).</p>
<p><code>options</code> is an object with the following defaults:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> flags<span class="sh_symbol">:</span> <span class="sh_string">'w'</span><span class="sh_symbol">,</span>
  encoding<span class="sh_symbol">:</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span>
  fd<span class="sh_symbol">:</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span>
  mode<span class="sh_symbol">:</span> <span class="sh_number">0666</span> <span class="sh_cbracket">}</span></code></pre>
<p><code>options</code> may also include a <code>start</code> option to allow writing data at some position past the beginning of the file. Modifying a file rather than replacing it may require a <code>flags</code> mode of <code>r+</code> rather than the default mode <code>w</code>.</p>
<p>Like <code>ReadStream</code> above, if <code>fd</code> is specified, <code>WriteStream</code> will ignore the <code>path</code> argument and will use the specified file descriptor. This means that no <code>open</code> event will be emitted.</p>
<h2>Class: fs.WriteStream<a id="all_class_fs_writestream" class="mark" href="#all_class_fs_writestream">#</a></h2>
<p><code>WriteStream</code> is a <a href="https://nodejs.org/api/stream.html#stream_class_stream_writable">Writable Stream</a>.</p>
<h3>Event: 'open'<a id="all_event_open_1" class="mark" href="#all_event_open_1">#</a></h3>
<div class="signature">
<ul>
<li><code>fd</code> <span class="type">Integer</span> file descriptor used by the WriteStream.</li>
</ul>
</div>
<p>Emitted when the WriteStream's file is opened.</p>
<h3>file.bytesWritten<a id="all_file_byteswritten" class="mark" href="#all_file_byteswritten">#</a></h3>
<p>The number of bytes written so far. Does not include data that is still queued for writing.</p>
<h2>Class: fs.FSWatcher<a id="all_class_fs_fswatcher" class="mark" href="#all_class_fs_fswatcher">#</a></h2>
<p>Objects returned from <code>fs.watch()</code> are of this type.</p>
<h3>watcher.close()<a id="all_watcher_close" class="mark" href="#all_watcher_close">#</a></h3>
<p>Stop watching for changes on the given <code>fs.FSWatcher</code>.</p>
<h3>Event: 'change'<a id="all_event_change" class="mark" href="#all_event_change">#</a></h3>
<div class="signature">
<ul>
<li><code>event</code> <span class="type">String</span> The type of fs change</li>
<li><code>filename</code> <span class="type">String</span> The filename that changed (if relevant/available)</li>
</ul>
</div>
<p>Emitted when something changes in a watched directory or file. See more details in <a href="#fs_fs_watch_filename_options_listener">fs.watch</a>.</p>
<h3>Event: 'error'<a id="all_event_error_2" class="mark" href="#all_event_error_2">#</a></h3>
<div class="signature">
<ul>
<li><code>error</code> <span class="type">Error object</span></li>
</ul>
</div>
<p>Emitted when an error occurs.</p>
<h1>Path<a id="all_path" class="mark" href="#all_path">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>This module contains utilities for handling and transforming file paths. Almost all these methods perform only string transformations. The file system is not consulted to check whether paths are valid.</p>
<p>Use <code>require('path')</code> to use this module. The following methods are provided:</p>
<h2>path.normalize(p)<a id="all_path_normalize_p" class="mark" href="#all_path_normalize_p">#</a></h2>
<p>Normalize a string path, taking care of <code>'..'</code> and <code>'.'</code> parts.</p>
<p>When multiple slashes are found, they're replaced by a single one; when the path contains a trailing slash, it is preserved. On Windows backslashes are used.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">normalize</span><span class="sh_symbol">(</span><span class="sh_string">'/foo/bar//baz/asdf/quux/..'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'/foo/bar/baz/asdf'</span></code></pre>
<h2>path.join([path1][, path2][, ...])<a id="all_path_join_path1_path2" class="mark" href="#all_path_join_path1_path2">#</a></h2>
<p>Join all arguments together and normalize the resulting path.</p>
<p>Arguments must be strings. In v0.8, non-string arguments were silently ignored. In v0.10 and up, an exception is thrown.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">join</span><span class="sh_symbol">(</span><span class="sh_string">'/foo'</span><span class="sh_symbol">,</span> <span class="sh_string">'bar'</span><span class="sh_symbol">,</span> <span class="sh_string">'baz/asdf'</span><span class="sh_symbol">,</span> <span class="sh_string">'quux'</span><span class="sh_symbol">,</span> <span class="sh_string">'..'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'/foo/bar/baz/asdf'</span>

path<span class="sh_symbol">.</span><span class="sh_function">join</span><span class="sh_symbol">(</span><span class="sh_string">'foo'</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{}</span><span class="sh_symbol">,</span> <span class="sh_string">'bar'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// throws exception</span>
<span class="sh_predef_func">TypeError</span><span class="sh_symbol">:</span> Arguments to path<span class="sh_symbol">.</span>join must be strings</code></pre>
<h2>path.resolve([from ...], to)<a id="all_path_resolve_from_to" class="mark" href="#all_path_resolve_from_to">#</a></h2>
<p>Resolves <code>to</code> to an absolute path.</p>
<p>If <code>to</code> isn't already absolute <code>from</code> arguments are prepended in right to left order, until an absolute path is found. If after using all <code>from</code> paths still no absolute path is found, the current working directory is used as well. The resulting path is normalized, and trailing slashes are removed unless the path gets resolved to the root directory. Non-string <code>from</code> arguments are ignored.</p>
<p>Another way to think of it is as a sequence of <code>cd</code> commands in a shell.</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span><span class="sh_string">'foo/bar'</span><span class="sh_symbol">,</span> <span class="sh_string">'/tmp/file/'</span><span class="sh_symbol">,</span> <span class="sh_string">'..'</span><span class="sh_symbol">,</span> <span class="sh_string">'a/../subfile'</span><span class="sh_symbol">)</span></code></pre>
<p>Is similar to:</p>
<pre class="sh_sourceCode"><code>cd <span class="sh_normal">foo</span><span class="sh_symbol">/</span>bar
<span class="sh_normal">cd </span><span class="sh_symbol">/</span><span class="sh_normal">tmp</span><span class="sh_symbol">/</span><span class="sh_normal">file</span><span class="sh_symbol">/</span>
cd <span class="sh_symbol">..</span>
cd <span class="sh_normal">a</span><span class="sh_symbol">/../</span>subfile
pwd</code></pre>
<p>The difference is that the different paths don't need to exist and may also be files.</p>
<p>Examples:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span><span class="sh_string">'/foo/bar'</span><span class="sh_symbol">,</span> <span class="sh_string">'./baz'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'/foo/bar/baz'</span>

path<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span><span class="sh_string">'/foo/bar'</span><span class="sh_symbol">,</span> <span class="sh_string">'/tmp/file/'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'/tmp/file'</span>

path<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span><span class="sh_string">'wwwroot'</span><span class="sh_symbol">,</span> <span class="sh_string">'static_files/png/'</span><span class="sh_symbol">,</span> <span class="sh_string">'../gif/image.gif'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// if currently in /home/myself/node, it returns</span>
<span class="sh_string">'/home/myself/node/wwwroot/static_files/gif/image.gif'</span></code></pre>
<h2>path.isAbsolute(path)<a id="all_path_isabsolute_path" class="mark" href="#all_path_isabsolute_path">#</a></h2>
<p>Determines whether <code>path</code> is an absolute path. An absolute path will always resolve to the same location, regardless of the working directory.</p>
<p>Posix examples:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">isAbsolute</span><span class="sh_symbol">(</span><span class="sh_string">'/foo/bar'</span><span class="sh_symbol">)</span> <span class="sh_comment">// true</span>
path<span class="sh_symbol">.</span><span class="sh_function">isAbsolute</span><span class="sh_symbol">(</span><span class="sh_string">'/baz/..'</span><span class="sh_symbol">)</span>  <span class="sh_comment">// true</span>
path<span class="sh_symbol">.</span><span class="sh_function">isAbsolute</span><span class="sh_symbol">(</span><span class="sh_string">'qux/'</span><span class="sh_symbol">)</span>     <span class="sh_comment">// false</span>
path<span class="sh_symbol">.</span><span class="sh_function">isAbsolute</span><span class="sh_symbol">(</span><span class="sh_string">'.'</span><span class="sh_symbol">)</span>        <span class="sh_comment">// false</span></code></pre>
<p>Windows examples:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">isAbsolute</span><span class="sh_symbol">(</span><span class="sh_string">'//server'</span><span class="sh_symbol">)</span>  <span class="sh_comment">// true</span>
path<span class="sh_symbol">.</span><span class="sh_function">isAbsolute</span><span class="sh_symbol">(</span><span class="sh_string">'C:/foo/..'</span><span class="sh_symbol">)</span> <span class="sh_comment">// true</span>
path<span class="sh_symbol">.</span><span class="sh_function">isAbsolute</span><span class="sh_symbol">(</span><span class="sh_string">'bar</span><span class="sh_specialchar">\\</span><span class="sh_string">baz'</span><span class="sh_symbol">)</span>   <span class="sh_comment">// false</span>
path<span class="sh_symbol">.</span><span class="sh_function">isAbsolute</span><span class="sh_symbol">(</span><span class="sh_string">'.'</span><span class="sh_symbol">)</span>         <span class="sh_comment">// false</span></code></pre>
<h2>path.relative(from, to)<a id="all_path_relative_from_to" class="mark" href="#all_path_relative_from_to">#</a></h2>
<p>Solve the relative path from <code>from</code> to <code>to</code>.</p>
<p>At times we have two absolute paths, and we need to derive the relative path from one to the other. This is actually the reverse transform of <code>path.resolve</code>, which means we see that:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span>from<span class="sh_symbol">,</span> path<span class="sh_symbol">.</span><span class="sh_function">relative</span><span class="sh_symbol">(</span>from<span class="sh_symbol">,</span> to<span class="sh_symbol">))</span> <span class="sh_symbol">==</span> path<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span>to<span class="sh_symbol">)</span></code></pre>
<p>Examples:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">relative</span><span class="sh_symbol">(</span><span class="sh_string">'C:</span><span class="sh_specialchar">\\</span><span class="sh_string">orandea</span><span class="sh_specialchar">\\</span><span class="sh_string">test</span><span class="sh_specialchar">\\</span><span class="sh_string">aaa'</span><span class="sh_symbol">,</span> <span class="sh_string">'C:</span><span class="sh_specialchar">\\</span><span class="sh_string">orandea</span><span class="sh_specialchar">\\</span><span class="sh_string">impl</span><span class="sh_specialchar">\\</span><span class="sh_string">bbb'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'..</span><span class="sh_specialchar">\\</span><span class="sh_string">..</span><span class="sh_specialchar">\\</span><span class="sh_string">impl</span><span class="sh_specialchar">\\</span><span class="sh_string">bbb'</span>

path<span class="sh_symbol">.</span><span class="sh_function">relative</span><span class="sh_symbol">(</span><span class="sh_string">'/data/orandea/test/aaa'</span><span class="sh_symbol">,</span> <span class="sh_string">'/data/orandea/impl/bbb'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'../../impl/bbb'</span></code></pre>
<h2>path.dirname(p)<a id="all_path_dirname_p" class="mark" href="#all_path_dirname_p">#</a></h2>
<p>Return the directory name of a path. Similar to the Unix <code>dirname</code> command.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">dirname</span><span class="sh_symbol">(</span><span class="sh_string">'/foo/bar/baz/asdf/quux'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'/foo/bar/baz/asdf'</span></code></pre>
<h2>path.basename(p[, ext])<a id="all_path_basename_p_ext" class="mark" href="#all_path_basename_p_ext">#</a></h2>
<p>Return the last portion of a path. Similar to the Unix <code>basename</code> command.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">basename</span><span class="sh_symbol">(</span><span class="sh_string">'/foo/bar/baz/asdf/quux.html'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'quux.html'</span>

path<span class="sh_symbol">.</span><span class="sh_function">basename</span><span class="sh_symbol">(</span><span class="sh_string">'/foo/bar/baz/asdf/quux.html'</span><span class="sh_symbol">,</span> <span class="sh_string">'.html'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'quux'</span></code></pre>
<h2>path.extname(p)<a id="all_path_extname_p" class="mark" href="#all_path_extname_p">#</a></h2>
<p>Return the extension of the path, from the last '.' to end of string in the last portion of the path. If there is no '.' in the last portion of the path or the first character of it is '.', then it returns an empty string. Examples:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">extname</span><span class="sh_symbol">(</span><span class="sh_string">'index.html'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'.html'</span>

path<span class="sh_symbol">.</span><span class="sh_function">extname</span><span class="sh_symbol">(</span><span class="sh_string">'index.coffee.md'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'.md'</span>

path<span class="sh_symbol">.</span><span class="sh_function">extname</span><span class="sh_symbol">(</span><span class="sh_string">'index.'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'.'</span>

path<span class="sh_symbol">.</span><span class="sh_function">extname</span><span class="sh_symbol">(</span><span class="sh_string">'index'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">''</span></code></pre>
<h2>path.sep<a id="all_path_sep" class="mark" href="#all_path_sep">#</a></h2>
<p>The platform-specific file separator. <code>'\\'</code> or <code>'/'</code>.</p>
<p>An example on *nix:</p>
<pre class="sh_sourceCode"><code><span class="sh_string">'foo/bar/baz'</span><span class="sh_symbol">.</span><span class="sh_function">split</span><span class="sh_symbol">(</span>path<span class="sh_symbol">.</span>sep<span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_symbol">[</span><span class="sh_string">'foo'</span><span class="sh_symbol">,</span> <span class="sh_string">'bar'</span><span class="sh_symbol">,</span> <span class="sh_string">'baz'</span><span class="sh_symbol">]</span></code></pre>
<p>An example on Windows:</p>
<pre class="sh_sourceCode"><code><span class="sh_string">'foo</span><span class="sh_specialchar">\\</span><span class="sh_string">bar</span><span class="sh_specialchar">\\</span><span class="sh_string">baz'</span><span class="sh_symbol">.</span><span class="sh_function">split</span><span class="sh_symbol">(</span>path<span class="sh_symbol">.</span>sep<span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_symbol">[</span><span class="sh_string">'foo'</span><span class="sh_symbol">,</span> <span class="sh_string">'bar'</span><span class="sh_symbol">,</span> <span class="sh_string">'baz'</span><span class="sh_symbol">]</span></code></pre>
<h2>path.delimiter<a id="all_path_delimiter" class="mark" href="#all_path_delimiter">#</a></h2>
<p>The platform-specific path delimiter, <code>;</code> or <code>':'</code>.</p>
<p>An example on *nix:</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>env<span class="sh_symbol">.</span>PATH<span class="sh_symbol">)</span>
<span class="sh_comment">// '/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin'</span>

process<span class="sh_symbol">.</span>env<span class="sh_symbol">.</span>PATH<span class="sh_symbol">.</span><span class="sh_function">split</span><span class="sh_symbol">(</span>path<span class="sh_symbol">.</span>delimiter<span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_symbol">[</span><span class="sh_string">'/usr/bin'</span><span class="sh_symbol">,</span> <span class="sh_string">'/bin'</span><span class="sh_symbol">,</span> <span class="sh_string">'/usr/sbin'</span><span class="sh_symbol">,</span> <span class="sh_string">'/sbin'</span><span class="sh_symbol">,</span> <span class="sh_string">'/usr/local/bin'</span><span class="sh_symbol">]</span></code></pre>
<p>An example on Windows:</p>
<pre class="sh_sourceCode"><code>console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>env<span class="sh_symbol">.</span>PATH<span class="sh_symbol">)</span>
<span class="sh_comment">// 'C:\Windows\system32;C:\Windows;C:\Program Files\nodejs\'</span>

process<span class="sh_symbol">.</span>env<span class="sh_symbol">.</span>PATH<span class="sh_symbol">.</span><span class="sh_function">split</span><span class="sh_symbol">(</span>path<span class="sh_symbol">.</span>delimiter<span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_symbol">[</span><span class="sh_string">'C:</span><span class="sh_specialchar">\W</span><span class="sh_string">indows</span><span class="sh_specialchar">\s</span><span class="sh_string">ystem32'</span><span class="sh_symbol">,</span> <span class="sh_string">'C:</span><span class="sh_specialchar">\W</span><span class="sh_string">indows'</span><span class="sh_symbol">,</span> <span class="sh_string">'C:</span><span class="sh_specialchar">\P</span><span class="sh_string">rogram Files</span><span class="sh_specialchar">\n</span><span class="sh_string">odejs</span><span class="sh_specialchar">\'</span><span class="sh_string">]</span></code></pre>
<h2>path.parse(pathString)<a id="all_path_parse_pathstring" class="mark" href="#all_path_parse_pathstring">#</a></h2>
<p>Returns an object from a path string.</p>
<p>An example on *nix:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span><span class="sh_string">'/home/user/dir/file.txt'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_cbracket">{</span>
    root <span class="sh_symbol">:</span> <span class="sh_string">"/"</span><span class="sh_symbol">,</span>
    dir <span class="sh_symbol">:</span> <span class="sh_string">"/home/user/dir"</span><span class="sh_symbol">,</span>
    base <span class="sh_symbol">:</span> <span class="sh_string">"file.txt"</span><span class="sh_symbol">,</span>
    ext <span class="sh_symbol">:</span> <span class="sh_string">".txt"</span><span class="sh_symbol">,</span>
    name <span class="sh_symbol">:</span> <span class="sh_string">"file"</span>
<span class="sh_cbracket">}</span></code></pre>
<p>An example on Windows:</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span><span class="sh_string">'C:</span><span class="sh_specialchar">\\</span><span class="sh_string">path</span><span class="sh_specialchar">\\</span><span class="sh_string">dir</span><span class="sh_specialchar">\\</span><span class="sh_string">index.html'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_cbracket">{</span>
    root <span class="sh_symbol">:</span> <span class="sh_string">"C:</span><span class="sh_specialchar">\"</span><span class="sh_string">,</span>
<span class="sh_string">    dir : "</span>C<span class="sh_symbol">:\</span>path<span class="sh_symbol">\</span>dir<span class="sh_string">",</span>
<span class="sh_string">    base : "</span>index<span class="sh_symbol">.</span>html<span class="sh_string">",</span>
<span class="sh_string">    ext : "</span><span class="sh_symbol">.</span>html<span class="sh_string">",</span>
<span class="sh_string">    name : "</span>index<span class="sh_string">"</span>
<span class="sh_string">}</span></code></pre>
<h2>path.format(pathObject)<a id="all_path_format_pathobject" class="mark" href="#all_path_format_pathobject">#</a></h2>
<p>Returns a path string from an object, the opposite of <code>path.parse</code> above.</p>
<pre class="sh_sourceCode"><code>path<span class="sh_symbol">.</span><span class="sh_function">format</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
    root <span class="sh_symbol">:</span> <span class="sh_string">"/"</span><span class="sh_symbol">,</span>
    dir <span class="sh_symbol">:</span> <span class="sh_string">"/home/user/dir"</span><span class="sh_symbol">,</span>
    base <span class="sh_symbol">:</span> <span class="sh_string">"file.txt"</span><span class="sh_symbol">,</span>
    ext <span class="sh_symbol">:</span> <span class="sh_string">".txt"</span><span class="sh_symbol">,</span>
    name <span class="sh_symbol">:</span> <span class="sh_string">"file"</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'/home/user/dir/file.txt'</span></code></pre>
<h2>path.posix<a id="all_path_posix" class="mark" href="#all_path_posix">#</a></h2>
<p>Provide access to aforementioned <code>path</code> methods but always interact in a posix compatible way.</p>
<h2>path.win32<a id="all_path_win32" class="mark" href="#all_path_win32">#</a></h2>
<p>Provide access to aforementioned <code>path</code> methods but always interact in a win32 compatible way.</p>
<h1>net<a id="all_net" class="mark" href="#all_net">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>The <code>net</code> module provides you with an asynchronous network wrapper. It contains methods for creating both servers and clients (called streams). You can include this module with <code>require('net');</code></p>
<h2>net.createServer([options][, connectionListener])<a id="all_net_createserver_options_connectionlistener" class="mark" href="#all_net_createserver_options_connectionlistener">#</a></h2>
<p>Creates a new TCP server. The <code>connectionListener</code> argument is automatically set as a listener for the <a href="#net_event_connection">'connection'</a> event.</p>
<p><code>options</code> is an object with the following defaults:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span>
  allowHalfOpen<span class="sh_symbol">:</span> <span class="sh_keyword">false</span><span class="sh_symbol">,</span>
  pauseOnConnect<span class="sh_symbol">:</span> <span class="sh_keyword">false</span>
<span class="sh_cbracket">}</span></code></pre>
<p>If <code>allowHalfOpen</code> is <code>true</code>, then the socket won't automatically send a FIN packet when the other end of the socket sends a FIN packet. The socket becomes non-readable, but still writable. You should call the <code>end()</code> method explicitly. See <a href="#net_event_end">'end'</a> event for more information.</p>
<p>If <code>pauseOnConnect</code> is <code>true</code>, then the socket associated with each incoming connection will be paused, and no data will be read from its handle. This allows connections to be passed between processes without any data being read by the original process. To begin reading data from a paused socket, call <code>resume()</code>.</p>
<p>Here is an example of an echo server which listens for connections on port 8124:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> net <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'net'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> net<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>c<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> <span class="sh_comment">//'connection' listener</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'client connected'</span><span class="sh_symbol">);</span>
  c<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'client disconnected'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  c<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'hello</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
  c<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>c<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8124</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span> <span class="sh_comment">//'listening' listener</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'server bound'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Test this by using <code>telnet</code>:</p>
<pre class="sh_sourceCode"><code>telnet localhost <span class="sh_number">8124</span></code></pre>
<p>To listen on the socket <code>/tmp/echo.sock</code> the third line from the last would just be changed to</p>
<pre class="sh_sourceCode"><code>server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/echo.sock'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span> <span class="sh_comment">//'listening' listener</span></code></pre>
<p>Use <code>nc</code> to connect to a UNIX domain socket server:</p>
<pre class="sh_sourceCode"><code>nc <span class="sh_symbol">-</span><span class="sh_normal">U </span><span class="sh_symbol">/</span><span class="sh_normal">tmp</span><span class="sh_symbol">/</span>echo<span class="sh_symbol">.</span>sock</code></pre>
<h2>net.connect(options[, connectionListener])<a id="all_net_connect_options_connectionlistener" class="mark" href="#all_net_connect_options_connectionlistener">#</a></h2>
<h2>net.createConnection(options[, connectionListener])<a id="all_net_createconnection_options_connectionlistener" class="mark" href="#all_net_createconnection_options_connectionlistener">#</a></h2>
<p>A factory method, which returns a new <a href="#net_class_net_socket">'net.Socket'</a> and connects to the supplied address and port.</p>
<p>When the socket is established, the <a href="#net_event_connect">'connect'</a> event will be emitted.</p>
<p>Has the same events as <a href="#net_class_net_socket">'net.Socket'</a>.</p>
<p>For TCP sockets, <code>options</code> argument should be an object which specifies:</p>
<ul>
<li>
<p><code>port</code>: Port the client should connect to (Required).</p>
</li>
<li>
<p><code>host</code>: Host the client should connect to. Defaults to <code>'localhost'</code>.</p>
</li>
<li>
<p><code>localAddress</code>: Local interface to bind to for network connections.</p>
</li>
<li>
<p><code>localPort</code>: Local port to bind to for network connections.</p>
</li>
<li>
<p><code>family</code> : Version of IP stack. Defaults to <code>4</code>.</p>
</li>
</ul>
<p>For local domain sockets, <code>options</code> argument should be an object which specifies:</p>
<ul>
<li><code>path</code>: Path the client should connect to (Required).</li>
</ul>
<p>Common options are:</p>
<ul>
<li><code>allowHalfOpen</code>: if <code>true</code>, the socket won't automatically send a FIN packet when the other end of the socket sends a FIN packet. Defaults to <code>false</code>. See <a href="#net_event_end">'end'</a> event for more information.</li>
</ul>
<p>The <code>connectListener</code> parameter will be added as an listener for the <a href="#net_event_connect">'connect'</a> event.</p>
<p>Here is an example of a client of echo server as described previously:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> net <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'net'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> client <span class="sh_symbol">=</span> net<span class="sh_symbol">.</span><span class="sh_function">connect</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>port<span class="sh_symbol">:</span> <span class="sh_number">8124</span><span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
    <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span> <span class="sh_comment">//'connect' listener</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'connected to server!'</span><span class="sh_symbol">);</span>
  client<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'world!</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
client<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>data<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">());</span>
  client<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
client<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'disconnected from server'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>To connect on the socket <code>/tmp/echo.sock</code> the second line would just be changed to</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> client <span class="sh_symbol">=</span> net<span class="sh_symbol">.</span><span class="sh_function">connect</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>path<span class="sh_symbol">:</span> <span class="sh_string">'/tmp/echo.sock'</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>net.connect(port[, host][, connectListener])<a id="all_net_connect_port_host_connectlistener" class="mark" href="#all_net_connect_port_host_connectlistener">#</a></h2>
<h2>net.createConnection(port[, host][, connectListener])<a id="all_net_createconnection_port_host_connectlistener" class="mark" href="#all_net_createconnection_port_host_connectlistener">#</a></h2>
<p>Creates a TCP connection to <code>port</code> on <code>host</code>. If <code>host</code> is omitted, <code>'localhost'</code> will be assumed. The <code>connectListener</code> parameter will be added as an listener for the <a href="#net_event_connect">'connect'</a> event.</p>
<p>Is a factory method which returns a new <a href="#net_class_net_socket">'net.Socket'</a>.</p>
<h2>net.connect(path[, connectListener])<a id="all_net_connect_path_connectlistener" class="mark" href="#all_net_connect_path_connectlistener">#</a></h2>
<h2>net.createConnection(path[, connectListener])<a id="all_net_createconnection_path_connectlistener" class="mark" href="#all_net_createconnection_path_connectlistener">#</a></h2>
<p>Creates unix socket connection to <code>path</code>. The <code>connectListener</code> parameter will be added as an listener for the <a href="#net_event_connect">'connect'</a> event.</p>
<p>A factory method which returns a new <a href="#net_class_net_socket">'net.Socket'</a>.</p>
<h2>Class: net.Server<a id="all_class_net_server" class="mark" href="#all_class_net_server">#</a></h2>
<p>This class is used to create a TCP or local server.</p>
<h3>server.listen(port[, host][, backlog][, callback])<a id="all_server_listen_port_host_backlog_callback" class="mark" href="#all_server_listen_port_host_backlog_callback">#</a></h3>
<p>Begin accepting connections on the specified <code>port</code> and <code>host</code>. If the <code>host</code> is omitted, the server will accept connections directed to any IPv4 address (<code>INADDR_ANY</code>). A port value of zero will assign a random port.</p>
<p>Backlog is the maximum length of the queue of pending connections. The actual length will be determined by your OS through sysctl settings such as <code>tcp_max_syn_backlog</code> and <code>somaxconn</code> on linux. The default value of this parameter is 511 (not 512).</p>
<p>This function is asynchronous. When the server has been bound, <a href="https://nodejs.org/api/net.html#net_event_listening">'listening'</a> event will be emitted. The last parameter <code>callback</code> will be added as an listener for the <a href="https://nodejs.org/api/net.html#net_event_listening">'listening'</a> event.</p>
<p>One issue some users run into is getting <code>EADDRINUSE</code> errors. This means that another server is already running on the requested port. One way of handling this would be to wait a second and then try again. This can be done with</p>
<pre class="sh_sourceCode"><code>server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>e<span class="sh_symbol">.</span>code <span class="sh_symbol">==</span> <span class="sh_string">'EADDRINUSE'</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Address in use, retrying...'</span><span class="sh_symbol">);</span>
    <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
      server<span class="sh_symbol">.</span><span class="sh_function">close</span><span class="sh_symbol">();</span>
      server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span>PORT<span class="sh_symbol">,</span> HOST<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>(Note: All sockets in Node set <code>SO_REUSEADDR</code> already)</p>
<h3>server.listen(path[, callback])<a id="all_server_listen_path_callback" class="mark" href="#all_server_listen_path_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>path</code> <span class="type">String</span></li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Start a local socket server listening for connections on the given <code>path</code>.</p>
<p>This function is asynchronous. When the server has been bound, <a href="https://nodejs.org/api/net.html#net_event_listening">'listening'</a> event will be emitted. The last parameter <code>callback</code> will be added as an listener for the <a href="https://nodejs.org/api/net.html#net_event_listening">'listening'</a> event.</p>
<p>On UNIX, the local domain is usually known as the UNIX domain. The path is a filesystem path name. It is subject to the same naming conventions and permissions checks as would be done on file creation, will be visible in the filesystem, and will <em>persist until unlinked</em>.</p>
<p>On Windows, the local domain is implemented using a named pipe. The path <em>must</em> refer to an entry in <code>\\?\pipe\</code> or <code>\\.\pipe\</code>. Any characters are permitted, but the latter may do some processing of pipe names, such as resolving <code>..</code> sequences. Despite appearances, the pipe name space is flat. Pipes will <em>not persist</em>, they are removed when the last reference to them is closed. Do not forget javascript string escaping requires paths to be specified with double-backslashes, such as:</p>
<pre class="sh_sourceCode"><code>net<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">().</span><span class="sh_function">listen</span><span class="sh_symbol">(</span>
    path<span class="sh_symbol">.</span><span class="sh_function">join</span><span class="sh_symbol">(</span><span class="sh_string">'</span><span class="sh_specialchar">\\\\</span><span class="sh_string">?</span><span class="sh_specialchar">\\</span><span class="sh_string">pipe'</span><span class="sh_symbol">,</span> process<span class="sh_symbol">.</span><span class="sh_function">cwd</span><span class="sh_symbol">(),</span> <span class="sh_string">'myctl'</span><span class="sh_symbol">))</span></code></pre>
<h3>server.listen(handle[, callback])<a id="all_server_listen_handle_callback" class="mark" href="#all_server_listen_handle_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>handle</code> <span class="type">Object</span></li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>The <code>handle</code> object can be set to either a server or socket (anything with an underlying <code>_handle</code> member), or a <code>{fd: &lt;n&gt;}</code> object.</p>
<p>This will cause the server to accept connections on the specified handle, but it is presumed that the file descriptor or handle has already been bound to a port or domain socket.</p>
<p>Listening on a file descriptor is not supported on Windows.</p>
<p>This function is asynchronous. When the server has been bound, <a href="https://nodejs.org/api/net.html#net_event_listening">'listening'</a> event will be emitted. the last parameter <code>callback</code> will be added as an listener for the <a href="https://nodejs.org/api/net.html#net_event_listening">'listening'</a> event.</p>
<h3>server.listen(options[, callback])<a id="all_server_listen_options_callback" class="mark" href="#all_server_listen_options_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>options</code> <span class="type">Object</span> - Required. Supports the following properties:
<ul>
<li><code>port</code> <span class="type">Number</span> - Optional.</li>
<li><code>host</code> <span class="type">String</span> - Optional.</li>
<li><code>backlog</code> <span class="type">Number</span> - Optional.</li>
<li><code>path</code> <span class="type">String</span> - Optional.</li>
<li><code>exclusive</code> <span class="type">Boolean</span> - Optional.</li>
</ul>
</li>
<li><code>callback</code> <span class="type">Function</span> - Optional.</li>
</ul>
</div>
<p>The <code>port</code>, <code>host</code>, and <code>backlog</code> properties of <code>options</code>, as well as the optional callback function, behave as they do on a call to <a href="#net_server_listen_port_host_backlog_callback">server.listen(port, [host], [backlog], [callback]) </a>. Alternatively, the <code>path</code> option can be used to specify a UNIX socket.</p>
<p>If <code>exclusive</code> is <code>false</code> (default), then cluster workers will use the same underlying handle, allowing connection handling duties to be shared. When <code>exclusive</code> is <code>true</code>, the handle is not shared, and attempted port sharing results in an error. An example which listens on an exclusive port is shown below.</p>
<pre class="sh_sourceCode"><code>server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  host<span class="sh_symbol">:</span> <span class="sh_string">'localhost'</span><span class="sh_symbol">,</span>
  port<span class="sh_symbol">:</span> <span class="sh_number">80</span><span class="sh_symbol">,</span>
  exclusive<span class="sh_symbol">:</span> <span class="sh_keyword">true</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>server.close([callback])<a id="all_server_close_callback" class="mark" href="#all_server_close_callback">#</a></h3>
<p>Stops the server from accepting new connections and keeps existing connections. This function is asynchronous, the server is finally closed when all connections are ended and the server emits a <code>'close'</code> event. Optionally, you can pass a callback to listen for the <code>'close'</code> event. If present, the callback is invoked with any potential error as the first and only argument.</p>
<h3>server.address()<a id="all_server_address_1" class="mark" href="#all_server_address_1">#</a></h3>
<p>Returns the bound address, the address family name and port of the server as reported by the operating system. Useful to find which port was assigned when giving getting an OS-assigned address. Returns an object with three properties, e.g. <code>{ port: 12346, family: 'IPv4', address: '127.0.0.1' }</code></p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> net<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">"goodbye</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// grab a random port.</span>
server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  address <span class="sh_symbol">=</span> server<span class="sh_symbol">.</span><span class="sh_function">address</span><span class="sh_symbol">();</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"opened server on %j"</span><span class="sh_symbol">,</span> address<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Don't call <code>server.address()</code> until the <code>'listening'</code> event has been emitted.</p>
<h3>server.unref()<a id="all_server_unref" class="mark" href="#all_server_unref">#</a></h3>
<p>Calling <code>unref</code> on a server will allow the program to exit if this is the only active server in the event system. If the server is already <code>unref</code>d calling <code>unref</code> again will have no effect.</p>
<h3>server.ref()<a id="all_server_ref" class="mark" href="#all_server_ref">#</a></h3>
<p>Opposite of <code>unref</code>, calling <code>ref</code> on a previously <code>unref</code>d server will <em>not</em> let the program exit if it's the only server left (the default behavior). If the server is <code>ref</code>d calling <code>ref</code> again will have no effect.</p>
<h3>server.maxConnections<a id="all_server_maxconnections_1" class="mark" href="#all_server_maxconnections_1">#</a></h3>
<p>Set this property to reject connections when the server's connection count gets high.</p>
<p>It is not recommended to use this option once a socket has been sent to a child with <code>child_process.fork()</code>.</p>
<h3>server.connections<a id="all_server_connections_1" class="mark" href="#all_server_connections_1">#</a></h3>
<p>This function is <strong>deprecated</strong>; please use <a href="#net_server_getconnections_callback">server.getConnections()</a> instead. The number of concurrent connections on the server.</p>
<p>This becomes <code>null</code> when sending a socket to a child with <code>child_process.fork()</code>. To poll forks and get current number of active connections use asynchronous <code>server.getConnections</code> instead.</p>
<h3>server.getConnections(callback)<a id="all_server_getconnections_callback" class="mark" href="#all_server_getconnections_callback">#</a></h3>
<p>Asynchronously get the number of concurrent connections on the server. Works when sockets were sent to forks.</p>
<p>Callback should take two arguments <code>err</code> and <code>count</code>.</p>
<p><code>net.Server</code> is an <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a> with the following events:</p>
<h3>Event: 'listening'<a id="all_event_listening" class="mark" href="#all_event_listening">#</a></h3>
<p>Emitted when the server has been bound after calling <code>server.listen</code>.</p>
<h3>Event: 'connection'<a id="all_event_connection" class="mark" href="#all_event_connection">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Socket object</span> The connection object</li>
</ul>
</div>
<p>Emitted when a new connection is made. <code>socket</code> is an instance of <code>net.Socket</code>.</p>
<h3>Event: 'close'<a id="all_event_close_1" class="mark" href="#all_event_close_1">#</a></h3>
<p>Emitted when the server closes. Note that if connections exist, this event is not emitted until all connections are ended.</p>
<h3>Event: 'error'<a id="all_event_error_3" class="mark" href="#all_event_error_3">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Error Object</span></li>
</ul>
</div>
<p>Emitted when an error occurs. The <code>'close'</code> event will be called directly following this event. See example in discussion of <code>server.listen</code>.</p>
<h2>Class: net.Socket<a id="all_class_net_socket" class="mark" href="#all_class_net_socket">#</a></h2>
<p>This object is an abstraction of a TCP or local socket. <code>net.Socket</code> instances implement a duplex Stream interface. They can be created by the user and used as a client (with <code>connect()</code>) or they can be created by Node and passed to the user through the <code>'connection'</code> event of a server.</p>
<h3>new net.Socket([options])<a id="all_new_net_socket_options" class="mark" href="#all_new_net_socket_options">#</a></h3>
<p>Construct a new socket object.</p>
<p><code>options</code> is an object with the following defaults:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> fd<span class="sh_symbol">:</span> <span class="sh_keyword">null</span>
  allowHalfOpen<span class="sh_symbol">:</span> <span class="sh_keyword">false</span><span class="sh_symbol">,</span>
  readable<span class="sh_symbol">:</span> <span class="sh_keyword">false</span><span class="sh_symbol">,</span>
  writable<span class="sh_symbol">:</span> <span class="sh_keyword">false</span>
<span class="sh_cbracket">}</span></code></pre>
<p><code>fd</code> allows you to specify the existing file descriptor of socket. Set <code>readable</code> and/or <code>writable</code> to <code>true</code> to allow reads and/or writes on this socket (NOTE: Works only when <code>fd</code> is passed). About <code>allowHalfOpen</code>, refer to <code>createServer()</code> and <code>'end'</code> event.</p>
<h3>socket.connect(port[, host][, connectListener])<a id="all_socket_connect_port_host_connectlistener" class="mark" href="#all_socket_connect_port_host_connectlistener">#</a></h3>
<h3>socket.connect(path[, connectListener])<a id="all_socket_connect_path_connectlistener" class="mark" href="#all_socket_connect_path_connectlistener">#</a></h3>
<p>Opens the connection for a given socket. If <code>port</code> and <code>host</code> are given, then the socket will be opened as a TCP socket, if <code>host</code> is omitted, <code>localhost</code> will be assumed. If a <code>path</code> is given, the socket will be opened as a unix socket to that path.</p>
<p>Normally this method is not needed, as <code>net.createConnection</code> opens the socket. Use this only if you are implementing a custom Socket.</p>
<p>This function is asynchronous. When the <a href="#net_event_connect">'connect'</a> event is emitted the socket is established. If there is a problem connecting, the <code>'connect'</code> event will not be emitted, the <code>'error'</code> event will be emitted with the exception.</p>
<p>The <code>connectListener</code> parameter will be added as an listener for the <a href="#net_event_connect">'connect'</a> event.</p>
<h3>socket.bufferSize<a id="all_socket_buffersize" class="mark" href="#all_socket_buffersize">#</a></h3>
<p><code>net.Socket</code> has the property that <code>socket.write()</code> always works. This is to help users get up and running quickly. The computer cannot always keep up with the amount of data that is written to a socket - the network connection simply might be too slow. Node will internally queue up the data written to a socket and send it out over the wire when it is possible. (Internally it is polling on the socket's file descriptor for being writable).</p>
<p>The consequence of this internal buffering is that memory may grow. This property shows the number of characters currently buffered to be written. (Number of characters is approximately equal to the number of bytes to be written, but the buffer may contain strings, and the strings are lazily encoded, so the exact number of bytes is not known.)</p>
<p>Users who experience large or growing <code>bufferSize</code> should attempt to "throttle" the data flows in their program with <code>pause()</code> and <code>resume()</code>.</p>
<h3>socket.setEncoding([encoding])<a id="all_socket_setencoding_encoding" class="mark" href="#all_socket_setencoding_encoding">#</a></h3>
<p>Set the encoding for the socket as a Readable Stream. See <a href="https://nodejs.org/api/stream.html#stream_stream_setencoding_encoding">stream.setEncoding()</a> for more information.</p>
<h3>socket.write(data[, encoding][, callback])<a id="all_socket_write_data_encoding_callback" class="mark" href="#all_socket_write_data_encoding_callback">#</a></h3>
<p>Sends data on the socket. The second parameter specifies the encoding in the case of a string--it defaults to UTF8 encoding.</p>
<p>Returns <code>true</code> if the entire data was flushed successfully to the kernel buffer. Returns <code>false</code> if all or part of the data was queued in user memory. <code>'drain'</code> will be emitted when the buffer is again free.</p>
<p>The optional <code>callback</code> parameter will be executed when the data is finally written out - this may not be immediately.</p>
<h3>socket.end([data][, encoding])<a id="all_socket_end_data_encoding" class="mark" href="#all_socket_end_data_encoding">#</a></h3>
<p>Half-closes the socket. i.e., it sends a FIN packet. It is possible the server will still send some data.</p>
<p>If <code>data</code> is specified, it is equivalent to calling <code>socket.write(data, encoding)</code> followed by <code>socket.end()</code>.</p>
<h3>socket.destroy()<a id="all_socket_destroy" class="mark" href="#all_socket_destroy">#</a></h3>
<p>Ensures that no more I/O activity happens on this socket. Only necessary in case of errors (parse error or so).</p>
<h3>socket.pause()<a id="all_socket_pause" class="mark" href="#all_socket_pause">#</a></h3>
<p>Pauses the reading of data. That is, <code>'data'</code> events will not be emitted. Useful to throttle back an upload.</p>
<h3>socket.resume()<a id="all_socket_resume" class="mark" href="#all_socket_resume">#</a></h3>
<p>Resumes reading after a call to <code>pause()</code>.</p>
<h3>socket.setTimeout(timeout[, callback])<a id="all_socket_settimeout_timeout_callback" class="mark" href="#all_socket_settimeout_timeout_callback">#</a></h3>
<p>Sets the socket to timeout after <code>timeout</code> milliseconds of inactivity on the socket. By default <code>net.Socket</code> do not have a timeout.</p>
<p>When an idle timeout is triggered the socket will receive a <code>'timeout'</code> event but the connection will not be severed. The user must manually <code>end()</code> or <code>destroy()</code> the socket.</p>
<p>If <code>timeout</code> is 0, then the existing idle timeout is disabled.</p>
<p>The optional <code>callback</code> parameter will be added as a one time listener for the <code>'timeout'</code> event.</p>
<h3>socket.setNoDelay([noDelay])<a id="all_socket_setnodelay_nodelay" class="mark" href="#all_socket_setnodelay_nodelay">#</a></h3>
<p>Disables the Nagle algorithm. By default TCP connections use the Nagle algorithm, they buffer data before sending it off. Setting <code>true</code> for <code>noDelay</code> will immediately fire off data each time <code>socket.write()</code> is called. <code>noDelay</code> defaults to <code>true</code>.</p>
<h3>socket.setKeepAlive([enable][, initialDelay])<a id="all_socket_setkeepalive_enable_initialdelay" class="mark" href="#all_socket_setkeepalive_enable_initialdelay">#</a></h3>
<p>Enable/disable keep-alive functionality, and optionally set the initial delay before the first keepalive probe is sent on an idle socket. <code>enable</code> defaults to <code>false</code>.</p>
<p>Set <code>initialDelay</code> (in milliseconds) to set the delay between the last data packet received and the first keepalive probe. Setting 0 for initialDelay will leave the value unchanged from the default (or previous) setting. Defaults to <code>0</code>.</p>
<h3>socket.address()<a id="all_socket_address" class="mark" href="#all_socket_address">#</a></h3>
<p>Returns the bound address, the address family name and port of the socket as reported by the operating system. Returns an object with three properties, e.g. <code>{ port: 12346, family: 'IPv4', address: '127.0.0.1' }</code></p>
<h3>socket.unref()<a id="all_socket_unref" class="mark" href="#all_socket_unref">#</a></h3>
<p>Calling <code>unref</code> on a socket will allow the program to exit if this is the only active socket in the event system. If the socket is already <code>unref</code>d calling <code>unref</code> again will have no effect.</p>
<h3>socket.ref()<a id="all_socket_ref" class="mark" href="#all_socket_ref">#</a></h3>
<p>Opposite of <code>unref</code>, calling <code>ref</code> on a previously <code>unref</code>d socket will <em>not</em> let the program exit if it's the only socket left (the default behavior). If the socket is <code>ref</code>d calling <code>ref</code> again will have no effect.</p>
<h3>socket.remoteAddress<a id="all_socket_remoteaddress" class="mark" href="#all_socket_remoteaddress">#</a></h3>
<p>The string representation of the remote IP address. For example, <code>'74.125.127.100'</code> or <code>'2001:4860:a005::68'</code>.</p>
<h3>socket.remoteFamily<a id="all_socket_remotefamily" class="mark" href="#all_socket_remotefamily">#</a></h3>
<p>The string representation of the remote IP family. <code>'IPv4'</code> or <code>'IPv6'</code>.</p>
<h3>socket.remotePort<a id="all_socket_remoteport" class="mark" href="#all_socket_remoteport">#</a></h3>
<p>The numeric representation of the remote port. For example, <code>80</code> or <code>21</code>.</p>
<h3>socket.localAddress<a id="all_socket_localaddress" class="mark" href="#all_socket_localaddress">#</a></h3>
<p>The string representation of the local IP address the remote client is connecting on. For example, if you are listening on <code>'0.0.0.0'</code> and the client connects on <code>'192.168.1.1'</code>, the value would be <code>'192.168.1.1'</code>.</p>
<h3>socket.localPort<a id="all_socket_localport" class="mark" href="#all_socket_localport">#</a></h3>
<p>The numeric representation of the local port. For example, <code>80</code> or <code>21</code>.</p>
<h3>socket.bytesRead<a id="all_socket_bytesread" class="mark" href="#all_socket_bytesread">#</a></h3>
<p>The amount of received bytes.</p>
<h3>socket.bytesWritten<a id="all_socket_byteswritten" class="mark" href="#all_socket_byteswritten">#</a></h3>
<p>The amount of bytes sent.</p>
<p><code>net.Socket</code> instances are <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a> with the following events:</p>
<h3>Event: 'lookup'<a id="all_event_lookup" class="mark" href="#all_event_lookup">#</a></h3>
<p>Emitted after resolving the hostname but before connecting. Not applicable to UNIX sockets.</p>
<ul>
<li><code>err</code> {Error | Null} The error object. See <a href="https://nodejs.org/api/dns.html#dns_dns_lookup_domain_family_callback">dns.lookup()</a>.</li>
<li><code>address</code> {String} The IP address.</li>
<li><code>family</code> {String | Null} The address type. See <a href="https://nodejs.org/api/dns.html#dns_dns_lookup_domain_family_callback">dns.lookup()</a>.</li>
</ul>
<h3>Event: 'connect'<a id="all_event_connect" class="mark" href="#all_event_connect">#</a></h3>
<p>Emitted when a socket connection is successfully established. See <code>connect()</code>.</p>
<h3>Event: 'data'<a id="all_event_data_1" class="mark" href="#all_event_data_1">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Buffer object</span></li>
</ul>
</div>
<p>Emitted when data is received. The argument <code>data</code> will be a <code>Buffer</code> or <code>String</code>. Encoding of data is set by <code>socket.setEncoding()</code>. (See the <a href="https://nodejs.org/api/stream.html#stream_class_stream_readable">Readable Stream</a> section for more information.)</p>
<p>Note that the <strong>data will be lost</strong> if there is no listener when a <code>Socket</code> emits a <code>'data'</code> event.</p>
<h3>Event: 'end'<a id="all_event_end_1" class="mark" href="#all_event_end_1">#</a></h3>
<p>Emitted when the other end of the socket sends a FIN packet.</p>
<p>By default (<code>allowHalfOpen == false</code>) the socket will destroy its file descriptor once it has written out its pending write queue. However, by setting <code>allowHalfOpen == true</code> the socket will not automatically <code>end()</code> its side allowing the user to write arbitrary amounts of data, with the caveat that the user is required to <code>end()</code> their side now.</p>
<h3>Event: 'timeout'<a id="all_event_timeout" class="mark" href="#all_event_timeout">#</a></h3>
<p>Emitted if the socket times out from inactivity. This is only to notify that the socket has been idle. The user must manually close the connection.</p>
<p>See also: <code>socket.setTimeout()</code></p>
<h3>Event: 'drain'<a id="all_event_drain_1" class="mark" href="#all_event_drain_1">#</a></h3>
<p>Emitted when the write buffer becomes empty. Can be used to throttle uploads.</p>
<p>See also: the return values of <code>socket.write()</code></p>
<h3>Event: 'error'<a id="all_event_error_4" class="mark" href="#all_event_error_4">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Error object</span></li>
</ul>
</div>
<p>Emitted when an error occurs. The <code>'close'</code> event will be called directly following this event.</p>
<h3>Event: 'close'<a id="all_event_close_2" class="mark" href="#all_event_close_2">#</a></h3>
<div class="signature">
<ul>
<li><code>had_error</code> <span class="type">Boolean</span> true if the socket had a transmission error</li>
</ul>
</div>
<p>Emitted once the socket is fully closed. The argument <code>had_error</code> is a boolean which says if the socket was closed due to a transmission error.</p>
<h2>net.isIP(input)<a id="all_net_isip_input" class="mark" href="#all_net_isip_input">#</a></h2>
<p>Tests if input is an IP address. Returns 0 for invalid strings, returns 4 for IP version 4 addresses, and returns 6 for IP version 6 addresses.</p>
<h2>net.isIPv4(input)<a id="all_net_isipv4_input" class="mark" href="#all_net_isipv4_input">#</a></h2>
<p>Returns true if input is a version 4 IP address, otherwise returns false.</p>
<h2>net.isIPv6(input)<a id="all_net_isipv6_input" class="mark" href="#all_net_isipv6_input">#</a></h2>
<p>Returns true if input is a version 6 IP address, otherwise returns false.</p>
<h1>UDP / Datagram Sockets<a id="all_udp_datagram_sockets" class="mark" href="#all_udp_datagram_sockets">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>Datagram sockets are available through <code>require('dgram')</code>.</p>
<p>Important note: the behavior of <code>dgram.Socket#bind()</code> has changed in v0.10 and is always asynchronous now. If you have code that looks like this:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> s <span class="sh_symbol">=</span> dgram<span class="sh_symbol">.</span><span class="sh_function">createSocket</span><span class="sh_symbol">(</span><span class="sh_string">'udp4'</span><span class="sh_symbol">);</span>
s<span class="sh_symbol">.</span><span class="sh_function">bind</span><span class="sh_symbol">(</span><span class="sh_number">1234</span><span class="sh_symbol">);</span>
s<span class="sh_symbol">.</span><span class="sh_function">addMembership</span><span class="sh_symbol">(</span><span class="sh_string">'224.0.0.114'</span><span class="sh_symbol">);</span></code></pre>
<p>You have to change it to this:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> s <span class="sh_symbol">=</span> dgram<span class="sh_symbol">.</span><span class="sh_function">createSocket</span><span class="sh_symbol">(</span><span class="sh_string">'udp4'</span><span class="sh_symbol">);</span>
s<span class="sh_symbol">.</span><span class="sh_function">bind</span><span class="sh_symbol">(</span><span class="sh_number">1234</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  s<span class="sh_symbol">.</span><span class="sh_function">addMembership</span><span class="sh_symbol">(</span><span class="sh_string">'224.0.0.114'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>dgram.createSocket(type[, callback])<a id="all_dgram_createsocket_type_callback" class="mark" href="#all_dgram_createsocket_type_callback">#</a></h2>
<div class="signature">
<ul>
<li><code>type</code> String. Either 'udp4' or 'udp6'</li>
<li><code>callback</code> Function. Attached as a listener to <code>message</code> events. Optional</li>
<li>Returns: Socket object</li>
</ul>
</div>
<p>Creates a datagram Socket of the specified types. Valid types are <code>udp4</code> and <code>udp6</code>.</p>
<p>Takes an optional callback which is added as a listener for <code>message</code> events.</p>
<p>Call <code>socket.bind()</code> if you want to receive datagrams. <code>socket.bind()</code> will bind to the "all interfaces" address on a random port (it does the right thing for both <code>udp4</code> and <code>udp6</code> sockets). You can then retrieve the address and port with <code>socket.address().address</code> and <code>socket.address().port</code>.</p>
<h2>dgram.createSocket(options[, callback])<a id="all_dgram_createsocket_options_callback" class="mark" href="#all_dgram_createsocket_options_callback">#</a></h2>
<div class="signature">
<ul>
<li><code>options</code> Object</li>
<li><code>callback</code> Function. Attached as a listener to <code>message</code> events.</li>
<li>Returns: Socket object</li>
</ul>
</div>
<p>The <code>options</code> object should contain a <code>type</code> field of either <code>udp4</code> or <code>udp6</code> and an optional boolean <code>reuseAddr</code> field.</p>
<p>When <code>reuseAddr</code> is true <code>socket.bind()</code> will reuse the address, even if another process has already bound a socket on it. <code>reuseAddr</code> defaults to <code>false</code>.</p>
<p>Takes an optional callback which is added as a listener for <code>message</code> events.</p>
<p>Call <code>socket.bind()</code> if you want to receive datagrams. <code>socket.bind()</code> will bind to the "all interfaces" address on a random port (it does the right thing for both <code>udp4</code> and <code>udp6</code> sockets). You can then retrieve the address and port with <code>socket.address().address</code> and <code>socket.address().port</code>.</p>
<h2>Class: dgram.Socket<a id="all_class_dgram_socket" class="mark" href="#all_class_dgram_socket">#</a></h2>
<p>The dgram Socket class encapsulates the datagram functionality. It should be created via <code>dgram.createSocket(...)</code></p>
<h3>Event: 'message'<a id="all_event_message" class="mark" href="#all_event_message">#</a></h3>
<div class="signature">
<ul>
<li><code>msg</code> Buffer object. The message</li>
<li><code>rinfo</code> Object. Remote address information</li>
</ul>
</div>
<p>Emitted when a new datagram is available on a socket. <code>msg</code> is a <code>Buffer</code> and <code>rinfo</code> is an object with the sender's address information:</p>
<pre class="sh_sourceCode"><code>socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'message'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>msg<span class="sh_symbol">,</span> rinfo<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Received %d bytes from %s:%d</span><span class="sh_specialchar">\n</span><span class="sh_string">'</span><span class="sh_symbol">,</span>
              msg<span class="sh_symbol">.</span>length<span class="sh_symbol">,</span> rinfo<span class="sh_symbol">.</span>address<span class="sh_symbol">,</span> rinfo<span class="sh_symbol">.</span>port<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'listening'<a id="all_event_listening_1" class="mark" href="#all_event_listening_1">#</a></h3>
<p>Emitted when a socket starts listening for datagrams. This happens as soon as UDP sockets are created.</p>
<h3>Event: 'close'<a id="all_event_close_3" class="mark" href="#all_event_close_3">#</a></h3>
<p>Emitted when a socket is closed with <code>close()</code>. No new <code>message</code> events will be emitted on this socket.</p>
<h3>Event: 'error'<a id="all_event_error_5" class="mark" href="#all_event_error_5">#</a></h3>
<div class="signature">
<ul>
<li><code>exception</code> Error object</li>
</ul>
</div>
<p>Emitted when an error occurs.</p>
<h3>socket.send(buf, offset, length, port, address[, callback])<a id="all_socket_send_buf_offset_length_port_address_callback" class="mark" href="#all_socket_send_buf_offset_length_port_address_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>buf</code> Buffer object or string. Message to be sent</li>
<li><code>offset</code> Integer. Offset in the buffer where the message starts.</li>
<li><code>length</code> Integer. Number of bytes in the message.</li>
<li><code>port</code> Integer. Destination port.</li>
<li><code>address</code> String. Destination hostname or IP address.</li>
<li><code>callback</code> Function. Called when the message has been sent. Optional.</li>
</ul>
</div>
<p>For UDP sockets, the destination port and address must be specified. A string may be supplied for the <code>address</code> parameter, and it will be resolved with DNS.</p>
<p>If the address is omitted or is an empty string, <code>'0.0.0.0'</code> or <code>'::0'</code> is used instead. Depending on the network configuration, those defaults may or may not work; it's best to be explicit about the destination address.</p>
<p>If the socket has not been previously bound with a call to <code>bind</code>, it gets assigned a random port number and is bound to the "all interfaces" address (<code>'0.0.0.0'</code> for <code>udp4</code> sockets, <code>'::0'</code> for <code>udp6</code> sockets.)</p>
<p>An optional callback may be specified to detect DNS errors or for determining when it's safe to reuse the <code>buf</code> object. Note that DNS lookups delay the time to send for at least one tick. The only way to know for sure that the datagram has been sent is by using a callback.</p>
<p>With consideration for multi-byte characters, <code>offset</code> and <code>length</code> will be calculated with respect to <a href="https://nodejs.org/api/buffer.html#buffer_class_method_buffer_bytelength_string_encoding">byte length</a> and not the character position.</p>
<p>Example of sending a UDP packet to a random port on <code>localhost</code>;</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> dgram <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'dgram'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> message <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_string">"Some bytes"</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> client <span class="sh_symbol">=</span> dgram<span class="sh_symbol">.</span><span class="sh_function">createSocket</span><span class="sh_symbol">(</span><span class="sh_string">"udp4"</span><span class="sh_symbol">);</span>
client<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span>message<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> message<span class="sh_symbol">.</span>length<span class="sh_symbol">,</span> <span class="sh_number">41234</span><span class="sh_symbol">,</span> <span class="sh_string">"localhost"</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  client<span class="sh_symbol">.</span><span class="sh_function">close</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p><strong>A Note about UDP datagram size</strong></p>
<p>The maximum size of an <code>IPv4/v6</code> datagram depends on the <code>MTU</code> (<em>Maximum Transmission Unit</em>) and on the <code>Payload Length</code> field size.</p>
<ul>
<li>
<p>The <code>Payload Length</code> field is <code>16 bits</code> wide, which means that a normal payload cannot be larger than 64K octets including internet header and data (65,507 bytes = 65,535 &minus; 8 bytes UDP header &minus; 20 bytes IP header); this is generally true for loopback interfaces, but such long datagrams are impractical for most hosts and networks.</p>
</li>
<li>
<p>The <code>MTU</code> is the largest size a given link layer technology can support for datagrams. For any link, <code>IPv4</code> mandates a minimum <code>MTU</code> of <code>68</code> octets, while the recommended <code>MTU</code> for IPv4 is <code>576</code> (typically recommended as the <code>MTU</code> for dial-up type applications), whether they arrive whole or in fragments.</p>
<p>For <code>IPv6</code>, the minimum <code>MTU</code> is <code>1280</code> octets, however, the mandatory minimum fragment reassembly buffer size is <code>1500</code> octets. The value of <code>68</code> octets is very small, since most current link layer technologies have a minimum <code>MTU</code> of <code>1500</code> (like Ethernet).</p>
</li>
</ul>
<p>Note that it's impossible to know in advance the MTU of each link through which a packet might travel, and that generally sending a datagram greater than the (receiver) <code>MTU</code> won't work (the packet gets silently dropped, without informing the source that the data did not reach its intended recipient).</p>
<h3>socket.bind(port[, address][, callback])<a id="all_socket_bind_port_address_callback" class="mark" href="#all_socket_bind_port_address_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>port</code> Integer</li>
<li><code>address</code> String, Optional</li>
<li><code>callback</code> Function with no parameters, Optional. Callback when binding is done.</li>
</ul>
</div>
<p>For UDP sockets, listen for datagrams on a named <code>port</code> and optional <code>address</code>. If <code>address</code> is not specified, the OS will try to listen on all addresses. After binding is done, a "listening" event is emitted and the <code>callback</code>(if specified) is called. Specifying both a "listening" event listener and <code>callback</code> is not harmful but not very useful.</p>
<p>A bound datagram socket keeps the node process running to receive datagrams.</p>
<p>If binding fails, an "error" event is generated. In rare case (e.g. binding a closed socket), an <code>Error</code> may be thrown by this method.</p>
<p>Example of a UDP server listening on port 41234:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> dgram <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">"dgram"</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> dgram<span class="sh_symbol">.</span><span class="sh_function">createSocket</span><span class="sh_symbol">(</span><span class="sh_string">"udp4"</span><span class="sh_symbol">);</span>

server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">"error"</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"server error:</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span> <span class="sh_symbol">+</span> err<span class="sh_symbol">.</span>stack<span class="sh_symbol">);</span>
  server<span class="sh_symbol">.</span><span class="sh_function">close</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">"message"</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>msg<span class="sh_symbol">,</span> rinfo<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"server got: "</span> <span class="sh_symbol">+</span> msg <span class="sh_symbol">+</span> <span class="sh_string">" from "</span> <span class="sh_symbol">+</span>
    rinfo<span class="sh_symbol">.</span>address <span class="sh_symbol">+</span> <span class="sh_string">":"</span> <span class="sh_symbol">+</span> rinfo<span class="sh_symbol">.</span>port<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">"listening"</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> address <span class="sh_symbol">=</span> server<span class="sh_symbol">.</span><span class="sh_function">address</span><span class="sh_symbol">();</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"server listening "</span> <span class="sh_symbol">+</span>
      address<span class="sh_symbol">.</span>address <span class="sh_symbol">+</span> <span class="sh_string">":"</span> <span class="sh_symbol">+</span> address<span class="sh_symbol">.</span>port<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

server<span class="sh_symbol">.</span><span class="sh_function">bind</span><span class="sh_symbol">(</span><span class="sh_number">41234</span><span class="sh_symbol">);</span>
<span class="sh_comment">// server listening 0.0.0.0:41234</span></code></pre>
<h3>socket.bind(options[, callback])<a id="all_socket_bind_options_callback" class="mark" href="#all_socket_bind_options_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>options</code> <span class="type">Object</span> - Required. Supports the following properties:
<ul>
<li><code>port</code> <span class="type">Number</span> - Required.</li>
<li><code>address</code> <span class="type">String</span> - Optional.</li>
<li><code>exclusive</code> <span class="type">Boolean</span> - Optional.</li>
</ul>
</li>
<li><code>callback</code> <span class="type">Function</span> - Optional.</li>
</ul>
</div>
<p>The <code>port</code> and <code>address</code> properties of <code>options</code>, as well as the optional callback function, behave as they do on a call to <a href="#dgram_socket_bind_port_address_callback">socket.bind(port, [address], [callback]) </a>.</p>
<p>If <code>exclusive</code> is <code>false</code> (default), then cluster workers will use the same underlying handle, allowing connection handling duties to be shared. When <code>exclusive</code> is <code>true</code>, the handle is not shared, and attempted port sharing results in an error. An example which listens on an exclusive port is shown below.</p>
<pre class="sh_sourceCode"><code>socket<span class="sh_symbol">.</span><span class="sh_function">bind</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  address<span class="sh_symbol">:</span> <span class="sh_string">'localhost'</span><span class="sh_symbol">,</span>
  port<span class="sh_symbol">:</span> <span class="sh_number">8000</span><span class="sh_symbol">,</span>
  exclusive<span class="sh_symbol">:</span> <span class="sh_keyword">true</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>socket.close()<a id="all_socket_close" class="mark" href="#all_socket_close">#</a></h3>
<p>Close the underlying socket and stop listening for data on it.</p>
<h3>socket.address()<a id="all_socket_address_1" class="mark" href="#all_socket_address_1">#</a></h3>
<p>Returns an object containing the address information for a socket. For UDP sockets, this object will contain <code>address</code> , <code>family</code> and <code>port</code>.</p>
<h3>socket.setBroadcast(flag)<a id="all_socket_setbroadcast_flag" class="mark" href="#all_socket_setbroadcast_flag">#</a></h3>
<div class="signature">
<ul>
<li><code>flag</code> Boolean</li>
</ul>
</div>
<p>Sets or clears the <code>SO_BROADCAST</code> socket option. When this option is set, UDP packets may be sent to a local interface's broadcast address.</p>
<h3>socket.setTTL(ttl)<a id="all_socket_setttl_ttl" class="mark" href="#all_socket_setttl_ttl">#</a></h3>
<div class="signature">
<ul>
<li><code>ttl</code> Integer</li>
</ul>
</div>
<p>Sets the <code>IP_TTL</code> socket option. TTL stands for "Time to Live," but in this context it specifies the number of IP hops that a packet is allowed to go through. Each router or gateway that forwards a packet decrements the TTL. If the TTL is decremented to 0 by a router, it will not be forwarded. Changing TTL values is typically done for network probes or when multicasting.</p>
<p>The argument to <code>setTTL()</code> is a number of hops between 1 and 255. The default on most systems is 64.</p>
<h3>socket.setMulticastTTL(ttl)<a id="all_socket_setmulticastttl_ttl" class="mark" href="#all_socket_setmulticastttl_ttl">#</a></h3>
<div class="signature">
<ul>
<li><code>ttl</code> Integer</li>
</ul>
</div>
<p>Sets the <code>IP_MULTICAST_TTL</code> socket option. TTL stands for "Time to Live," but in this context it specifies the number of IP hops that a packet is allowed to go through, specifically for multicast traffic. Each router or gateway that forwards a packet decrements the TTL. If the TTL is decremented to 0 by a router, it will not be forwarded.</p>
<p>The argument to <code>setMulticastTTL()</code> is a number of hops between 0 and 255. The default on most systems is 1.</p>
<h3>socket.setMulticastLoopback(flag)<a id="all_socket_setmulticastloopback_flag" class="mark" href="#all_socket_setmulticastloopback_flag">#</a></h3>
<div class="signature">
<ul>
<li><code>flag</code> Boolean</li>
</ul>
</div>
<p>Sets or clears the <code>IP_MULTICAST_LOOP</code> socket option. When this option is set, multicast packets will also be received on the local interface.</p>
<h3>socket.addMembership(multicastAddress[, multicastInterface])<a id="all_socket_addmembership_multicastaddress_multicastinterface" class="mark" href="#all_socket_addmembership_multicastaddress_multicastinterface">#</a></h3>
<div class="signature">
<ul>
<li><code>multicastAddress</code> String</li>
<li><code>multicastInterface</code> String, Optional</li>
</ul>
</div>
<p>Tells the kernel to join a multicast group with <code>IP_ADD_MEMBERSHIP</code> socket option.</p>
<p>If <code>multicastInterface</code> is not specified, the OS will try to add membership to all valid interfaces.</p>
<h3>socket.dropMembership(multicastAddress[, multicastInterface])<a id="all_socket_dropmembership_multicastaddress_multicastinterface" class="mark" href="#all_socket_dropmembership_multicastaddress_multicastinterface">#</a></h3>
<div class="signature">
<ul>
<li><code>multicastAddress</code> String</li>
<li><code>multicastInterface</code> String, Optional</li>
</ul>
</div>
<p>Opposite of <code>addMembership</code> - tells the kernel to leave a multicast group with <code>IP_DROP_MEMBERSHIP</code> socket option. This is automatically called by the kernel when the socket is closed or process terminates, so most apps will never need to call this.</p>
<p>If <code>multicastInterface</code> is not specified, the OS will try to drop membership to all valid interfaces.</p>
<h3>socket.unref()<a id="all_socket_unref_1" class="mark" href="#all_socket_unref_1">#</a></h3>
<p>Calling <code>unref</code> on a socket will allow the program to exit if this is the only active socket in the event system. If the socket is already <code>unref</code>d calling <code>unref</code> again will have no effect.</p>
<h3>socket.ref()<a id="all_socket_ref_1" class="mark" href="#all_socket_ref_1">#</a></h3>
<p>Opposite of <code>unref</code>, calling <code>ref</code> on a previously <code>unref</code>d socket will <em>not</em> let the program exit if it's the only socket left (the default behavior). If the socket is <code>ref</code>d calling <code>ref</code> again will have no effect.</p>
<h1>DNS<a id="all_dns" class="mark" href="#all_dns">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>Use <code>require('dns')</code> to access this module.</p>
<p>This module contains functions that belong to two different categories:</p>
<p>1) Functions that use the underlying operating system facilities to perform name resolution, and that do not necessarily do any network communication. This category contains only one function: <code>dns.lookup</code>. <strong>Developers looking to perform name resolution in the same way that other applications on the same operating system behave should use <code>dns.lookup</code>.</strong></p>
<p>Here is an example that does a lookup of <code>www.google.com</code>.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> dns <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'dns'</span><span class="sh_symbol">);</span>

dns<span class="sh_symbol">.</span><span class="sh_function">lookup</span><span class="sh_symbol">(</span><span class="sh_string">'www.google.com'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_function">onLookup</span><span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> addresses<span class="sh_symbol">,</span> family<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'addresses:'</span><span class="sh_symbol">,</span> addresses<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>2) Functions that connect to an actual DNS server to perform name resolution, and that <em>always</em> use the network to perform DNS queries. This category contains all functions in the <code>dns</code> module but <code>dns.lookup</code>. These functions do not use the same set of configuration files than what <code>dns.lookup</code> uses. For instance, <em>they do not use the configuration from <code>/etc/hosts</code></em>. These functions should be used by developers who do not want to use the underlying operating system's facilities for name resolution, and instead want to <em>always</em> perform DNS queries.</p>
<p>Here is an example which resolves <code>'www.google.com'</code> then reverse resolves the IP addresses which are returned.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> dns <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'dns'</span><span class="sh_symbol">);</span>

dns<span class="sh_symbol">.</span><span class="sh_function">resolve4</span><span class="sh_symbol">(</span><span class="sh_string">'www.google.com'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> addresses<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>

  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'addresses: '</span> <span class="sh_symbol">+</span> JSON<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span>addresses<span class="sh_symbol">));</span>

  addresses<span class="sh_symbol">.</span><span class="sh_function">forEach</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>a<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    dns<span class="sh_symbol">.</span><span class="sh_function">reverse</span><span class="sh_symbol">(</span>a<span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> hostnames<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">throw</span> err<span class="sh_symbol">;</span>
      <span class="sh_cbracket">}</span>

      console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'reverse for '</span> <span class="sh_symbol">+</span> a <span class="sh_symbol">+</span> <span class="sh_string">': '</span> <span class="sh_symbol">+</span> JSON<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span>hostnames<span class="sh_symbol">));</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>There are subtle consequences in choosing one or another, please consult the <a href="#dns_implementation_considerations">Implementation considerations section</a> for more information.</p>
<h2>dns.lookup(hostname[, options], callback)<a id="all_dns_lookup_hostname_options_callback" class="mark" href="#all_dns_lookup_hostname_options_callback">#</a></h2>
<p>Resolves a hostname (e.g. <code>'google.com'</code>) into the first found A (IPv4) or AAAA (IPv6) record. <code>options</code> can be an object or integer. If <code>options</code> is not provided, then IP v4 and v6 addresses are both valid. If <code>options</code> is an integer, then it must be <code>4</code> or <code>6</code>.</p>
<p>Alternatively, <code>options</code> can be an object containing two properties, <code>family</code> and <code>hints</code>. Both properties are optional. If <code>family</code> is provided, it must be the integer <code>4</code> or <code>6</code>. If <code>family</code> is not provided then IP v4 and v6 addresses are accepted. The <code>hints</code> field, if present, should be one or more of the supported <code>getaddrinfo</code> flags. If <code>hints</code> is not provided, then no flags are passed to <code>getaddrinfo</code>. Multiple flags can be passed through <code>hints</code> by logically <code>OR</code>ing their values. An example usage of <code>options</code> is shown below.</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span>
  family<span class="sh_symbol">:</span> <span class="sh_number">4</span><span class="sh_symbol">,</span>
  hints<span class="sh_symbol">:</span> dns<span class="sh_symbol">.</span>ADDRCONFIG <span class="sh_symbol">|</span> dns<span class="sh_symbol">.</span>V4MAPPED
<span class="sh_cbracket">}</span></code></pre>
<p>See <a href="#dns_supported_getaddrinfo_flags">supported <code>getaddrinfo</code> flags</a> below for more information on supported flags.</p>
<p>The callback has arguments <code>(err, address, family)</code>. The <code>address</code> argument is a string representation of a IP v4 or v6 address. The <code>family</code> argument is either the integer 4 or 6 and denotes the family of <code>address</code> (not necessarily the value initially passed to <code>lookup</code>).</p>
<p>On error, <code>err</code> is an <code>Error</code> object, where <code>err.code</code> is the error code. Keep in mind that <code>err.code</code> will be set to <code>'ENOENT'</code> not only when the hostname does not exist but also when the lookup fails in other ways such as no available file descriptors.</p>
<p><code>dns.lookup</code> doesn't necessarily have anything to do with the DNS protocol. It's only an operating system facility that can associate name with addresses, and vice versa.</p>
<p>Its implementation can have subtle but important consequences on the behavior of any Node.js program. Please take some time to consult the <a href="#dns_implementation_considerations">Implementation considerations section</a> before using it.</p>
<h1>dns.lookupService(address, port, callback)<a id="all_dns_lookupservice_address_port_callback" class="mark" href="#all_dns_lookupservice_address_port_callback">#</a></h1>
<p>Resolves the given address and port into a hostname and service using <code>getnameinfo</code>.</p>
<p>The callback has arguments <code>(err, hostname, service)</code>. The <code>hostname</code> and <code>service</code> arguments are strings (e.g. <code>'localhost'</code> and <code>'http'</code> respectively).</p>
<p>On error, <code>err</code> is an <code>Error</code> object, where <code>err.code</code> is the error code.</p>
<h2>dns.resolve(hostname[, rrtype], callback)<a id="all_dns_resolve_hostname_rrtype_callback" class="mark" href="#all_dns_resolve_hostname_rrtype_callback">#</a></h2>
<p>Resolves a hostname (e.g. <code>'google.com'</code>) into an array of the record types specified by rrtype.</p>
<p>Valid rrtypes are:</p>
<ul>
<li><code>'A'</code> (IPV4 addresses, default)</li>
<li><code>'AAAA'</code> (IPV6 addresses)</li>
<li><code>'MX'</code> (mail exchange records)</li>
<li><code>'TXT'</code> (text records)</li>
<li><code>'SRV'</code> (SRV records)</li>
<li><code>'PTR'</code> (used for reverse IP lookups)</li>
<li><code>'NS'</code> (name server records)</li>
<li><code>'CNAME'</code> (canonical name records)</li>
<li><code>'SOA'</code> (start of authority record)</li>
</ul>
<p>The callback has arguments <code>(err, addresses)</code>. The type of each item in <code>addresses</code> is determined by the record type, and described in the documentation for the corresponding lookup methods below.</p>
<p>On error, <code>err</code> is an <code>Error</code> object, where <code>err.code</code> is one of the error codes listed below.</p>
<h2>dns.resolve4(hostname, callback)<a id="all_dns_resolve4_hostname_callback" class="mark" href="#all_dns_resolve4_hostname_callback">#</a></h2>
<p>The same as <code>dns.resolve()</code>, but only for IPv4 queries (<code>A</code> records). <code>addresses</code> is an array of IPv4 addresses (e.g. <code>['74.125.79.104', '74.125.79.105', '74.125.79.106']</code>).</p>
<h2>dns.resolve6(hostname, callback)<a id="all_dns_resolve6_hostname_callback" class="mark" href="#all_dns_resolve6_hostname_callback">#</a></h2>
<p>The same as <code>dns.resolve4()</code> except for IPv6 queries (an <code>AAAA</code> query).</p>
<h2>dns.resolveMx(hostname, callback)<a id="all_dns_resolvemx_hostname_callback" class="mark" href="#all_dns_resolvemx_hostname_callback">#</a></h2>
<p>The same as <code>dns.resolve()</code>, but only for mail exchange queries (<code>MX</code> records).</p>
<p><code>addresses</code> is an array of MX records, each with a priority and an exchange attribute (e.g. <code>[{'priority': 10, 'exchange': 'mx.example.com'},...]</code>).</p>
<h2>dns.resolveTxt(hostname, callback)<a id="all_dns_resolvetxt_hostname_callback" class="mark" href="#all_dns_resolvetxt_hostname_callback">#</a></h2>
<p>The same as <code>dns.resolve()</code>, but only for text queries (<code>TXT</code> records). <code>addresses</code> is an 2-d array of the text records available for <code>hostname</code> (e.g., <code>[ ['v=spf1 ip4:0.0.0.0 ', '~all' ] ]</code>). Each sub-array contains TXT chunks of one record. Depending on the use case, the could be either joined together or treated separately.</p>
<h2>dns.resolveSrv(hostname, callback)<a id="all_dns_resolvesrv_hostname_callback" class="mark" href="#all_dns_resolvesrv_hostname_callback">#</a></h2>
<p>The same as <code>dns.resolve()</code>, but only for service records (<code>SRV</code> records). <code>addresses</code> is an array of the SRV records available for <code>hostname</code>. Properties of SRV records are priority, weight, port, and name (e.g., <code>[{'priority': 10, 'weight': 5, 'port': 21223, 'name': 'service.example.com'}, ...]</code>).</p>
<h2>dns.resolveSoa(hostname, callback)<a id="all_dns_resolvesoa_hostname_callback" class="mark" href="#all_dns_resolvesoa_hostname_callback">#</a></h2>
<p>The same as <code>dns.resolve()</code>, but only for start of authority record queries (<code>SOA</code> record).</p>
<p><code>addresses</code> is an object with the following structure:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span>
  nsname<span class="sh_symbol">:</span> <span class="sh_string">'ns.example.com'</span><span class="sh_symbol">,</span>
  hostmaster<span class="sh_symbol">:</span> <span class="sh_string">'root.example.com'</span><span class="sh_symbol">,</span>
  serial<span class="sh_symbol">:</span> <span class="sh_number">2013101809</span><span class="sh_symbol">,</span>
  refresh<span class="sh_symbol">:</span> <span class="sh_number">10000</span><span class="sh_symbol">,</span>
  retry<span class="sh_symbol">:</span> <span class="sh_number">2400</span><span class="sh_symbol">,</span>
  expire<span class="sh_symbol">:</span> <span class="sh_number">604800</span><span class="sh_symbol">,</span>
  minttl<span class="sh_symbol">:</span> <span class="sh_number">3600</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>dns.resolveNs(hostname, callback)<a id="all_dns_resolvens_hostname_callback" class="mark" href="#all_dns_resolvens_hostname_callback">#</a></h2>
<p>The same as <code>dns.resolve()</code>, but only for name server records (<code>NS</code> records). <code>addresses</code> is an array of the name server records available for <code>hostname</code> (e.g., <code>['ns1.example.com', 'ns2.example.com']</code>).</p>
<h2>dns.resolveCname(hostname, callback)<a id="all_dns_resolvecname_hostname_callback" class="mark" href="#all_dns_resolvecname_hostname_callback">#</a></h2>
<p>The same as <code>dns.resolve()</code>, but only for canonical name records (<code>CNAME</code> records). <code>addresses</code> is an array of the canonical name records available for <code>hostname</code> (e.g., <code>['bar.example.com']</code>).</p>
<h2>dns.reverse(ip, callback)<a id="all_dns_reverse_ip_callback" class="mark" href="#all_dns_reverse_ip_callback">#</a></h2>
<p>Reverse resolves an ip address to an array of hostnames.</p>
<p>The callback has arguments <code>(err, hostnames)</code>.</p>
<p>On error, <code>err</code> is an <code>Error</code> object, where <code>err.code</code> is one of the error codes listed below.</p>
<h2>dns.getServers()<a id="all_dns_getservers" class="mark" href="#all_dns_getservers">#</a></h2>
<p>Returns an array of IP addresses as strings that are currently being used for resolution</p>
<h2>dns.setServers(servers)<a id="all_dns_setservers_servers" class="mark" href="#all_dns_setservers_servers">#</a></h2>
<p>Given an array of IP addresses as strings, set them as the servers to use for resolving</p>
<p>If you specify a port with the address it will be stripped, as the underlying library doesn't support that.</p>
<p>This will throw if you pass invalid input.</p>
<h2>Error codes<a id="all_error_codes" class="mark" href="#all_error_codes">#</a></h2>
<p>Each DNS query can return one of the following error codes:</p>
<ul>
<li><code>dns.NODATA</code>: DNS server returned answer with no data.</li>
<li><code>dns.FORMERR</code>: DNS server claims query was misformatted.</li>
<li><code>dns.SERVFAIL</code>: DNS server returned general failure.</li>
<li><code>dns.NOTFOUND</code>: Domain name not found.</li>
<li><code>dns.NOTIMP</code>: DNS server does not implement requested operation.</li>
<li><code>dns.REFUSED</code>: DNS server refused query.</li>
<li><code>dns.BADQUERY</code>: Misformatted DNS query.</li>
<li><code>dns.BADNAME</code>: Misformatted hostname.</li>
<li><code>dns.BADFAMILY</code>: Unsupported address family.</li>
<li><code>dns.BADRESP</code>: Misformatted DNS reply.</li>
<li><code>dns.CONNREFUSED</code>: Could not contact DNS servers.</li>
<li><code>dns.TIMEOUT</code>: Timeout while contacting DNS servers.</li>
<li><code>dns.EOF</code>: End of file.</li>
<li><code>dns.FILE</code>: Error reading file.</li>
<li><code>dns.NOMEM</code>: Out of memory.</li>
<li><code>dns.DESTRUCTION</code>: Channel is being destroyed.</li>
<li><code>dns.BADSTR</code>: Misformatted string.</li>
<li><code>dns.BADFLAGS</code>: Illegal flags specified.</li>
<li><code>dns.NONAME</code>: Given hostname is not numeric.</li>
<li><code>dns.BADHINTS</code>: Illegal hints flags specified.</li>
<li><code>dns.NOTINITIALIZED</code>: c-ares library initialization not yet performed.</li>
<li><code>dns.LOADIPHLPAPI</code>: Error loading iphlpapi.dll.</li>
<li><code>dns.ADDRGETNETWORKPARAMS</code>: Could not find GetNetworkParams function.</li>
<li><code>dns.CANCELLED</code>: DNS query cancelled.</li>
</ul>
<h2>Supported getaddrinfo flags<a id="all_supported_getaddrinfo_flags" class="mark" href="#all_supported_getaddrinfo_flags">#</a></h2>
<p>The following flags can be passed as hints to <code>dns.lookup</code>.</p>
<ul>
<li><code>dns.ADDRCONFIG</code>: Returned address types are determined by the types of addresses supported by the current system. For example, IPv4 addresses are only returned if the current system has at least one IPv4 address configured. Loopback addresses are not considered.</li>
<li><code>dns.V4MAPPED</code>: If the IPv6 family was specified, but no IPv6 addresses were found, then return IPv4 mapped IPv6 addresses. Note that it is not supported on some operating systems (e.g FreeBSD 10.1).</li>
</ul>
<h2>Implementation considerations<a id="all_implementation_considerations" class="mark" href="#all_implementation_considerations">#</a></h2>
<p>Although <code>dns.lookup</code> and <code>dns.resolve*/dns.reverse</code> functions have the same goal of associating a network name with a network address (or vice versa), their behavior is quite different. These differences can have subtle but significant consequences on the behavior of Node.js programs.</p>
<h3>dns.lookup<a id="all_dns_lookup" class="mark" href="#all_dns_lookup">#</a></h3>
<p>Under the hood, <code>dns.lookup</code> uses the same operating system facilities as most other programs. For instance, <code>dns.lookup</code> will almost always resolve a given name the same way as the <code>ping</code> command. On most POSIX-like operating systems, the behavior of the <code>dns.lookup</code> function can be tweaked by changing settings in <code>nsswitch.conf(5)</code> and/or <code>resolv.conf(5)</code>, but be careful that changing these files will change the behavior of all other programs running on the same operating system.</p>
<p>Though the call will be asynchronous from JavaScript's perspective, it is implemented as a synchronous call to <code>getaddrinfo(3)</code> that runs on libuv's threadpool. Because libuv's threadpool has a fixed size, it means that if for whatever reason the call to <code>getaddrinfo(3)</code> takes a long time, other operations that could run on libuv's threadpool (such as filesystem operations) will experience degraded performance. In order to mitigate this issue, one potential solution is to increase the size of libuv's threadpool by setting the 'UV_THREADPOOL_SIZE' environment variable to a value greater than 4 (its current default value). For more information on libuv's threadpool, see <a href="http://docs.libuv.org/en/latest/threadpool.html">the official libuv documentation</a>.</p>
<h3>dns.resolve, functions starting with dns.resolve and dns.reverse<a id="all_dns_resolve_functions_starting_with_dns_resolve_and_dns_reverse" class="mark" href="#all_dns_resolve_functions_starting_with_dns_resolve_and_dns_reverse">#</a></h3>
<p>These functions are implemented quite differently than <code>dns.lookup</code>. They do not use <code>getaddrinfo(3)</code> and they <em>always</em> perform a DNS query on the network. This network communication is always done asynchronously, and does not use libuv's threadpool.</p>
<p>As a result, these functions cannot have the same negative impact on other processing that happens on libuv's threadpool that <code>dns.lookup</code> can have.</p>
<p>They do not use the same set of configuration files than what <code>dns.lookup</code> uses. For instance, <em>they do not use the configuration from <code>/etc/hosts</code></em>.</p>
<h1>HTTP<a id="all_http" class="mark" href="#all_http">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>To use the HTTP server and client one must <code>require('http')</code>.</p>
<p>The HTTP interfaces in Node are designed to support many features of the protocol which have been traditionally difficult to use. In particular, large, possibly chunk-encoded, messages. The interface is careful to never buffer entire requests or responses--the user is able to stream data.</p>
<p>HTTP message headers are represented by an object like this:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> <span class="sh_string">'content-length'</span><span class="sh_symbol">:</span> <span class="sh_string">'123'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'content-type'</span><span class="sh_symbol">:</span> <span class="sh_string">'text/plain'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'connection'</span><span class="sh_symbol">:</span> <span class="sh_string">'keep-alive'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'host'</span><span class="sh_symbol">:</span> <span class="sh_string">'mysite.com'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'accept'</span><span class="sh_symbol">:</span> <span class="sh_string">'*/*'</span> <span class="sh_cbracket">}</span></code></pre>
<p>Keys are lowercased. Values are not modified.</p>
<p>In order to support the full spectrum of possible HTTP applications, Node's HTTP API is very low-level. It deals with stream handling and message parsing only. It parses a message into headers and body but it does not parse the actual headers or the body.</p>
<p>Defined headers that allow multiple values are concatenated with a <code>,</code> character, except for the <code>set-cookie</code> and <code>cookie</code> headers which are represented as an array of values. Headers such as <code>content-length</code> which can only have a single value are parsed accordingly, and only a single value is represented on the parsed object.</p>
<p>The raw headers as they were received are retained in the <code>rawHeaders</code> property, which is an array of <code>[key, value, key2, value2, ...]</code>. For example, the previous message header object might have a <code>rawHeaders</code> list like the following:</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">[</span> <span class="sh_string">'ConTent-Length'</span><span class="sh_symbol">,</span> <span class="sh_string">'123456'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'content-LENGTH'</span><span class="sh_symbol">,</span> <span class="sh_string">'123'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'content-type'</span><span class="sh_symbol">,</span> <span class="sh_string">'text/plain'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'CONNECTION'</span><span class="sh_symbol">,</span> <span class="sh_string">'keep-alive'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'Host'</span><span class="sh_symbol">,</span> <span class="sh_string">'mysite.com'</span><span class="sh_symbol">,</span>
  <span class="sh_string">'accepT'</span><span class="sh_symbol">,</span> <span class="sh_string">'*/*'</span> <span class="sh_symbol">]</span></code></pre>
<h2>http.METHODS<a id="all_http_methods" class="mark" href="#all_http_methods">#</a></h2>
<div class="signature">
<ul>
<li><span class="type">Array</span></li>
</ul>
</div>
<p>A list of the HTTP methods that are supported by the parser.</p>
<h2>http.STATUS_CODES<a id="all_http_status_codes" class="mark" href="#all_http_status_codes">#</a></h2>
<div class="signature">
<ul>
<li><span class="type">Object</span></li>
</ul>
</div>
<p>A collection of all the standard HTTP response status codes, and the short description of each. For example, <code>http.STATUS_CODES[404] === 'Not Found'</code>.</p>
<h2>http.createServer([requestListener])<a id="all_http_createserver_requestlistener" class="mark" href="#all_http_createserver_requestlistener">#</a></h2>
<p>Returns a new instance of <a href="#http_class_http_server">http.Server</a>.</p>
<p>The <code>requestListener</code> is a function which is automatically added to the <code>'request'</code> event.</p>
<h2>http.createClient([port][, host])<a id="all_http_createclient_port_host" class="mark" href="#all_http_createclient_port_host">#</a></h2>
<p>This function is <strong>deprecated</strong>; please use <a href="https://nodejs.org/api/http.html#http_http_request_options_callback">http.request()</a> instead. Constructs a new HTTP client. <code>port</code> and <code>host</code> refer to the server to be connected to.</p>
<h2>Class: http.Server<a id="all_class_http_server" class="mark" href="#all_class_http_server">#</a></h2>
<p>This is an <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a> with the following events:</p>
<h3>Event: 'request'<a id="all_event_request" class="mark" href="#all_event_request">#</a></h3>
<p><code>function (request, response) { }</code></p>
<p>Emitted each time there is a request. Note that there may be multiple requests per connection (in the case of keep-alive connections). <code>request</code> is an instance of <a href="#http_http_incomingmessage">http.IncomingMessage</a> and <code>response</code> is an instance of <a href="#http_class_http_serverresponse">http.ServerResponse</a>.</p>
<h3>Event: 'connection'<a id="all_event_connection_1" class="mark" href="#all_event_connection_1">#</a></h3>
<p><code>function (socket) { }</code></p>
<p>When a new TCP stream is established. <code>socket</code> is an object of type <code>net.Socket</code>. Usually users will not want to access this event. In particular, the socket will not emit <code>readable</code> events because of how the protocol parser attaches to the socket. The <code>socket</code> can also be accessed at <code>request.connection</code>.</p>
<h3>Event: 'close'<a id="all_event_close_4" class="mark" href="#all_event_close_4">#</a></h3>
<p><code>function () { }</code></p>
<p>Emitted when the server closes.</p>
<h3>Event: 'checkContinue'<a id="all_event_checkcontinue" class="mark" href="#all_event_checkcontinue">#</a></h3>
<p><code>function (request, response) { }</code></p>
<p>Emitted each time a request with an http Expect: 100-continue is received. If this event isn't listened for, the server will automatically respond with a 100 Continue as appropriate.</p>
<p>Handling this event involves calling <a href="#http_response_writecontinue">response.writeContinue()</a> if the client should continue to send the request body, or generating an appropriate HTTP response (e.g., 400 Bad Request) if the client should not continue to send the request body.</p>
<p>Note that when this event is emitted and handled, the <code>request</code> event will not be emitted.</p>
<h3>Event: 'connect'<a id="all_event_connect_1" class="mark" href="#all_event_connect_1">#</a></h3>
<p><code>function (request, socket, head) { }</code></p>
<p>Emitted each time a client requests a http CONNECT method. If this event isn't listened for, then clients requesting a CONNECT method will have their connections closed.</p>
<ul>
<li><code>request</code> is the arguments for the http request, as it is in the request event.</li>
<li><code>socket</code> is the network socket between the server and client.</li>
<li><code>head</code> is an instance of Buffer, the first packet of the tunneling stream, this may be empty.</li>
</ul>
<p>After this event is emitted, the request's socket will not have a <code>data</code> event listener, meaning you will need to bind to it in order to handle data sent to the server on that socket.</p>
<h3>Event: 'upgrade'<a id="all_event_upgrade" class="mark" href="#all_event_upgrade">#</a></h3>
<p><code>function (request, socket, head) { }</code></p>
<p>Emitted each time a client requests a http upgrade. If this event isn't listened for, then clients requesting an upgrade will have their connections closed.</p>
<ul>
<li><code>request</code> is the arguments for the http request, as it is in the request event.</li>
<li><code>socket</code> is the network socket between the server and client.</li>
<li><code>head</code> is an instance of Buffer, the first packet of the upgraded stream, this may be empty.</li>
</ul>
<p>After this event is emitted, the request's socket will not have a <code>data</code> event listener, meaning you will need to bind to it in order to handle data sent to the server on that socket.</p>
<h3>Event: 'clientError'<a id="all_event_clienterror_1" class="mark" href="#all_event_clienterror_1">#</a></h3>
<p><code>function (exception, socket) { }</code></p>
<p>If a client connection emits an 'error' event, it will be forwarded here.</p>
<p><code>socket</code> is the <code>net.Socket</code> object that the error originated from.</p>
<h3>server.listen(port[, hostname][, backlog][, callback])<a id="all_server_listen_port_hostname_backlog_callback" class="mark" href="#all_server_listen_port_hostname_backlog_callback">#</a></h3>
<p>Begin accepting connections on the specified port and hostname. If the hostname is omitted, the server will accept connections directed to any IPv4 address (<code>INADDR_ANY</code>).</p>
<p>To listen to a unix socket, supply a filename instead of port and hostname.</p>
<p>Backlog is the maximum length of the queue of pending connections. The actual length will be determined by your OS through sysctl settings such as <code>tcp_max_syn_backlog</code> and <code>somaxconn</code> on linux. The default value of this parameter is 511 (not 512).</p>
<p>This function is asynchronous. The last parameter <code>callback</code> will be added as a listener for the <a href="https://nodejs.org/api/net.html#net_event_listening">'listening'</a> event. See also <a href="https://nodejs.org/api/net.html#net_server_listen_port_host_backlog_callback">net.Server.listen(port)</a>.</p>
<h3>server.listen(path[, callback])<a id="all_server_listen_path_callback_1" class="mark" href="#all_server_listen_path_callback_1">#</a></h3>
<p>Start a UNIX socket server listening for connections on the given <code>path</code>.</p>
<p>This function is asynchronous. The last parameter <code>callback</code> will be added as a listener for the <a href="https://nodejs.org/api/net.html#net_event_listening">'listening'</a> event. See also <a href="https://nodejs.org/api/net.html#net_server_listen_path_callback">net.Server.listen(path)</a>.</p>
<h3>server.listen(handle[, callback])<a id="all_server_listen_handle_callback_1" class="mark" href="#all_server_listen_handle_callback_1">#</a></h3>
<div class="signature">
<ul>
<li><code>handle</code> <span class="type">Object</span></li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>The <code>handle</code> object can be set to either a server or socket (anything with an underlying <code>_handle</code> member), or a <code>{fd: &lt;n&gt;}</code> object.</p>
<p>This will cause the server to accept connections on the specified handle, but it is presumed that the file descriptor or handle has already been bound to a port or domain socket.</p>
<p>Listening on a file descriptor is not supported on Windows.</p>
<p>This function is asynchronous. The last parameter <code>callback</code> will be added as a listener for the <a href="https://nodejs.org/api/net.html#event_listening_">'listening'</a> event. See also <a href="https://nodejs.org/api/net.html#net_server_listen_handle_callback">net.Server.listen()</a>.</p>
<h3>server.close([callback])<a id="all_server_close_callback_1" class="mark" href="#all_server_close_callback_1">#</a></h3>
<p>Stops the server from accepting new connections. See <a href="https://nodejs.org/api/net.html#net_server_close_callback">net.Server.close()</a>.</p>
<h3>server.maxHeadersCount<a id="all_server_maxheaderscount" class="mark" href="#all_server_maxheaderscount">#</a></h3>
<p>Limits maximum incoming headers count, equal to 1000 by default. If set to 0 - no limit will be applied.</p>
<h3>server.setTimeout(msecs, callback)<a id="all_server_settimeout_msecs_callback" class="mark" href="#all_server_settimeout_msecs_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>msecs</code> <span class="type">Number</span></li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Sets the timeout value for sockets, and emits a <code>'timeout'</code> event on the Server object, passing the socket as an argument, if a timeout occurs.</p>
<p>If there is a <code>'timeout'</code> event listener on the Server object, then it will be called with the timed-out socket as an argument.</p>
<p>By default, the Server's timeout value is 2 minutes, and sockets are destroyed automatically if they time out. However, if you assign a callback to the Server's <code>'timeout'</code> event, then you are responsible for handling socket timeouts.</p>
<h3>server.timeout<a id="all_server_timeout" class="mark" href="#all_server_timeout">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Number</span> Default = 120000 (2 minutes)</li>
</ul>
</div>
<p>The number of milliseconds of inactivity before a socket is presumed to have timed out.</p>
<p>Note that the socket timeout logic is set up on connection, so changing this value only affects <em>new</em> connections to the server, not any existing connections.</p>
<p>Set to 0 to disable any kind of automatic timeout behavior on incoming connections.</p>
<h2>Class: http.ServerResponse<a id="all_class_http_serverresponse" class="mark" href="#all_class_http_serverresponse">#</a></h2>
<p>This object is created internally by a HTTP server--not by the user. It is passed as the second parameter to the <code>'request'</code> event.</p>
<p>The response implements the <a href="https://nodejs.org/api/stream.html#stream_class_stream_writable">Writable Stream</a> interface. This is an <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a> with the following events:</p>
<h3>Event: 'close'<a id="all_event_close_5" class="mark" href="#all_event_close_5">#</a></h3>
<p><code>function () { }</code></p>
<p>Indicates that the underlying connection was terminated before <a href="#http_response_end_data_encoding">response.end()</a> was called or able to flush.</p>
<h3>Event: 'finish'<a id="all_event_finish_1" class="mark" href="#all_event_finish_1">#</a></h3>
<p><code>function () { }</code></p>
<p>Emitted when the response has been sent. More specifically, this event is emitted when the last segment of the response headers and body have been handed off to the operating system for transmission over the network. It does not imply that the client has received anything yet.</p>
<p>After this event, no more events will be emitted on the response object.</p>
<h3>response.writeContinue()<a id="all_response_writecontinue" class="mark" href="#all_response_writecontinue">#</a></h3>
<p>Sends a HTTP/1.1 100 Continue message to the client, indicating that the request body should be sent. See the <a href="#http_event_checkcontinue">'checkContinue'</a> event on <code>Server</code>.</p>
<h3>response.writeHead(statusCode[, statusMessage][, headers])<a id="all_response_writehead_statuscode_statusmessage_headers" class="mark" href="#all_response_writehead_statuscode_statusmessage_headers">#</a></h3>
<p>Sends a response header to the request. The status code is a 3-digit HTTP status code, like <code>404</code>. The last argument, <code>headers</code>, are the response headers. Optionally one can give a human-readable <code>statusMessage</code> as the second argument.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> body <span class="sh_symbol">=</span> <span class="sh_string">'hello world'</span><span class="sh_symbol">;</span>
response<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span>
  <span class="sh_string">'Content-Length'</span><span class="sh_symbol">:</span> body<span class="sh_symbol">.</span>length<span class="sh_symbol">,</span>
  <span class="sh_string">'Content-Type'</span><span class="sh_symbol">:</span> <span class="sh_string">'text/plain'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>This method must only be called once on a message and it must be called before <a href="#http_response_end_data_encoding">response.end()</a> is called.</p>
<p>If you call <a href="#http_response_write_chunk_encoding">response.write()</a> or <a href="#http_response_end_data_encoding">response.end()</a> before calling this, the implicit/mutable headers will be calculated and call this function for you.</p>
<p>Note that Content-Length is given in bytes not characters. The above example works because the string <code>'hello world'</code> contains only single byte characters. If the body contains higher coded characters then <code>Buffer.byteLength()</code> should be used to determine the number of bytes in a given encoding. And Node does not check whether Content-Length and the length of the body which has been transmitted are equal or not.</p>
<h3>response.setTimeout(msecs, callback)<a id="all_response_settimeout_msecs_callback" class="mark" href="#all_response_settimeout_msecs_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>msecs</code> <span class="type">Number</span></li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Sets the Socket's timeout value to <code>msecs</code>. If a callback is provided, then it is added as a listener on the <code>'timeout'</code> event on the response object.</p>
<p>If no <code>'timeout'</code> listener is added to the request, the response, or the server, then sockets are destroyed when they time out. If you assign a handler on the request, the response, or the server's <code>'timeout'</code> events, then it is your responsibility to handle timed out sockets.</p>
<h3>response.statusCode<a id="all_response_statuscode" class="mark" href="#all_response_statuscode">#</a></h3>
<p>When using implicit headers (not calling <a href="#http_response_writehead_statuscode_reasonphrase_headers">response.writeHead()</a> explicitly), this property controls the status code that will be sent to the client when the headers get flushed.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>response<span class="sh_symbol">.</span>statusCode <span class="sh_symbol">=</span> <span class="sh_number">404</span><span class="sh_symbol">;</span></code></pre>
<p>After response header was sent to the client, this property indicates the status code which was sent out.</p>
<h3>response.statusMessage<a id="all_response_statusmessage" class="mark" href="#all_response_statusmessage">#</a></h3>
<p>When using implicit headers (not calling <code>response.writeHead()</code> explicitly), this property controls the status message that will be sent to the client when the headers get flushed. If this is left as <code>undefined</code> then the standard message for the status code will be used.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>response<span class="sh_symbol">.</span>statusMessage <span class="sh_symbol">=</span> <span class="sh_string">'Not found'</span><span class="sh_symbol">;</span></code></pre>
<p>After response header was sent to the client, this property indicates the status message which was sent out.</p>
<h3>response.setHeader(name, value)<a id="all_response_setheader_name_value" class="mark" href="#all_response_setheader_name_value">#</a></h3>
<p>Sets a single header value for implicit headers. If this header already exists in the to-be-sent headers, its value will be replaced. Use an array of strings here if you need to send multiple headers with the same name.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>response<span class="sh_symbol">.</span><span class="sh_function">setHeader</span><span class="sh_symbol">(</span><span class="sh_string">"Content-Type"</span><span class="sh_symbol">,</span> <span class="sh_string">"text/html"</span><span class="sh_symbol">);</span></code></pre>
<p>or</p>
<pre class="sh_sourceCode"><code>response<span class="sh_symbol">.</span><span class="sh_function">setHeader</span><span class="sh_symbol">(</span><span class="sh_string">"Set-Cookie"</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_string">"type=ninja"</span><span class="sh_symbol">,</span> <span class="sh_string">"language=javascript"</span><span class="sh_symbol">]);</span></code></pre>
<h3>response.headersSent<a id="all_response_headerssent" class="mark" href="#all_response_headerssent">#</a></h3>
<p>Boolean (read-only). True if headers were sent, false otherwise.</p>
<h3>response.sendDate<a id="all_response_senddate" class="mark" href="#all_response_senddate">#</a></h3>
<p>When true, the Date header will be automatically generated and sent in the response if it is not already present in the headers. Defaults to true.</p>
<p>This should only be disabled for testing; HTTP requires the Date header in responses.</p>
<h3>response.getHeader(name)<a id="all_response_getheader_name" class="mark" href="#all_response_getheader_name">#</a></h3>
<p>Reads out a header that's already been queued but not sent to the client. Note that the name is case insensitive. This can only be called before headers get implicitly flushed.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> contentType <span class="sh_symbol">=</span> response<span class="sh_symbol">.</span><span class="sh_function">getHeader</span><span class="sh_symbol">(</span><span class="sh_string">'content-type'</span><span class="sh_symbol">);</span></code></pre>
<h3>response.removeHeader(name)<a id="all_response_removeheader_name" class="mark" href="#all_response_removeheader_name">#</a></h3>
<p>Removes a header that's queued for implicit sending.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>response<span class="sh_symbol">.</span><span class="sh_function">removeHeader</span><span class="sh_symbol">(</span><span class="sh_string">"Content-Encoding"</span><span class="sh_symbol">);</span></code></pre>
<h3>response.write(chunk[, encoding][, callback])<a id="all_response_write_chunk_encoding_callback" class="mark" href="#all_response_write_chunk_encoding_callback">#</a></h3>
<p>If this method is called and <a href="#http_response_writehead_statuscode_reasonphrase_headers">response.writeHead()</a> has not been called, it will switch to implicit header mode and flush the implicit headers.</p>
<p>This sends a chunk of the response body. This method may be called multiple times to provide successive parts of the body.</p>
<p><code>chunk</code> can be a string or a buffer. If <code>chunk</code> is a string, the second parameter specifies how to encode it into a byte stream. By default the <code>encoding</code> is <code>'utf8'</code>. The last parameter <code>callback</code> will be called when this chunk of data is flushed.</p>
<p><strong>Note</strong>: This is the raw HTTP body and has nothing to do with higher-level multi-part body encodings that may be used.</p>
<p>The first time <code>response.write()</code> is called, it will send the buffered header information and the first body to the client. The second time <code>response.write()</code> is called, Node assumes you're going to be streaming data, and sends that separately. That is, the response is buffered up to the first chunk of body.</p>
<p>Returns <code>true</code> if the entire data was flushed successfully to the kernel buffer. Returns <code>false</code> if all or part of the data was queued in user memory. <code>'drain'</code> will be emitted when the buffer is free again.</p>
<h3>response.addTrailers(headers)<a id="all_response_addtrailers_headers" class="mark" href="#all_response_addtrailers_headers">#</a></h3>
<p>This method adds HTTP trailing headers (a header but at the end of the message) to the response.</p>
<p>Trailers will <strong>only</strong> be emitted if chunked encoding is used for the response; if it is not (e.g., if the request was HTTP/1.0), they will be silently discarded.</p>
<p>Note that HTTP requires the <code>Trailer</code> header to be sent if you intend to emit trailers, with a list of the header fields in its value. E.g.,</p>
<pre class="sh_sourceCode"><code>response<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span> <span class="sh_string">'Content-Type'</span><span class="sh_symbol">:</span> <span class="sh_string">'text/plain'</span><span class="sh_symbol">,</span>
                          <span class="sh_string">'Trailer'</span><span class="sh_symbol">:</span> <span class="sh_string">'Content-MD5'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
response<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>fileData<span class="sh_symbol">);</span>
response<span class="sh_symbol">.</span><span class="sh_function">addTrailers</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span><span class="sh_string">'Content-MD5'</span><span class="sh_symbol">:</span> <span class="sh_string">"7895bf4b8828b55ceaf47747b4bca667"</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
response<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span></code></pre>
<h3>response.end([data][, encoding][, callback])<a id="all_response_end_data_encoding_callback" class="mark" href="#all_response_end_data_encoding_callback">#</a></h3>
<p>This method signals to the server that all of the response headers and body have been sent; that server should consider this message complete. The method, <code>response.end()</code>, MUST be called on each response.</p>
<p>If <code>data</code> is specified, it is equivalent to calling <code>response.write(data, encoding)</code> followed by <code>response.end(callback)</code>.</p>
<p>If <code>callback</code> is specified, it will be called when the response stream is finished.</p>
<h2>http.request(options[, callback])<a id="all_http_request_options_callback" class="mark" href="#all_http_request_options_callback">#</a></h2>
<p>Node maintains several connections per server to make HTTP requests. This function allows one to transparently issue requests.</p>
<p><code>options</code> can be an object or a string. If <code>options</code> is a string, it is automatically parsed with <a href="https://nodejs.org/api/url.html#url_url_parse_urlstr_parsequerystring_slashesdenotehost">url.parse()</a>.</p>
<p>Options:</p>
<ul>
<li><code>host</code>: A domain name or IP address of the server to issue the request to. Defaults to <code>'localhost'</code>.</li>
<li><code>hostname</code>: To support <code>url.parse()</code> <code>hostname</code> is preferred over <code>host</code></li>
<li><code>port</code>: Port of remote server. Defaults to 80.</li>
<li><code>localAddress</code>: Local interface to bind for network connections.</li>
<li><code>socketPath</code>: Unix Domain Socket (use one of host:port or socketPath)</li>
<li><code>method</code>: A string specifying the HTTP request method. Defaults to <code>'GET'</code>.</li>
<li><code>path</code>: Request path. Defaults to <code>'/'</code>. Should include query string if any. E.G. <code>'/index.html?page=12'</code>. An exception is thrown when the request path contains illegal characters. Currently, only spaces are rejected but that may change in the future.</li>
<li><code>headers</code>: An object containing request headers.</li>
<li><code>auth</code>: Basic authentication i.e. <code>'user:password'</code> to compute an Authorization header.</li>
<li><code>agent</code>: Controls <a href="#https_class_https_agent">Agent</a> behavior. When an Agent is used request will default to <code>Connection: keep-alive</code>. Possible values:
<ul>
<li><code>undefined</code> (default): use <a href="#http_http_globalagent">global Agent</a> for this host and port.</li>
<li><code>Agent</code> object: explicitly use the passed in <code>Agent</code>.</li>
<li><code>false</code>: opts out of connection pooling with an Agent, defaults request to <code>Connection: close</code>.</li>
</ul>
</li>
<li><code>keepAlive</code>: {Boolean} Keep sockets around in a pool to be used by other requests in the future. Default = <code>false</code></li>
<li><code>keepAliveMsecs</code>: {Integer} When using HTTP KeepAlive, how often to send TCP KeepAlive packets over sockets being kept alive. Default = <code>1000</code>. Only relevant if <code>keepAlive</code> is set to <code>true</code>.</li>
</ul>
<p>The optional <code>callback</code> parameter will be added as a one time listener for the <a href="#http_event_response">'response'</a> event.</p>
<p><code>http.request()</code> returns an instance of the <a href="#http_class_http_clientrequest">http.ClientRequest</a> class. The <code>ClientRequest</code> instance is a writable stream. If one needs to upload a file with a POST request, then write to the <code>ClientRequest</code> object.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> postData <span class="sh_symbol">=</span> querystring<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  <span class="sh_string">'msg'</span> <span class="sh_symbol">:</span> <span class="sh_string">'Hello World!'</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  hostname<span class="sh_symbol">:</span> <span class="sh_string">'www.google.com'</span><span class="sh_symbol">,</span>
  port<span class="sh_symbol">:</span> <span class="sh_number">80</span><span class="sh_symbol">,</span>
  path<span class="sh_symbol">:</span> <span class="sh_string">'/upload'</span><span class="sh_symbol">,</span>
  method<span class="sh_symbol">:</span> <span class="sh_string">'POST'</span><span class="sh_symbol">,</span>
  headers<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    <span class="sh_string">'Content-Type'</span><span class="sh_symbol">:</span> <span class="sh_string">'application/x-www-form-urlencoded'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'Content-Length'</span><span class="sh_symbol">:</span> postData<span class="sh_symbol">.</span>length
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> req <span class="sh_symbol">=</span> http<span class="sh_symbol">.</span><span class="sh_function">request</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'STATUS: '</span> <span class="sh_symbol">+</span> res<span class="sh_symbol">.</span>statusCode<span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'HEADERS: '</span> <span class="sh_symbol">+</span> JSON<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span>res<span class="sh_symbol">.</span>headers<span class="sh_symbol">));</span>
  res<span class="sh_symbol">.</span><span class="sh_function">setEncoding</span><span class="sh_symbol">(</span><span class="sh_string">'utf8'</span><span class="sh_symbol">);</span>
  res<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'BODY: '</span> <span class="sh_symbol">+</span> chunk<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

req<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'problem with request: '</span> <span class="sh_symbol">+</span> e<span class="sh_symbol">.</span>message<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// write data to request body</span>
req<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>postData<span class="sh_symbol">);</span>
req<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span></code></pre>
<p>Note that in the example <code>req.end()</code> was called. With <code>http.request()</code> one must always call <code>req.end()</code> to signify that you're done with the request - even if there is no data being written to the request body.</p>
<p>If any error is encountered during the request (be that with DNS resolution, TCP level errors, or actual HTTP parse errors) an <code>'error'</code> event is emitted on the returned request object.</p>
<p>There are a few special headers that should be noted.</p>
<ul>
<li>
<p>Sending a 'Connection: keep-alive' will notify Node that the connection to the server should be persisted until the next request.</p>
</li>
<li>
<p>Sending a 'Content-length' header will disable the default chunked encoding.</p>
</li>
<li>
<p>Sending an 'Expect' header will immediately send the request headers. Usually, when sending 'Expect: 100-continue', you should both set a timeout and listen for the <code>continue</code> event. See RFC2616 Section 8.2.3 for more information.</p>
</li>
<li>
<p>Sending an Authorization header will override using the <code>auth</code> option to compute basic authentication.</p>
</li>
</ul>
<h2>http.get(options[, callback])<a id="all_http_get_options_callback" class="mark" href="#all_http_get_options_callback">#</a></h2>
<p>Since most requests are GET requests without bodies, Node provides this convenience method. The only difference between this method and <code>http.request()</code> is that it sets the method to GET and calls <code>req.end()</code> automatically.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>http<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"http://www.google.com/index.html"</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"Got response: "</span> <span class="sh_symbol">+</span> res<span class="sh_symbol">.</span>statusCode<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"Got error: "</span> <span class="sh_symbol">+</span> e<span class="sh_symbol">.</span>message<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Class: http.Agent<a id="all_class_http_agent" class="mark" href="#all_class_http_agent">#</a></h2>
<p>The HTTP Agent is used for pooling sockets used in HTTP client requests.</p>
<p>The HTTP Agent also defaults client requests to using Connection:keep-alive. If no pending HTTP requests are waiting on a socket to become free the socket is closed. This means that Node's pool has the benefit of keep-alive when under load but still does not require developers to manually close the HTTP clients using KeepAlive.</p>
<p>If you opt into using HTTP KeepAlive, you can create an Agent object with that flag set to <code>true</code>. (See the <a href="#http_new_agent_options">constructor options</a> below.) Then, the Agent will keep unused sockets in a pool for later use. They will be explicitly marked so as to not keep the Node process running. However, it is still a good idea to explicitly <a href="#http_agent_destroy"><code>destroy()</code></a> KeepAlive agents when they are no longer in use, so that the Sockets will be shut down.</p>
<p>Sockets are removed from the agent's pool when the socket emits either a "close" event or a special "agentRemove" event. This means that if you intend to keep one HTTP request open for a long time and don't want it to stay in the pool you can do something along the lines of:</p>
<pre class="sh_sourceCode"><code>http<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// Do stuff</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">"socket"</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">emit</span><span class="sh_symbol">(</span><span class="sh_string">"agentRemove"</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Alternatively, you could just opt out of pooling entirely using <code>agent:false</code>:</p>
<pre class="sh_sourceCode"><code>http<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  hostname<span class="sh_symbol">:</span> <span class="sh_string">'localhost'</span><span class="sh_symbol">,</span>
  port<span class="sh_symbol">:</span> <span class="sh_number">80</span><span class="sh_symbol">,</span>
  path<span class="sh_symbol">:</span> <span class="sh_string">'/'</span><span class="sh_symbol">,</span>
  agent<span class="sh_symbol">:</span> <span class="sh_keyword">false</span>  <span class="sh_comment">// create a new agent just for this one request</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// Do stuff with response</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">)</span></code></pre>
<h3>new Agent([options])<a id="all_new_agent_options" class="mark" href="#all_new_agent_options">#</a></h3>
<div class="signature">
<ul>
<li><code>options</code> <span class="type">Object</span> Set of configurable options to set on the agent. Can have the following fields:
<ul>
<li><code>keepAlive</code> <span class="type">Boolean</span> Keep sockets around in a pool to be used by other requests in the future. Default = <code>false</code></li>
<li><code>keepAliveMsecs</code> <span class="type">Integer</span> When using HTTP KeepAlive, how often to send TCP KeepAlive packets over sockets being kept alive. Default = <code>1000</code>. Only relevant if <code>keepAlive</code> is set to <code>true</code>.</li>
<li><code>maxSockets</code> <span class="type">Number</span> Maximum number of sockets to allow per host. Default = <code>Infinity</code>.</li>
<li><code>maxFreeSockets</code> <span class="type">Number</span> Maximum number of sockets to leave open in a free state. Only relevant if <code>keepAlive</code> is set to <code>true</code>. Default = <code>256</code>.</li>
</ul>
</li>
</ul>
</div>
<p>The default <code>http.globalAgent</code> that is used by <code>http.request</code> has all of these values set to their respective defaults.</p>
<p>To configure any of them, you must create your own <code>Agent</code> object.</p>
<pre class="sh_sourceCode"><code class="javascript"><span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> keepAliveAgent <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> http<span class="sh_symbol">.</span><span class="sh_function">Agent</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> keepAlive<span class="sh_symbol">:</span> <span class="sh_keyword">true</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
options<span class="sh_symbol">.</span>agent <span class="sh_symbol">=</span> keepAliveAgent<span class="sh_symbol">;</span>
http<span class="sh_symbol">.</span><span class="sh_function">request</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> onResponseCallback<span class="sh_symbol">);</span></code></pre>
<h3>agent.maxSockets<a id="all_agent_maxsockets" class="mark" href="#all_agent_maxsockets">#</a></h3>
<p>By default set to Infinity. Determines how many concurrent sockets the agent can have open per origin. Origin is either a 'host:port' or 'host:port:localAddress' combination.</p>
<h3>agent.maxFreeSockets<a id="all_agent_maxfreesockets" class="mark" href="#all_agent_maxfreesockets">#</a></h3>
<p>By default set to 256. For Agents supporting HTTP KeepAlive, this sets the maximum number of sockets that will be left open in the free state.</p>
<h3>agent.sockets<a id="all_agent_sockets" class="mark" href="#all_agent_sockets">#</a></h3>
<p>An object which contains arrays of sockets currently in use by the Agent. Do not modify.</p>
<h3>agent.freeSockets<a id="all_agent_freesockets" class="mark" href="#all_agent_freesockets">#</a></h3>
<p>An object which contains arrays of sockets currently awaiting use by the Agent when HTTP KeepAlive is used. Do not modify.</p>
<h3>agent.requests<a id="all_agent_requests" class="mark" href="#all_agent_requests">#</a></h3>
<p>An object which contains queues of requests that have not yet been assigned to sockets. Do not modify.</p>
<h3>agent.destroy()<a id="all_agent_destroy" class="mark" href="#all_agent_destroy">#</a></h3>
<p>Destroy any sockets that are currently in use by the agent.</p>
<p>It is usually not necessary to do this. However, if you are using an agent with KeepAlive enabled, then it is best to explicitly shut down the agent when you know that it will no longer be used. Otherwise, sockets may hang open for quite a long time before the server terminates them.</p>
<h3>agent.getName(options)<a id="all_agent_getname_options" class="mark" href="#all_agent_getname_options">#</a></h3>
<p>Get a unique name for a set of request options, to determine whether a connection can be reused. In the http agent, this returns <code>host:port:localAddress</code>. In the https agent, the name includes the CA, cert, ciphers, and other HTTPS/TLS-specific options that determine socket reusability.</p>
<h2>http.globalAgent<a id="all_http_globalagent" class="mark" href="#all_http_globalagent">#</a></h2>
<p>Global instance of Agent which is used as the default for all http client requests.</p>
<h2>Class: http.ClientRequest<a id="all_class_http_clientrequest" class="mark" href="#all_class_http_clientrequest">#</a></h2>
<p>This object is created internally and returned from <code>http.request()</code>. It represents an <em>in-progress</em> request whose header has already been queued. The header is still mutable using the <code>setHeader(name, value)</code>, <code>getHeader(name)</code>, <code>removeHeader(name)</code> API. The actual header will be sent along with the first data chunk or when closing the connection.</p>
<p>To get the response, add a listener for <code>'response'</code> to the request object. <code>'response'</code> will be emitted from the request object when the response headers have been received. The <code>'response'</code> event is executed with one argument which is an instance of <a href="#http_http_incomingmessage">http.IncomingMessage</a>.</p>
<p>During the <code>'response'</code> event, one can add listeners to the response object; particularly to listen for the <code>'data'</code> event.</p>
<p>If no <code>'response'</code> handler is added, then the response will be entirely discarded. However, if you add a <code>'response'</code> event handler, then you <strong>must</strong> consume the data from the response object, either by calling <code>response.read()</code> whenever there is a <code>'readable'</code> event, or by adding a <code>'data'</code> handler, or by calling the <code>.resume()</code> method. Until the data is consumed, the <code>'end'</code> event will not fire. Also, until the data is read it will consume memory that can eventually lead to a 'process out of memory' error.</p>
<p>Note: Node does not check whether Content-Length and the length of the body which has been transmitted are equal or not.</p>
<p>The request implements the <a href="https://nodejs.org/api/stream.html#stream_class_stream_writable">Writable Stream</a> interface. This is an <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a> with the following events:</p>
<h3>Event: 'response'<a id="all_event_response" class="mark" href="#all_event_response">#</a></h3>
<p><code>function (response) { }</code></p>
<p>Emitted when a response is received to this request. This event is emitted only once. The <code>response</code> argument will be an instance of <a href="#http_http_incomingmessage">http.IncomingMessage</a>.</p>
<p>Options:</p>
<ul>
<li><code>host</code>: A domain name or IP address of the server to issue the request to.</li>
<li><code>port</code>: Port of remote server.</li>
<li><code>socketPath</code>: Unix Domain Socket (use one of host:port or socketPath)</li>
</ul>
<h3>Event: 'socket'<a id="all_event_socket" class="mark" href="#all_event_socket">#</a></h3>
<p><code>function (socket) { }</code></p>
<p>Emitted after a socket is assigned to this request.</p>
<h3>Event: 'connect'<a id="all_event_connect_2" class="mark" href="#all_event_connect_2">#</a></h3>
<p><code>function (response, socket, head) { }</code></p>
<p>Emitted each time a server responds to a request with a CONNECT method. If this event isn't being listened for, clients receiving a CONNECT method will have their connections closed.</p>
<p>A client server pair that show you how to listen for the <code>connect</code> event.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> net <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'net'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> url <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'url'</span><span class="sh_symbol">);</span>

<span class="sh_comment">// Create an HTTP tunneling proxy</span>
<span class="sh_keyword">var</span> proxy <span class="sh_symbol">=</span> http<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  res<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span><span class="sh_string">'Content-Type'</span><span class="sh_symbol">:</span> <span class="sh_string">'text/plain'</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'okay'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
proxy<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'connect'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> cltSocket<span class="sh_symbol">,</span> head<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// connect to an origin server</span>
  <span class="sh_keyword">var</span> srvUrl <span class="sh_symbol">=</span> url<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span><span class="sh_string">'http://'</span> <span class="sh_symbol">+</span> req<span class="sh_symbol">.</span>url<span class="sh_symbol">);</span>
  <span class="sh_keyword">var</span> srvSocket <span class="sh_symbol">=</span> net<span class="sh_symbol">.</span><span class="sh_function">connect</span><span class="sh_symbol">(</span>srvUrl<span class="sh_symbol">.</span>port<span class="sh_symbol">,</span> srvUrl<span class="sh_symbol">.</span>hostname<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    cltSocket<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'HTTP/1.1 200 Connection Established</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span> <span class="sh_symbol">+</span>
                    <span class="sh_string">'Proxy-agent: Node-Proxy</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span> <span class="sh_symbol">+</span>
                    <span class="sh_string">'</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
    srvSocket<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>head<span class="sh_symbol">);</span>
    srvSocket<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>cltSocket<span class="sh_symbol">);</span>
    cltSocket<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>srvSocket<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// now that proxy is running</span>
proxy<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">,</span> <span class="sh_string">'127.0.0.1'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>

  <span class="sh_comment">// make a request to a tunneling proxy</span>
  <span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
    port<span class="sh_symbol">:</span> <span class="sh_number">1337</span><span class="sh_symbol">,</span>
    hostname<span class="sh_symbol">:</span> <span class="sh_string">'127.0.0.1'</span><span class="sh_symbol">,</span>
    method<span class="sh_symbol">:</span> <span class="sh_string">'CONNECT'</span><span class="sh_symbol">,</span>
    path<span class="sh_symbol">:</span> <span class="sh_string">'www.google.com:80'</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

  <span class="sh_keyword">var</span> req <span class="sh_symbol">=</span> http<span class="sh_symbol">.</span><span class="sh_function">request</span><span class="sh_symbol">(</span>options<span class="sh_symbol">);</span>
  req<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>

  req<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'connect'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">,</span> socket<span class="sh_symbol">,</span> head<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'got connected!'</span><span class="sh_symbol">);</span>

    <span class="sh_comment">// make a request over an HTTP tunnel</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'GET / HTTP/1.1</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span> <span class="sh_symbol">+</span>
                 <span class="sh_string">'Host: www.google.com:80</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span> <span class="sh_symbol">+</span>
                 <span class="sh_string">'Connection: close</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span> <span class="sh_symbol">+</span>
                 <span class="sh_string">'</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>chunk<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">());</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'end'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
      proxy<span class="sh_symbol">.</span><span class="sh_function">close</span><span class="sh_symbol">();</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'upgrade'<a id="all_event_upgrade_1" class="mark" href="#all_event_upgrade_1">#</a></h3>
<p><code>function (response, socket, head) { }</code></p>
<p>Emitted each time a server responds to a request with an upgrade. If this event isn't being listened for, clients receiving an upgrade header will have their connections closed.</p>
<p>A client server pair that show you how to listen for the <code>upgrade</code> event.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>

<span class="sh_comment">// Create an HTTP server</span>
<span class="sh_keyword">var</span> srv <span class="sh_symbol">=</span> http<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  res<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span><span class="sh_string">'Content-Type'</span><span class="sh_symbol">:</span> <span class="sh_string">'text/plain'</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'okay'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
srv<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'upgrade'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> socket<span class="sh_symbol">,</span> head<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'HTTP/1.1 101 Web Socket Protocol Handshake</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span> <span class="sh_symbol">+</span>
               <span class="sh_string">'Upgrade: WebSocket</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span> <span class="sh_symbol">+</span>
               <span class="sh_string">'Connection: Upgrade</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span> <span class="sh_symbol">+</span>
               <span class="sh_string">'</span><span class="sh_specialchar">\r\n</span><span class="sh_string">'</span><span class="sh_symbol">);</span>

  socket<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">);</span> <span class="sh_comment">// echo back</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// now that server is running</span>
srv<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">,</span> <span class="sh_string">'127.0.0.1'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>

  <span class="sh_comment">// make a request</span>
  <span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
    port<span class="sh_symbol">:</span> <span class="sh_number">1337</span><span class="sh_symbol">,</span>
    hostname<span class="sh_symbol">:</span> <span class="sh_string">'127.0.0.1'</span><span class="sh_symbol">,</span>
    headers<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
      <span class="sh_string">'Connection'</span><span class="sh_symbol">:</span> <span class="sh_string">'Upgrade'</span><span class="sh_symbol">,</span>
      <span class="sh_string">'Upgrade'</span><span class="sh_symbol">:</span> <span class="sh_string">'websocket'</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

  <span class="sh_keyword">var</span> req <span class="sh_symbol">=</span> http<span class="sh_symbol">.</span><span class="sh_function">request</span><span class="sh_symbol">(</span>options<span class="sh_symbol">);</span>
  req<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>

  req<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'upgrade'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">,</span> socket<span class="sh_symbol">,</span> upgradeHead<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'got upgraded!'</span><span class="sh_symbol">);</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>
    process<span class="sh_symbol">.</span><span class="sh_function">exit</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'continue'<a id="all_event_continue" class="mark" href="#all_event_continue">#</a></h3>
<p><code>function () { }</code></p>
<p>Emitted when the server sends a '100 Continue' HTTP response, usually because the request contained 'Expect: 100-continue'. This is an instruction that the client should send the request body.</p>
<h3>request.flushHeaders()<a id="all_request_flushheaders" class="mark" href="#all_request_flushheaders">#</a></h3>
<p>Flush the request headers.</p>
<p>For efficiency reasons, node.js normally buffers the request headers until you call <code>request.end()</code> or write the first chunk of request data. It then tries hard to pack the request headers and data into a single TCP packet.</p>
<p>That's usually what you want (it saves a TCP round-trip) but not when the first data isn't sent until possibly much later. <code>request.flush()</code> lets you bypass the optimization and kickstart the request.</p>
<h3>request.write(chunk[, encoding][, callback])<a id="all_request_write_chunk_encoding_callback" class="mark" href="#all_request_write_chunk_encoding_callback">#</a></h3>
<p>Sends a chunk of the body. By calling this method many times, the user can stream a request body to a server--in that case it is suggested to use the <code>['Transfer-Encoding', 'chunked']</code> header line when creating the request.</p>
<p>The <code>chunk</code> argument should be a <a href="https://nodejs.org/api/buffer.html#buffer_buffer">Buffer</a> or a string.</p>
<p>The <code>encoding</code> argument is optional and only applies when <code>chunk</code> is a string. Defaults to <code>'utf8'</code>.</p>
<p>The <code>callback</code> argument is optional and will be called when this chunk of data is flushed.</p>
<h3>request.end([data][, encoding][, callback])<a id="all_request_end_data_encoding_callback" class="mark" href="#all_request_end_data_encoding_callback">#</a></h3>
<p>Finishes sending the request. If any parts of the body are unsent, it will flush them to the stream. If the request is chunked, this will send the terminating <code>'0\r\n\r\n'</code>.</p>
<p>If <code>data</code> is specified, it is equivalent to calling <code>request.write(data, encoding)</code> followed by <code>request.end(callback)</code>.</p>
<p>If <code>callback</code> is specified, it will be called when the request stream is finished.</p>
<h3>request.abort()<a id="all_request_abort" class="mark" href="#all_request_abort">#</a></h3>
<p>Aborts a request. (New since v0.3.8.)</p>
<h3>request.setTimeout(timeout[, callback])<a id="all_request_settimeout_timeout_callback" class="mark" href="#all_request_settimeout_timeout_callback">#</a></h3>
<p>Once a socket is assigned to this request and is connected <a href="https://nodejs.org/api/net.html#net_socket_settimeout_timeout_callback">socket.setTimeout()</a> will be called.</p>
<h3>request.setNoDelay([noDelay])<a id="all_request_setnodelay_nodelay" class="mark" href="#all_request_setnodelay_nodelay">#</a></h3>
<p>Once a socket is assigned to this request and is connected <a href="https://nodejs.org/api/net.html#net_socket_setnodelay_nodelay">socket.setNoDelay()</a> will be called.</p>
<h3>request.setSocketKeepAlive([enable][, initialDelay])<a id="all_request_setsocketkeepalive_enable_initialdelay" class="mark" href="#all_request_setsocketkeepalive_enable_initialdelay">#</a></h3>
<p>Once a socket is assigned to this request and is connected <a href="https://nodejs.org/api/net.html#net_socket_setkeepalive_enable_initialdelay">socket.setKeepAlive()</a> will be called.</p>
<h2>http.IncomingMessage<a id="all_http_incomingmessage" class="mark" href="#all_http_incomingmessage">#</a></h2>
<p>An <code>IncomingMessage</code> object is created by <a href="#http_class_http_server">http.Server</a> or <a href="#http_class_http_clientrequest">http.ClientRequest</a> and passed as the first argument to the <code>'request'</code> and <code>'response'</code> event respectively. It may be used to access response status, headers and data.</p>
<p>It implements the <a href="https://nodejs.org/api/stream.html#stream_class_stream_readable">Readable Stream</a> interface, as well as the following additional events, methods, and properties.</p>
<h3>Event: 'close'<a id="all_event_close_6" class="mark" href="#all_event_close_6">#</a></h3>
<p><code>function () { }</code></p>
<p>Indicates that the underlying connection was closed. Just like <code>'end'</code>, this event occurs only once per response.</p>
<h3>message.httpVersion<a id="all_message_httpversion" class="mark" href="#all_message_httpversion">#</a></h3>
<p>In case of server request, the HTTP version sent by the client. In the case of client response, the HTTP version of the connected-to server. Probably either <code>'1.1'</code> or <code>'1.0'</code>.</p>
<p>Also <code>response.httpVersionMajor</code> is the first integer and <code>response.httpVersionMinor</code> is the second.</p>
<h3>message.headers<a id="all_message_headers" class="mark" href="#all_message_headers">#</a></h3>
<p>The request/response headers object.</p>
<p>Read only map of header names and values. Header names are lower-cased. Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// Prints something like:</span>
<span class="sh_comment">//</span>
<span class="sh_comment">// { 'user-agent': 'curl/7.22.0',</span>
<span class="sh_comment">//   host: '127.0.0.1:8000',</span>
<span class="sh_comment">//   accept: '*/*' }</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>request<span class="sh_symbol">.</span>headers<span class="sh_symbol">);</span></code></pre>
<h3>message.rawHeaders<a id="all_message_rawheaders" class="mark" href="#all_message_rawheaders">#</a></h3>
<p>The raw request/response headers list exactly as they were received.</p>
<p>Note that the keys and values are in the same list. It is <em>not</em> a list of tuples. So, the even-numbered offsets are key values, and the odd-numbered offsets are the associated values.</p>
<p>Header names are not lowercased, and duplicates are not merged.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// Prints something like:</span>
<span class="sh_comment">//</span>
<span class="sh_comment">// [ 'user-agent',</span>
<span class="sh_comment">//   'this is invalid because there can be only one',</span>
<span class="sh_comment">//   'User-Agent',</span>
<span class="sh_comment">//   'curl/7.22.0',</span>
<span class="sh_comment">//   'Host',</span>
<span class="sh_comment">//   '127.0.0.1:8000',</span>
<span class="sh_comment">//   'ACCEPT',</span>
<span class="sh_comment">//   '*/*' ]</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>request<span class="sh_symbol">.</span>rawHeaders<span class="sh_symbol">);</span></code></pre>
<h3>message.trailers<a id="all_message_trailers" class="mark" href="#all_message_trailers">#</a></h3>
<p>The request/response trailers object. Only populated at the 'end' event.</p>
<h3>message.rawTrailers<a id="all_message_rawtrailers" class="mark" href="#all_message_rawtrailers">#</a></h3>
<p>The raw request/response trailer keys and values exactly as they were received. Only populated at the 'end' event.</p>
<h3>message.setTimeout(msecs, callback)<a id="all_message_settimeout_msecs_callback" class="mark" href="#all_message_settimeout_msecs_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>msecs</code> <span class="type">Number</span></li>
<li><code>callback</code> <span class="type">Function</span></li>
</ul>
</div>
<p>Calls <code>message.connection.setTimeout(msecs, callback)</code>.</p>
<h3>message.method<a id="all_message_method" class="mark" href="#all_message_method">#</a></h3>
<p><strong>Only valid for request obtained from <a href="#http_class_http_server">http.Server</a>.</strong></p>
<p>The request method as a string. Read only. Example: <code>'GET'</code>, <code>'DELETE'</code>.</p>
<h3>message.url<a id="all_message_url" class="mark" href="#all_message_url">#</a></h3>
<p><strong>Only valid for request obtained from <a href="#http_class_http_server">http.Server</a>.</strong></p>
<p>Request URL string. This contains only the URL that is present in the actual HTTP request. If the request is:</p>
<pre class="sh_sourceCode"><code><span class="sh_normal">GET </span><span class="sh_symbol">/</span>status<span class="sh_symbol">?</span>name<span class="sh_symbol">=</span>ryan <span class="sh_normal">HTTP</span><span class="sh_symbol">/</span><span class="sh_number">1.1</span><span class="sh_symbol">\</span>r<span class="sh_symbol">\</span>n
Accept<span class="sh_symbol">:</span> <span class="sh_normal">text</span><span class="sh_symbol">/</span>plain<span class="sh_symbol">\</span>r<span class="sh_symbol">\</span>n
<span class="sh_symbol">\</span>r<span class="sh_symbol">\</span>n</code></pre>
<p>Then <code>request.url</code> will be:</p>
<pre class="sh_sourceCode"><code><span class="sh_string">'/status?name=ryan'</span></code></pre>
<p>If you would like to parse the URL into its parts, you can use <code>require('url').parse(request.url)</code>. Example:</p>
<pre class="sh_sourceCode"><code>node<span class="sh_symbol">&gt;</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'url'</span><span class="sh_symbol">).</span><span class="sh_function">parse</span><span class="sh_symbol">(</span><span class="sh_string">'/status?name=ryan'</span><span class="sh_symbol">)</span>
<span class="sh_cbracket">{</span> href<span class="sh_symbol">:</span> <span class="sh_string">'/status?name=ryan'</span><span class="sh_symbol">,</span>
  search<span class="sh_symbol">:</span> <span class="sh_string">'?name=ryan'</span><span class="sh_symbol">,</span>
  query<span class="sh_symbol">:</span> <span class="sh_string">'name=ryan'</span><span class="sh_symbol">,</span>
  pathname<span class="sh_symbol">:</span> <span class="sh_string">'/status'</span> <span class="sh_cbracket">}</span></code></pre>
<p>If you would like to extract the params from the query string, you can use the <code>require('querystring').parse</code> function, or pass <code>true</code> as the second argument to <code>require('url').parse</code>. Example:</p>
<pre class="sh_sourceCode"><code>node<span class="sh_symbol">&gt;</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'url'</span><span class="sh_symbol">).</span><span class="sh_function">parse</span><span class="sh_symbol">(</span><span class="sh_string">'/status?name=ryan'</span><span class="sh_symbol">,</span> <span class="sh_keyword">true</span><span class="sh_symbol">)</span>
<span class="sh_cbracket">{</span> href<span class="sh_symbol">:</span> <span class="sh_string">'/status?name=ryan'</span><span class="sh_symbol">,</span>
  search<span class="sh_symbol">:</span> <span class="sh_string">'?name=ryan'</span><span class="sh_symbol">,</span>
  query<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span> name<span class="sh_symbol">:</span> <span class="sh_string">'ryan'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  pathname<span class="sh_symbol">:</span> <span class="sh_string">'/status'</span> <span class="sh_cbracket">}</span></code></pre>
<h3>message.statusCode<a id="all_message_statuscode" class="mark" href="#all_message_statuscode">#</a></h3>
<p><strong>Only valid for response obtained from <code>http.ClientRequest</code>.</strong></p>
<p>The 3-digit HTTP response status code. E.G. <code>404</code>.</p>
<h3>message.statusMessage<a id="all_message_statusmessage" class="mark" href="#all_message_statusmessage">#</a></h3>
<p><strong>Only valid for response obtained from <code>http.ClientRequest</code>.</strong></p>
<p>The HTTP response status message (reason phrase). E.G. <code>OK</code> or <code>Internal Server Error</code>.</p>
<h3>message.socket<a id="all_message_socket" class="mark" href="#all_message_socket">#</a></h3>
<p>The <code>net.Socket</code> object associated with the connection.</p>
<p>With HTTPS support, use request.connection.verifyPeer() and request.connection.getPeerCertificate() to obtain the client's authentication details.</p>
<h1>HTTPS<a id="all_https" class="mark" href="#all_https">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>HTTPS is the HTTP protocol over TLS/SSL. In Node this is implemented as a separate module.</p>
<h2>Class: https.Server<a id="all_class_https_server" class="mark" href="#all_class_https_server">#</a></h2>
<p>This class is a subclass of <code>tls.Server</code> and emits events same as <code>http.Server</code>. See <code>http.Server</code> for more information.</p>
<h3>server.setTimeout(msecs, callback)<a id="all_server_settimeout_msecs_callback_1" class="mark" href="#all_server_settimeout_msecs_callback_1">#</a></h3>
<p>See <a href="https://nodejs.org/api/http.html#http_server_settimeout_msecs_callback">http.Server#setTimeout()</a>.</p>
<h3>server.timeout<a id="all_server_timeout_1" class="mark" href="#all_server_timeout_1">#</a></h3>
<p>See <a href="https://nodejs.org/api/http.html#http_server_timeout">http.Server#timeout</a>.</p>
<h2>https.createServer(options[, requestListener])<a id="all_https_createserver_options_requestlistener" class="mark" href="#all_https_createserver_options_requestlistener">#</a></h2>
<p>Returns a new HTTPS web server object. The <code>options</code> is similar to <a href="https://nodejs.org/api/tls.html#tls_tls_createserver_options_secureconnectionlistener">tls.createServer()</a>. The <code>requestListener</code> is a function which is automatically added to the <code>'request'</code> event.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// curl -k https://localhost:8000/</span>
<span class="sh_keyword">var</span> https <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'https'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  key<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'test/fixtures/keys/agent2-key.pem'</span><span class="sh_symbol">),</span>
  cert<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'test/fixtures/keys/agent2-cert.pem'</span><span class="sh_symbol">)</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

https<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  res<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">);</span>
  res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">"hello world</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">);</span></code></pre>
<p>Or</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> https <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'https'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  pfx<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'server.pfx'</span><span class="sh_symbol">)</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

https<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  res<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">);</span>
  res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">"hello world</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">);</span></code></pre>
<h3>server.listen(port[, host][, backlog][, callback])<a id="all_server_listen_port_host_backlog_callback_1" class="mark" href="#all_server_listen_port_host_backlog_callback_1">#</a></h3>
<h3>server.listen(path[, callback])<a id="all_server_listen_path_callback_2" class="mark" href="#all_server_listen_path_callback_2">#</a></h3>
<h3>server.listen(handle[, callback])<a id="all_server_listen_handle_callback_2" class="mark" href="#all_server_listen_handle_callback_2">#</a></h3>
<p>See <a href="https://nodejs.org/api/http.html#http_server_listen_port_hostname_backlog_callback">http.listen()</a> for details.</p>
<h3>server.close([callback])<a id="all_server_close_callback_2" class="mark" href="#all_server_close_callback_2">#</a></h3>
<p>See <a href="https://nodejs.org/api/http.html#http_server_close_callback">http.close()</a> for details.</p>
<h2>https.request(options, callback)<a id="all_https_request_options_callback" class="mark" href="#all_https_request_options_callback">#</a></h2>
<p>Makes a request to a secure web server.</p>
<p><code>options</code> can be an object or a string. If <code>options</code> is a string, it is automatically parsed with <a href="https://nodejs.org/api/url.html#url.parse">url.parse()</a>.</p>
<p>All options from <a href="https://nodejs.org/api/http.html#http_http_request_options_callback">http.request()</a> are valid.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> https <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'https'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  hostname<span class="sh_symbol">:</span> <span class="sh_string">'encrypted.google.com'</span><span class="sh_symbol">,</span>
  port<span class="sh_symbol">:</span> <span class="sh_number">443</span><span class="sh_symbol">,</span>
  path<span class="sh_symbol">:</span> <span class="sh_string">'/'</span><span class="sh_symbol">,</span>
  method<span class="sh_symbol">:</span> <span class="sh_string">'GET'</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> req <span class="sh_symbol">=</span> https<span class="sh_symbol">.</span><span class="sh_function">request</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"statusCode: "</span><span class="sh_symbol">,</span> res<span class="sh_symbol">.</span>statusCode<span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"headers: "</span><span class="sh_symbol">,</span> res<span class="sh_symbol">.</span>headers<span class="sh_symbol">);</span>

  res<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>d<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>d<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
req<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>

req<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span>e<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>The options argument has the following options</p>
<ul>
<li><code>host</code>: A domain name or IP address of the server to issue the request to. Defaults to <code>'localhost'</code>.</li>
<li><code>hostname</code>: To support <code>url.parse()</code> <code>hostname</code> is preferred over <code>host</code></li>
<li><code>port</code>: Port of remote server. Defaults to 443.</li>
<li><code>method</code>: A string specifying the HTTP request method. Defaults to <code>'GET'</code>.</li>
<li><code>path</code>: Request path. Defaults to <code>'/'</code>. Should include query string if any. E.G. <code>'/index.html?page=12'</code></li>
<li><code>headers</code>: An object containing request headers.</li>
<li><code>auth</code>: Basic authentication i.e. <code>'user:password'</code> to compute an Authorization header.</li>
<li><code>agent</code>: Controls <a href="#https_class_https_agent">Agent</a> behavior. When an Agent is used request will default to <code>Connection: keep-alive</code>. Possible values:
<ul>
<li><code>undefined</code> (default): use <a href="#https_https_globalagent">globalAgent</a> for this host and port.</li>
<li><code>Agent</code> object: explicitly use the passed in <code>Agent</code>.</li>
<li><code>false</code>: opts out of connection pooling with an Agent, defaults request to <code>Connection: close</code>.</li>
</ul>
</li>
</ul>
<p>The following options from <a href="https://nodejs.org/api/tls.html#tls_tls_connect_options_callback">tls.connect()</a> can also be specified. However, a <a href="#https_https_globalagent">globalAgent</a> silently ignores these.</p>
<ul>
<li><code>pfx</code>: Certificate, Private key and CA certificates to use for SSL. Default <code>null</code>.</li>
<li><code>key</code>: Private key to use for SSL. Default <code>null</code>.</li>
<li><code>passphrase</code>: A string of passphrase for the private key or pfx. Default <code>null</code>.</li>
<li><code>cert</code>: Public x509 certificate to use. Default <code>null</code>.</li>
<li><code>ca</code>: An authority certificate or array of authority certificates to check the remote host against.</li>
<li><code>ciphers</code>: A string describing the ciphers to use or exclude. Consult <a href="http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT">http://www.openssl.org/docs/apps/ciphers.html#CIPHER_LIST_FORMAT</a> for details on the format.</li>
<li><code>rejectUnauthorized</code>: If <code>true</code>, the server certificate is verified against the list of supplied CAs. An <code>'error'</code> event is emitted if verification fails. Verification happens at the connection level, <em>before</em> the HTTP request is sent. Default <code>true</code>.</li>
<li><code>secureProtocol</code>: The SSL method to use, e.g. <code>TLSv1_method</code> to force TLS version 1. The possible values depend on your installation of OpenSSL and are defined in the constant <a href="http://www.openssl.org/docs/ssl/ssl.html#DEALING_WITH_PROTOCOL_METHODS">SSL_METHODS</a>.</li>
</ul>
<p>In order to specify these options, use a custom <code>Agent</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  hostname<span class="sh_symbol">:</span> <span class="sh_string">'encrypted.google.com'</span><span class="sh_symbol">,</span>
  port<span class="sh_symbol">:</span> <span class="sh_number">443</span><span class="sh_symbol">,</span>
  path<span class="sh_symbol">:</span> <span class="sh_string">'/'</span><span class="sh_symbol">,</span>
  method<span class="sh_symbol">:</span> <span class="sh_string">'GET'</span><span class="sh_symbol">,</span>
  key<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'test/fixtures/keys/agent2-key.pem'</span><span class="sh_symbol">),</span>
  cert<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'test/fixtures/keys/agent2-cert.pem'</span><span class="sh_symbol">)</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
options<span class="sh_symbol">.</span>agent <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> https<span class="sh_symbol">.</span><span class="sh_function">Agent</span><span class="sh_symbol">(</span>options<span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> req <span class="sh_symbol">=</span> https<span class="sh_symbol">.</span><span class="sh_function">request</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_symbol">...</span>
<span class="sh_cbracket">}</span></code></pre>
<p>Or does not use an <code>Agent</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  hostname<span class="sh_symbol">:</span> <span class="sh_string">'encrypted.google.com'</span><span class="sh_symbol">,</span>
  port<span class="sh_symbol">:</span> <span class="sh_number">443</span><span class="sh_symbol">,</span>
  path<span class="sh_symbol">:</span> <span class="sh_string">'/'</span><span class="sh_symbol">,</span>
  method<span class="sh_symbol">:</span> <span class="sh_string">'GET'</span><span class="sh_symbol">,</span>
  key<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'test/fixtures/keys/agent2-key.pem'</span><span class="sh_symbol">),</span>
  cert<span class="sh_symbol">:</span> fs<span class="sh_symbol">.</span><span class="sh_function">readFileSync</span><span class="sh_symbol">(</span><span class="sh_string">'test/fixtures/keys/agent2-cert.pem'</span><span class="sh_symbol">),</span>
  agent<span class="sh_symbol">:</span> <span class="sh_keyword">false</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> req <span class="sh_symbol">=</span> https<span class="sh_symbol">.</span><span class="sh_function">request</span><span class="sh_symbol">(</span>options<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_symbol">...</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>https.get(options, callback)<a id="all_https_get_options_callback" class="mark" href="#all_https_get_options_callback">#</a></h2>
<p>Like <code>http.get()</code> but for HTTPS.</p>
<p><code>options</code> can be an object or a string. If <code>options</code> is a string, it is automatically parsed with <a href="https://nodejs.org/api/url.html#url.parse">url.parse()</a>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> https <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'https'</span><span class="sh_symbol">);</span>

https<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">'https://encrypted.google.com/'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"statusCode: "</span><span class="sh_symbol">,</span> res<span class="sh_symbol">.</span>statusCode<span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"headers: "</span><span class="sh_symbol">,</span> res<span class="sh_symbol">.</span>headers<span class="sh_symbol">);</span>

  res<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>d<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>d<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'error'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span>e<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Class: https.Agent<a id="all_class_https_agent" class="mark" href="#all_class_https_agent">#</a></h2>
<p>An Agent object for HTTPS similar to <a href="https://nodejs.org/api/http.html#http_class_http_agent">http.Agent</a>. See <a href="#https_https_request_options_callback">https.request()</a> for more information.</p>
<h2>https.globalAgent<a id="all_https_globalagent" class="mark" href="#all_https_globalagent">#</a></h2>
<p>Global instance of <a href="#https_class_https_agent">https.Agent</a> for all HTTPS client requests.</p>
<h1>URL<a id="all_url" class="mark" href="#all_url">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>This module has utilities for URL resolution and parsing. Call <code>require('url')</code> to use it.</p>
<p>Parsed URL objects have some or all of the following fields, depending on whether or not they exist in the URL string. Any parts that are not in the URL string will not be in the parsed object. Examples are shown for the URL</p>
<p><code>'http://user:pass@host.com:8080/p/a/t/h?query=string#hash'</code></p>
<ul>
<li>
<p><code>href</code>: The full URL that was originally parsed. Both the protocol and host are lowercased.</p>
<p>Example: <code>'http://user:pass@host.com:8080/p/a/t/h?query=string#hash'</code></p>
</li>
<li>
<p><code>protocol</code>: The request protocol, lowercased.</p>
<p>Example: <code>'http:'</code></p>
</li>
<li>
<p><code>slashes</code>: The protocol requires slashes after the colon</p>
<p>Example: true or false</p>
</li>
<li>
<p><code>host</code>: The full lowercased host portion of the URL, including port information.</p>
<p>Example: <code>'host.com:8080'</code></p>
</li>
<li>
<p><code>auth</code>: The authentication information portion of a URL.</p>
<p>Example: <code>'user:pass'</code></p>
</li>
<li>
<p><code>hostname</code>: Just the lowercased hostname portion of the host.</p>
<p>Example: <code>'host.com'</code></p>
</li>
<li>
<p><code>port</code>: The port number portion of the host.</p>
<p>Example: <code>'8080'</code></p>
</li>
<li>
<p><code>pathname</code>: The path section of the URL, that comes after the host and before the query, including the initial slash if present.</p>
<p>Example: <code>'/p/a/t/h'</code></p>
</li>
<li>
<p><code>search</code>: The 'query string' portion of the URL, including the leading question mark.</p>
<p>Example: <code>'?query=string'</code></p>
</li>
<li>
<p><code>path</code>: Concatenation of <code>pathname</code> and <code>search</code>.</p>
<p>Example: <code>'/p/a/t/h?query=string'</code></p>
</li>
<li>
<p><code>query</code>: Either the 'params' portion of the query string, or a querystring-parsed object.</p>
<p>Example: <code>'query=string'</code> or <code>{'query':'string'}</code></p>
</li>
<li>
<p><code>hash</code>: The 'fragment' portion of the URL including the pound-sign.</p>
<p>Example: <code>'#hash'</code></p>
</li>
</ul>
<p>The following methods are provided by the URL module:</p>
<h2>url.parse(urlStr[, parseQueryString][, slashesDenoteHost])<a id="all_url_parse_urlstr_parsequerystring_slashesdenotehost" class="mark" href="#all_url_parse_urlstr_parsequerystring_slashesdenotehost">#</a></h2>
<p>Take a URL string, and return an object.</p>
<p>Pass <code>true</code> as the second argument to also parse the query string using the <code>querystring</code> module. If <code>true</code> then the <code>query</code> property will always be assigned an object, and the <code>search</code> property will always be a (possibly empty) string. Defaults to <code>false</code>.</p>
<p>Pass <code>true</code> as the third argument to treat <code>//foo/bar</code> as <code>{ host: 'foo', pathname: '/bar' }</code> rather than <code>{ pathname: '//foo/bar' }</code>. Defaults to <code>false</code>.</p>
<h2>url.format(urlObj)<a id="all_url_format_urlobj" class="mark" href="#all_url_format_urlobj">#</a></h2>
<p>Take a parsed URL object, and return a formatted URL string.</p>
<p>Here's how the formatting process works:</p>
<ul>
<li><code>href</code> will be ignored.</li>
<li><code>protocol</code> is treated the same with or without the trailing <code>:</code> (colon).
<ul>
<li>The protocols <code>http</code>, <code>https</code>, <code>ftp</code>, <code>gopher</code>, <code>file</code> will be postfixed with <code>://</code> (colon-slash-slash).</li>
<li>All other protocols <code>mailto</code>, <code>xmpp</code>, <code>aim</code>, <code>sftp</code>, <code>foo</code>, etc will be postfixed with <code>:</code> (colon)</li>
</ul>
</li>
<li><code>slashes</code> set to <code>true</code> if the protocol requires <code>://</code> (colon-slash-slash)
<ul>
<li>Only needs to be set for protocols not previously listed as requiring slashes, such as <code>mongodb://localhost:8000/</code></li>
</ul>
</li>
<li><code>auth</code> will be used if present.</li>
<li><code>hostname</code> will only be used if <code>host</code> is absent.</li>
<li><code>port</code> will only be used if <code>host</code> is absent.</li>
<li><code>host</code> will be used in place of <code>hostname</code> and <code>port</code></li>
<li><code>pathname</code> is treated the same with or without the leading <code>/</code> (slash).</li>
<li><code>search</code> will be used in place of <code>query</code>.
<ul>
<li>It is treated the same with or without the leading <code>?</code> (question mark)</li>
</ul>
</li>
<li><code>query</code> (object; see <code>querystring</code>) will only be used if <code>search</code> is absent.</li>
<li><code>hash</code> is treated the same with or without the leading <code>#</code> (pound sign, anchor).</li>
</ul>
<h2>url.resolve(from, to)<a id="all_url_resolve_from_to" class="mark" href="#all_url_resolve_from_to">#</a></h2>
<p>Take a base URL, and a href URL, and resolve them as a browser would for an anchor tag. Examples:</p>
<pre class="sh_sourceCode"><code>url<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span><span class="sh_string">'/one/two/three'</span><span class="sh_symbol">,</span> <span class="sh_string">'four'</span><span class="sh_symbol">)</span>         <span class="sh_comment">// '/one/two/four'</span>
url<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span><span class="sh_string">'http://example.com/'</span><span class="sh_symbol">,</span> <span class="sh_string">'/one'</span><span class="sh_symbol">)</span>    <span class="sh_comment">// 'http://example.com/one'</span>
url<span class="sh_symbol">.</span><span class="sh_function">resolve</span><span class="sh_symbol">(</span><span class="sh_string">'http://example.com/one'</span><span class="sh_symbol">,</span> <span class="sh_string">'/two'</span><span class="sh_symbol">)</span> <span class="sh_comment">// 'http://example.com/two'</span></code></pre>
<h1>Query String<a id="all_query_string" class="mark" href="#all_query_string">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>This module provides utilities for dealing with query strings. It provides the following methods:</p>
<h2>querystring.stringify(obj[, sep][, eq][, options])<a id="all_querystring_stringify_obj_sep_eq_options" class="mark" href="#all_querystring_stringify_obj_sep_eq_options">#</a></h2>
<p>Serialize an object to a query string. Optionally override the default separator (<code>'&amp;'</code>) and assignment (<code>'='</code>) characters.</p>
<p>Options object may contain <code>encodeURIComponent</code> property (<code>querystring.escape</code> by default), it can be used to encode string with <code>non-utf8</code> encoding if necessary.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>querystring<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> foo<span class="sh_symbol">:</span> <span class="sh_string">'bar'</span><span class="sh_symbol">,</span> baz<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'qux'</span><span class="sh_symbol">,</span> <span class="sh_string">'quux'</span><span class="sh_symbol">],</span> corge<span class="sh_symbol">:</span> <span class="sh_string">''</span> <span class="sh_cbracket">}</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'foo=bar&amp;baz=qux&amp;baz=quux&amp;corge='</span>

querystring<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>foo<span class="sh_symbol">:</span> <span class="sh_string">'bar'</span><span class="sh_symbol">,</span> baz<span class="sh_symbol">:</span> <span class="sh_string">'qux'</span><span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_string">';'</span><span class="sh_symbol">,</span> <span class="sh_string">':'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'foo:bar;baz:qux'</span>

<span class="sh_comment">// Suppose gbkEncodeURIComponent function already exists,</span>
<span class="sh_comment">// it can encode string with `gbk` encoding</span>
querystring<span class="sh_symbol">.</span><span class="sh_function">stringify</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> w<span class="sh_symbol">:</span> <span class="sh_string">'中文'</span><span class="sh_symbol">,</span> foo<span class="sh_symbol">:</span> <span class="sh_string">'bar'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> <span class="sh_predef_func">encodeURIComponent</span><span class="sh_symbol">:</span> gbkEncodeURIComponent <span class="sh_cbracket">}</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_string">'w=%D6%D0%CE%C4&amp;foo=bar'</span></code></pre>
<h2>querystring.parse(str[, sep][, eq][, options])<a id="all_querystring_parse_str_sep_eq_options" class="mark" href="#all_querystring_parse_str_sep_eq_options">#</a></h2>
<p>Deserialize a query string to an object. Optionally override the default separator (<code>'&amp;'</code>) and assignment (<code>'='</code>) characters.</p>
<p>Options object may contain <code>maxKeys</code> property (equal to 1000 by default), it'll be used to limit processed keys. Set it to 0 to remove key count limitation.</p>
<p>Options object may contain <code>decodeURIComponent</code> property (<code>querystring.unescape</code> by default), it can be used to decode a <code>non-utf8</code> encoding string if necessary.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>querystring<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span><span class="sh_string">'foo=bar&amp;baz=qux&amp;baz=quux&amp;corge'</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_cbracket">{</span> foo<span class="sh_symbol">:</span> <span class="sh_string">'bar'</span><span class="sh_symbol">,</span> baz<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'qux'</span><span class="sh_symbol">,</span> <span class="sh_string">'quux'</span><span class="sh_symbol">],</span> corge<span class="sh_symbol">:</span> <span class="sh_string">''</span> <span class="sh_cbracket">}</span>

<span class="sh_comment">// Suppose gbkDecodeURIComponent function already exists,</span>
<span class="sh_comment">// it can decode `gbk` encoding string</span>
querystring<span class="sh_symbol">.</span><span class="sh_function">parse</span><span class="sh_symbol">(</span><span class="sh_string">'w=%D6%D0%CE%C4&amp;foo=bar'</span><span class="sh_symbol">,</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> <span class="sh_predef_func">decodeURIComponent</span><span class="sh_symbol">:</span> gbkDecodeURIComponent <span class="sh_cbracket">}</span><span class="sh_symbol">)</span>
<span class="sh_comment">// returns</span>
<span class="sh_cbracket">{</span> w<span class="sh_symbol">:</span> <span class="sh_string">'中文'</span><span class="sh_symbol">,</span> foo<span class="sh_symbol">:</span> <span class="sh_string">'bar'</span> <span class="sh_cbracket">}</span></code></pre>
<h2>querystring.escape<a id="all_querystring_escape" class="mark" href="#all_querystring_escape">#</a></h2>
<p>The escape function used by <code>querystring.stringify</code>, provided so that it could be overridden if necessary.</p>
<h2>querystring.unescape<a id="all_querystring_unescape" class="mark" href="#all_querystring_unescape">#</a></h2>
<p>The unescape function used by <code>querystring.parse</code>, provided so that it could be overridden if necessary.</p>
<p>It will try to use <code>decodeURIComponent</code> in the first place, but if that fails it falls back to a safer equivalent that doesn't throw on malformed URLs.</p>
<h1>punycode<a id="all_punycode" class="mark" href="#all_punycode">#</a></h1>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable</pre>
<p><a href="http://mths.be/punycode">Punycode.js</a> is bundled with Node.js v0.6.2+. Use <code>require('punycode')</code> to access it. (To use it with other Node.js versions, use npm to install the <code>punycode</code> module first.)</p>
<h2>punycode.decode(string)<a id="all_punycode_decode_string" class="mark" href="#all_punycode_decode_string">#</a></h2>
<p>Converts a Punycode string of ASCII-only symbols to a string of Unicode symbols.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// decode domain name parts</span>
punycode<span class="sh_symbol">.</span><span class="sh_function">decode</span><span class="sh_symbol">(</span><span class="sh_string">'maana-pta'</span><span class="sh_symbol">);</span> <span class="sh_comment">// 'ma&ntilde;ana'</span>
punycode<span class="sh_symbol">.</span><span class="sh_function">decode</span><span class="sh_symbol">(</span><span class="sh_string">'--dqo34k'</span><span class="sh_symbol">);</span> <span class="sh_comment">// '☃-⌘'</span></code></pre>
<h2>punycode.encode(string)<a id="all_punycode_encode_string" class="mark" href="#all_punycode_encode_string">#</a></h2>
<p>Converts a string of Unicode symbols to a Punycode string of ASCII-only symbols.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// encode domain name parts</span>
punycode<span class="sh_symbol">.</span><span class="sh_function">encode</span><span class="sh_symbol">(</span><span class="sh_string">'ma&ntilde;ana'</span><span class="sh_symbol">);</span> <span class="sh_comment">// 'maana-pta'</span>
punycode<span class="sh_symbol">.</span><span class="sh_function">encode</span><span class="sh_symbol">(</span><span class="sh_string">'☃-⌘'</span><span class="sh_symbol">);</span> <span class="sh_comment">// '--dqo34k'</span></code></pre>
<h2>punycode.toUnicode(domain)<a id="all_punycode_tounicode_domain" class="mark" href="#all_punycode_tounicode_domain">#</a></h2>
<p>Converts a Punycode string representing a domain name to Unicode. Only the Punycoded parts of the domain name will be converted, i.e. it doesn't matter if you call it on a string that has already been converted to Unicode.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// decode domain names</span>
punycode<span class="sh_symbol">.</span><span class="sh_function">toUnicode</span><span class="sh_symbol">(</span><span class="sh_string">'xn--maana-pta.com'</span><span class="sh_symbol">);</span> <span class="sh_comment">// 'ma&ntilde;ana.com'</span>
punycode<span class="sh_symbol">.</span><span class="sh_function">toUnicode</span><span class="sh_symbol">(</span><span class="sh_string">'xn----dqo34k.com'</span><span class="sh_symbol">);</span> <span class="sh_comment">// '☃-⌘.com'</span></code></pre>
<h2>punycode.toASCII(domain)<a id="all_punycode_toascii_domain" class="mark" href="#all_punycode_toascii_domain">#</a></h2>
<p>Converts a Unicode string representing a domain name to Punycode. Only the non-ASCII parts of the domain name will be converted, i.e. it doesn't matter if you call it with a domain that's already in ASCII.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// encode domain names</span>
punycode<span class="sh_symbol">.</span><span class="sh_function">toASCII</span><span class="sh_symbol">(</span><span class="sh_string">'ma&ntilde;ana.com'</span><span class="sh_symbol">);</span> <span class="sh_comment">// 'xn--maana-pta.com'</span>
punycode<span class="sh_symbol">.</span><span class="sh_function">toASCII</span><span class="sh_symbol">(</span><span class="sh_string">'☃-⌘.com'</span><span class="sh_symbol">);</span> <span class="sh_comment">// 'xn----dqo34k.com'</span></code></pre>
<h2>punycode.ucs2<a id="all_punycode_ucs2" class="mark" href="#all_punycode_ucs2">#</a></h2>
<h3>punycode.ucs2.decode(string)<a id="all_punycode_ucs2_decode_string" class="mark" href="#all_punycode_ucs2_decode_string">#</a></h3>
<p>Creates an array containing the numeric code point values of each Unicode symbol in the string. While <a href="http://mathiasbynens.be/notes/javascript-encoding">JavaScript uses UCS-2 internally</a>, this function will convert a pair of surrogate halves (each of which UCS-2 exposes as separate characters) into a single code point, matching UTF-16.</p>
<pre class="sh_sourceCode"><code>punycode<span class="sh_symbol">.</span>ucs2<span class="sh_symbol">.</span><span class="sh_function">decode</span><span class="sh_symbol">(</span><span class="sh_string">'abc'</span><span class="sh_symbol">);</span> <span class="sh_comment">// [0x61, 0x62, 0x63]</span>
<span class="sh_comment">// surrogate pair for U+1D306 tetragram for centre:</span>
punycode<span class="sh_symbol">.</span>ucs2<span class="sh_symbol">.</span><span class="sh_function">decode</span><span class="sh_symbol">(</span><span class="sh_string">'</span><span class="sh_specialchar">\u</span><span class="sh_string">D834</span><span class="sh_specialchar">\u</span><span class="sh_string">DF06'</span><span class="sh_symbol">);</span> <span class="sh_comment">// [0x1D306]</span></code></pre>
<h3>punycode.ucs2.encode(codePoints)<a id="all_punycode_ucs2_encode_codepoints" class="mark" href="#all_punycode_ucs2_encode_codepoints">#</a></h3>
<p>Creates a string based on an array of numeric code point values.</p>
<pre class="sh_sourceCode"><code>punycode<span class="sh_symbol">.</span>ucs2<span class="sh_symbol">.</span><span class="sh_function">encode</span><span class="sh_symbol">([</span><span class="sh_number">0x61</span><span class="sh_symbol">,</span> <span class="sh_number">0x62</span><span class="sh_symbol">,</span> <span class="sh_number">0x63</span><span class="sh_symbol">]);</span> <span class="sh_comment">// 'abc'</span>
punycode<span class="sh_symbol">.</span>ucs2<span class="sh_symbol">.</span><span class="sh_function">encode</span><span class="sh_symbol">([</span><span class="sh_number">0x1D306</span><span class="sh_symbol">]);</span> <span class="sh_comment">// '\uD834\uDF06'</span></code></pre>
<h2>punycode.version<a id="all_punycode_version" class="mark" href="#all_punycode_version">#</a></h2>
<p>A string representing the current Punycode.js version number.</p>
<h1>Readline<a id="all_readline" class="mark" href="#all_readline">#</a></h1>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable</pre>
<p>To use this module, do <code>require('readline')</code>. Readline allows reading of a stream (such as <code>process.stdin</code>) on a line-by-line basis.</p>
<p>Note that once you've invoked this module, your node program will not terminate until you've closed the interface. Here's how to allow your program to gracefully exit:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> readline <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'readline'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> rl <span class="sh_symbol">=</span> readline<span class="sh_symbol">.</span><span class="sh_function">createInterface</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  input<span class="sh_symbol">:</span> process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">,</span>
  output<span class="sh_symbol">:</span> process<span class="sh_symbol">.</span>stdout
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

rl<span class="sh_symbol">.</span><span class="sh_function">question</span><span class="sh_symbol">(</span><span class="sh_string">"What do you think of node.js? "</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>answer<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// TODO: Log the answer in a database</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"Thank you for your valuable feedback:"</span><span class="sh_symbol">,</span> answer<span class="sh_symbol">);</span>

  rl<span class="sh_symbol">.</span><span class="sh_function">close</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>readline.createInterface(options)<a id="all_readline_createinterface_options" class="mark" href="#all_readline_createinterface_options">#</a></h2>
<p>Creates a readline <code>Interface</code> instance. Accepts an "options" Object that takes the following values:</p>
<ul>
<li>
<p><code>input</code> - the readable stream to listen to (Required).</p>
</li>
<li>
<p><code>output</code> - the writable stream to write readline data to (Optional).</p>
</li>
<li>
<p><code>completer</code> - an optional function that is used for Tab autocompletion. See below for an example of using this.</p>
</li>
<li>
<p><code>terminal</code> - pass <code>true</code> if the <code>input</code> and <code>output</code> streams should be treated like a TTY, and have ANSI/VT100 escape codes written to it. Defaults to checking <code>isTTY</code> on the <code>output</code> stream upon instantiation.</p>
</li>
</ul>
<p>The <code>completer</code> function is given the current line entered by the user, and is supposed to return an Array with 2 entries:</p>
<ol>
<li>
<p>An Array with matching entries for the completion.</p>
</li>
<li>
<p>The substring that was used for the matching.</p>
</li>
</ol>
<p>Which ends up looking something like: <code>[[substr1, substr2, ...], originalsubstring]</code>.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">function</span> <span class="sh_function">completer</span><span class="sh_symbol">(</span>line<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> completions <span class="sh_symbol">=</span> <span class="sh_string">'.help .error .exit .quit .q'</span><span class="sh_symbol">.</span><span class="sh_function">split</span><span class="sh_symbol">(</span><span class="sh_string">' '</span><span class="sh_symbol">)</span>
  <span class="sh_keyword">var</span> hits <span class="sh_symbol">=</span> completions<span class="sh_symbol">.</span><span class="sh_function">filter</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>c<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> <span class="sh_keyword">return</span> c<span class="sh_symbol">.</span><span class="sh_function">indexOf</span><span class="sh_symbol">(</span>line<span class="sh_symbol">)</span> <span class="sh_symbol">==</span> <span class="sh_number">0</span> <span class="sh_cbracket">}</span><span class="sh_symbol">)</span>
  <span class="sh_comment">// show all completions if none found</span>
  <span class="sh_keyword">return</span> <span class="sh_symbol">[</span>hits<span class="sh_symbol">.</span>length <span class="sh_symbol">?</span> hits <span class="sh_symbol">:</span> completions<span class="sh_symbol">,</span> line<span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span></code></pre>
<p>Also <code>completer</code> can be run in async mode if it accepts two arguments:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">function</span> <span class="sh_function">completer</span><span class="sh_symbol">(</span>linePartial<span class="sh_symbol">,</span> callback<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">callback</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_symbol">[[</span><span class="sh_string">'123'</span><span class="sh_symbol">],</span> linePartial<span class="sh_symbol">]);</span>
<span class="sh_cbracket">}</span></code></pre>
<p><code>createInterface</code> is commonly used with <code>process.stdin</code> and <code>process.stdout</code> in order to accept user input:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> readline <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'readline'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> rl <span class="sh_symbol">=</span> readline<span class="sh_symbol">.</span><span class="sh_function">createInterface</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  input<span class="sh_symbol">:</span> process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">,</span>
  output<span class="sh_symbol">:</span> process<span class="sh_symbol">.</span>stdout
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Once you have a readline instance, you most commonly listen for the <code>"line"</code> event.</p>
<p>If <code>terminal</code> is <code>true</code> for this instance then the <code>output</code> stream will get the best compatibility if it defines an <code>output.columns</code> property, and fires a <code>"resize"</code> event on the <code>output</code> if/when the columns ever change (<code>process.stdout</code> does this automatically when it is a TTY).</p>
<h2>Class: Interface<a id="all_class_interface" class="mark" href="#all_class_interface">#</a></h2>
<p>The class that represents a readline interface with an input and output stream.</p>
<h3>rl.setPrompt(prompt)<a id="all_rl_setprompt_prompt" class="mark" href="#all_rl_setprompt_prompt">#</a></h3>
<p>Sets the prompt, for example when you run <code>node</code> on the command line, you see <code>&gt; </code>, which is node's prompt.</p>
<h3>rl.prompt([preserveCursor])<a id="all_rl_prompt_preservecursor" class="mark" href="#all_rl_prompt_preservecursor">#</a></h3>
<p>Readies readline for input from the user, putting the current <code>setPrompt</code> options on a new line, giving the user a new spot to write. Set <code>preserveCursor</code> to <code>true</code> to prevent the cursor placement being reset to <code>0</code>.</p>
<p>This will also resume the <code>input</code> stream used with <code>createInterface</code> if it has been paused.</p>
<p>If <code>output</code> is set to <code>null</code> or <code>undefined</code> when calling <code>createInterface</code>, the prompt is not written.</p>
<h3>rl.question(query, callback)<a id="all_rl_question_query_callback" class="mark" href="#all_rl_question_query_callback">#</a></h3>
<p>Prepends the prompt with <code>query</code> and invokes <code>callback</code> with the user's response. Displays the query to the user, and then invokes <code>callback</code> with the user's response after it has been typed.</p>
<p>This will also resume the <code>input</code> stream used with <code>createInterface</code> if it has been paused.</p>
<p>If <code>output</code> is set to <code>null</code> or <code>undefined</code> when calling <code>createInterface</code>, nothing is displayed.</p>
<p>Example usage:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">interface</span><span class="sh_symbol">.</span><span class="sh_function">question</span><span class="sh_symbol">(</span><span class="sh_string">'What is your favorite food?'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>answer<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Oh, so your favorite food is '</span> <span class="sh_symbol">+</span> answer<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>rl.pause()<a id="all_rl_pause" class="mark" href="#all_rl_pause">#</a></h3>
<p>Pauses the readline <code>input</code> stream, allowing it to be resumed later if needed.</p>
<p>Note that this doesn't immediately pause the stream of events. Several events may be emitted after calling <code>pause</code>, including <code>line</code>.</p>
<h3>rl.resume()<a id="all_rl_resume" class="mark" href="#all_rl_resume">#</a></h3>
<p>Resumes the readline <code>input</code> stream.</p>
<h3>rl.close()<a id="all_rl_close" class="mark" href="#all_rl_close">#</a></h3>
<p>Closes the <code>Interface</code> instance, relinquishing control on the <code>input</code> and <code>output</code> streams. The "close" event will also be emitted.</p>
<h3>rl.write(data[, key])<a id="all_rl_write_data_key" class="mark" href="#all_rl_write_data_key">#</a></h3>
<p>Writes <code>data</code> to <code>output</code> stream, unless <code>output</code> is set to <code>null</code> or <code>undefined</code> when calling <code>createInterface</code>. <code>key</code> is an object literal to represent a key sequence; available if the terminal is a TTY.</p>
<p>This will also resume the <code>input</code> stream if it has been paused.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code>rl<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_string">'Delete me!'</span><span class="sh_symbol">);</span>
<span class="sh_comment">// Simulate ctrl+u to delete the line written previously</span>
rl<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span>ctrl<span class="sh_symbol">:</span> <span class="sh_keyword">true</span><span class="sh_symbol">,</span> name<span class="sh_symbol">:</span> <span class="sh_string">'u'</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Events<a id="all_events_1" class="mark" href="#all_events_1">#</a></h2>
<h3>Event: 'line'<a id="all_event_line" class="mark" href="#all_event_line">#</a></h3>
<p><code>function (line) {}</code></p>
<p>Emitted whenever the <code>input</code> stream receives a <code>\n</code>, usually received when the user hits enter, or return. This is a good hook to listen for user input.</p>
<p>Example of listening for <code>line</code>:</p>
<pre class="sh_sourceCode"><code>rl<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'line'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>cmd<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'You just typed: '</span><span class="sh_symbol">+</span>cmd<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'pause'<a id="all_event_pause" class="mark" href="#all_event_pause">#</a></h3>
<p><code>function () {}</code></p>
<p>Emitted whenever the <code>input</code> stream is paused.</p>
<p>Also emitted whenever the <code>input</code> stream is not paused and receives the <code>SIGCONT</code> event. (See events <code>SIGTSTP</code> and <code>SIGCONT</code>)</p>
<p>Example of listening for <code>pause</code>:</p>
<pre class="sh_sourceCode"><code>rl<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'pause'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Readline paused.'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'resume'<a id="all_event_resume" class="mark" href="#all_event_resume">#</a></h3>
<p><code>function () {}</code></p>
<p>Emitted whenever the <code>input</code> stream is resumed.</p>
<p>Example of listening for <code>resume</code>:</p>
<pre class="sh_sourceCode"><code>rl<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'resume'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Readline resumed.'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'close'<a id="all_event_close_7" class="mark" href="#all_event_close_7">#</a></h3>
<p><code>function () {}</code></p>
<p>Emitted when <code>close()</code> is called.</p>
<p>Also emitted when the <code>input</code> stream receives its "end" event. The <code>Interface</code> instance should be considered "finished" once this is emitted. For example, when the <code>input</code> stream receives <code>^D</code>, respectively known as <code>EOT</code>.</p>
<p>This event is also called if there is no <code>SIGINT</code> event listener present when the <code>input</code> stream receives a <code>^C</code>, respectively known as <code>SIGINT</code>.</p>
<h3>Event: 'SIGINT'<a id="all_event_sigint" class="mark" href="#all_event_sigint">#</a></h3>
<p><code>function () {}</code></p>
<p>Emitted whenever the <code>input</code> stream receives a <code>^C</code>, respectively known as <code>SIGINT</code>. If there is no <code>SIGINT</code> event listener present when the <code>input</code> stream receives a <code>SIGINT</code>, <code>pause</code> will be triggered.</p>
<p>Example of listening for <code>SIGINT</code>:</p>
<pre class="sh_sourceCode"><code>rl<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'SIGINT'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  rl<span class="sh_symbol">.</span><span class="sh_function">question</span><span class="sh_symbol">(</span><span class="sh_string">'Are you sure you want to exit?'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>answer<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>answer<span class="sh_symbol">.</span><span class="sh_function">match</span><span class="sh_symbol">(</span><span class="sh_regexp">/^y(es)?$/i</span><span class="sh_symbol">))</span> rl<span class="sh_symbol">.</span><span class="sh_function">pause</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'SIGTSTP'<a id="all_event_sigtstp" class="mark" href="#all_event_sigtstp">#</a></h3>
<p><code>function () {}</code></p>
<p><strong>This does not work on Windows.</strong></p>
<p>Emitted whenever the <code>input</code> stream receives a <code>^Z</code>, respectively known as <code>SIGTSTP</code>. If there is no <code>SIGTSTP</code> event listener present when the <code>input</code> stream receives a <code>SIGTSTP</code>, the program will be sent to the background.</p>
<p>When the program is resumed with <code>fg</code>, the <code>pause</code> and <code>SIGCONT</code> events will be emitted. You can use either to resume the stream.</p>
<p>The <code>pause</code> and <code>SIGCONT</code> events will not be triggered if the stream was paused before the program was sent to the background.</p>
<p>Example of listening for <code>SIGTSTP</code>:</p>
<pre class="sh_sourceCode"><code>rl<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'SIGTSTP'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// This will override SIGTSTP and prevent the program from going to the</span>
  <span class="sh_comment">// background.</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Caught SIGTSTP.'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'SIGCONT'<a id="all_event_sigcont" class="mark" href="#all_event_sigcont">#</a></h3>
<p><code>function () {}</code></p>
<p><strong>This does not work on Windows.</strong></p>
<p>Emitted whenever the <code>input</code> stream is sent to the background with <code>^Z</code>, respectively known as <code>SIGTSTP</code>, and then continued with <code>fg(1)</code>. This event only emits if the stream was not paused before sending the program to the background.</p>
<p>Example of listening for <code>SIGCONT</code>:</p>
<pre class="sh_sourceCode"><code>rl<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'SIGCONT'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// `prompt` will automatically resume the stream</span>
  rl<span class="sh_symbol">.</span><span class="sh_function">prompt</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Example: Tiny CLI<a id="all_example_tiny_cli" class="mark" href="#all_example_tiny_cli">#</a></h2>
<p>Here's an example of how to use all these together to craft a tiny command line interface:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> readline <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'readline'</span><span class="sh_symbol">),</span>
    rl <span class="sh_symbol">=</span> readline<span class="sh_symbol">.</span><span class="sh_function">createInterface</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">,</span> process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">);</span>

rl<span class="sh_symbol">.</span><span class="sh_function">setPrompt</span><span class="sh_symbol">(</span><span class="sh_string">'OHAI&gt; '</span><span class="sh_symbol">);</span>
rl<span class="sh_symbol">.</span><span class="sh_function">prompt</span><span class="sh_symbol">();</span>

rl<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'line'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>line<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">switch</span><span class="sh_symbol">(</span>line<span class="sh_symbol">.</span><span class="sh_function">trim</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">case</span> <span class="sh_string">'hello'</span><span class="sh_symbol">:</span>
      console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'world!'</span><span class="sh_symbol">);</span>
      <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">default</span><span class="sh_symbol">:</span>
      console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Say what? I might have heard `'</span> <span class="sh_symbol">+</span> line<span class="sh_symbol">.</span><span class="sh_function">trim</span><span class="sh_symbol">()</span> <span class="sh_symbol">+</span> <span class="sh_string">'`'</span><span class="sh_symbol">);</span>
      <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span>
  rl<span class="sh_symbol">.</span><span class="sh_function">prompt</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'close'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Have a great day!'</span><span class="sh_symbol">);</span>
  process<span class="sh_symbol">.</span><span class="sh_function">exit</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>readline.cursorTo(stream, x, y)<a id="all_readline_cursorto_stream_x_y" class="mark" href="#all_readline_cursorto_stream_x_y">#</a></h2>
<p>Move cursor to the specified position in a given TTY stream.</p>
<h2>readline.moveCursor(stream, dx, dy)<a id="all_readline_movecursor_stream_dx_dy" class="mark" href="#all_readline_movecursor_stream_dx_dy">#</a></h2>
<p>Move cursor relative to it's current position in a given TTY stream.</p>
<h2>readline.clearLine(stream, dir)<a id="all_readline_clearline_stream_dir" class="mark" href="#all_readline_clearline_stream_dir">#</a></h2>
<p>Clears current line of given TTY stream in a specified direction. <code>dir</code> should have one of following values:</p>
<ul>
<li><code>-1</code> - to the left from cursor</li>
<li><code>1</code> - to the right from cursor</li>
<li><code>0</code> - the entire line</li>
</ul>
<h2>readline.clearScreenDown(stream)<a id="all_readline_clearscreendown_stream" class="mark" href="#all_readline_clearscreendown_stream">#</a></h2>
<p>Clears the screen from the current position of the cursor down.</p>
<h1>REPL<a id="all_repl" class="mark" href="#all_repl">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>A Read-Eval-Print-Loop (REPL) is available both as a standalone program and easily includable in other programs. The REPL provides a way to interactively run JavaScript and see the results. It can be used for debugging, testing, or just trying things out.</p>
<p>By executing <code>node</code> without any arguments from the command-line you will be dropped into the REPL. It has simplistic emacs line-editing.</p>
<pre class="sh_sourceCode"><code>mjr<span class="sh_symbol">:~</span>$ node
Type <span class="sh_string">'.help'</span> <span class="sh_keyword">for</span> options<span class="sh_symbol">.</span>
<span class="sh_symbol">&gt;</span> a <span class="sh_symbol">=</span> <span class="sh_symbol">[</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">];</span>
<span class="sh_symbol">[</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">3</span> <span class="sh_symbol">]</span>
<span class="sh_symbol">&gt;</span> a<span class="sh_symbol">.</span><span class="sh_function">forEach</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>v<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
<span class="sh_symbol">...</span>   console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>v<span class="sh_symbol">);</span>
<span class="sh_symbol">...</span>   <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_number">1</span>
<span class="sh_number">2</span>
<span class="sh_number">3</span></code></pre>
<p>For advanced line-editors, start node with the environmental variable <code>NODE_NO_READLINE=1</code>. This will start the main and debugger REPL in canonical terminal settings which will allow you to use with <code>rlwrap</code>.</p>
<p>For example, you could add this to your bashrc file:</p>
<pre class="sh_sourceCode"><code>alias node<span class="sh_symbol">=</span><span class="sh_string">"env NODE_NO_READLINE=1 rlwrap node"</span></code></pre>
<h2>repl.start(options)<a id="all_repl_start_options" class="mark" href="#all_repl_start_options">#</a></h2>
<p>Returns and starts a <code>REPLServer</code> instance, that inherits from [Readline Interface][]. Accepts an "options" Object that takes the following values:</p>
<ul>
<li>
<p><code>prompt</code> - the prompt and <code>stream</code> for all I/O. Defaults to <code>&gt; </code>.</p>
</li>
<li>
<p><code>input</code> - the readable stream to listen to. Defaults to <code>process.stdin</code>.</p>
</li>
<li>
<p><code>output</code> - the writable stream to write readline data to. Defaults to <code>process.stdout</code>.</p>
</li>
<li>
<p><code>terminal</code> - pass <code>true</code> if the <code>stream</code> should be treated like a TTY, and have ANSI/VT100 escape codes written to it. Defaults to checking <code>isTTY</code> on the <code>output</code> stream upon instantiation.</p>
</li>
<li>
<p><code>eval</code> - function that will be used to eval each given line. Defaults to an async wrapper for <code>eval()</code>. See below for an example of a custom <code>eval</code>.</p>
</li>
<li>
<p><code>useColors</code> - a boolean which specifies whether or not the <code>writer</code> function should output colors. If a different <code>writer</code> function is set then this does nothing. Defaults to the repl's <code>terminal</code> value.</p>
</li>
<li>
<p><code>useGlobal</code> - if set to <code>true</code>, then the repl will use the <code>global</code> object, instead of running scripts in a separate context. Defaults to <code>false</code>.</p>
</li>
<li>
<p><code>ignoreUndefined</code> - if set to <code>true</code>, then the repl will not output the return value of command if it's <code>undefined</code>. Defaults to <code>false</code>.</p>
</li>
<li>
<p><code>writer</code> - the function to invoke for each command that gets evaluated which returns the formatting (including coloring) to display. Defaults to <code>util.inspect</code>.</p>
</li>
</ul>
<p>You can use your own <code>eval</code> function if it has following signature:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">function</span> <span class="sh_predef_func">eval</span><span class="sh_symbol">(</span>cmd<span class="sh_symbol">,</span> context<span class="sh_symbol">,</span> filename<span class="sh_symbol">,</span> callback<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">callback</span><span class="sh_symbol">(</span><span class="sh_keyword">null</span><span class="sh_symbol">,</span> result<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<p>Multiple REPLs may be started against the same running instance of node. Each will share the same global object but will have unique I/O.</p>
<p>Here is an example that starts a REPL on stdin, a Unix socket, and a TCP socket:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> net <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">"net"</span><span class="sh_symbol">),</span>
    repl <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">"repl"</span><span class="sh_symbol">);</span>

connections <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>

repl<span class="sh_symbol">.</span><span class="sh_function">start</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  prompt<span class="sh_symbol">:</span> <span class="sh_string">"node via stdin&gt; "</span><span class="sh_symbol">,</span>
  input<span class="sh_symbol">:</span> process<span class="sh_symbol">.</span>stdin<span class="sh_symbol">,</span>
  output<span class="sh_symbol">:</span> process<span class="sh_symbol">.</span>stdout
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

net<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  connections <span class="sh_symbol">+=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
  repl<span class="sh_symbol">.</span><span class="sh_function">start</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
    prompt<span class="sh_symbol">:</span> <span class="sh_string">"node via Unix socket&gt; "</span><span class="sh_symbol">,</span>
    input<span class="sh_symbol">:</span> socket<span class="sh_symbol">,</span>
    output<span class="sh_symbol">:</span> socket
  <span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">)</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_string">"/tmp/node-repl-sock"</span><span class="sh_symbol">);</span>

net<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  connections <span class="sh_symbol">+=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
  repl<span class="sh_symbol">.</span><span class="sh_function">start</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
    prompt<span class="sh_symbol">:</span> <span class="sh_string">"node via TCP socket&gt; "</span><span class="sh_symbol">,</span>
    input<span class="sh_symbol">:</span> socket<span class="sh_symbol">,</span>
    output<span class="sh_symbol">:</span> socket
  <span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">5001</span><span class="sh_symbol">);</span></code></pre>
<p>Running this program from the command line will start a REPL on stdin. Other REPL clients may connect through the Unix socket or TCP socket. <code>telnet</code> is useful for connecting to TCP sockets, and <code>socat</code> can be used to connect to both Unix and TCP sockets.</p>
<p>By starting a REPL from a Unix socket-based server instead of stdin, you can connect to a long-running node process without restarting it.</p>
<p>For an example of running a "full-featured" (<code>terminal</code>) REPL over a <code>net.Server</code> and <code>net.Socket</code> instance, see: <a href="https://gist.github.com/2209310">https://gist.github.com/2209310</a></p>
<p>For an example of running a REPL instance over <code>curl(1)</code>, see: <a href="https://gist.github.com/2053342">https://gist.github.com/2053342</a></p>
<h3>Event: 'exit'<a id="all_event_exit_1" class="mark" href="#all_event_exit_1">#</a></h3>
<p><code>function () {}</code></p>
<p>Emitted when the user exits the REPL in any of the defined ways. Namely, typing <code>.exit</code> at the repl, pressing Ctrl+C twice to signal SIGINT, or pressing Ctrl+D to signal "end" on the <code>input</code> stream.</p>
<p>Example of listening for <code>exit</code>:</p>
<pre class="sh_sourceCode"><code>r<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Got "exit" event from repl!'</span><span class="sh_symbol">);</span>
  process<span class="sh_symbol">.</span><span class="sh_function">exit</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'reset'<a id="all_event_reset" class="mark" href="#all_event_reset">#</a></h3>
<p><code>function (context) {}</code></p>
<p>Emitted when the REPL's context is reset. This happens when you type <code>.clear</code>. If you start the repl with <code>{ useGlobal: true }</code> then this event will never be emitted.</p>
<p>Example of listening for <code>reset</code>:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// Extend the initial repl context.</span>
r <span class="sh_symbol">=</span> repl<span class="sh_symbol">.</span><span class="sh_function">start</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> options <span class="sh_symbol">...</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
someExtension<span class="sh_symbol">.</span><span class="sh_function">extend</span><span class="sh_symbol">(</span>r<span class="sh_symbol">.</span>context<span class="sh_symbol">);</span>

<span class="sh_comment">// When a new context is created extend it as well.</span>
r<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'reset'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>context<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'repl has a new context'</span><span class="sh_symbol">);</span>
  someExtension<span class="sh_symbol">.</span><span class="sh_function">extend</span><span class="sh_symbol">(</span>context<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>REPL Features<a id="all_repl_features" class="mark" href="#all_repl_features">#</a></h2>
<p>Inside the REPL, Control+D will exit. Multi-line expressions can be input. Tab completion is supported for both global and local variables.</p>
<p>The special variable <code>_</code> (underscore) contains the result of the last expression.</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">&gt;</span> <span class="sh_symbol">[</span> <span class="sh_string">"a"</span><span class="sh_symbol">,</span> <span class="sh_string">"b"</span><span class="sh_symbol">,</span> <span class="sh_string">"c"</span> <span class="sh_symbol">]</span>
<span class="sh_symbol">[</span> <span class="sh_string">'a'</span><span class="sh_symbol">,</span> <span class="sh_string">'b'</span><span class="sh_symbol">,</span> <span class="sh_string">'c'</span> <span class="sh_symbol">]</span>
<span class="sh_symbol">&gt;</span> _<span class="sh_symbol">.</span>length
<span class="sh_number">3</span>
<span class="sh_symbol">&gt;</span> _ <span class="sh_symbol">+=</span> <span class="sh_number">1</span>
<span class="sh_number">4</span></code></pre>
<p>The REPL provides access to any variables in the global scope. You can expose a variable to the REPL explicitly by assigning it to the <code>context</code> object associated with each <code>REPLServer</code>. For example:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// repl_test.js</span>
<span class="sh_keyword">var</span> repl <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">"repl"</span><span class="sh_symbol">),</span>
    msg <span class="sh_symbol">=</span> <span class="sh_string">"message"</span><span class="sh_symbol">;</span>

repl<span class="sh_symbol">.</span><span class="sh_function">start</span><span class="sh_symbol">(</span><span class="sh_string">"&gt; "</span><span class="sh_symbol">).</span>context<span class="sh_symbol">.</span>m <span class="sh_symbol">=</span> msg<span class="sh_symbol">;</span></code></pre>
<p>Things in the <code>context</code> object appear as local within the REPL:</p>
<pre class="sh_sourceCode"><code>mjr<span class="sh_symbol">:~</span>$ node repl_test<span class="sh_symbol">.</span>js
<span class="sh_symbol">&gt;</span> m
<span class="sh_string">'message'</span></code></pre>
<p>There are a few special REPL commands:</p>
<ul>
<li><code>.break</code> - While inputting a multi-line expression, sometimes you get lost or just don't care about completing it. <code>.break</code> will start over.</li>
<li><code>.clear</code> - Resets the <code>context</code> object to an empty object and clears any multi-line expression.</li>
<li><code>.exit</code> - Close the I/O stream, which will cause the REPL to exit.</li>
<li><code>.help</code> - Show this list of special commands.</li>
<li><code>.save</code> - Save the current REPL session to a file
<blockquote>
<p>.save ./file/to/save.js</p>
</blockquote>
</li>
<li><code>.load</code> - Load a file into the current REPL session.
<blockquote>
<p>.load ./file/to/load.js</p>
</blockquote>
</li>
</ul>
<p>The following key combinations in the REPL have these special effects:</p>
<ul>
<li><code>&lt;ctrl&gt;C</code> - Similar to the <code>.break</code> keyword. Terminates the current command. Press twice on a blank line to forcibly exit.</li>
<li><code>&lt;ctrl&gt;D</code> - Similar to the <code>.exit</code> keyword.</li>
</ul>
<h1>Executing JavaScript<a id="all_executing_javascript" class="mark" href="#all_executing_javascript">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>You can access this module with:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> vm <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'vm'</span><span class="sh_symbol">);</span></code></pre>
<p>JavaScript code can be compiled and run immediately or compiled, saved, and run later.</p>
<h2>vm.runInThisContext(code[, options])<a id="all_vm_runinthiscontext_code_options" class="mark" href="#all_vm_runinthiscontext_code_options">#</a></h2>
<p><code>vm.runInThisContext()</code> compiles <code>code</code>, runs it and returns the result. Running code does not have access to local scope, but does have access to the current <code>global</code> object.</p>
<p>Example of using <code>vm.runInThisContext</code> and <code>eval</code> to run the same code:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> localVar <span class="sh_symbol">=</span> <span class="sh_string">'initial value'</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> vmResult <span class="sh_symbol">=</span> vm<span class="sh_symbol">.</span><span class="sh_function">runInThisContext</span><span class="sh_symbol">(</span><span class="sh_string">'localVar = "vm";'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'vmResult: '</span><span class="sh_symbol">,</span> vmResult<span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'localVar: '</span><span class="sh_symbol">,</span> localVar<span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> evalResult <span class="sh_symbol">=</span> <span class="sh_predef_func">eval</span><span class="sh_symbol">(</span><span class="sh_string">'localVar = "eval";'</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'evalResult: '</span><span class="sh_symbol">,</span> evalResult<span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'localVar: '</span><span class="sh_symbol">,</span> localVar<span class="sh_symbol">);</span>

<span class="sh_comment">// vmResult: 'vm', localVar: 'initial value'</span>
<span class="sh_comment">// evalResult: 'eval', localVar: 'eval'</span></code></pre>
<p><code>vm.runInThisContext</code> does not have access to the local scope, so <code>localVar</code> is unchanged. <code>eval</code> does have access to the local scope, so <code>localVar</code> is changed.</p>
<p>In this way <code>vm.runInThisContext</code> is much like an <a href="http://es5.github.io/#x10.4.2">indirect <code>eval</code> call</a>, e.g. <code>(0,eval)('code')</code>. However, it also has the following additional options:</p>
<ul>
<li><code>filename</code>: allows you to control the filename that shows up in any stack traces produced.</li>
<li><code>displayErrors</code>: whether or not to print any errors to stderr, with the line of code that caused them highlighted, before throwing an exception. Will capture both syntax errors from compiling <code>code</code> and runtime errors thrown by executing the compiled code. Defaults to <code>true</code>.</li>
<li><code>timeout</code>: a number of milliseconds to execute <code>code</code> before terminating execution. If execution is terminated, an <code>Error</code> will be thrown.</li>
</ul>
<h2>vm.createContext([sandbox])<a id="all_vm_createcontext_sandbox" class="mark" href="#all_vm_createcontext_sandbox">#</a></h2>
<p>If given a <code>sandbox</code> object, will "contextify" that sandbox so that it can be used in calls to <code>vm.runInContext</code> or <code>script.runInContext</code>. Inside scripts run as such, <code>sandbox</code> will be the global object, retaining all its existing properties but also having the built-in objects and functions any standard <a href="http://es5.github.io/#x15.1">global object</a> has. Outside of scripts run by the vm module, <code>sandbox</code> will be unchanged.</p>
<p>If not given a sandbox object, returns a new, empty contextified sandbox object you can use.</p>
<p>This function is useful for creating a sandbox that can be used to run multiple scripts, e.g. if you were emulating a web browser it could be used to create a single sandbox representing a window's global object, then run all <code>&lt;script&gt;</code> tags together inside that sandbox.</p>
<h2>vm.isContext(sandbox)<a id="all_vm_iscontext_sandbox" class="mark" href="#all_vm_iscontext_sandbox">#</a></h2>
<p>Returns whether or not a sandbox object has been contextified by calling <code>vm.createContext</code> on it.</p>
<h2>vm.runInContext(code, contextifiedSandbox[, options])<a id="all_vm_runincontext_code_contextifiedsandbox_options" class="mark" href="#all_vm_runincontext_code_contextifiedsandbox_options">#</a></h2>
<p><code>vm.runInContext</code> compiles <code>code</code>, then runs it in <code>contextifiedSandbox</code> and returns the result. Running code does not have access to local scope. The <code>contextifiedSandbox</code> object must have been previously contextified via <code>vm.createContext</code>; it will be used as the global object for <code>code</code>.</p>
<p><code>vm.runInContext</code> takes the same options as <code>vm.runInThisContext</code>.</p>
<p>Example: compile and execute different scripts in a single existing context.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> vm <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'vm'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> sandbox <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> globalVar<span class="sh_symbol">:</span> <span class="sh_number">1</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
vm<span class="sh_symbol">.</span><span class="sh_function">createContext</span><span class="sh_symbol">(</span>sandbox<span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">10</span><span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    vm<span class="sh_symbol">.</span><span class="sh_function">runInContext</span><span class="sh_symbol">(</span><span class="sh_string">'globalVar *= 2;'</span><span class="sh_symbol">,</span> sandbox<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>sandbox<span class="sh_symbol">));</span>

<span class="sh_comment">// { globalVar: 1024 }</span></code></pre>
<p>Note that running untrusted code is a tricky business requiring great care. <code>vm.runInContext</code> is quite useful, but safely running untrusted code requires a separate process.</p>
<h2>vm.runInNewContext(code[, sandbox][, options])<a id="all_vm_runinnewcontext_code_sandbox_options" class="mark" href="#all_vm_runinnewcontext_code_sandbox_options">#</a></h2>
<p><code>vm.runInNewContext</code> compiles <code>code</code>, contextifies <code>sandbox</code> if passed or creates a new contextified sandbox if it's omitted, and then runs the code with the sandbox as the global object and returns the result.</p>
<p><code>vm.runInNewContext</code> takes the same options as <code>vm.runInThisContext</code>.</p>
<p>Example: compile and execute code that increments a global variable and sets a new one. These globals are contained in the sandbox.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> vm <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'vm'</span><span class="sh_symbol">),</span>

<span class="sh_keyword">var</span> sandbox <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  animal<span class="sh_symbol">:</span> <span class="sh_string">'cat'</span><span class="sh_symbol">,</span>
  count<span class="sh_symbol">:</span> <span class="sh_number">2</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

vm<span class="sh_symbol">.</span><span class="sh_function">runInNewContext</span><span class="sh_symbol">(</span><span class="sh_string">'count += 1; name = "kitty"'</span><span class="sh_symbol">,</span> sandbox<span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>sandbox<span class="sh_symbol">));</span>

<span class="sh_comment">// { animal: 'cat', count: 3, name: 'kitty' }</span></code></pre>
<p>Note that running untrusted code is a tricky business requiring great care. <code>vm.runInNewContext</code> is quite useful, but safely running untrusted code requires a separate process.</p>
<h2>vm.runInDebugContext(code)<a id="all_vm_runindebugcontext_code" class="mark" href="#all_vm_runindebugcontext_code">#</a></h2>
<p><code>vm.runInDebugContext</code> compiles and executes <code>code</code> inside the V8 debug context. The primary use case is to get access to the V8 debug object:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> Debug <span class="sh_symbol">=</span> vm<span class="sh_symbol">.</span><span class="sh_function">runInDebugContext</span><span class="sh_symbol">(</span><span class="sh_string">'Debug'</span><span class="sh_symbol">);</span>
Debug<span class="sh_symbol">.</span><span class="sh_function">scripts</span><span class="sh_symbol">().</span><span class="sh_function">forEach</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>script<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>script<span class="sh_symbol">.</span>name<span class="sh_symbol">);</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Note that the debug context and object are intrinsically tied to V8's debugger implementation and may change (or even get removed) without prior warning.</p>
<p>The debug object can also be exposed with the <code>--expose_debug_as=</code> switch.</p>
<h2>Class: Script<a id="all_class_script" class="mark" href="#all_class_script">#</a></h2>
<p>A class for holding precompiled scripts, and running them in specific sandboxes.</p>
<h3>new vm.Script(code, options)<a id="all_new_vm_script_code_options" class="mark" href="#all_new_vm_script_code_options">#</a></h3>
<p>Creating a new <code>Script</code> compiles <code>code</code> but does not run it. Instead, the created <code>vm.Script</code> object represents this compiled code. This script can be run later many times using methods below. The returned script is not bound to any global object. It is bound before each run, just for that run.</p>
<p>The options when creating a script are:</p>
<ul>
<li><code>filename</code>: allows you to control the filename that shows up in any stack traces produced from this script.</li>
<li><code>displayErrors</code>: whether or not to print any errors to stderr, with the line of code that caused them highlighted, before throwing an exception. Applies only to syntax errors compiling the code; errors while running the code are controlled by the options to the script's methods.</li>
</ul>
<h3>script.runInThisContext([options])<a id="all_script_runinthiscontext_options" class="mark" href="#all_script_runinthiscontext_options">#</a></h3>
<p>Similar to <code>vm.runInThisContext</code> but a method of a precompiled <code>Script</code> object. <code>script.runInThisContext</code> runs <code>script</code>'s compiled code and returns the result. Running code does not have access to local scope, but does have access to the current <code>global</code> object.</p>
<p>Example of using <code>script.runInThisContext</code> to compile code once and run it multiple times:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> vm <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'vm'</span><span class="sh_symbol">);</span>

global<span class="sh_symbol">.</span>globalVar <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> script <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> vm<span class="sh_symbol">.</span><span class="sh_function">Script</span><span class="sh_symbol">(</span><span class="sh_string">'globalVar += 1'</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span> filename<span class="sh_symbol">:</span> <span class="sh_string">'myfile.vm'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">1000</span><span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  script<span class="sh_symbol">.</span><span class="sh_function">runInThisContext</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>globalVar<span class="sh_symbol">);</span>

<span class="sh_comment">// 1000</span></code></pre>
<p>The options for running a script are:</p>
<ul>
<li><code>displayErrors</code>: whether or not to print any runtime errors to stderr, with the line of code that caused them highlighted, before throwing an exception. Applies only to runtime errors executing the code; it is impossible to create a <code>Script</code> instance with syntax errors, as the constructor will throw.</li>
<li><code>timeout</code>: a number of milliseconds to execute the script before terminating execution. If execution is terminated, an <code>Error</code> will be thrown.</li>
</ul>
<h3>script.runInContext(contextifiedSandbox[, options])<a id="all_script_runincontext_contextifiedsandbox_options" class="mark" href="#all_script_runincontext_contextifiedsandbox_options">#</a></h3>
<p>Similar to <code>vm.runInContext</code> but a method of a precompiled <code>Script</code> object. <code>script.runInContext</code> runs <code>script</code>'s compiled code in <code>contextifiedSandbox</code> and returns the result. Running code does not have access to local scope.</p>
<p><code>script.runInContext</code> takes the same options as <code>script.runInThisContext</code>.</p>
<p>Example: compile code that increments a global variable and sets one, then execute the code multiple times. These globals are contained in the sandbox.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> vm <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'vm'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> sandbox <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
  animal<span class="sh_symbol">:</span> <span class="sh_string">'cat'</span><span class="sh_symbol">,</span>
  count<span class="sh_symbol">:</span> <span class="sh_number">2</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">var</span> script <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> vm<span class="sh_symbol">.</span><span class="sh_function">Script</span><span class="sh_symbol">(</span><span class="sh_string">'count += 1; name = "kitty"'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">10</span><span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  script<span class="sh_symbol">.</span><span class="sh_function">runInContext</span><span class="sh_symbol">(</span>sandbox<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>sandbox<span class="sh_symbol">));</span>

<span class="sh_comment">// { animal: 'cat', count: 12, name: 'kitty' }</span></code></pre>
<p>Note that running untrusted code is a tricky business requiring great care. <code>script.runInContext</code> is quite useful, but safely running untrusted code requires a separate process.</p>
<h3>script.runInNewContext([sandbox][, options])<a id="all_script_runinnewcontext_sandbox_options" class="mark" href="#all_script_runinnewcontext_sandbox_options">#</a></h3>
<p>Similar to <code>vm.runInNewContext</code> but a method of a precompiled <code>Script</code> object. <code>script.runInNewContext</code> contextifies <code>sandbox</code> if passed or creates a new contextified sandbox if it's omitted, and then runs <code>script</code>'s compiled code with the sandbox as the global object and returns the result. Running code does not have access to local scope.</p>
<p><code>script.runInNewContext</code> takes the same options as <code>script.runInThisContext</code>.</p>
<p>Example: compile code that sets a global variable, then execute the code multiple times in different contexts. These globals are set on and contained in the sandboxes.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> util <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'util'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> vm <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'vm'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> sandboxes <span class="sh_symbol">=</span> <span class="sh_symbol">[</span><span class="sh_cbracket">{}</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{}</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{}</span><span class="sh_symbol">];</span>

<span class="sh_keyword">var</span> script <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> vm<span class="sh_symbol">.</span><span class="sh_function">Script</span><span class="sh_symbol">(</span><span class="sh_string">'globalVar = "set"'</span><span class="sh_symbol">);</span>

sandboxes<span class="sh_symbol">.</span><span class="sh_function">forEach</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span>sandbox<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  script<span class="sh_symbol">.</span><span class="sh_function">runInNewContext</span><span class="sh_symbol">(</span>sandbox<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>util<span class="sh_symbol">.</span><span class="sh_function">inspect</span><span class="sh_symbol">(</span>sandboxes<span class="sh_symbol">));</span>

<span class="sh_comment">// [{ globalVar: 'set' }, { globalVar: 'set' }, { globalVar: 'set' }]</span></code></pre>
<p>Note that running untrusted code is a tricky business requiring great care. <code>script.runInNewContext</code> is quite useful, but safely running untrusted code requires a separate process.</p>
<h1>Child Process<a id="all_child_process" class="mark" href="#all_child_process">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>Node provides a tri-directional <code>popen(3)</code> facility through the <code>child_process</code> module.</p>
<p>It is possible to stream data through a child's <code>stdin</code>, <code>stdout</code>, and <code>stderr</code> in a fully non-blocking way. (Note that some programs use line-buffered I/O internally. That doesn't affect node.js but it means data you send to the child process may not be immediately consumed.)</p>
<p>To create a child process use <code>require('child_process').spawn()</code> or <code>require('child_process').fork()</code>. The semantics of each are slightly different, and explained <a href="#child_process_asynchronous_process_creation">below</a>.</p>
<p>For scripting purposes you may find the <a href="#child_process_synchronous_process_creation">synchronous counterparts</a> more convenient.</p>
<h2>Class: ChildProcess<a id="all_class_childprocess" class="mark" href="#all_class_childprocess">#</a></h2>
<p><code>ChildProcess</code> is an <a href="https://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a>.</p>
<p>Child processes always have three streams associated with them. <code>child.stdin</code>, <code>child.stdout</code>, and <code>child.stderr</code>. These may be shared with the stdio streams of the parent process, or they may be separate stream objects which can be piped to and from.</p>
<p>The ChildProcess class is not intended to be used directly. Use the <code>spawn()</code>, <code>exec()</code>, <code>execFile()</code>, or <code>fork()</code> methods to create a Child Process instance.</p>
<h3>Event: 'error'<a id="all_event_error_6" class="mark" href="#all_event_error_6">#</a></h3>
<div class="signature">
<ul>
<li><code>err</code> <span class="type">Error Object</span> the error.</li>
</ul>
</div>
<p>Emitted when:</p>
<ol>
<li>The process could not be spawned, or</li>
<li>The process could not be killed, or</li>
<li>Sending a message to the child process failed for whatever reason.</li>
</ol>
<p>Note that the <code>exit</code>-event may or may not fire after an error has occurred. If you are listening on both events to fire a function, remember to guard against calling your function twice.</p>
<p>See also <a href="#child_process_child_kill_signal"><code>ChildProcess#kill()</code></a> and <a href="#child_process_child_send_message_sendhandle"><code>ChildProcess#send()</code></a>.</p>
<h3>Event: 'exit'<a id="all_event_exit_2" class="mark" href="#all_event_exit_2">#</a></h3>
<div class="signature">
<ul>
<li><code>code</code> <span class="type">Number</span> the exit code, if it exited normally.</li>
<li><code>signal</code> <span class="type">String</span> the signal passed to kill the child process, if it was killed by the parent.</li>
</ul>
</div>
<p>This event is emitted after the child process ends. If the process terminated normally, <code>code</code> is the final exit code of the process, otherwise <code>null</code>. If the process terminated due to receipt of a signal, <code>signal</code> is the string name of the signal, otherwise <code>null</code>.</p>
<p>Note that the child process stdio streams might still be open.</p>
<p>Also, note that node establishes signal handlers for <code>'SIGINT'</code> and <code>'SIGTERM</code>', so it will not terminate due to receipt of those signals, it will exit.</p>
<p>See <code>waitpid(2)</code>.</p>
<h3>Event: 'close'<a id="all_event_close_8" class="mark" href="#all_event_close_8">#</a></h3>
<div class="signature">
<ul>
<li><code>code</code> <span class="type">Number</span> the exit code, if it exited normally.</li>
<li><code>signal</code> <span class="type">String</span> the signal passed to kill the child process, if it was killed by the parent.</li>
</ul>
</div>
<p>This event is emitted when the stdio streams of a child process have all terminated. This is distinct from 'exit', since multiple processes might share the same stdio streams.</p>
<h3>Event: 'disconnect'<a id="all_event_disconnect" class="mark" href="#all_event_disconnect">#</a></h3>
<p>This event is emitted after calling the <code>.disconnect()</code> method in the parent or in the child. After disconnecting it is no longer possible to send messages, and the <code>.connected</code> property is false.</p>
<h3>Event: 'message'<a id="all_event_message_1" class="mark" href="#all_event_message_1">#</a></h3>
<div class="signature">
<ul>
<li><code>message</code> <span class="type">Object</span> a parsed JSON object or primitive value</li>
<li><code>sendHandle</code> <span class="type">Handle object</span> a Socket or Server object</li>
</ul>
</div>
<p>Messages send by <code>.send(message, [sendHandle])</code> are obtained using the <code>message</code> event.</p>
<h3>child.stdin<a id="all_child_stdin" class="mark" href="#all_child_stdin">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Stream object</span></li>
</ul>
</div>
<p>A <code>Writable Stream</code> that represents the child process's <code>stdin</code>. If the child is waiting to read all its input, it will not continue until this stream has been closed via <code>end()</code>.</p>
<p>If the child was not spawned with <code>stdio[0]</code> set to <code>'pipe'</code>, then this will not be set.</p>
<p><code>child.stdin</code> is shorthand for <code>child.stdio[0]</code>. Both properties will refer to the same object, or null.</p>
<h3>child.stdout<a id="all_child_stdout" class="mark" href="#all_child_stdout">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Stream object</span></li>
</ul>
</div>
<p>A <code>Readable Stream</code> that represents the child process's <code>stdout</code>.</p>
<p>If the child was not spawned with <code>stdio[1]</code> set to <code>'pipe'</code>, then this will not be set.</p>
<p><code>child.stdout</code> is shorthand for <code>child.stdio[1]</code>. Both properties will refer to the same object, or null.</p>
<h3>child.stderr<a id="all_child_stderr" class="mark" href="#all_child_stderr">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Stream object</span></li>
</ul>
</div>
<p>A <code>Readable Stream</code> that represents the child process's <code>stderr</code>.</p>
<p>If the child was not spawned with <code>stdio[2]</code> set to <code>'pipe'</code>, then this will not be set.</p>
<p><code>child.stderr</code> is shorthand for <code>child.stdio[2]</code>. Both properties will refer to the same object, or null.</p>
<h3>child.stdio<a id="all_child_stdio" class="mark" href="#all_child_stdio">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Array</span></li>
</ul>
</div>
<p>A sparse array of pipes to the child process, corresponding with positions in the <a href="#child_process_options_stdio">stdio</a> option to <a href="#child_process_child_process_spawn_command_args_options">spawn</a> that have been set to <code>'pipe'</code>. Note that streams 0-2 are also available as ChildProcess.stdin, ChildProcess.stdout, and ChildProcess.stderr, respectively.</p>
<p>In the following example, only the child's fd <code>1</code> is setup as a pipe, so only the parent's <code>child.stdio[1]</code> is a stream, all other values in the array are <code>null</code>.</p>
<pre class="sh_sourceCode"><code>child <span class="sh_symbol">=</span> child_process<span class="sh_symbol">.</span><span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">"ls"</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span>
    stdio<span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
      <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_comment">// use parents stdin for child</span>
      <span class="sh_string">'pipe'</span><span class="sh_symbol">,</span> <span class="sh_comment">// pipe child's stdout to parent</span>
      fs<span class="sh_symbol">.</span><span class="sh_function">openSync</span><span class="sh_symbol">(</span><span class="sh_string">"err.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">)</span> <span class="sh_comment">// direct child's stderr to a file</span>
    <span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

assert<span class="sh_symbol">.</span><span class="sh_function">equal</span><span class="sh_symbol">(</span>child<span class="sh_symbol">.</span>stdio<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">],</span> <span class="sh_keyword">null</span><span class="sh_symbol">);</span>
assert<span class="sh_symbol">.</span><span class="sh_function">equal</span><span class="sh_symbol">(</span>child<span class="sh_symbol">.</span>stdio<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">],</span> child<span class="sh_symbol">.</span>stdin<span class="sh_symbol">);</span>

<span class="sh_function">assert</span><span class="sh_symbol">(</span>child<span class="sh_symbol">.</span>stdout<span class="sh_symbol">);</span>
assert<span class="sh_symbol">.</span><span class="sh_function">equal</span><span class="sh_symbol">(</span>child<span class="sh_symbol">.</span>stdio<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">],</span> child<span class="sh_symbol">.</span>stdout<span class="sh_symbol">);</span>

assert<span class="sh_symbol">.</span><span class="sh_function">equal</span><span class="sh_symbol">(</span>child<span class="sh_symbol">.</span>stdio<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">],</span> <span class="sh_keyword">null</span><span class="sh_symbol">);</span>
assert<span class="sh_symbol">.</span><span class="sh_function">equal</span><span class="sh_symbol">(</span>child<span class="sh_symbol">.</span>stdio<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">],</span> child<span class="sh_symbol">.</span>stderr<span class="sh_symbol">);</span></code></pre>
<h3>child.pid<a id="all_child_pid" class="mark" href="#all_child_pid">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Integer</span></li>
</ul>
</div>
<p>The PID of the child process.</p>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> spawn <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span>spawn<span class="sh_symbol">,</span>
    grep  <span class="sh_symbol">=</span> <span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'grep'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_string">'ssh'</span><span class="sh_symbol">]);</span>

console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Spawned child pid: '</span> <span class="sh_symbol">+</span> grep<span class="sh_symbol">.</span>pid<span class="sh_symbol">);</span>
grep<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span></code></pre>
<h3>child.connected<a id="all_child_connected" class="mark" href="#all_child_connected">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Boolean</span> Set to false after `.disconnect' is called</li>
</ul>
</div>
<p>If <code>.connected</code> is false, it is no longer possible to send messages.</p>
<h3>child.kill([signal])<a id="all_child_kill_signal" class="mark" href="#all_child_kill_signal">#</a></h3>
<div class="signature">
<ul>
<li><code>signal</code> <span class="type">String</span></li>
</ul>
</div>
<p>Send a signal to the child process. If no argument is given, the process will be sent <code>'SIGTERM'</code>. See <code>signal(7)</code> for a list of available signals.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> spawn <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span>spawn<span class="sh_symbol">,</span>
    grep  <span class="sh_symbol">=</span> <span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'grep'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_string">'ssh'</span><span class="sh_symbol">]);</span>

grep<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'close'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>code<span class="sh_symbol">,</span> signal<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'child process terminated due to receipt of signal '</span><span class="sh_symbol">+</span>signal<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// send SIGHUP to process</span>
grep<span class="sh_symbol">.</span><span class="sh_function">kill</span><span class="sh_symbol">(</span><span class="sh_string">'SIGHUP'</span><span class="sh_symbol">);</span></code></pre>
<p>May emit an <code>'error'</code> event when the signal cannot be delivered. Sending a signal to a child process that has already exited is not an error but may have unforeseen consequences: if the PID (the process ID) has been reassigned to another process, the signal will be delivered to that process instead. What happens next is anyone's guess.</p>
<p>Note that while the function is called <code>kill</code>, the signal delivered to the child process may not actually kill it. <code>kill</code> really just sends a signal to a process.</p>
<p>See <code>kill(2)</code></p>
<h3>child.send(message[, sendHandle])<a id="all_child_send_message_sendhandle" class="mark" href="#all_child_send_message_sendhandle">#</a></h3>
<div class="signature">
<ul>
<li><code>message</code> <span class="type">Object</span></li>
<li><code>sendHandle</code> <span class="type">Handle object</span></li>
</ul>
</div>
<p>When using <code>child_process.fork()</code> you can write to the child using <code>child.send(message, [sendHandle])</code> and messages are received by a <code>'message'</code> event on the child.</p>
<p>For example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> cp <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> n <span class="sh_symbol">=</span> cp<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">(</span>__dirname <span class="sh_symbol">+</span> <span class="sh_string">'/sub.js'</span><span class="sh_symbol">);</span>

n<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'message'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>m<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'PARENT got message:'</span><span class="sh_symbol">,</span> m<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

n<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> hello<span class="sh_symbol">:</span> <span class="sh_string">'world'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>And then the child script, <code>'sub.js'</code> might look like this:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'message'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>m<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'CHILD got message:'</span><span class="sh_symbol">,</span> m<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

process<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> foo<span class="sh_symbol">:</span> <span class="sh_string">'bar'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>In the child the <code>process</code> object will have a <code>send()</code> method, and <code>process</code> will emit objects each time it receives a message on its channel.</p>
<p>Please note that the <code>send()</code> method on both the parent and child are synchronous - sending large chunks of data is not advised (pipes can be used instead, see <a href="#child_process_child_process_spawn_command_args_options"><code>child_process.spawn</code></a>).</p>
<p>There is a special case when sending a <code>{cmd: 'NODE_foo'}</code> message. All messages containing a <code>NODE_</code> prefix in its <code>cmd</code> property will not be emitted in the <code>message</code> event, since they are internal messages used by node core. Messages containing the prefix are emitted in the <code>internalMessage</code> event, you should by all means avoid using this feature, it is subject to change without notice.</p>
<p>The <code>sendHandle</code> option to <code>child.send()</code> is for sending a TCP server or socket object to another process. The child will receive the object as its second argument to the <code>message</code> event.</p>
<p>Emits an <code>'error'</code> event if the message cannot be sent, for example because the child process has already exited.</p>
<h4>Example: sending server object<a id="all_example_sending_server_object" class="mark" href="#all_example_sending_server_object">#</a></h4>
<p>Here is an example of sending a server:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> child <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span><span class="sh_function">fork</span><span class="sh_symbol">(</span><span class="sh_string">'child.js'</span><span class="sh_symbol">);</span>

<span class="sh_comment">// Open up the server object and send the handle.</span>
<span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'net'</span><span class="sh_symbol">).</span><span class="sh_function">createServer</span><span class="sh_symbol">();</span>
server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'handled by parent'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  child<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_string">'server'</span><span class="sh_symbol">,</span> server<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>And the child would the receive the server object as:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'message'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>m<span class="sh_symbol">,</span> server<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>m <span class="sh_symbol">===</span> <span class="sh_string">'server'</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'handled by child'</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Note that the server is now shared between the parent and child, this means that some connections will be handled by the parent and some by the child.</p>
<p>For <code>dgram</code> servers the workflow is exactly the same. Here you listen on a <code>message</code> event instead of <code>connection</code> and use <code>server.bind</code> instead of <code>server.listen</code>. (Currently only supported on UNIX platforms.)</p>
<h4>Example: sending socket object<a id="all_example_sending_socket_object" class="mark" href="#all_example_sending_socket_object">#</a></h4>
<p>Here is an example of sending a socket. It will spawn two children and handle connections with the remote address <code>74.125.127.100</code> as VIP by sending the socket to a "special" child process. Other sockets will go to a "normal" process.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> normal <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span><span class="sh_function">fork</span><span class="sh_symbol">(</span><span class="sh_string">'child.js'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_string">'normal'</span><span class="sh_symbol">]);</span>
<span class="sh_keyword">var</span> special <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span><span class="sh_function">fork</span><span class="sh_symbol">(</span><span class="sh_string">'child.js'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_string">'special'</span><span class="sh_symbol">]);</span>

<span class="sh_comment">// Open up the server and send sockets to child</span>
<span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'net'</span><span class="sh_symbol">).</span><span class="sh_function">createServer</span><span class="sh_symbol">();</span>
server<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'connection'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>

  <span class="sh_comment">// if this is a VIP</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>socket<span class="sh_symbol">.</span>remoteAddress <span class="sh_symbol">===</span> <span class="sh_string">'74.125.127.100'</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    special<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_string">'socket'</span><span class="sh_symbol">,</span> socket<span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span><span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span>
  <span class="sh_comment">// just the usual dudes</span>
  normal<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_string">'socket'</span><span class="sh_symbol">,</span> socket<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">);</span></code></pre>
<p>The <code>child.js</code> could look like this:</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'message'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>m<span class="sh_symbol">,</span> socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>m <span class="sh_symbol">===</span> <span class="sh_string">'socket'</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    socket<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">'You were handled as a '</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span>argv<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">+</span> <span class="sh_string">' person'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Note that once a single socket has been sent to a child the parent can no longer keep track of when the socket is destroyed. To indicate this condition the <code>.connections</code> property becomes <code>null</code>. It is also recommended not to use <code>.maxConnections</code> in this condition.</p>
<h3>child.disconnect()<a id="all_child_disconnect" class="mark" href="#all_child_disconnect">#</a></h3>
<p>Close the IPC channel between parent and child, allowing the child to exit gracefully once there are no other connections keeping it alive. After calling this method the <code>.connected</code> flag will be set to <code>false</code> in both the parent and child, and it is no longer possible to send messages.</p>
<p>The 'disconnect' event will be emitted when there are no messages in the process of being received, most likely immediately.</p>
<p>Note that you can also call <code>process.disconnect()</code> in the child process when the child process has any open IPC channels with the parent (i.e <code>fork()</code>).</p>
<h2>Asynchronous Process Creation<a id="all_asynchronous_process_creation" class="mark" href="#all_asynchronous_process_creation">#</a></h2>
<p>These methods follow the common async programming patterns (accepting a callback or returning an EventEmitter).</p>
<h3>child_process.spawn(command[, args][, options])<a id="all_child_process_spawn_command_args_options" class="mark" href="#all_child_process_spawn_command_args_options">#</a></h3>
<div class="signature">
<ul>
<li><code>command</code> <span class="type">String</span> The command to run</li>
<li><code>args</code> <span class="type">Array</span> List of string arguments</li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>cwd</code> <span class="type">String</span> Current working directory of the child process</li>
<li><code>env</code> <span class="type">Object</span> Environment key-value pairs</li>
<li><code>stdio</code> <span class="type">Array|String</span> Child's stdio configuration. (See <a href="#child_process_options_stdio">below</a>)</li>
<li><code>customFds</code> <span class="type">Array</span> <strong>Deprecated</strong> File descriptors for the child to use for stdio. (See <a href="#child_process_options_customFds">below</a>)</li>
<li><code>detached</code> <span class="type">Boolean</span> The child will be a process group leader. (See <a href="#child_process_options_detached">below</a>)</li>
<li><code>uid</code> <span class="type">Number</span> Sets the user identity of the process. (See setuid(2).)</li>
<li><code>gid</code> <span class="type">Number</span> Sets the group identity of the process. (See setgid(2).)</li>
</ul>
</li>
<li>return: <span class="type">ChildProcess object</span></li>
</ul>
</div>
<p>Launches a new process with the given <code>command</code>, with command line arguments in <code>args</code>. If omitted, <code>args</code> defaults to an empty Array.</p>
<p>The third argument is used to specify additional options, with these defaults:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> cwd<span class="sh_symbol">:</span> <span class="sh_predef_var">undefined</span><span class="sh_symbol">,</span>
  env<span class="sh_symbol">:</span> process<span class="sh_symbol">.</span>env
<span class="sh_cbracket">}</span></code></pre>
<p>Use <code>cwd</code> to specify the working directory from which the process is spawned. If not given, the default is to inherit the current working directory.</p>
<p>Use <code>env</code> to specify environment variables that will be visible to the new process, the default is <code>process.env</code>.</p>
<p>Example of running <code>ls -lh /usr</code>, capturing <code>stdout</code>, <code>stderr</code>, and the exit code:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> spawn <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span>spawn<span class="sh_symbol">,</span>
    ls    <span class="sh_symbol">=</span> <span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'ls'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_string">'-lh'</span><span class="sh_symbol">,</span> <span class="sh_string">'/usr'</span><span class="sh_symbol">]);</span>

ls<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'stdout: '</span> <span class="sh_symbol">+</span> data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

ls<span class="sh_symbol">.</span>stderr<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'stderr: '</span> <span class="sh_symbol">+</span> data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

ls<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'close'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>code<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'child process exited with code '</span> <span class="sh_symbol">+</span> code<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Example: A very elaborate way to run 'ps ax | grep ssh'</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> spawn <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span>spawn<span class="sh_symbol">,</span>
    ps    <span class="sh_symbol">=</span> <span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'ps'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_string">'ax'</span><span class="sh_symbol">]),</span>
    grep  <span class="sh_symbol">=</span> <span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'grep'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_string">'ssh'</span><span class="sh_symbol">]);</span>

ps<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  grep<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">write</span><span class="sh_symbol">(</span>data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

ps<span class="sh_symbol">.</span>stderr<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'ps stderr: '</span> <span class="sh_symbol">+</span> data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

ps<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'close'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>code<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>code <span class="sh_symbol">!==</span> <span class="sh_number">0</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'ps process exited with code '</span> <span class="sh_symbol">+</span> code<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
  grep<span class="sh_symbol">.</span>stdin<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

grep<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">''</span> <span class="sh_symbol">+</span> data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

grep<span class="sh_symbol">.</span>stderr<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>data<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'grep stderr: '</span> <span class="sh_symbol">+</span> data<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

grep<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'close'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>code<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>code <span class="sh_symbol">!==</span> <span class="sh_number">0</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'grep process exited with code '</span> <span class="sh_symbol">+</span> code<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>options.stdio<a id="all_options_stdio" class="mark" href="#all_options_stdio">#</a></h3>
<p>As a shorthand, the <code>stdio</code> argument may also be one of the following strings:</p>
<ul>
<li><code>'pipe'</code> - <code>['pipe', 'pipe', 'pipe']</code>, this is the default value</li>
<li><code>'ignore'</code> - <code>['ignore', 'ignore', 'ignore']</code></li>
<li><code>'inherit'</code> - <code>[process.stdin, process.stdout, process.stderr]</code> or <code>[0,1,2]</code></li>
</ul>
<p>Otherwise, the 'stdio' option to <code>child_process.spawn()</code> is an array where each index corresponds to a fd in the child. The value is one of the following:</p>
<ol>
<li><code>'pipe'</code> - Create a pipe between the child process and the parent process. The parent end of the pipe is exposed to the parent as a property on the <code>child_process</code> object as <code>ChildProcess.stdio[fd]</code>. Pipes created for fds 0 - 2 are also available as ChildProcess.stdin, ChildProcess.stdout and ChildProcess.stderr, respectively.</li>
<li><code>'ipc'</code> - Create an IPC channel for passing messages/file descriptors between parent and child. A ChildProcess may have at most <em>one</em> IPC stdio file descriptor. Setting this option enables the ChildProcess.send() method. If the child writes JSON messages to this file descriptor, then this will trigger ChildProcess.on('message'). If the child is a Node.js program, then the presence of an IPC channel will enable process.send() and process.on('message').</li>
<li><code>'ignore'</code> - Do not set this file descriptor in the child. Note that Node will always open fd 0 - 2 for the processes it spawns. When any of these is ignored node will open <code>/dev/null</code> and attach it to the child's fd.</li>
<li><code>Stream</code> object - Share a readable or writable stream that refers to a tty, file, socket, or a pipe with the child process. The stream's underlying file descriptor is duplicated in the child process to the fd that corresponds to the index in the <code>stdio</code> array. Note that the stream must have an underlying descriptor (file streams do not until the <code>'open'</code> event has occurred).</li>
<li>Positive integer - The integer value is interpreted as a file descriptor that is is currently open in the parent process. It is shared with the child process, similar to how <code>Stream</code> objects can be shared.</li>
<li><code>null</code>, <code>undefined</code> - Use default value. For stdio fds 0, 1 and 2 (in other words, stdin, stdout, and stderr) a pipe is created. For fd 3 and up, the default is <code>'ignore'</code>.</li>
</ol>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> spawn <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span>spawn<span class="sh_symbol">;</span>

<span class="sh_comment">// Child will use parent's stdios</span>
<span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'prg'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[],</span> <span class="sh_cbracket">{</span> stdio<span class="sh_symbol">:</span> <span class="sh_string">'inherit'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// Spawn child sharing only stderr</span>
<span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'prg'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[],</span> <span class="sh_cbracket">{</span> stdio<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'pipe'</span><span class="sh_symbol">,</span> <span class="sh_string">'pipe'</span><span class="sh_symbol">,</span> process<span class="sh_symbol">.</span>stderr<span class="sh_symbol">]</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// Open an extra fd=4, to interact with programs present a</span>
<span class="sh_comment">// startd-style interface.</span>
<span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'prg'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[],</span> <span class="sh_cbracket">{</span> stdio<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'pipe'</span><span class="sh_symbol">,</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span> <span class="sh_string">'pipe'</span><span class="sh_symbol">]</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>options.detached<a id="all_options_detached" class="mark" href="#all_options_detached">#</a></h3>
<p>If the <code>detached</code> option is set, the child process will be made the leader of a new process group. This makes it possible for the child to continue running after the parent exits.</p>
<p>By default, the parent will wait for the detached child to exit. To prevent the parent from waiting for a given <code>child</code>, use the <code>child.unref()</code> method, and the parent's event loop will not include the child in its reference count.</p>
<p>Example of detaching a long-running process and redirecting its output to a file:</p>
<pre class="sh_sourceCode"><code> <span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">),</span>
     spawn <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span>spawn<span class="sh_symbol">,</span>
     out <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">openSync</span><span class="sh_symbol">(</span><span class="sh_string">'./out.log'</span><span class="sh_symbol">,</span> <span class="sh_string">'a'</span><span class="sh_symbol">),</span>
     err <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">openSync</span><span class="sh_symbol">(</span><span class="sh_string">'./out.log'</span><span class="sh_symbol">,</span> <span class="sh_string">'a'</span><span class="sh_symbol">);</span>

 <span class="sh_keyword">var</span> child <span class="sh_symbol">=</span> <span class="sh_function">spawn</span><span class="sh_symbol">(</span><span class="sh_string">'prg'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[],</span> <span class="sh_cbracket">{</span>
   detached<span class="sh_symbol">:</span> <span class="sh_keyword">true</span><span class="sh_symbol">,</span>
   stdio<span class="sh_symbol">:</span> <span class="sh_symbol">[</span> <span class="sh_string">'ignore'</span><span class="sh_symbol">,</span> out<span class="sh_symbol">,</span> err <span class="sh_symbol">]</span>
 <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

 child<span class="sh_symbol">.</span><span class="sh_function">unref</span><span class="sh_symbol">();</span></code></pre>
<p>When using the <code>detached</code> option to start a long-running process, the process will not stay running in the background unless it is provided with a <code>stdio</code> configuration that is not connected to the parent. If the parent's <code>stdio</code> is inherited, the child will remain attached to the controlling terminal.</p>
<h3>options.customFds<a id="all_options_customfds" class="mark" href="#all_options_customfds">#</a></h3>
<p>There is a deprecated option called <code>customFds</code> which allows one to specify specific file descriptors for the stdio of the child process. This API was not portable to all platforms and therefore removed. With <code>customFds</code> it was possible to hook up the new process' <code>[stdin, stdout, stderr]</code> to existing streams; <code>-1</code> meant that a new stream should be created. Use at your own risk.</p>
<p>See also: <code>child_process.exec()</code> and <code>child_process.fork()</code></p>
<h3>child_process.exec(command[, options], callback)<a id="all_child_process_exec_command_options_callback" class="mark" href="#all_child_process_exec_command_options_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>command</code> <span class="type">String</span> The command to run, with space-separated arguments</li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>cwd</code> <span class="type">String</span> Current working directory of the child process</li>
<li><code>env</code> <span class="type">Object</span> Environment key-value pairs</li>
<li><code>encoding</code> <span class="type">String</span> (Default: 'utf8')</li>
<li><code>shell</code> <span class="type">String</span> Shell to execute the command with (Default: '/bin/sh' on UNIX, 'cmd.exe' on Windows, The shell should understand the <code>-c</code> switch on UNIX or <code>/s /c</code> on Windows. On Windows, command line parsing should be compatible with <code>cmd.exe</code>.)</li>
<li><code>timeout</code> <span class="type">Number</span> (Default: 0)</li>
<li><code>maxBuffer</code> <span class="type">Number</span> (Default: <code>200*1024</code>)</li>
<li><code>killSignal</code> <span class="type">String</span> (Default: 'SIGTERM')</li>
<li><code>uid</code> <span class="type">Number</span> Sets the user identity of the process. (See setuid(2).)</li>
<li><code>gid</code> <span class="type">Number</span> Sets the group identity of the process. (See setgid(2).)</li>
</ul>
</li>
<li><code>callback</code> <span class="type">Function</span> called with the output when process terminates
<ul>
<li><code>error</code> <span class="type">Error</span></li>
<li><code>stdout</code> <span class="type">Buffer</span></li>
<li><code>stderr</code> <span class="type">Buffer</span></li>
</ul>
</li>
<li>Return: ChildProcess object</li>
</ul>
</div>
<p>Runs a command in a shell and buffers the output.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> exec <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'child_process'</span><span class="sh_symbol">).</span>exec<span class="sh_symbol">,</span>
    child<span class="sh_symbol">;</span>

child <span class="sh_symbol">=</span> <span class="sh_function">exec</span><span class="sh_symbol">(</span><span class="sh_string">'cat *.js bad_file | wc -l'</span><span class="sh_symbol">,</span>
  <span class="sh_keyword">function</span> <span class="sh_symbol">(</span>error<span class="sh_symbol">,</span> stdout<span class="sh_symbol">,</span> stderr<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'stdout: '</span> <span class="sh_symbol">+</span> stdout<span class="sh_symbol">);</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'stderr: '</span> <span class="sh_symbol">+</span> stderr<span class="sh_symbol">);</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>error <span class="sh_symbol">!==</span> <span class="sh_keyword">null</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'exec error: '</span> <span class="sh_symbol">+</span> error<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>The callback gets the arguments <code>(error, stdout, stderr)</code>. On success, <code>error</code> will be <code>null</code>. On error, <code>error</code> will be an instance of <code>Error</code> and <code>error.code</code> will be the exit code of the child process, and <code>error.signal</code> will be set to the signal that terminated the process.</p>
<p>There is a second optional argument to specify several options. The default options are</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> encoding<span class="sh_symbol">:</span> <span class="sh_string">'utf8'</span><span class="sh_symbol">,</span>
  timeout<span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
  maxBuffer<span class="sh_symbol">:</span> <span class="sh_number">200</span><span class="sh_symbol">*</span><span class="sh_number">1024</span><span class="sh_symbol">,</span>
  killSignal<span class="sh_symbol">:</span> <span class="sh_string">'SIGTERM'</span><span class="sh_symbol">,</span>
  cwd<span class="sh_symbol">:</span> <span class="sh_keyword">null</span><span class="sh_symbol">,</span>
  env<span class="sh_symbol">:</span> <span class="sh_keyword">null</span> <span class="sh_cbracket">}</span></code></pre>
<p>If <code>timeout</code> is greater than 0, then it will kill the child process if it runs longer than <code>timeout</code> milliseconds. The child process is killed with <code>killSignal</code> (default: <code>'SIGTERM'</code>). <code>maxBuffer</code> specifies the largest amount of data allowed on stdout or stderr - if this value is exceeded then the child process is killed.</p>
<h3>child_process.execFile(file[, args][, options][, callback])<a id="all_child_process_execfile_file_args_options_callback" class="mark" href="#all_child_process_execfile_file_args_options_callback">#</a></h3>
<div class="signature">
<ul>
<li><code>file</code> <span class="type">String</span> The filename of the program to run</li>
<li><code>args</code> <span class="type">Array</span> List of string arguments</li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>cwd</code> <span class="type">String</span> Current working directory of the child process</li>
<li><code>env</code> <span class="type">Object</span> Environment key-value pairs</li>
<li><code>encoding</code> <span class="type">String</span> (Default: 'utf8')</li>
<li><code>timeout</code> <span class="type">Number</span> (Default: 0)</li>
<li><code>maxBuffer</code> <span class="type">Number</span> (Default: 200*1024)</li>
<li><code>killSignal</code> <span class="type">String</span> (Default: 'SIGTERM')</li>
<li><code>uid</code> <span class="type">Number</span> Sets the user identity of the process. (See setuid(2).)</li>
<li><code>gid</code> <span class="type">Number</span> Sets the group identity of the process. (See setgid(2).)</li>
</ul>
</li>
<li><code>callback</code> <span class="type">Function</span> called with the output when process terminates
<ul>
<li><code>error</code> <span class="type">Error</span></li>
<li><code>stdout</code> <span class="type">Buffer</span></li>
<li><code>stderr</code> <span class="type">Buffer</span></li>
</ul>
</li>
<li>Return: ChildProcess object</li>
</ul>
</div>
<p>This is similar to <code>child_process.exec()</code> except it does not execute a subshell but rather the specified file directly. This makes it slightly leaner than <code>child_process.exec</code>. It has the same options.</p>
<h3>child_process.fork(modulePath[, args][, options])<a id="all_child_process_fork_modulepath_args_options" class="mark" href="#all_child_process_fork_modulepath_args_options">#</a></h3>
<div class="signature">
<ul>
<li><code>modulePath</code> <span class="type">String</span> The module to run in the child</li>
<li><code>args</code> <span class="type">Array</span> List of string arguments</li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>cwd</code> <span class="type">String</span> Current working directory of the child process</li>
<li><code>env</code> <span class="type">Object</span> Environment key-value pairs</li>
<li><code>execPath</code> <span class="type">String</span> Executable used to create the child process</li>
<li><code>execArgv</code> <span class="type">Array</span> List of string arguments passed to the executable (Default: <code>process.execArgv</code>)</li>
<li><code>silent</code> <span class="type">Boolean</span> If true, stdin, stdout, and stderr of the child will be piped to the parent, otherwise they will be inherited from the parent, see the "pipe" and "inherit" options for <code>spawn()</code>'s <code>stdio</code> for more details (default is false)</li>
<li><code>uid</code> <span class="type">Number</span> Sets the user identity of the process. (See setuid(2).)</li>
<li><code>gid</code> <span class="type">Number</span> Sets the group identity of the process. (See setgid(2).)</li>
</ul>
</li>
<li>Return: ChildProcess object</li>
</ul>
</div>
<p>This is a special case of the <code>spawn()</code> functionality for spawning Node processes. In addition to having all the methods in a normal ChildProcess instance, the returned object has a communication channel built-in. See <code>child.send(message, [sendHandle])</code> for details.</p>
<p>These child Nodes are still whole new instances of V8. Assume at least 30ms startup and 10mb memory for each new Node. That is, you cannot create many thousands of them.</p>
<p>The <code>execPath</code> property in the <code>options</code> object allows for a process to be created for the child rather than the current <code>node</code> executable. This should be done with care and by default will talk over the fd represented an environmental variable <code>NODE_CHANNEL_FD</code> on the child process. The input and output on this fd is expected to be line delimited JSON objects.</p>
<h2>Synchronous Process Creation<a id="all_synchronous_process_creation" class="mark" href="#all_synchronous_process_creation">#</a></h2>
<p>These methods are <strong>synchronous</strong>, meaning they <strong>WILL</strong> block the event loop, pausing execution of your code until the spawned process exits.</p>
<p>Blocking calls like these are mostly useful for simplifying general purpose scripting tasks and for simplifying the loading/processing of application configuration at startup.</p>
<h3>child_process.spawnSync(command[, args][, options])<a id="all_child_process_spawnsync_command_args_options" class="mark" href="#all_child_process_spawnsync_command_args_options">#</a></h3>
<div class="signature">
<ul>
<li><code>command</code> <span class="type">String</span> The command to run</li>
<li><code>args</code> <span class="type">Array</span> List of string arguments</li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>cwd</code> <span class="type">String</span> Current working directory of the child process</li>
<li><code>input</code> <span class="type">String|Buffer</span> The value which will be passed as stdin to the spawned process
<ul>
<li>supplying this value will override <code>stdio[0]</code></li>
</ul>
</li>
<li><code>stdio</code> <span class="type">Array</span> Child's stdio configuration.</li>
<li><code>env</code> <span class="type">Object</span> Environment key-value pairs</li>
<li><code>uid</code> <span class="type">Number</span> Sets the user identity of the process. (See setuid(2).)</li>
<li><code>gid</code> <span class="type">Number</span> Sets the group identity of the process. (See setgid(2).)</li>
<li><code>timeout</code> <span class="type">Number</span> In milliseconds the maximum amount of time the process is allowed to run. (Default: undefined)</li>
<li><code>killSignal</code> <span class="type">String</span> The signal value to be used when the spawned process will be killed. (Default: 'SIGTERM')</li>
<li><code>maxBuffer</code> <span class="type">Number</span></li>
<li><code>encoding</code> <span class="type">String</span> The encoding used for all stdio inputs and outputs. (Default: 'buffer')</li>
</ul>
</li>
<li>return: <span class="type">Object</span>
<ul>
<li><code>pid</code> <span class="type">Number</span> Pid of the child process</li>
<li><code>output</code> <span class="type">Array</span> Array of results from stdio output</li>
<li><code>stdout</code> <span class="type">Buffer|String</span> The contents of <code>output[1]</code></li>
<li><code>stderr</code> <span class="type">Buffer|String</span> The contents of <code>output[2]</code></li>
<li><code>status</code> <span class="type">Number</span> The exit code of the child process</li>
<li><code>signal</code> <span class="type">String</span> The signal used to kill the child process</li>
<li><code>error</code> <span class="type">Error</span> The error object if the child process failed or timed out</li>
</ul>
</li>
</ul>
</div>
<p><code>spawnSync</code> will not return until the child process has fully closed. When a timeout has been encountered and <code>killSignal</code> is sent, the method won't return until the process has completely exited. That is to say, if the process handles the <code>SIGTERM</code> signal and doesn't exit, your process will wait until the child process has exited.</p>
<h3>child_process.execFileSync(command[, args][, options])<a id="all_child_process_execfilesync_command_args_options" class="mark" href="#all_child_process_execfilesync_command_args_options">#</a></h3>
<div class="signature">
<ul>
<li><code>command</code> <span class="type">String</span> The command to run</li>
<li><code>args</code> <span class="type">Array</span> List of string arguments</li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>cwd</code> <span class="type">String</span> Current working directory of the child process</li>
<li><code>input</code> <span class="type">String|Buffer</span> The value which will be passed as stdin to the spawned process
<ul>
<li>supplying this value will override <code>stdio[0]</code></li>
</ul>
</li>
<li><code>stdio</code> <span class="type">Array</span> Child's stdio configuration. (Default: 'pipe')
<ul>
<li><code>stderr</code> by default will be output to the parent process' stderr unless <code>stdio</code> is specified</li>
</ul>
</li>
<li><code>env</code> <span class="type">Object</span> Environment key-value pairs</li>
<li><code>uid</code> <span class="type">Number</span> Sets the user identity of the process. (See setuid(2).)</li>
<li><code>gid</code> <span class="type">Number</span> Sets the group identity of the process. (See setgid(2).)</li>
<li><code>timeout</code> <span class="type">Number</span> In milliseconds the maximum amount of time the process is allowed to run. (Default: undefined)</li>
<li><code>killSignal</code> <span class="type">String</span> The signal value to be used when the spawned process will be killed. (Default: 'SIGTERM')</li>
<li><code>maxBuffer</code> <span class="type">Number</span></li>
<li><code>encoding</code> <span class="type">String</span> The encoding used for all stdio inputs and outputs. (Default: 'buffer')</li>
</ul>
</li>
<li>return: <span class="type">Buffer|String</span> The stdout from the command</li>
</ul>
</div>
<p><code>execFileSync</code> will not return until the child process has fully closed. When a timeout has been encountered and <code>killSignal</code> is sent, the method won't return until the process has completely exited. That is to say, if the process handles the <code>SIGTERM</code> signal and doesn't exit, your process will wait until the child process has exited.</p>
<p>If the process times out, or has a non-zero exit code, this method <strong><em>will</em></strong> throw. The <code>Error</code> object will contain the entire result from <a href="#child_process_child_process_spawnsync_command_args_options"><code>child_process.spawnSync</code></a></p>
<h3>child_process.execSync(command[, options])<a id="all_child_process_execsync_command_options" class="mark" href="#all_child_process_execsync_command_options">#</a></h3>
<div class="signature">
<ul>
<li><code>command</code> <span class="type">String</span> The command to run</li>
<li><code>options</code> <span class="type">Object</span>
<ul>
<li><code>cwd</code> <span class="type">String</span> Current working directory of the child process</li>
<li><code>input</code> <span class="type">String|Buffer</span> The value which will be passed as stdin to the spawned process
<ul>
<li>supplying this value will override <code>stdio[0]</code></li>
</ul>
</li>
<li><code>stdio</code> <span class="type">Array</span> Child's stdio configuration. (Default: 'pipe')
<ul>
<li><code>stderr</code> by default will be output to the parent process' stderr unless <code>stdio</code> is specified</li>
</ul>
</li>
<li><code>env</code> <span class="type">Object</span> Environment key-value pairs</li>
<li><code>uid</code> <span class="type">Number</span> Sets the user identity of the process. (See setuid(2).)</li>
<li><code>gid</code> <span class="type">Number</span> Sets the group identity of the process. (See setgid(2).)</li>
<li><code>timeout</code> <span class="type">Number</span> In milliseconds the maximum amount of time the process is allowed to run. (Default: undefined)</li>
<li><code>killSignal</code> <span class="type">String</span> The signal value to be used when the spawned process will be killed. (Default: 'SIGTERM')</li>
<li><code>maxBuffer</code> <span class="type">Number</span></li>
<li><code>encoding</code> <span class="type">String</span> The encoding used for all stdio inputs and outputs. (Default: 'buffer')</li>
</ul>
</li>
<li>return: <span class="type">Buffer|String</span> The stdout from the command</li>
</ul>
</div>
<p><code>execSync</code> will not return until the child process has fully closed. When a timeout has been encountered and <code>killSignal</code> is sent, the method won't return until the process has completely exited. That is to say, if the process handles the <code>SIGTERM</code> signal and doesn't exit, your process will wait until the child process has exited.</p>
<p>If the process times out, or has a non-zero exit code, this method <strong><em>will</em></strong> throw. The <code>Error</code> object will contain the entire result from <a href="#child_process_child_process_spawnsync_command_args_options"><code>child_process.spawnSync</code></a></p>
<h1>Assert<a id="all_assert" class="mark" href="#all_assert">#</a></h1>
<pre class="api_stability_5 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">5</span> <span class="sh_symbol">-</span> Locked</pre>
<p>This module is used for writing unit tests for your applications, you can access it with <code>require('assert')</code>.</p>
<h2>assert.fail(actual, expected, message, operator)<a id="all_assert_fail_actual_expected_message_operator" class="mark" href="#all_assert_fail_actual_expected_message_operator">#</a></h2>
<p>Throws an exception that displays the values for <code>actual</code> and <code>expected</code> separated by the provided operator.</p>
<h2>assert(value[, message]), assert.ok(value[, message])<a id="all_assert_value_message_assert_ok_value_message" class="mark" href="#all_assert_value_message_assert_ok_value_message">#</a></h2>
<p>Tests if value is truthy, it is equivalent to <code>assert.equal(true, !!value, message);</code></p>
<h2>assert.equal(actual, expected[, message])<a id="all_assert_equal_actual_expected_message" class="mark" href="#all_assert_equal_actual_expected_message">#</a></h2>
<p>Tests shallow, coercive equality with the equal comparison operator ( <code>==</code> ).</p>
<h2>assert.notEqual(actual, expected[, message])<a id="all_assert_notequal_actual_expected_message" class="mark" href="#all_assert_notequal_actual_expected_message">#</a></h2>
<p>Tests shallow, coercive non-equality with the not equal comparison operator ( <code>!=</code> ).</p>
<h2>assert.deepEqual(actual, expected[, message])<a id="all_assert_deepequal_actual_expected_message" class="mark" href="#all_assert_deepequal_actual_expected_message">#</a></h2>
<p>Tests for deep equality.</p>
<h2>assert.notDeepEqual(actual, expected[, message])<a id="all_assert_notdeepequal_actual_expected_message" class="mark" href="#all_assert_notdeepequal_actual_expected_message">#</a></h2>
<p>Tests for any deep inequality.</p>
<h2>assert.strictEqual(actual, expected[, message])<a id="all_assert_strictequal_actual_expected_message" class="mark" href="#all_assert_strictequal_actual_expected_message">#</a></h2>
<p>Tests strict equality, as determined by the strict equality operator ( <code>===</code> )</p>
<h2>assert.notStrictEqual(actual, expected[, message])<a id="all_assert_notstrictequal_actual_expected_message" class="mark" href="#all_assert_notstrictequal_actual_expected_message">#</a></h2>
<p>Tests strict non-equality, as determined by the strict not equal operator ( <code>!==</code> )</p>
<h2>assert.throws(block[, error][, message])<a id="all_assert_throws_block_error_message" class="mark" href="#all_assert_throws_block_error_message">#</a></h2>
<p>Expects <code>block</code> to throw an error. <code>error</code> can be constructor, <code>RegExp</code> or validation function.</p>
<p>Validate instanceof using constructor:</p>
<pre class="sh_sourceCode"><code>assert<span class="sh_symbol">.</span><span class="sh_keyword">throws</span><span class="sh_symbol">(</span>
  <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">throw</span> <span class="sh_keyword">new</span> <span class="sh_predef_func">Error</span><span class="sh_symbol">(</span><span class="sh_string">"Wrong value"</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_predef_func">Error</span>
<span class="sh_symbol">);</span></code></pre>
<p>Validate error message using RegExp:</p>
<pre class="sh_sourceCode"><code>assert<span class="sh_symbol">.</span><span class="sh_keyword">throws</span><span class="sh_symbol">(</span>
  <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">throw</span> <span class="sh_keyword">new</span> <span class="sh_predef_func">Error</span><span class="sh_symbol">(</span><span class="sh_string">"Wrong value"</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_regexp">/value/</span>
<span class="sh_symbol">);</span></code></pre>
<p>Custom error validation:</p>
<pre class="sh_sourceCode"><code>assert<span class="sh_symbol">.</span><span class="sh_keyword">throws</span><span class="sh_symbol">(</span>
  <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">throw</span> <span class="sh_keyword">new</span> <span class="sh_predef_func">Error</span><span class="sh_symbol">(</span><span class="sh_string">"Wrong value"</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_keyword">function</span><span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> <span class="sh_symbol">(</span>err <span class="sh_keyword">instanceof</span> <span class="sh_predef_func">Error</span><span class="sh_symbol">)</span> <span class="sh_symbol">&amp;&amp;</span> <span class="sh_regexp">/value/</span><span class="sh_symbol">.</span><span class="sh_function">test</span><span class="sh_symbol">(</span>err<span class="sh_symbol">)</span> <span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_string">"unexpected error"</span>
<span class="sh_symbol">);</span></code></pre>
<h2>assert.doesNotThrow(block[, message])<a id="all_assert_doesnotthrow_block_message" class="mark" href="#all_assert_doesnotthrow_block_message">#</a></h2>
<p>Expects <code>block</code> not to throw an error, see <code>assert.throws</code> for details.</p>
<h2>assert.ifError(value)<a id="all_assert_iferror_value" class="mark" href="#all_assert_iferror_value">#</a></h2>
<p>Tests if value is not a false value, throws if it is a true value. Useful when testing the first argument, <code>error</code> in callbacks.</p>
<h1>TTY<a id="all_tty" class="mark" href="#all_tty">#</a></h1>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable</pre>
<p>The <code>tty</code> module houses the <code>tty.ReadStream</code> and <code>tty.WriteStream</code> classes. In most cases, you will not need to use this module directly.</p>
<p>When node detects that it is being run inside a TTY context, then <code>process.stdin</code> will be a <code>tty.ReadStream</code> instance and <code>process.stdout</code> will be a <code>tty.WriteStream</code> instance. The preferred way to check if node is being run in a TTY context is to check <code>process.stdout.isTTY</code>:</p>
<pre class="sh_sourceCode"><code>$ node <span class="sh_symbol">-</span>p <span class="sh_symbol">-</span>e <span class="sh_string">"Boolean(process.stdout.isTTY)"</span>
<span class="sh_keyword">true</span>
$ node <span class="sh_symbol">-</span>p <span class="sh_symbol">-</span>e <span class="sh_string">"Boolean(process.stdout.isTTY)"</span> <span class="sh_symbol">|</span> cat
<span class="sh_keyword">false</span></code></pre>
<h2>tty.isatty(fd)<a id="all_tty_isatty_fd" class="mark" href="#all_tty_isatty_fd">#</a></h2>
<p>Returns <code>true</code> or <code>false</code> depending on if the <code>fd</code> is associated with a terminal.</p>
<h2>tty.setRawMode(mode)<a id="all_tty_setrawmode_mode" class="mark" href="#all_tty_setrawmode_mode">#</a></h2>
<p>Deprecated. Use <code>tty.ReadStream#setRawMode()</code> (i.e. <code>process.stdin.setRawMode()</code>) instead.</p>
<h2>Class: ReadStream<a id="all_class_readstream" class="mark" href="#all_class_readstream">#</a></h2>
<p>A <code>net.Socket</code> subclass that represents the readable portion of a tty. In normal circumstances, <code>process.stdin</code> will be the only <code>tty.ReadStream</code> instance in any node program (only when <code>isatty(0)</code> is true).</p>
<h3>rs.isRaw<a id="all_rs_israw" class="mark" href="#all_rs_israw">#</a></h3>
<p>A <code>Boolean</code> that is initialized to <code>false</code>. It represents the current "raw" state of the <code>tty.ReadStream</code> instance.</p>
<h3>rs.setRawMode(mode)<a id="all_rs_setrawmode_mode" class="mark" href="#all_rs_setrawmode_mode">#</a></h3>
<p><code>mode</code> should be <code>true</code> or <code>false</code>. This sets the properties of the <code>tty.ReadStream</code> to act either as a raw device or default. <code>isRaw</code> will be set to the resulting mode.</p>
<h2>Class: WriteStream<a id="all_class_writestream" class="mark" href="#all_class_writestream">#</a></h2>
<p>A <code>net.Socket</code> subclass that represents the writable portion of a tty. In normal circumstances, <code>process.stdout</code> will be the only <code>tty.WriteStream</code> instance ever created (and only when <code>isatty(1)</code> is true).</p>
<h3>ws.columns<a id="all_ws_columns" class="mark" href="#all_ws_columns">#</a></h3>
<p>A <code>Number</code> that gives the number of columns the TTY currently has. This property gets updated on "resize" events.</p>
<h3>ws.rows<a id="all_ws_rows" class="mark" href="#all_ws_rows">#</a></h3>
<p>A <code>Number</code> that gives the number of rows the TTY currently has. This property gets updated on "resize" events.</p>
<h3>Event: 'resize'<a id="all_event_resize" class="mark" href="#all_event_resize">#</a></h3>
<p><code>function () {}</code></p>
<p>Emitted by <code>refreshSize()</code> when either of the <code>columns</code> or <code>rows</code> properties has changed.</p>
<pre class="sh_sourceCode"><code>process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'resize'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'screen size has changed!'</span><span class="sh_symbol">);</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span>columns <span class="sh_symbol">+</span> <span class="sh_string">'x'</span> <span class="sh_symbol">+</span> process<span class="sh_symbol">.</span>stdout<span class="sh_symbol">.</span>rows<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h1>Zlib<a id="all_zlib" class="mark" href="#all_zlib">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>You can access this module with:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> zlib <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'zlib'</span><span class="sh_symbol">);</span></code></pre>
<p>This provides bindings to Gzip/Gunzip, Deflate/Inflate, and DeflateRaw/InflateRaw classes. Each class takes the same options, and is a readable/writable Stream.</p>
<h2>Examples<a id="all_examples" class="mark" href="#all_examples">#</a></h2>
<p>Compressing or decompressing a file can be done by piping an fs.ReadStream into a zlib stream, then into an fs.WriteStream.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> gzip <span class="sh_symbol">=</span> zlib<span class="sh_symbol">.</span><span class="sh_function">createGzip</span><span class="sh_symbol">();</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> inp <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createReadStream</span><span class="sh_symbol">(</span><span class="sh_string">'input.txt'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> out <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createWriteStream</span><span class="sh_symbol">(</span><span class="sh_string">'input.txt.gz'</span><span class="sh_symbol">);</span>

inp<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>gzip<span class="sh_symbol">).</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>out<span class="sh_symbol">);</span></code></pre>
<p>Compressing or decompressing data in one step can be done by using the convenience methods.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> input <span class="sh_symbol">=</span> <span class="sh_string">'.................................'</span><span class="sh_symbol">;</span>
zlib<span class="sh_symbol">.</span><span class="sh_function">deflate</span><span class="sh_symbol">(</span>input<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> buffer<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buffer<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">(</span><span class="sh_string">'base64'</span><span class="sh_symbol">));</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_keyword">var</span> buffer <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">Buffer</span><span class="sh_symbol">(</span><span class="sh_string">'eJzT0yMAAGTvBe8='</span><span class="sh_symbol">,</span> <span class="sh_string">'base64'</span><span class="sh_symbol">);</span>
zlib<span class="sh_symbol">.</span><span class="sh_function">unzip</span><span class="sh_symbol">(</span>buffer<span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>err<span class="sh_symbol">,</span> buffer<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span>err<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span>buffer<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">());</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>To use this module in an HTTP client or server, use the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3">accept-encoding</a> on requests, and the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11">content-encoding</a> header on responses.</p>
<p><strong>Note: these examples are drastically simplified to show the basic concept.</strong> Zlib encoding can be expensive, and the results ought to be cached. See <a href="#zlib_memory_usage_tuning">Memory Usage Tuning</a> below for more information on the speed/memory/compression tradeoffs involved in zlib usage.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// client request example</span>
<span class="sh_keyword">var</span> zlib <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'zlib'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> request <span class="sh_symbol">=</span> http<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> host<span class="sh_symbol">:</span> <span class="sh_string">'izs.me'</span><span class="sh_symbol">,</span>
                         path<span class="sh_symbol">:</span> <span class="sh_string">'/'</span><span class="sh_symbol">,</span>
                         port<span class="sh_symbol">:</span> <span class="sh_number">80</span><span class="sh_symbol">,</span>
                         headers<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span> <span class="sh_string">'accept-encoding'</span><span class="sh_symbol">:</span> <span class="sh_string">'gzip,deflate'</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
request<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'response'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>response<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> output <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createWriteStream</span><span class="sh_symbol">(</span><span class="sh_string">'izs.me_index.html'</span><span class="sh_symbol">);</span>

  <span class="sh_keyword">switch</span> <span class="sh_symbol">(</span>response<span class="sh_symbol">.</span>headers<span class="sh_symbol">[</span><span class="sh_string">'content-encoding'</span><span class="sh_symbol">])</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// or, just use zlib.createUnzip() to handle both cases</span>
    <span class="sh_keyword">case</span> <span class="sh_string">'gzip'</span><span class="sh_symbol">:</span>
      response<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>zlib<span class="sh_symbol">.</span><span class="sh_function">createGunzip</span><span class="sh_symbol">()).</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>output<span class="sh_symbol">);</span>
      <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">case</span> <span class="sh_string">'deflate'</span><span class="sh_symbol">:</span>
      response<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>zlib<span class="sh_symbol">.</span><span class="sh_function">createInflate</span><span class="sh_symbol">()).</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>output<span class="sh_symbol">);</span>
      <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">default</span><span class="sh_symbol">:</span>
      response<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>output<span class="sh_symbol">);</span>
      <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// server example</span>
<span class="sh_comment">// Running a gzip operation on every request is quite expensive.</span>
<span class="sh_comment">// It would be much more efficient to cache the compressed buffer.</span>
<span class="sh_keyword">var</span> zlib <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'zlib'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> fs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'fs'</span><span class="sh_symbol">);</span>
http<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>request<span class="sh_symbol">,</span> response<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> raw <span class="sh_symbol">=</span> fs<span class="sh_symbol">.</span><span class="sh_function">createReadStream</span><span class="sh_symbol">(</span><span class="sh_string">'index.html'</span><span class="sh_symbol">);</span>
  <span class="sh_keyword">var</span> acceptEncoding <span class="sh_symbol">=</span> request<span class="sh_symbol">.</span>headers<span class="sh_symbol">[</span><span class="sh_string">'accept-encoding'</span><span class="sh_symbol">];</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span>acceptEncoding<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    acceptEncoding <span class="sh_symbol">=</span> <span class="sh_string">''</span><span class="sh_symbol">;</span>
  <span class="sh_cbracket">}</span>

  <span class="sh_comment">// Note: this is not a conformant accept-encoding parser.</span>
  <span class="sh_comment">// See http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>acceptEncoding<span class="sh_symbol">.</span><span class="sh_function">match</span><span class="sh_symbol">(</span><span class="sh_regexp">/\bdeflate\b/</span><span class="sh_symbol">))</span> <span class="sh_cbracket">{</span>
    response<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span> <span class="sh_string">'content-encoding'</span><span class="sh_symbol">:</span> <span class="sh_string">'deflate'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
    raw<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>zlib<span class="sh_symbol">.</span><span class="sh_function">createDeflate</span><span class="sh_symbol">()).</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>response<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>acceptEncoding<span class="sh_symbol">.</span><span class="sh_function">match</span><span class="sh_symbol">(</span><span class="sh_regexp">/\bgzip\b/</span><span class="sh_symbol">))</span> <span class="sh_cbracket">{</span>
    response<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span> <span class="sh_string">'content-encoding'</span><span class="sh_symbol">:</span> <span class="sh_string">'gzip'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
    raw<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>zlib<span class="sh_symbol">.</span><span class="sh_function">createGzip</span><span class="sh_symbol">()).</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>response<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    response<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{}</span><span class="sh_symbol">);</span>
    raw<span class="sh_symbol">.</span><span class="sh_function">pipe</span><span class="sh_symbol">(</span>response<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">1337</span><span class="sh_symbol">);</span></code></pre>
<h2>zlib.createGzip([options])<a id="all_zlib_creategzip_options" class="mark" href="#all_zlib_creategzip_options">#</a></h2>
<p>Returns a new <a href="#zlib_class_zlib_gzip">Gzip</a> object with an <a href="#zlib_options">options</a>.</p>
<h2>zlib.createGunzip([options])<a id="all_zlib_creategunzip_options" class="mark" href="#all_zlib_creategunzip_options">#</a></h2>
<p>Returns a new <a href="#zlib_class_zlib_gunzip">Gunzip</a> object with an <a href="#zlib_options">options</a>.</p>
<h2>zlib.createDeflate([options])<a id="all_zlib_createdeflate_options" class="mark" href="#all_zlib_createdeflate_options">#</a></h2>
<p>Returns a new <a href="#zlib_class_zlib_deflate">Deflate</a> object with an <a href="#zlib_options">options</a>.</p>
<h2>zlib.createInflate([options])<a id="all_zlib_createinflate_options" class="mark" href="#all_zlib_createinflate_options">#</a></h2>
<p>Returns a new <a href="#zlib_class_zlib_inflate">Inflate</a> object with an <a href="#zlib_options">options</a>.</p>
<h2>zlib.createDeflateRaw([options])<a id="all_zlib_createdeflateraw_options" class="mark" href="#all_zlib_createdeflateraw_options">#</a></h2>
<p>Returns a new <a href="#zlib_class_zlib_deflateraw">DeflateRaw</a> object with an <a href="#zlib_options">options</a>.</p>
<h2>zlib.createInflateRaw([options])<a id="all_zlib_createinflateraw_options" class="mark" href="#all_zlib_createinflateraw_options">#</a></h2>
<p>Returns a new <a href="#zlib_class_zlib_inflateraw">InflateRaw</a> object with an <a href="#zlib_options">options</a>.</p>
<h2>zlib.createUnzip([options])<a id="all_zlib_createunzip_options" class="mark" href="#all_zlib_createunzip_options">#</a></h2>
<p>Returns a new <a href="#zlib_class_zlib_unzip">Unzip</a> object with an <a href="#zlib_options">options</a>.</p>
<h2>Class: zlib.Zlib<a id="all_class_zlib_zlib" class="mark" href="#all_class_zlib_zlib">#</a></h2>
<p>Not exported by the <code>zlib</code> module. It is documented here because it is the base class of the compressor/decompressor classes.</p>
<h3>zlib.flush([kind], callback)<a id="all_zlib_flush_kind_callback" class="mark" href="#all_zlib_flush_kind_callback">#</a></h3>
<p><code>kind</code> defaults to <code>zlib.Z_FULL_FLUSH</code>.</p>
<p>Flush pending data. Don't call this frivolously, premature flushes negatively impact the effectiveness of the compression algorithm.</p>
<h3>zlib.params(level, strategy, callback)<a id="all_zlib_params_level_strategy_callback" class="mark" href="#all_zlib_params_level_strategy_callback">#</a></h3>
<p>Dynamically update the compression level and compression strategy. Only applicable to deflate algorithm.</p>
<h3>zlib.reset()<a id="all_zlib_reset" class="mark" href="#all_zlib_reset">#</a></h3>
<p>Reset the compressor/decompressor to factory defaults. Only applicable to the inflate and deflate algorithms.</p>
<h2>Class: zlib.Gzip<a id="all_class_zlib_gzip" class="mark" href="#all_class_zlib_gzip">#</a></h2>
<p>Compress data using gzip.</p>
<h2>Class: zlib.Gunzip<a id="all_class_zlib_gunzip" class="mark" href="#all_class_zlib_gunzip">#</a></h2>
<p>Decompress a gzip stream.</p>
<h2>Class: zlib.Deflate<a id="all_class_zlib_deflate" class="mark" href="#all_class_zlib_deflate">#</a></h2>
<p>Compress data using deflate.</p>
<h2>Class: zlib.Inflate<a id="all_class_zlib_inflate" class="mark" href="#all_class_zlib_inflate">#</a></h2>
<p>Decompress a deflate stream.</p>
<h2>Class: zlib.DeflateRaw<a id="all_class_zlib_deflateraw" class="mark" href="#all_class_zlib_deflateraw">#</a></h2>
<p>Compress data using deflate, and do not append a zlib header.</p>
<h2>Class: zlib.InflateRaw<a id="all_class_zlib_inflateraw" class="mark" href="#all_class_zlib_inflateraw">#</a></h2>
<p>Decompress a raw deflate stream.</p>
<h2>Class: zlib.Unzip<a id="all_class_zlib_unzip" class="mark" href="#all_class_zlib_unzip">#</a></h2>
<p>Decompress either a Gzip- or Deflate-compressed stream by auto-detecting the header.</p>
<h2>Convenience Methods<a id="all_convenience_methods" class="mark" href="#all_convenience_methods">#</a></h2>
<p>All of these take a string or buffer as the first argument, an optional second argument to supply options to the zlib classes and will call the supplied callback with <code>callback(error, result)</code>.</p>
<p>Every method has a <code>*Sync</code> counterpart, which accept the same arguments, but without a callback.</p>
<h2>zlib.deflate(buf[, options], callback)<a id="all_zlib_deflate_buf_options_callback" class="mark" href="#all_zlib_deflate_buf_options_callback">#</a></h2>
<h2>zlib.deflateSync(buf[, options])<a id="all_zlib_deflatesync_buf_options" class="mark" href="#all_zlib_deflatesync_buf_options">#</a></h2>
<p>Compress a string with Deflate.</p>
<h2>zlib.deflateRaw(buf[, options], callback)<a id="all_zlib_deflateraw_buf_options_callback" class="mark" href="#all_zlib_deflateraw_buf_options_callback">#</a></h2>
<h2>zlib.deflateRawSync(buf[, options])<a id="all_zlib_deflaterawsync_buf_options" class="mark" href="#all_zlib_deflaterawsync_buf_options">#</a></h2>
<p>Compress a string with DeflateRaw.</p>
<h2>zlib.gzip(buf[, options], callback)<a id="all_zlib_gzip_buf_options_callback" class="mark" href="#all_zlib_gzip_buf_options_callback">#</a></h2>
<h2>zlib.gzipSync(buf[, options])<a id="all_zlib_gzipsync_buf_options" class="mark" href="#all_zlib_gzipsync_buf_options">#</a></h2>
<p>Compress a string with Gzip.</p>
<h2>zlib.gunzip(buf[, options], callback)<a id="all_zlib_gunzip_buf_options_callback" class="mark" href="#all_zlib_gunzip_buf_options_callback">#</a></h2>
<h2>zlib.gunzipSync(buf[, options])<a id="all_zlib_gunzipsync_buf_options" class="mark" href="#all_zlib_gunzipsync_buf_options">#</a></h2>
<p>Decompress a raw Buffer with Gunzip.</p>
<h2>zlib.inflate(buf[, options], callback)<a id="all_zlib_inflate_buf_options_callback" class="mark" href="#all_zlib_inflate_buf_options_callback">#</a></h2>
<h2>zlib.inflateSync(buf[, options])<a id="all_zlib_inflatesync_buf_options" class="mark" href="#all_zlib_inflatesync_buf_options">#</a></h2>
<p>Decompress a raw Buffer with Inflate.</p>
<h2>zlib.inflateRaw(buf[, options], callback)<a id="all_zlib_inflateraw_buf_options_callback" class="mark" href="#all_zlib_inflateraw_buf_options_callback">#</a></h2>
<h2>zlib.inflateRawSync(buf[, options])<a id="all_zlib_inflaterawsync_buf_options" class="mark" href="#all_zlib_inflaterawsync_buf_options">#</a></h2>
<p>Decompress a raw Buffer with InflateRaw.</p>
<h2>zlib.unzip(buf[, options], callback)<a id="all_zlib_unzip_buf_options_callback" class="mark" href="#all_zlib_unzip_buf_options_callback">#</a></h2>
<h2>zlib.unzipSync(buf[, options])<a id="all_zlib_unzipsync_buf_options" class="mark" href="#all_zlib_unzipsync_buf_options">#</a></h2>
<p>Decompress a raw Buffer with Unzip.</p>
<h2>Options<a id="all_options" class="mark" href="#all_options">#</a></h2>
<p>Each class takes an options object. All options are optional.</p>
<p>Note that some options are only relevant when compressing, and are ignored by the decompression classes.</p>
<ul>
<li>flush (default: <code>zlib.Z_NO_FLUSH</code>)</li>
<li>chunkSize (default: 16*1024)</li>
<li>windowBits</li>
<li>level (compression only)</li>
<li>memLevel (compression only)</li>
<li>strategy (compression only)</li>
<li>dictionary (deflate/inflate only, empty dictionary by default)</li>
</ul>
<p>See the description of <code>deflateInit2</code> and <code>inflateInit2</code> at</p>
<p><a href="http://zlib.net/manual.html#Advanced">http://zlib.net/manual.html#Advanced</a> for more information on these.</p>
<h2>Memory Usage Tuning<a id="all_memory_usage_tuning" class="mark" href="#all_memory_usage_tuning">#</a></h2>
<p>From <code>zlib/zconf.h</code>, modified to node's usage:</p>
<p>The memory requirements for deflate are (in bytes):</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">(</span><span class="sh_number">1</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_symbol">(</span>windowBits<span class="sh_number">+2</span><span class="sh_symbol">))</span> <span class="sh_symbol">+</span>  <span class="sh_symbol">(</span><span class="sh_number">1</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_symbol">(</span>memLevel<span class="sh_number">+9</span><span class="sh_symbol">))</span></code></pre>
<p>that is: 128K for windowBits=15 + 128K for memLevel = 8 (default values) plus a few kilobytes for small objects.</p>
<p>For example, if you want to reduce the default memory requirements from 256K to 128K, set the options to:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> windowBits<span class="sh_symbol">:</span> <span class="sh_number">14</span><span class="sh_symbol">,</span> memLevel<span class="sh_symbol">:</span> <span class="sh_number">7</span> <span class="sh_cbracket">}</span></code></pre>
<p>Of course this will generally degrade compression (there's no free lunch).</p>
<p>The memory requirements for inflate are (in bytes)</p>
<pre class="sh_sourceCode"><code><span class="sh_number">1</span> <span class="sh_symbol">&lt;&lt;</span> windowBits</code></pre>
<p>that is, 32K for windowBits=15 (default value) plus a few kilobytes for small objects.</p>
<p>This is in addition to a single internal output slab buffer of size <code>chunkSize</code>, which defaults to 16K.</p>
<p>The speed of zlib compression is affected most dramatically by the <code>level</code> setting. A higher level will result in better compression, but will take longer to complete. A lower level will result in less compression, but will be much faster.</p>
<p>In general, greater memory usage options will mean that node has to make fewer calls to zlib, since it'll be able to process more data in a single <code>write</code> operation. So, this is another factor that affects the speed, at the cost of memory usage.</p>
<h2>Constants<a id="all_constants" class="mark" href="#all_constants">#</a></h2>
<p>All of the constants defined in zlib.h are also defined on <code>require('zlib')</code>. In the normal course of operations, you will not need to ever set any of these. They are documented here so that their presence is not surprising. This section is taken almost directly from the <a href="http://zlib.net/manual.html#Constants">zlib documentation</a>. See</p>
<p><a href="http://zlib.net/manual.html#Constants">http://zlib.net/manual.html#Constants</a> for more details.</p>
<p>Allowed flush values.</p>
<ul>
<li><code>zlib.Z_NO_FLUSH</code></li>
<li><code>zlib.Z_PARTIAL_FLUSH</code></li>
<li><code>zlib.Z_SYNC_FLUSH</code></li>
<li><code>zlib.Z_FULL_FLUSH</code></li>
<li><code>zlib.Z_FINISH</code></li>
<li><code>zlib.Z_BLOCK</code></li>
<li><code>zlib.Z_TREES</code></li>
</ul>
<p>Return codes for the compression/decompression functions. Negative values are errors, positive values are used for special but normal events.</p>
<ul>
<li><code>zlib.Z_OK</code></li>
<li><code>zlib.Z_STREAM_END</code></li>
<li><code>zlib.Z_NEED_DICT</code></li>
<li><code>zlib.Z_ERRNO</code></li>
<li><code>zlib.Z_STREAM_ERROR</code></li>
<li><code>zlib.Z_DATA_ERROR</code></li>
<li><code>zlib.Z_MEM_ERROR</code></li>
<li><code>zlib.Z_BUF_ERROR</code></li>
<li><code>zlib.Z_VERSION_ERROR</code></li>
</ul>
<p>Compression levels.</p>
<ul>
<li><code>zlib.Z_NO_COMPRESSION</code></li>
<li><code>zlib.Z_BEST_SPEED</code></li>
<li><code>zlib.Z_BEST_COMPRESSION</code></li>
<li><code>zlib.Z_DEFAULT_COMPRESSION</code></li>
</ul>
<p>Compression strategy.</p>
<ul>
<li><code>zlib.Z_FILTERED</code></li>
<li><code>zlib.Z_HUFFMAN_ONLY</code></li>
<li><code>zlib.Z_RLE</code></li>
<li><code>zlib.Z_FIXED</code></li>
<li><code>zlib.Z_DEFAULT_STRATEGY</code></li>
</ul>
<p>Possible values of the data_type field.</p>
<ul>
<li><code>zlib.Z_BINARY</code></li>
<li><code>zlib.Z_TEXT</code></li>
<li><code>zlib.Z_ASCII</code></li>
<li><code>zlib.Z_UNKNOWN</code></li>
</ul>
<p>The deflate compression method (the only one supported in this version).</p>
<ul>
<li><code>zlib.Z_DEFLATED</code></li>
</ul>
<p>For initializing zalloc, zfree, opaque.</p>
<ul>
<li><code>zlib.Z_NULL</code></li>
</ul>
<h1>os<a id="all_os" class="mark" href="#all_os">#</a></h1>
<pre class="api_stability_4 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">4</span> <span class="sh_symbol">-</span> API Frozen</pre>
<p>Provides a few basic operating-system related utility functions.</p>
<p>Use <code>require('os')</code> to access this module.</p>
<h2>os.tmpdir()<a id="all_os_tmpdir" class="mark" href="#all_os_tmpdir">#</a></h2>
<p>Returns the operating system's default directory for temp files.</p>
<h2>os.endianness()<a id="all_os_endianness" class="mark" href="#all_os_endianness">#</a></h2>
<p>Returns the endianness of the CPU. Possible values are <code>"BE"</code> or <code>"LE"</code>.</p>
<h2>os.hostname()<a id="all_os_hostname" class="mark" href="#all_os_hostname">#</a></h2>
<p>Returns the hostname of the operating system.</p>
<h2>os.type()<a id="all_os_type" class="mark" href="#all_os_type">#</a></h2>
<p>Returns the operating system name.</p>
<h2>os.platform()<a id="all_os_platform" class="mark" href="#all_os_platform">#</a></h2>
<p>Returns the operating system platform.</p>
<h2>os.arch()<a id="all_os_arch" class="mark" href="#all_os_arch">#</a></h2>
<p>Returns the operating system CPU architecture. Possible values are <code>"x64"</code>, <code>"arm"</code> and <code>"ia32"</code>.</p>
<h2>os.release()<a id="all_os_release" class="mark" href="#all_os_release">#</a></h2>
<p>Returns the operating system release.</p>
<h2>os.uptime()<a id="all_os_uptime" class="mark" href="#all_os_uptime">#</a></h2>
<p>Returns the system uptime in seconds.</p>
<h2>os.loadavg()<a id="all_os_loadavg" class="mark" href="#all_os_loadavg">#</a></h2>
<p>Returns an array containing the 1, 5, and 15 minute load averages.</p>
<p>The load average is a measure of system activity, calculated by the operating system and expressed as a fractional number. As a rule of thumb, the load average should ideally be less than the number of logical CPUs in the system.</p>
<p>The load average is a very UNIX-y concept; there is no real equivalent on Windows platforms. That is why this function always returns <code>[0, 0, 0]</code> on Windows.</p>
<h2>os.totalmem()<a id="all_os_totalmem" class="mark" href="#all_os_totalmem">#</a></h2>
<p>Returns the total amount of system memory in bytes.</p>
<h2>os.freemem()<a id="all_os_freemem" class="mark" href="#all_os_freemem">#</a></h2>
<p>Returns the amount of free system memory in bytes.</p>
<h2>os.cpus()<a id="all_os_cpus" class="mark" href="#all_os_cpus">#</a></h2>
<p>Returns an array of objects containing information about each CPU/core installed: model, speed (in MHz), and times (an object containing the number of milliseconds the CPU/core spent in: user, nice, sys, idle, and irq).</p>
<p>Example inspection of os.cpus:</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">[</span> <span class="sh_cbracket">{</span> model<span class="sh_symbol">:</span> <span class="sh_string">'Intel(R) Core(TM) i7 CPU         860  @ 2.80GHz'</span><span class="sh_symbol">,</span>
    speed<span class="sh_symbol">:</span> <span class="sh_number">2926</span><span class="sh_symbol">,</span>
    times<span class="sh_symbol">:</span>
     <span class="sh_cbracket">{</span> user<span class="sh_symbol">:</span> <span class="sh_number">252020</span><span class="sh_symbol">,</span>
       nice<span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
       sys<span class="sh_symbol">:</span> <span class="sh_number">30340</span><span class="sh_symbol">,</span>
       idle<span class="sh_symbol">:</span> <span class="sh_number">1070356870</span><span class="sh_symbol">,</span>
       irq<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> model<span class="sh_symbol">:</span> <span class="sh_string">'Intel(R) Core(TM) i7 CPU         860  @ 2.80GHz'</span><span class="sh_symbol">,</span>
    speed<span class="sh_symbol">:</span> <span class="sh_number">2926</span><span class="sh_symbol">,</span>
    times<span class="sh_symbol">:</span>
     <span class="sh_cbracket">{</span> user<span class="sh_symbol">:</span> <span class="sh_number">306960</span><span class="sh_symbol">,</span>
       nice<span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
       sys<span class="sh_symbol">:</span> <span class="sh_number">26980</span><span class="sh_symbol">,</span>
       idle<span class="sh_symbol">:</span> <span class="sh_number">1071569080</span><span class="sh_symbol">,</span>
       irq<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> model<span class="sh_symbol">:</span> <span class="sh_string">'Intel(R) Core(TM) i7 CPU         860  @ 2.80GHz'</span><span class="sh_symbol">,</span>
    speed<span class="sh_symbol">:</span> <span class="sh_number">2926</span><span class="sh_symbol">,</span>
    times<span class="sh_symbol">:</span>
     <span class="sh_cbracket">{</span> user<span class="sh_symbol">:</span> <span class="sh_number">248450</span><span class="sh_symbol">,</span>
       nice<span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
       sys<span class="sh_symbol">:</span> <span class="sh_number">21750</span><span class="sh_symbol">,</span>
       idle<span class="sh_symbol">:</span> <span class="sh_number">1070919370</span><span class="sh_symbol">,</span>
       irq<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> model<span class="sh_symbol">:</span> <span class="sh_string">'Intel(R) Core(TM) i7 CPU         860  @ 2.80GHz'</span><span class="sh_symbol">,</span>
    speed<span class="sh_symbol">:</span> <span class="sh_number">2926</span><span class="sh_symbol">,</span>
    times<span class="sh_symbol">:</span>
     <span class="sh_cbracket">{</span> user<span class="sh_symbol">:</span> <span class="sh_number">256880</span><span class="sh_symbol">,</span>
       nice<span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
       sys<span class="sh_symbol">:</span> <span class="sh_number">19430</span><span class="sh_symbol">,</span>
       idle<span class="sh_symbol">:</span> <span class="sh_number">1070905480</span><span class="sh_symbol">,</span>
       irq<span class="sh_symbol">:</span> <span class="sh_number">20</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> model<span class="sh_symbol">:</span> <span class="sh_string">'Intel(R) Core(TM) i7 CPU         860  @ 2.80GHz'</span><span class="sh_symbol">,</span>
    speed<span class="sh_symbol">:</span> <span class="sh_number">2926</span><span class="sh_symbol">,</span>
    times<span class="sh_symbol">:</span>
     <span class="sh_cbracket">{</span> user<span class="sh_symbol">:</span> <span class="sh_number">511580</span><span class="sh_symbol">,</span>
       nice<span class="sh_symbol">:</span> <span class="sh_number">20</span><span class="sh_symbol">,</span>
       sys<span class="sh_symbol">:</span> <span class="sh_number">40900</span><span class="sh_symbol">,</span>
       idle<span class="sh_symbol">:</span> <span class="sh_number">1070842510</span><span class="sh_symbol">,</span>
       irq<span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> model<span class="sh_symbol">:</span> <span class="sh_string">'Intel(R) Core(TM) i7 CPU         860  @ 2.80GHz'</span><span class="sh_symbol">,</span>
    speed<span class="sh_symbol">:</span> <span class="sh_number">2926</span><span class="sh_symbol">,</span>
    times<span class="sh_symbol">:</span>
     <span class="sh_cbracket">{</span> user<span class="sh_symbol">:</span> <span class="sh_number">291660</span><span class="sh_symbol">,</span>
       nice<span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
       sys<span class="sh_symbol">:</span> <span class="sh_number">34360</span><span class="sh_symbol">,</span>
       idle<span class="sh_symbol">:</span> <span class="sh_number">1070888000</span><span class="sh_symbol">,</span>
       irq<span class="sh_symbol">:</span> <span class="sh_number">10</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> model<span class="sh_symbol">:</span> <span class="sh_string">'Intel(R) Core(TM) i7 CPU         860  @ 2.80GHz'</span><span class="sh_symbol">,</span>
    speed<span class="sh_symbol">:</span> <span class="sh_number">2926</span><span class="sh_symbol">,</span>
    times<span class="sh_symbol">:</span>
     <span class="sh_cbracket">{</span> user<span class="sh_symbol">:</span> <span class="sh_number">308260</span><span class="sh_symbol">,</span>
       nice<span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
       sys<span class="sh_symbol">:</span> <span class="sh_number">55410</span><span class="sh_symbol">,</span>
       idle<span class="sh_symbol">:</span> <span class="sh_number">1071129970</span><span class="sh_symbol">,</span>
       irq<span class="sh_symbol">:</span> <span class="sh_number">880</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
  <span class="sh_cbracket">{</span> model<span class="sh_symbol">:</span> <span class="sh_string">'Intel(R) Core(TM) i7 CPU         860  @ 2.80GHz'</span><span class="sh_symbol">,</span>
    speed<span class="sh_symbol">:</span> <span class="sh_number">2926</span><span class="sh_symbol">,</span>
    times<span class="sh_symbol">:</span>
     <span class="sh_cbracket">{</span> user<span class="sh_symbol">:</span> <span class="sh_number">266450</span><span class="sh_symbol">,</span>
       nice<span class="sh_symbol">:</span> <span class="sh_number">1480</span><span class="sh_symbol">,</span>
       sys<span class="sh_symbol">:</span> <span class="sh_number">34920</span><span class="sh_symbol">,</span>
       idle<span class="sh_symbol">:</span> <span class="sh_number">1072572010</span><span class="sh_symbol">,</span>
       irq<span class="sh_symbol">:</span> <span class="sh_number">30</span> <span class="sh_cbracket">}</span> <span class="sh_cbracket">}</span> <span class="sh_symbol">]</span></code></pre>
<h2>os.networkInterfaces()<a id="all_os_networkinterfaces" class="mark" href="#all_os_networkinterfaces">#</a></h2>
<p>Get a list of network interfaces:</p>
<pre class="sh_sourceCode"><code><span class="sh_cbracket">{</span> lo<span class="sh_symbol">:</span>
   <span class="sh_symbol">[</span> <span class="sh_cbracket">{</span> address<span class="sh_symbol">:</span> <span class="sh_string">'127.0.0.1'</span><span class="sh_symbol">,</span>
       netmask<span class="sh_symbol">:</span> <span class="sh_string">'255.0.0.0'</span><span class="sh_symbol">,</span>
       family<span class="sh_symbol">:</span> <span class="sh_string">'IPv4'</span><span class="sh_symbol">,</span>
       mac<span class="sh_symbol">:</span> <span class="sh_string">'00:00:00:00:00:00'</span><span class="sh_symbol">,</span>
       internal<span class="sh_symbol">:</span> <span class="sh_keyword">true</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
     <span class="sh_cbracket">{</span> address<span class="sh_symbol">:</span> <span class="sh_string">'::1'</span><span class="sh_symbol">,</span>
       netmask<span class="sh_symbol">:</span> <span class="sh_string">'ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff'</span><span class="sh_symbol">,</span>
       family<span class="sh_symbol">:</span> <span class="sh_string">'IPv6'</span><span class="sh_symbol">,</span>
       mac<span class="sh_symbol">:</span> <span class="sh_string">'00:00:00:00:00:00'</span><span class="sh_symbol">,</span>
       internal<span class="sh_symbol">:</span> <span class="sh_keyword">true</span> <span class="sh_cbracket">}</span> <span class="sh_symbol">],</span>
  eth0<span class="sh_symbol">:</span>
   <span class="sh_symbol">[</span> <span class="sh_cbracket">{</span> address<span class="sh_symbol">:</span> <span class="sh_string">'192.168.1.108'</span><span class="sh_symbol">,</span>
       netmask<span class="sh_symbol">:</span> <span class="sh_string">'255.255.255.0'</span><span class="sh_symbol">,</span>
       family<span class="sh_symbol">:</span> <span class="sh_string">'IPv4'</span><span class="sh_symbol">,</span>
       mac<span class="sh_symbol">:</span> <span class="sh_string">'01:02:03:0a:0b:0c'</span><span class="sh_symbol">,</span>
       internal<span class="sh_symbol">:</span> <span class="sh_keyword">false</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
     <span class="sh_cbracket">{</span> address<span class="sh_symbol">:</span> <span class="sh_string">'fe80::a00:27ff:fe4e:66a1'</span><span class="sh_symbol">,</span>
       netmask<span class="sh_symbol">:</span> <span class="sh_string">'ffff:ffff:ffff:ffff::'</span><span class="sh_symbol">,</span>
       family<span class="sh_symbol">:</span> <span class="sh_string">'IPv6'</span><span class="sh_symbol">,</span>
       mac<span class="sh_symbol">:</span> <span class="sh_string">'01:02:03:0a:0b:0c'</span><span class="sh_symbol">,</span>
       internal<span class="sh_symbol">:</span> <span class="sh_keyword">false</span> <span class="sh_cbracket">}</span> <span class="sh_symbol">]</span> <span class="sh_cbracket">}</span></code></pre>
<h2>os.EOL<a id="all_os_eol" class="mark" href="#all_os_eol">#</a></h2>
<p>A constant defining the appropriate End-of-line marker for the operating system.</p>
<h1>Debugger<a id="all_debugger" class="mark" href="#all_debugger">#</a></h1>
<pre class="api_stability_3 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">-</span> Stable</pre>
<p>V8 comes with an extensive debugger which is accessible out-of-process via a simple <a href="http://code.google.com/p/v8/wiki/DebuggerProtocol">TCP protocol</a>. Node has a built-in client for this debugger. To use this, start Node with the <code>debug</code> argument; a prompt will appear:</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">%</span> node debug myscript<span class="sh_symbol">.</span>js
<span class="sh_symbol">&lt;</span> <span class="sh_keyword">debugger</span> listening on port <span class="sh_number">5858</span>
connecting<span class="sh_symbol">...</span> ok
<span class="sh_keyword">break</span> <span class="sh_keyword">in</span> <span class="sh_regexp">/home/i</span><span class="sh_normal">ndutny</span><span class="sh_symbol">/</span><span class="sh_normal">Code</span><span class="sh_symbol">/</span><span class="sh_normal">git</span><span class="sh_symbol">/</span><span class="sh_normal">indutny</span><span class="sh_symbol">/</span>myscript<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">1</span>
  <span class="sh_number">1</span> x <span class="sh_symbol">=</span> <span class="sh_number">5</span><span class="sh_symbol">;</span>
  <span class="sh_number">2</span> <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_number">3</span>   <span class="sh_keyword">debugger</span><span class="sh_symbol">;</span>
debug<span class="sh_symbol">&gt;</span></code></pre>
<p>Node's debugger client doesn't support the full range of commands, but simple step and inspection is possible. By putting the statement <code>debugger;</code> into the source code of your script, you will enable a breakpoint.</p>
<p>For example, suppose <code>myscript.js</code> looked like this:</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// myscript.js</span>
x <span class="sh_symbol">=</span> <span class="sh_number">5</span><span class="sh_symbol">;</span>
<span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">debugger</span><span class="sh_symbol">;</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"world"</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span>
console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"hello"</span><span class="sh_symbol">);</span></code></pre>
<p>Then once the debugger is run, it will break on line 4.</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">%</span> node debug myscript<span class="sh_symbol">.</span>js
<span class="sh_symbol">&lt;</span> <span class="sh_keyword">debugger</span> listening on port <span class="sh_number">5858</span>
connecting<span class="sh_symbol">...</span> ok
<span class="sh_keyword">break</span> <span class="sh_keyword">in</span> <span class="sh_regexp">/home/i</span><span class="sh_normal">ndutny</span><span class="sh_symbol">/</span><span class="sh_normal">Code</span><span class="sh_symbol">/</span><span class="sh_normal">git</span><span class="sh_symbol">/</span><span class="sh_normal">indutny</span><span class="sh_symbol">/</span>myscript<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">1</span>
  <span class="sh_number">1</span> x <span class="sh_symbol">=</span> <span class="sh_number">5</span><span class="sh_symbol">;</span>
  <span class="sh_number">2</span> <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_number">3</span>   <span class="sh_keyword">debugger</span><span class="sh_symbol">;</span>
debug<span class="sh_symbol">&gt;</span> cont
<span class="sh_symbol">&lt;</span> hello
<span class="sh_keyword">break</span> <span class="sh_keyword">in</span> <span class="sh_regexp">/home/i</span><span class="sh_normal">ndutny</span><span class="sh_symbol">/</span><span class="sh_normal">Code</span><span class="sh_symbol">/</span><span class="sh_normal">git</span><span class="sh_symbol">/</span><span class="sh_normal">indutny</span><span class="sh_symbol">/</span>myscript<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">3</span>
  <span class="sh_number">1</span> x <span class="sh_symbol">=</span> <span class="sh_number">5</span><span class="sh_symbol">;</span>
  <span class="sh_number">2</span> <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_number">3</span>   <span class="sh_keyword">debugger</span><span class="sh_symbol">;</span>
  <span class="sh_number">4</span>   console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"world"</span><span class="sh_symbol">);</span>
  <span class="sh_number">5</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span>
debug<span class="sh_symbol">&gt;</span> next
<span class="sh_keyword">break</span> <span class="sh_keyword">in</span> <span class="sh_regexp">/home/i</span><span class="sh_normal">ndutny</span><span class="sh_symbol">/</span><span class="sh_normal">Code</span><span class="sh_symbol">/</span><span class="sh_normal">git</span><span class="sh_symbol">/</span><span class="sh_normal">indutny</span><span class="sh_symbol">/</span>myscript<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">4</span>
  <span class="sh_number">2</span> <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_number">3</span>   <span class="sh_keyword">debugger</span><span class="sh_symbol">;</span>
  <span class="sh_number">4</span>   console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"world"</span><span class="sh_symbol">);</span>
  <span class="sh_number">5</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span>
  <span class="sh_number">6</span> console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"hello"</span><span class="sh_symbol">);</span>
debug<span class="sh_symbol">&gt;</span> repl
Press Ctrl <span class="sh_symbol">+</span> C to leave debug repl
<span class="sh_symbol">&gt;</span> x
<span class="sh_number">5</span>
<span class="sh_symbol">&gt;</span> <span class="sh_number">2+2</span>
<span class="sh_number">4</span>
debug<span class="sh_symbol">&gt;</span> next
<span class="sh_symbol">&lt;</span> world
<span class="sh_keyword">break</span> <span class="sh_keyword">in</span> <span class="sh_regexp">/home/i</span><span class="sh_normal">ndutny</span><span class="sh_symbol">/</span><span class="sh_normal">Code</span><span class="sh_symbol">/</span><span class="sh_normal">git</span><span class="sh_symbol">/</span><span class="sh_normal">indutny</span><span class="sh_symbol">/</span>myscript<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">5</span>
  <span class="sh_number">3</span>   <span class="sh_keyword">debugger</span><span class="sh_symbol">;</span>
  <span class="sh_number">4</span>   console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"world"</span><span class="sh_symbol">);</span>
  <span class="sh_number">5</span> <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span>
  <span class="sh_number">6</span> console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"hello"</span><span class="sh_symbol">);</span>
  <span class="sh_number">7</span>
debug<span class="sh_symbol">&gt;</span> quit
<span class="sh_symbol">%</span></code></pre>
<p>The <code>repl</code> command allows you to evaluate code remotely. The <code>next</code> command steps over to the next line. There are a few other commands available and more to come. Type <code>help</code> to see others.</p>
<h2>Watchers<a id="all_watchers" class="mark" href="#all_watchers">#</a></h2>
<p>You can watch expression and variable values while debugging your code. On every breakpoint each expression from the watchers list will be evaluated in the current context and displayed just before the breakpoint's source code listing.</p>
<p>To start watching an expression, type <code>watch("my_expression")</code>. <code>watchers</code> prints the active watchers. To remove a watcher, type <code>unwatch("my_expression")</code>.</p>
<h2>Commands reference<a id="all_commands_reference" class="mark" href="#all_commands_reference">#</a></h2>
<h3>Stepping<a id="all_stepping" class="mark" href="#all_stepping">#</a></h3>
<ul>
<li><code>cont</code>, <code>c</code> - Continue execution</li>
<li><code>next</code>, <code>n</code> - Step next</li>
<li><code>step</code>, <code>s</code> - Step in</li>
<li><code>out</code>, <code>o</code> - Step out</li>
<li><code>pause</code> - Pause running code (like pause button in Developer Tools)</li>
</ul>
<h3>Breakpoints<a id="all_breakpoints" class="mark" href="#all_breakpoints">#</a></h3>
<div class="signature">
<ul>
<li><code>setBreakpoint()</code>, <code>sb()</code> - Set breakpoint on current line</li>
<li><code>setBreakpoint(line)</code>, <code>sb(line)</code> - Set breakpoint on specific line</li>
<li><code>setBreakpoint('fn()')</code>, <code>sb(...)</code> - Set breakpoint on a first statement in functions body</li>
<li><code>setBreakpoint('script.js', 1)</code>, <code>sb(...)</code> - Set breakpoint on first line of script.js</li>
<li><code>clearBreakpoint</code>, <code>cb(...)</code> - Clear breakpoint</li>
</ul>
</div>
<p>It is also possible to set a breakpoint in a file (module) that isn't loaded yet:</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">%</span> <span class="sh_symbol">.</span><span class="sh_regexp">/node debug test/</span><span class="sh_normal">fixtures</span><span class="sh_symbol">/</span><span class="sh_keyword">break</span><span class="sh_symbol">-</span><span class="sh_keyword">in</span><span class="sh_symbol">-</span><span class="sh_normal">module</span><span class="sh_symbol">/</span>main<span class="sh_symbol">.</span>js
<span class="sh_symbol">&lt;</span> <span class="sh_keyword">debugger</span> listening on port <span class="sh_number">5858</span>
connecting to port <span class="sh_number">5858</span><span class="sh_symbol">...</span> ok
<span class="sh_keyword">break</span> <span class="sh_keyword">in</span> <span class="sh_normal">test</span><span class="sh_symbol">/</span><span class="sh_normal">fixtures</span><span class="sh_symbol">/</span><span class="sh_keyword">break</span><span class="sh_symbol">-</span><span class="sh_keyword">in</span><span class="sh_symbol">-</span><span class="sh_normal">module</span><span class="sh_symbol">/</span>main<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">1</span>
  <span class="sh_number">1</span> <span class="sh_keyword">var</span> mod <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./mod.js'</span><span class="sh_symbol">);</span>
  <span class="sh_number">2</span> mod<span class="sh_symbol">.</span><span class="sh_function">hello</span><span class="sh_symbol">();</span>
  <span class="sh_number">3</span> mod<span class="sh_symbol">.</span><span class="sh_function">hello</span><span class="sh_symbol">();</span>
debug<span class="sh_symbol">&gt;</span> <span class="sh_function">setBreakpoint</span><span class="sh_symbol">(</span><span class="sh_string">'mod.js'</span><span class="sh_symbol">,</span> <span class="sh_number">23</span><span class="sh_symbol">)</span>
Warning<span class="sh_symbol">:</span> script <span class="sh_string">'mod.js'</span> was not loaded yet<span class="sh_symbol">.</span>
  <span class="sh_number">1</span> <span class="sh_keyword">var</span> mod <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'./mod.js'</span><span class="sh_symbol">);</span>
  <span class="sh_number">2</span> mod<span class="sh_symbol">.</span><span class="sh_function">hello</span><span class="sh_symbol">();</span>
  <span class="sh_number">3</span> mod<span class="sh_symbol">.</span><span class="sh_function">hello</span><span class="sh_symbol">();</span>
debug<span class="sh_symbol">&gt;</span> c
<span class="sh_keyword">break</span> <span class="sh_keyword">in</span> <span class="sh_normal">test</span><span class="sh_symbol">/</span><span class="sh_normal">fixtures</span><span class="sh_symbol">/</span><span class="sh_keyword">break</span><span class="sh_symbol">-</span><span class="sh_keyword">in</span><span class="sh_symbol">-</span><span class="sh_normal">module</span><span class="sh_symbol">/</span>mod<span class="sh_symbol">.</span>js<span class="sh_symbol">:</span><span class="sh_number">23</span>
 <span class="sh_number">21</span>
 <span class="sh_number">22</span> exports<span class="sh_symbol">.</span>hello <span class="sh_symbol">=</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
 <span class="sh_number">23</span>   <span class="sh_keyword">return</span> <span class="sh_string">'hello from module'</span><span class="sh_symbol">;</span>
 <span class="sh_number">24</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
 <span class="sh_number">25</span>
debug<span class="sh_symbol">&gt;</span></code></pre>
<h3>Info<a id="all_info" class="mark" href="#all_info">#</a></h3>
<div class="signature">
<ul>
<li><code>backtrace</code>, <code>bt</code> - Print backtrace of current execution frame</li>
<li><code>list(5)</code> - List scripts source code with 5 line context (5 lines before and after)</li>
<li><code>watch(expr)</code> - Add expression to watch list</li>
<li><code>unwatch(expr)</code> - Remove expression from watch list</li>
<li><code>watchers</code> - List all watchers and their values (automatically listed on each breakpoint)</li>
<li><code>repl</code> - Open debugger's repl for evaluation in debugging script's context</li>
</ul>
</div>
<h3>Execution control<a id="all_execution_control" class="mark" href="#all_execution_control">#</a></h3>
<div class="signature">
<ul>
<li><code>run</code> - Run script (automatically runs on debugger's start)</li>
<li><code>restart</code> - Restart script</li>
<li><code>kill</code> - Kill script</li>
</ul>
</div>
<h3>Various<a id="all_various" class="mark" href="#all_various">#</a></h3>
<div class="signature">
<ul>
<li><code>scripts</code> - List all loaded scripts</li>
<li><code>version</code> - Display v8's version</li>
</ul>
</div>
<h2>Advanced Usage<a id="all_advanced_usage" class="mark" href="#all_advanced_usage">#</a></h2>
<p>The V8 debugger can be enabled and accessed either by starting Node with the <code>--debug</code> command-line flag or by signaling an existing Node process with <code>SIGUSR1</code>.</p>
<p>Once a process has been set in debug mode with this it can be connected to with the node debugger. Either connect to the <code>pid</code> or the URI to the debugger. The syntax is:</p>
<ul>
<li><code>node debug -p &lt;pid&gt;</code> - Connects to the process via the <code>pid</code></li>
<li><code>node debug &lt;URI&gt;</code> - Connects to the process via the URI such as localhost:5858</li>
</ul>
<h1>Cluster<a id="all_cluster" class="mark" href="#all_cluster">#</a></h1>
<pre class="api_stability_2 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">-</span> Unstable</pre>
<p>A single instance of Node runs in a single thread. To take advantage of multi-core systems the user will sometimes want to launch a cluster of Node processes to handle the load.</p>
<p>The cluster module allows you to easily create child processes that all share server ports.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> cluster <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'cluster'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> numCPUs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'os'</span><span class="sh_symbol">).</span><span class="sh_function">cpus</span><span class="sh_symbol">().</span>length<span class="sh_symbol">;</span>

<span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isMaster<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// Fork workers.</span>
  <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> numCPUs<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
    cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span>

  cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">,</span> code<span class="sh_symbol">,</span> signal<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'worker '</span> <span class="sh_symbol">+</span> worker<span class="sh_symbol">.</span>process<span class="sh_symbol">.</span>pid <span class="sh_symbol">+</span> <span class="sh_string">' died'</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// Workers can share any TCP connection</span>
  <span class="sh_comment">// In this case its a HTTP server</span>
  http<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    res<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">);</span>
    res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">"hello world</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<p>Running node will now share port 8000 between the workers:</p>
<pre class="sh_sourceCode"><code><span class="sh_symbol">%</span> NODE_DEBUG<span class="sh_symbol">=</span>cluster node server<span class="sh_symbol">.</span>js
<span class="sh_number">23521</span><span class="sh_symbol">,</span>Master Worker <span class="sh_number">23524</span> online
<span class="sh_number">23521</span><span class="sh_symbol">,</span>Master Worker <span class="sh_number">23526</span> online
<span class="sh_number">23521</span><span class="sh_symbol">,</span>Master Worker <span class="sh_number">23523</span> online
<span class="sh_number">23521</span><span class="sh_symbol">,</span>Master Worker <span class="sh_number">23528</span> online</code></pre>
<p>This feature was introduced recently, and may change in future versions. Please try it out and provide feedback.</p>
<p>Also note that, on Windows, it is not yet possible to set up a named pipe server in a worker.</p>
<h2>How It Works<a id="all_how_it_works" class="mark" href="#all_how_it_works">#</a></h2>
<p>The worker processes are spawned using the <code>child_process.fork</code> method, so that they can communicate with the parent via IPC and pass server handles back and forth.</p>
<p>The cluster module supports two methods of distributing incoming connections.</p>
<p>The first one (and the default one on all platforms except Windows), is the round-robin approach, where the master process listens on a port, accepts new connections and distributes them across the workers in a round-robin fashion, with some built-in smarts to avoid overloading a worker process.</p>
<p>The second approach is where the master process creates the listen socket and sends it to interested workers. The workers then accept incoming connections directly.</p>
<p>The second approach should, in theory, give the best performance. In practice however, distribution tends to be very unbalanced due to operating system scheduler vagaries. Loads have been observed where over 70% of all connections ended up in just two processes, out of a total of eight.</p>
<p>Because <code>server.listen()</code> hands off most of the work to the master process, there are three cases where the behavior between a normal node.js process and a cluster worker differs:</p>
<ol>
<li><code>server.listen({fd: 7})</code> Because the message is passed to the master, file descriptor 7 <strong>in the parent</strong> will be listened on, and the handle passed to the worker, rather than listening to the worker's idea of what the number 7 file descriptor references.</li>
<li><code>server.listen(handle)</code> Listening on handles explicitly will cause the worker to use the supplied handle, rather than talk to the master process. If the worker already has the handle, then it's presumed that you know what you are doing.</li>
<li><code>server.listen(0)</code> Normally, this will cause servers to listen on a random port. However, in a cluster, each worker will receive the same "random" port each time they do <code>listen(0)</code>. In essence, the port is random the first time, but predictable thereafter. If you want to listen on a unique port, generate a port number based on the cluster worker ID.</li>
</ol>
<p>There is no routing logic in Node.js, or in your program, and no shared state between the workers. Therefore, it is important to design your program such that it does not rely too heavily on in-memory data objects for things like sessions and login.</p>
<p>Because workers are all separate processes, they can be killed or re-spawned depending on your program's needs, without affecting other workers. As long as there are some workers still alive, the server will continue to accept connections. Node does not automatically manage the number of workers for you, however. It is your responsibility to manage the worker pool for your application's needs.</p>
<h2>cluster.schedulingPolicy<a id="all_cluster_schedulingpolicy" class="mark" href="#all_cluster_schedulingpolicy">#</a></h2>
<p>The scheduling policy, either <code>cluster.SCHED_RR</code> for round-robin or <code>cluster.SCHED_NONE</code> to leave it to the operating system. This is a global setting and effectively frozen once you spawn the first worker or call <code>cluster.setupMaster()</code>, whatever comes first.</p>
<p><code>SCHED_RR</code> is the default on all operating systems except Windows. Windows will change to <code>SCHED_RR</code> once libuv is able to effectively distribute IOCP handles without incurring a large performance hit.</p>
<p><code>cluster.schedulingPolicy</code> can also be set through the <code>NODE_CLUSTER_SCHED_POLICY</code> environment variable. Valid values are <code>"rr"</code> and <code>"none"</code>.</p>
<h2>cluster.settings<a id="all_cluster_settings" class="mark" href="#all_cluster_settings">#</a></h2>
<div class="signature">
<ul>
<li><span class="type">Object</span>
<ul>
<li><code>execArgv</code> <span class="type">Array</span> list of string arguments passed to the node executable. (Default=<code>process.execArgv</code>)</li>
<li><code>exec</code> <span class="type">String</span> file path to worker file. (Default=<code>process.argv[1]</code>)</li>
<li><code>args</code> <span class="type">Array</span> string arguments passed to worker. (Default=<code>process.argv.slice(2)</code>)</li>
<li><code>silent</code> <span class="type">Boolean</span> whether or not to send output to parent's stdio. (Default=<code>false</code>)</li>
<li><code>uid</code> <span class="type">Number</span> Sets the user identity of the process. (See setuid(2).)</li>
<li><code>gid</code> <span class="type">Number</span> Sets the group identity of the process. (See setgid(2).)</li>
</ul>
</li>
</ul>
</div>
<p>After calling <code>.setupMaster()</code> (or <code>.fork()</code>) this settings object will contain the settings, including the default values.</p>
<p>It is effectively frozen after being set, because <code>.setupMaster()</code> can only be called once.</p>
<p>This object is not supposed to be changed or set manually, by you.</p>
<h2>cluster.isMaster<a id="all_cluster_ismaster" class="mark" href="#all_cluster_ismaster">#</a></h2>
<div class="signature">
<ul>
<li><span class="type">Boolean</span></li>
</ul>
</div>
<p>True if the process is a master. This is determined by the <code>process.env.NODE_UNIQUE_ID</code>. If <code>process.env.NODE_UNIQUE_ID</code> is undefined, then <code>isMaster</code> is <code>true</code>.</p>
<h2>cluster.isWorker<a id="all_cluster_isworker" class="mark" href="#all_cluster_isworker">#</a></h2>
<div class="signature">
<ul>
<li><span class="type">Boolean</span></li>
</ul>
</div>
<p>True if the process is not a master (it is the negation of <code>cluster.isMaster</code>).</p>
<h2>Event: 'fork'<a id="all_event_fork" class="mark" href="#all_event_fork">#</a></h2>
<div class="signature">
<ul>
<li><code>worker</code> <span class="type">Worker object</span></li>
</ul>
</div>
<p>When a new worker is forked the cluster module will emit a 'fork' event. This can be used to log worker activity, and create your own timeout.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> timeouts <span class="sh_symbol">=</span> <span class="sh_symbol">[];</span>
<span class="sh_keyword">function</span> <span class="sh_function">errorMsg</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">error</span><span class="sh_symbol">(</span><span class="sh_string">"Something must be wrong with the connection ..."</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'fork'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  timeouts<span class="sh_symbol">[</span>worker<span class="sh_symbol">.</span>id<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span>errorMsg<span class="sh_symbol">,</span> <span class="sh_number">2000</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'listening'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">,</span> address<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">clearTimeout</span><span class="sh_symbol">(</span>timeouts<span class="sh_symbol">[</span>worker<span class="sh_symbol">.</span>id<span class="sh_symbol">]);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">,</span> code<span class="sh_symbol">,</span> signal<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_function">clearTimeout</span><span class="sh_symbol">(</span>timeouts<span class="sh_symbol">[</span>worker<span class="sh_symbol">.</span>id<span class="sh_symbol">]);</span>
  <span class="sh_function">errorMsg</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Event: 'online'<a id="all_event_online" class="mark" href="#all_event_online">#</a></h2>
<div class="signature">
<ul>
<li><code>worker</code> <span class="type">Worker object</span></li>
</ul>
</div>
<p>After forking a new worker, the worker should respond with an online message. When the master receives an online message it will emit this event. The difference between 'fork' and 'online' is that fork is emitted when the master forks a worker, and 'online' is emitted when the worker is running.</p>
<pre class="sh_sourceCode"><code>cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'online'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"Yay, the worker responded after it was forked"</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Event: 'listening'<a id="all_event_listening_2" class="mark" href="#all_event_listening_2">#</a></h2>
<div class="signature">
<ul>
<li><code>worker</code> <span class="type">Worker object</span></li>
<li><code>address</code> <span class="type">Object</span></li>
</ul>
</div>
<p>After calling <code>listen()</code> from a worker, when the 'listening' event is emitted on the server, a listening event will also be emitted on <code>cluster</code> in the master.</p>
<p>The event handler is executed with two arguments, the <code>worker</code> contains the worker object and the <code>address</code> object contains the following connection properties: <code>address</code>, <code>port</code> and <code>addressType</code>. This is very useful if the worker is listening on more than one address.</p>
<pre class="sh_sourceCode"><code>cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'listening'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">,</span> address<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"A worker is now connected to "</span> <span class="sh_symbol">+</span> address<span class="sh_symbol">.</span>address <span class="sh_symbol">+</span> <span class="sh_string">":"</span> <span class="sh_symbol">+</span> address<span class="sh_symbol">.</span>port<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>The <code>addressType</code> is one of:</p>
<ul>
<li><code>4</code> (TCPv4)</li>
<li><code>6</code> (TCPv6)</li>
<li><code>-1</code> (unix domain socket)</li>
<li><code>"udp4"</code> or <code>"udp6"</code> (UDP v4 or v6)</li>
</ul>
<h2>Event: 'disconnect'<a id="all_event_disconnect_1" class="mark" href="#all_event_disconnect_1">#</a></h2>
<div class="signature">
<ul>
<li><code>worker</code> <span class="type">Worker object</span></li>
</ul>
</div>
<p>Emitted after the worker IPC channel has disconnected. This can occur when a worker exits gracefully, is killed, or is disconnected manually (such as with worker.disconnect()).</p>
<p>There may be a delay between the <code>disconnect</code> and <code>exit</code> events. These events can be used to detect if the process is stuck in a cleanup or if there are long-living connections.</p>
<pre class="sh_sourceCode"><code>cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'disconnect'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'The worker #'</span> <span class="sh_symbol">+</span> worker<span class="sh_symbol">.</span>id <span class="sh_symbol">+</span> <span class="sh_string">' has disconnected'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Event: 'exit'<a id="all_event_exit_3" class="mark" href="#all_event_exit_3">#</a></h2>
<div class="signature">
<ul>
<li><code>worker</code> <span class="type">Worker object</span></li>
<li><code>code</code> <span class="type">Number</span> the exit code, if it exited normally.</li>
<li><code>signal</code> <span class="type">String</span> the name of the signal (eg. <code>'SIGHUP'</code>) that caused the process to be killed.</li>
</ul>
</div>
<p>When any of the workers die the cluster module will emit the 'exit' event.</p>
<p>This can be used to restart the worker by calling <code>.fork()</code> again.</p>
<pre class="sh_sourceCode"><code>cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">,</span> code<span class="sh_symbol">,</span> signal<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'worker %d died (%s). restarting...'</span><span class="sh_symbol">,</span>
    worker<span class="sh_symbol">.</span>process<span class="sh_symbol">.</span>pid<span class="sh_symbol">,</span> signal <span class="sh_symbol">||</span> code<span class="sh_symbol">);</span>
  cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>See <a href="https://nodejs.org/api/child_process.html#child_process_event_exit">child_process event: 'exit'</a>.</p>
<h2>Event: 'setup'<a id="all_event_setup" class="mark" href="#all_event_setup">#</a></h2>
<div class="signature">
<ul>
<li><code>settings</code> <span class="type">Object</span></li>
</ul>
</div>
<p>Emitted every time <code>.setupMaster()</code> is called.</p>
<p>The <code>settings</code> object is the <code>cluster.settings</code> object at the time <code>.setupMaster()</code> was called and is advisory only, since multiple calls to <code>.setupMaster()</code> can be made in a single tick.</p>
<p>If accuracy is important, use <code>cluster.settings</code>.</p>
<h2>cluster.setupMaster([settings])<a id="all_cluster_setupmaster_settings" class="mark" href="#all_cluster_setupmaster_settings">#</a></h2>
<div class="signature">
<ul>
<li><code>settings</code> <span class="type">Object</span>
<ul>
<li><code>exec</code> <span class="type">String</span> file path to worker file. (Default=<code>process.argv[1]</code>)</li>
<li><code>args</code> <span class="type">Array</span> string arguments passed to worker. (Default=<code>process.argv.slice(2)</code>)</li>
<li><code>silent</code> <span class="type">Boolean</span> whether or not to send output to parent's stdio. (Default=<code>false</code>)</li>
</ul>
</li>
</ul>
</div>
<p><code>setupMaster</code> is used to change the default 'fork' behavior. Once called, the settings will be present in <code>cluster.settings</code>.</p>
<p>Note that:</p>
<ul>
<li>any settings changes only affect future calls to <code>.fork()</code> and have no effect on workers that are already running</li>
<li>The <em>only</em> attribute of a worker that cannot be set via <code>.setupMaster()</code> is the <code>env</code> passed to <code>.fork()</code></li>
<li>the defaults above apply to the first call only, the defaults for later calls is the current value at the time of <code>cluster.setupMaster()</code> is called</li>
</ul>
<p>Example:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> cluster <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'cluster'</span><span class="sh_symbol">);</span>
cluster<span class="sh_symbol">.</span><span class="sh_function">setupMaster</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  exec<span class="sh_symbol">:</span> <span class="sh_string">'worker.js'</span><span class="sh_symbol">,</span>
  args<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'--use'</span><span class="sh_symbol">,</span> <span class="sh_string">'https'</span><span class="sh_symbol">],</span>
  silent<span class="sh_symbol">:</span> <span class="sh_keyword">true</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span> <span class="sh_comment">// https worker</span>
cluster<span class="sh_symbol">.</span><span class="sh_function">setupMaster</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span>
  args<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'--use'</span><span class="sh_symbol">,</span> <span class="sh_string">'http'</span><span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span> <span class="sh_comment">// http worker</span></code></pre>
<p>This can only be called from the master process.</p>
<h2>cluster.fork([env])<a id="all_cluster_fork_env" class="mark" href="#all_cluster_fork_env">#</a></h2>
<div class="signature">
<ul>
<li><code>env</code> <span class="type">Object</span> Key/value pairs to add to worker process environment.</li>
<li>return <span class="type">Worker object</span></li>
</ul>
</div>
<p>Spawn a new worker process.</p>
<p>This can only be called from the master process.</p>
<h2>cluster.disconnect([callback])<a id="all_cluster_disconnect_callback" class="mark" href="#all_cluster_disconnect_callback">#</a></h2>
<div class="signature">
<ul>
<li><code>callback</code> <span class="type">Function</span> called when all workers are disconnected and handles are closed</li>
</ul>
</div>
<p>Calls <code>.disconnect()</code> on each worker in <code>cluster.workers</code>.</p>
<p>When they are disconnected all internal handles will be closed, allowing the master process to die gracefully if no other event is waiting.</p>
<p>The method takes an optional callback argument which will be called when finished.</p>
<p>This can only be called from the master process.</p>
<h2>cluster.worker<a id="all_cluster_worker" class="mark" href="#all_cluster_worker">#</a></h2>
<div class="signature">
<ul>
<li><span class="type">Object</span></li>
</ul>
</div>
<p>A reference to the current worker object. Not available in the master process.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> cluster <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'cluster'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isMaster<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'I am master'</span><span class="sh_symbol">);</span>
  cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
  cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isWorker<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'I am worker #'</span> <span class="sh_symbol">+</span> cluster<span class="sh_symbol">.</span>worker<span class="sh_symbol">.</span>id<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<h2>cluster.workers<a id="all_cluster_workers" class="mark" href="#all_cluster_workers">#</a></h2>
<div class="signature">
<ul>
<li><span class="type">Object</span></li>
</ul>
</div>
<p>A hash that stores the active worker objects, keyed by <code>id</code> field. Makes it easy to loop through all the workers. It is only available in the master process.</p>
<p>A worker is removed from cluster.workers after the worker has disconnected <em>and</em> exited. The order between these two events cannot be determined in advance. However, it is guaranteed that the removal from the cluster.workers list happens before last <code>'disconnect'</code> or <code>'exit'</code> event is emitted.</p>
<pre class="sh_sourceCode"><code><span class="sh_comment">// Go through all workers</span>
<span class="sh_keyword">function</span> <span class="sh_function">eachWorker</span><span class="sh_symbol">(</span>callback<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> id <span class="sh_keyword">in</span> cluster<span class="sh_symbol">.</span>workers<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_function">callback</span><span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>workers<span class="sh_symbol">[</span>id<span class="sh_symbol">]);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>
<span class="sh_function">eachWorker</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  worker<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_string">'big announcement to all workers'</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>Should you wish to reference a worker over a communication channel, using the worker's unique id is the easiest way to find the worker.</p>
<pre class="sh_sourceCode"><code>socket<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'data'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>id<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> worker <span class="sh_symbol">=</span> cluster<span class="sh_symbol">.</span>workers<span class="sh_symbol">[</span>id<span class="sh_symbol">];</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h2>Class: Worker<a id="all_class_worker" class="mark" href="#all_class_worker">#</a></h2>
<p>A Worker object contains all public information and method about a worker. In the master it can be obtained using <code>cluster.workers</code>. In a worker it can be obtained using <code>cluster.worker</code>.</p>
<h3>worker.id<a id="all_worker_id" class="mark" href="#all_worker_id">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">String</span></li>
</ul>
</div>
<p>Each new worker is given its own unique id, this id is stored in the <code>id</code>.</p>
<p>While a worker is alive, this is the key that indexes it in cluster.workers</p>
<h3>worker.process<a id="all_worker_process" class="mark" href="#all_worker_process">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">ChildProcess object</span></li>
</ul>
</div>
<p>All workers are created using <code>child_process.fork()</code>, the returned object from this function is stored as <code>.process</code>. In a worker, the global <code>process</code> is stored.</p>
<p>See: <a href="https://nodejs.org/api/child_process.html#child_process_child_process_fork_modulepath_args_options">Child Process module</a></p>
<p>Note that workers will call <code>process.exit(0)</code> if the <code>'disconnect'</code> event occurs on <code>process</code> and <code>.suicide</code> is not <code>true</code>. This protects against accidental disconnection.</p>
<h3>worker.suicide<a id="all_worker_suicide" class="mark" href="#all_worker_suicide">#</a></h3>
<div class="signature">
<ul>
<li><span class="type">Boolean</span></li>
</ul>
</div>
<p>Set by calling <code>.kill()</code> or <code>.disconnect()</code>, until then it is <code>undefined</code>.</p>
<p>The boolean <code>worker.suicide</code> lets you distinguish between voluntary and accidental exit, the master may choose not to respawn a worker based on this value.</p>
<pre class="sh_sourceCode"><code>cluster<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>worker<span class="sh_symbol">,</span> code<span class="sh_symbol">,</span> signal<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>worker<span class="sh_symbol">.</span>suicide <span class="sh_symbol">===</span> <span class="sh_keyword">true</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">'Oh, it was just suicide</span><span class="sh_specialchar">\'</span><span class="sh_string"> &ndash; no need to worry'</span><span class="sh_symbol">).</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_comment">// kill worker</span>
worker<span class="sh_symbol">.</span><span class="sh_function">kill</span><span class="sh_symbol">();</span></code></pre>
<h3>worker.send(message[, sendHandle])<a id="all_worker_send_message_sendhandle" class="mark" href="#all_worker_send_message_sendhandle">#</a></h3>
<div class="signature">
<ul>
<li><code>message</code> <span class="type">Object</span></li>
<li><code>sendHandle</code> <span class="type">Handle object</span></li>
</ul>
</div>
<p>This function is equal to the send methods provided by <code>child_process.fork()</code>. In the master you should use this function to send a message to a specific worker.</p>
<p>In a worker you can also use <code>process.send(message)</code>, it is the same function.</p>
<p>This example will echo back all messages from the master:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isMaster<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> worker <span class="sh_symbol">=</span> cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
  worker<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_string">'hi there'</span><span class="sh_symbol">);</span>

<span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isWorker<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'message'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>msg<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    process<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span>msg<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<h3>worker.kill([signal='SIGTERM'])<a id="all_worker_kill_signal_sigterm" class="mark" href="#all_worker_kill_signal_sigterm">#</a></h3>
<div class="signature">
<ul>
<li><code>signal</code> <span class="type">String</span> Name of the kill signal to send to the worker process.</li>
</ul>
</div>
<p>This function will kill the worker. In the master, it does this by disconnecting the <code>worker.process</code>, and once disconnected, killing with <code>signal</code>. In the worker, it does it by disconnecting the channel, and then exiting with code <code>0</code>.</p>
<p>Causes <code>.suicide</code> to be set.</p>
<p>This method is aliased as <code>worker.destroy()</code> for backwards compatibility.</p>
<p>Note that in a worker, <code>process.kill()</code> exists, but it is not this function, it is <a href="https://nodejs.org/api/process.html#process_process_kill_pid_signal">kill</a>.</p>
<h3>worker.disconnect()<a id="all_worker_disconnect" class="mark" href="#all_worker_disconnect">#</a></h3>
<p>In a worker, this function will close all servers, wait for the 'close' event on those servers, and then disconnect the IPC channel.</p>
<p>In the master, an internal message is sent to the worker causing it to call <code>.disconnect()</code> on itself.</p>
<p>Causes <code>.suicide</code> to be set.</p>
<p>Note that after a server is closed, it will no longer accept new connections, but connections may be accepted by any other listening worker. Existing connections will be allowed to close as usual. When no more connections exist, see <a href="https://nodejs.org/api/net.html#net_event_close">server.close()</a>, the IPC channel to the worker will close allowing it to die gracefully.</p>
<p>The above applies <em>only</em> to server connections, client connections are not automatically closed by workers, and disconnect does not wait for them to close before exiting.</p>
<p>Note that in a worker, <code>process.disconnect</code> exists, but it is not this function, it is <a href="https://nodejs.org/api/child_process.html#child_process_child_disconnect">disconnect</a>.</p>
<p>Because long living server connections may block workers from disconnecting, it may be useful to send a message, so application specific actions may be taken to close them. It also may be useful to implement a timeout, killing a worker if the <code>disconnect</code> event has not been emitted after some time.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isMaster<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> worker <span class="sh_symbol">=</span> cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
  <span class="sh_keyword">var</span> timeout<span class="sh_symbol">;</span>

  worker<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'listening'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>address<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    worker<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_string">'shutdown'</span><span class="sh_symbol">);</span>
    worker<span class="sh_symbol">.</span><span class="sh_function">disconnect</span><span class="sh_symbol">();</span>
    timeout <span class="sh_symbol">=</span> <span class="sh_function">setTimeout</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
      worker<span class="sh_symbol">.</span><span class="sh_function">kill</span><span class="sh_symbol">();</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">2000</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

  worker<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'disconnect'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    <span class="sh_function">clearTimeout</span><span class="sh_symbol">(</span>timeout<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isWorker<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">var</span> net <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'net'</span><span class="sh_symbol">);</span>
  <span class="sh_keyword">var</span> server <span class="sh_symbol">=</span> net<span class="sh_symbol">.</span><span class="sh_function">createServer</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>socket<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_comment">// connections never end</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

  server<span class="sh_symbol">.</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">);</span>

  process<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'message'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>msg<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>msg <span class="sh_symbol">===</span> <span class="sh_string">'shutdown'</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      <span class="sh_comment">// initiate graceful close of any connections to server</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<h3>worker.isDead()<a id="all_worker_isdead" class="mark" href="#all_worker_isdead">#</a></h3>
<p>This function returns <code>true</code> if the worker's process has terminated (either because of exiting or being signaled). Otherwise, it returns <code>false</code>.</p>
<h3>worker.isConnected()<a id="all_worker_isconnected" class="mark" href="#all_worker_isconnected">#</a></h3>
<p>This function returns <code>true</code> if the worker is connected to its master via its IPC channel, <code>false</code> otherwise. A worker is connected to its master after it's been created. It is disconnected after the <code>disconnect</code> event is emitted.</p>
<h3>Event: 'message'<a id="all_event_message_2" class="mark" href="#all_event_message_2">#</a></h3>
<div class="signature">
<ul>
<li><code>message</code> <span class="type">Object</span></li>
</ul>
</div>
<p>This event is the same as the one provided by <code>child_process.fork()</code>.</p>
<p>In a worker you can also use <code>process.on('message')</code>.</p>
<p>As an example, here is a cluster that keeps count of the number of requests in the master process using the message system:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> cluster <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'cluster'</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> http <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'http'</span><span class="sh_symbol">);</span>

<span class="sh_keyword">if</span> <span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>isMaster<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>

  <span class="sh_comment">// Keep track of http requests</span>
  <span class="sh_keyword">var</span> numReqs <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
  <span class="sh_function">setInterval</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"numReqs ="</span><span class="sh_symbol">,</span> numReqs<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">,</span> <span class="sh_number">1000</span><span class="sh_symbol">);</span>

  <span class="sh_comment">// Count requestes</span>
  <span class="sh_keyword">function</span> <span class="sh_function">messageHandler</span><span class="sh_symbol">(</span>msg<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>msg<span class="sh_symbol">.</span>cmd <span class="sh_symbol">&amp;&amp;</span> msg<span class="sh_symbol">.</span>cmd <span class="sh_symbol">==</span> <span class="sh_string">'notifyRequest'</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
      numReqs <span class="sh_symbol">+=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
  <span class="sh_cbracket">}</span>

  <span class="sh_comment">// Start workers and listen for messages containing notifyRequest</span>
  <span class="sh_keyword">var</span> numCPUs <span class="sh_symbol">=</span> <span class="sh_function">require</span><span class="sh_symbol">(</span><span class="sh_string">'os'</span><span class="sh_symbol">).</span><span class="sh_function">cpus</span><span class="sh_symbol">().</span>length<span class="sh_symbol">;</span>
  <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> numCPUs<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
    cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
  <span class="sh_cbracket">}</span>

  <span class="sh_predef_func">Object</span><span class="sh_symbol">.</span><span class="sh_function">keys</span><span class="sh_symbol">(</span>cluster<span class="sh_symbol">.</span>workers<span class="sh_symbol">).</span><span class="sh_function">forEach</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>id<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    cluster<span class="sh_symbol">.</span>workers<span class="sh_symbol">[</span>id<span class="sh_symbol">].</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'message'</span><span class="sh_symbol">,</span> messageHandler<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

<span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>

  <span class="sh_comment">// Worker processes have a http server.</span>
  http<span class="sh_symbol">.</span><span class="sh_function">Server</span><span class="sh_symbol">(</span><span class="sh_keyword">function</span><span class="sh_symbol">(</span>req<span class="sh_symbol">,</span> res<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    res<span class="sh_symbol">.</span><span class="sh_function">writeHead</span><span class="sh_symbol">(</span><span class="sh_number">200</span><span class="sh_symbol">);</span>
    res<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(</span><span class="sh_string">"hello world</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">);</span>

    <span class="sh_comment">// notify master about the request</span>
    process<span class="sh_symbol">.</span><span class="sh_function">send</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span> cmd<span class="sh_symbol">:</span> <span class="sh_string">'notifyRequest'</span> <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span><span class="sh_symbol">).</span><span class="sh_function">listen</span><span class="sh_symbol">(</span><span class="sh_number">8000</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
<h3>Event: 'online'<a id="all_event_online_1" class="mark" href="#all_event_online_1">#</a></h3>
<p>Similar to the <code>cluster.on('online')</code> event, but specific to this worker.</p>
<pre class="sh_sourceCode"><code>cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">().</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'online'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// Worker is online</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>It is not emitted in the worker.</p>
<h3>Event: 'listening'<a id="all_event_listening_3" class="mark" href="#all_event_listening_3">#</a></h3>
<div class="signature">
<ul>
<li><code>address</code> <span class="type">Object</span></li>
</ul>
</div>
<p>Similar to the <code>cluster.on('listening')</code> event, but specific to this worker.</p>
<pre class="sh_sourceCode"><code>cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">().</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'listening'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>address<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// Worker is listening</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<p>It is not emitted in the worker.</p>
<h3>Event: 'disconnect'<a id="all_event_disconnect_2" class="mark" href="#all_event_disconnect_2">#</a></h3>
<p>Similar to the <code>cluster.on('disconnect')</code> event, but specfic to this worker.</p>
<pre class="sh_sourceCode"><code>cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">().</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'disconnect'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
  <span class="sh_comment">// Worker has disconnected</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'exit'<a id="all_event_exit_4" class="mark" href="#all_event_exit_4">#</a></h3>
<div class="signature">
<ul>
<li><code>code</code> <span class="type">Number</span> the exit code, if it exited normally.</li>
<li><code>signal</code> <span class="type">String</span> the name of the signal (eg. <code>'SIGHUP'</code>) that caused the process to be killed.</li>
</ul>
</div>
<p>Similar to the <code>cluster.on('exit')</code> event, but specific to this worker.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> worker <span class="sh_symbol">=</span> cluster<span class="sh_symbol">.</span><span class="sh_function">fork</span><span class="sh_symbol">();</span>
worker<span class="sh_symbol">.</span><span class="sh_function">on</span><span class="sh_symbol">(</span><span class="sh_string">'exit'</span><span class="sh_symbol">,</span> <span class="sh_keyword">function</span><span class="sh_symbol">(</span>code<span class="sh_symbol">,</span> signal<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">if</span><span class="sh_symbol">(</span> signal <span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"worker was killed by signal: "</span><span class="sh_symbol">+</span>signal<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_keyword">if</span><span class="sh_symbol">(</span> code <span class="sh_symbol">!==</span> <span class="sh_number">0</span> <span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"worker exited with error code: "</span><span class="sh_symbol">+</span>code<span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span><span class="sh_string">"worker success!"</span><span class="sh_symbol">);</span>
  <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">);</span></code></pre>
<h3>Event: 'error'<a id="all_event_error_7" class="mark" href="#all_event_error_7">#</a></h3>
<p>This event is the same as the one provided by <code>child_process.fork()</code>.</p>
<p>In a worker you can also use <code>process.on('error')</code>.</p>
<h1>Smalloc<a id="all_smalloc" class="mark" href="#all_smalloc">#</a></h1>
<pre class="api_stability_1 sh_sourceCode">Stability<span class="sh_symbol">:</span> <span class="sh_number">1</span> <span class="sh_symbol">-</span> Experimental</pre>
<h2>Class: smalloc<a id="all_class_smalloc" class="mark" href="#all_class_smalloc">#</a></h2>
<p>Buffers are backed by a simple allocator that only handles the assignation of external raw memory. Smalloc exposes that functionality.</p>
<h3>smalloc.alloc(length[, receiver][, type])<a id="all_smalloc_alloc_length_receiver_type" class="mark" href="#all_smalloc_alloc_length_receiver_type">#</a></h3>
<div class="signature">
<ul>
<li><code>length</code> <span class="type">Number</span> <code>&lt;= smalloc.kMaxLength</code></li>
<li><code>receiver</code> <span class="type">Object</span> Default: <code>new Object</code></li>
<li><code>type</code> <span class="type">Enum</span> Default: <code>Uint8</code></li>
</ul>
</div>
<p>Returns <code>receiver</code> with allocated external array data. If no <code>receiver</code> is passed then a new Object will be created and returned.</p>
<p>This can be used to create your own Buffer-like classes. No other properties are set, so the user will need to keep track of other necessary information (e.g. <code>length</code> of the allocation).</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">function</span> <span class="sh_function">SimpleData</span><span class="sh_symbol">(</span>n<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>length <span class="sh_symbol">=</span> n<span class="sh_symbol">;</span>
  smalloc<span class="sh_symbol">.</span><span class="sh_function">alloc</span><span class="sh_symbol">(</span><span class="sh_keyword">this</span><span class="sh_symbol">.</span>length<span class="sh_symbol">,</span> <span class="sh_keyword">this</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

SimpleData<span class="sh_symbol">.</span><span class="sh_keyword">prototype</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span> <span class="sh_comment">/* ... */</span> <span class="sh_cbracket">}</span><span class="sh_symbol">;</span></code></pre>
<p>It only checks if the <code>receiver</code> is an Object, and also not an Array. Because of this it is possible to allocate external array data to more than a plain Object.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">function</span> <span class="sh_function">allocMe</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span> <span class="sh_cbracket">}</span>
smalloc<span class="sh_symbol">.</span><span class="sh_function">alloc</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> allocMe<span class="sh_symbol">);</span>

<span class="sh_comment">// { [Function allocMe] '0': 0, '1': 0, '2': 0 }</span></code></pre>
<p>v8 does not support allocating external array data to an Array, and if passed will throw.</p>
<p>It's possible to specify the type of external array data you would like. All possible options are listed in <code>smalloc.Types</code>. Example usage:</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> doubleArr <span class="sh_symbol">=</span> smalloc<span class="sh_symbol">.</span><span class="sh_function">alloc</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> smalloc<span class="sh_symbol">.</span>Types<span class="sh_symbol">.</span>Double<span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">3</span><span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
  doubleArr <span class="sh_symbol">=</span> <span class="sh_normal">i </span><span class="sh_symbol">/</span> <span class="sh_number">10</span><span class="sh_symbol">;</span>

<span class="sh_comment">// { '0': 0, '1': 0.1, '2': 0.2 }</span></code></pre>
<p>It is not possible to freeze, seal and prevent extensions of objects with external data using <code>Object.freeze</code>, <code>Object.seal</code> and <code>Object.preventExtensions</code> respectively.</p>
<h3>smalloc.copyOnto(source, sourceStart, dest, destStart, copyLength);<a id="all_smalloc_copyonto_source_sourcestart_dest_deststart_copylength" class="mark" href="#all_smalloc_copyonto_source_sourcestart_dest_deststart_copylength">#</a></h3>
<div class="signature">
<ul>
<li><code>source</code> <span class="type">Object</span> with external array allocation</li>
<li><code>sourceStart</code> <span class="type">Number</span> Position to begin copying from</li>
<li><code>dest</code> <span class="type">Object</span> with external array allocation</li>
<li><code>destStart</code> <span class="type">Number</span> Position to begin copying onto</li>
<li><code>copyLength</code> <span class="type">Number</span> Length of copy</li>
</ul>
</div>
<p>Copy memory from one external array allocation to another. No arguments are optional, and any violation will throw.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> a <span class="sh_symbol">=</span> smalloc<span class="sh_symbol">.</span><span class="sh_function">alloc</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> b <span class="sh_symbol">=</span> smalloc<span class="sh_symbol">.</span><span class="sh_function">alloc</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>

<span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_keyword">var</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">4</span><span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_cbracket">{</span>
  a<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> i<span class="sh_symbol">;</span>
  b<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> i <span class="sh_symbol">*</span> <span class="sh_number">2</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

<span class="sh_comment">// { '0': 0, '1': 1, '2': 2, '3': 3 }</span>
<span class="sh_comment">// { '0': 0, '1': 2, '2': 4, '3': 6 }</span>

smalloc<span class="sh_symbol">.</span><span class="sh_function">copyOnto</span><span class="sh_symbol">(</span>b<span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> a<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>

<span class="sh_comment">// { '0': 4, '1': 6, '2': 2, '3': 3 }</span></code></pre>
<p><code>copyOnto</code> automatically detects the length of the allocation internally, so no need to set any additional properties for this to work.</p>
<h3>smalloc.dispose(obj)<a id="all_smalloc_dispose_obj" class="mark" href="#all_smalloc_dispose_obj">#</a></h3>
<div class="signature">
<ul>
<li><code>obj</code> Object</li>
</ul>
</div>
<p>Free memory that has been allocated to an object via <code>smalloc.alloc</code>.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> a <span class="sh_symbol">=</span> <span class="sh_cbracket">{}</span><span class="sh_symbol">;</span>
smalloc<span class="sh_symbol">.</span><span class="sh_function">alloc</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> a<span class="sh_symbol">);</span>

<span class="sh_comment">// { '0': 0, '1': 0, '2': 0 }</span>

smalloc<span class="sh_symbol">.</span><span class="sh_function">dispose</span><span class="sh_symbol">(</span>a<span class="sh_symbol">);</span>

<span class="sh_comment">// {}</span></code></pre>
<p>This is useful to reduce strain on the garbage collector, but developers must be careful. Cryptic errors may arise in applications that are difficult to trace.</p>
<pre class="sh_sourceCode"><code><span class="sh_keyword">var</span> a <span class="sh_symbol">=</span> smalloc<span class="sh_symbol">.</span><span class="sh_function">alloc</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>
<span class="sh_keyword">var</span> b <span class="sh_symbol">=</span> smalloc<span class="sh_symbol">.</span><span class="sh_function">alloc</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">);</span>

<span class="sh_comment">// perform this somewhere along the line</span>
smalloc<span class="sh_symbol">.</span><span class="sh_function">dispose</span><span class="sh_symbol">(</span>b<span class="sh_symbol">);</span>

<span class="sh_comment">// now trying to copy some data out</span>
smalloc<span class="sh_symbol">.</span><span class="sh_function">copyOnto</span><span class="sh_symbol">(</span>b<span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> a<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>

<span class="sh_comment">// now results in:</span>
<span class="sh_comment">// RangeError: copy_length &gt; source_length</span></code></pre>
<p>After <code>dispose()</code> is called object still behaves as one with external data, for example <code>smalloc.hasExternalData()</code> returns <code>true</code>. <code>dispose()</code> does not support Buffers, and will throw if passed.</p>
<h3>smalloc.hasExternalData(obj)<a id="all_smalloc_hasexternaldata_obj" class="mark" href="#all_smalloc_hasexternaldata_obj">#</a></h3>
<div class="signature">
<ul>
<li><code>obj</code> <span class="type">Object</span></li>
</ul>
</div>
<p>Returns <code>true</code> if the <code>obj</code> has externally allocated memory.</p>
<h3>smalloc.kMaxLength<a id="all_smalloc_kmaxlength" class="mark" href="#all_smalloc_kmaxlength">#</a></h3>
<p>Size of maximum allocation. This is also applicable to Buffer creation.</p>
<h3>smalloc.Types<a id="all_smalloc_types" class="mark" href="#all_smalloc_types">#</a></h3>
<p>Enum of possible external array types. Contains:</p>
<ul>
<li><code>Int8</code></li>
<li><code>Uint8</code></li>
<li><code>Int16</code></li>
<li><code>Uint16</code></li>
<li><code>Int32</code></li>
<li><code>Uint32</code></li>
<li><code>Float</code></li>
<li><code>Double</code></li>
<li><code>Uint8Clamped</code></li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div class="foot-1">
<h5>The Node.js Project is Sponsored by</h5>
<a href="http://www.joyent.com"><img src="https://nodejs.org/api/assets/joyent-footer.svg" alt="" width="200" /></a>
<p class="tag">Production Node +<br />High Performance Infrastructure</p>
<a class="button getstarted" href="https://my.joyent.com/landing/signup/701800000015696">Get Started</a></div>
<div class="foot-2">
<div class="foot-nav">
<ul>
<li><a href="http://nodejs.org/download/">Downloads</a></li>
</ul>
<ul>
<li><a href="http://nodejs.org/documentation/">Documentation</a></li>
<li><a href="http://nodejs.org/api/">API Docs</a></li>
<li><a href="http://nodejs.org/documentation/tutorials/">Tutorials</a></li>
<li><a href="http://nodejs.org/documentation/localization/">Localization</a></li>
</ul>
<ul>
<li><a href="http://nodejs.org/community/">Community</a></li>
<li><a href="https://github.com/joyent/node/issues">Github Issues</a></li>
<li><a href="http://groups.google.com/group/nodejs">Mailing List</a></li>
<li><a href="http://webchat.freenode.net/?channels=node.js">IRC</a></li>
<li><a href="https://twitter.com/nodejs">Twitter</a></li>
</ul>
<ul>
<li><a href="http://nodejs.org/about/">About</a></li>
<li><a href="http://nodejs.org/about/organization/">Organization</a></li>
<li><a href="http://nodejs.org/about/core-team/">Core Team</a></li>
<li><a href="http://nodejs.org/about/resources/">Resources</a></li>
</ul>
<ul>
<li><a href="http://blog.nodejs.org">Blog</a></li>
</ul>
</div>
<p class="copyright">Copyright 2014 <a href="http://joyent.com/">Joyent, Inc</a>, Node.js is a <a href="https://nodejs.org/images/trademark-policy.pdf">trademark</a> of Joyent, Inc. <a href="https://raw.github.com/joyent/node/v0.12.7/LICENSE">View license</a>.</p>
</div>
</div>
</body>
</html>