<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>iron-router.html</title>
	<link rel="stylesheet" href="../../css/main.css"> 
	<script src='../../lib/jquery-1.8.0.min.js'></script>
	<script src='../../lib/pCfg.js'></script>
	<script src='../../lib/table_search.js'></script>
	<script>
	var cfg = {
		labels: ['dynamic', 'link', 'render', 'yield']
	};
	</script>
</head>
<body>
	<p>https://github.com/eventedmind/iron-router/blob/master/examples</p>

	<p>https://github.com/EventedMind/class-using-iron-router</p>

<p>https://github.com/EventedMind/class-using-iron-router</p>


	<table>
		<tr>
			<td>dynamic</td>
			<td>
				<xmp>
{{> yield }}
					
Router.route('/', function(){
	var isLoggedIn = Session.get('isLoggedIn');

	if(isLoggedIn)
		this.render('Home');
	else 
		this.render('Login');
})					
				</xmp>
			</td>
		</tr>
		<tr>
			<td>dynamic</td>
			<td>
				<xmp>
<a href="/blog/1">1i</a>
<a href="/blog/2?q1=h1&q2=h2">2i</a>
<a href="/blog/3">3i</a>

<template name="Article">todolist</template>

Router.route('blog/:_id', function(){
	console.dir(this.params._id);
	console.log(this.params.query.q1);

	this.layout('Layout');
	this.render('Article');
});					
				</xmp>
			</td>
		</tr>
		<tr>
			<td>links</td>
			<td>
				<xmp>
{{#each articles}}
	<a href="/blog/{{id}}">{{title}}</a>
	
	<a href="{{ pathFor 'article.show' query='q1=h1' hash='hashfrag'}}">{{title}}</a>
	
	<a href="{{ urlFor 'article.show' query='q1=h1' hash='hashfrag'}}">{{title}}</a>
	
	{{#linkTo route='article.show' query='q1=h1' hash='hashfrag'}}
		<div>{{title}}</div>
	{{/linkTo}}
{{/each}}					
				</xmp>
			</td>
		</tr>
		<tr>
			<td>render data</td>
			<td>
				<xmp>
<template name="Article">
{{#with }}
	<h1>{{title}}</h1>
{{/with}}
</template>					

this.layout('Layout', {data: function(){
	return Articles.findOne({_id, this.params.id});
	return {title: 'Sample', author: 'Author'};
}});

this.render('Article', {data: function(){
	return Articles.findOne({_id, this.params.id});
	return {title: 'Sample', author: 'Author'};
}});

				</xmp>
			</td>
		</tr>
		<tr>
			<td>yield contentFor</td>
			<td>
				<xmp>
<head>
  <title>Routing App</title>
</head>

<body>
</body>

<template name="Layout">
  <div class="login">
    {{> loginButtons}}
  </div>

  <div class="container">
    <div id="new-article">
      {{#linkTo route="article.new"}}
        New Article
      {{/linkTo}}
    </div>

    <ul class="breadcrumb">
      {{> yield "breadcrumbs"}}
    </ul>

    <div class="content">
      {{> yield}}
    </div>
  </div>
</template>

<template name="Blog">
  {{#contentFor "breadcrumbs"}}
    <li>
      {{#linkTo route="home"}}
        Home
      {{/linkTo}}
    </li>
  {{/contentFor}}

  <h1>Blog</h1>

  <ul>
    {{#each articles}}
      <li>
        {{#linkTo route='article.show' query='q=search+string' hash='frashfrag'}}
          <div>
            {{title}}
          </div>
        {{/linkTo}}
      </li>
    {{/each}}
  </ul>
</template>

<template name="Article">
  {{#contentFor "breadcrumbs"}}
    <li>
      {{#linkTo route="home"}}
        Home
      {{/linkTo}}
    </li>
    <li>
      <span class="divider">/</span>
    </li>
    <li>
      {{title}}
    </li>
  {{/contentFor}}

  <h1>
    {{title}}
  </h1>

  <div>
    {{author}}
  </div>

  <p>
    {{body}}
  </p>
</template>

<template name="ArticleNew">
  {{#contentFor "breadcrumbs"}}
    <li>
      {{#linkTo route="home"}}
        Home
      {{/linkTo}}
    </li>
    <li><span class="divider">/</span></li>
    <li>
      New Article
    </li>
  {{/contentFor}}

  <form id="new-article">
    <div class="field">
      <input type="text" name="title" placeholder="Title">
    </div>
    <div class="field">
      <textarea name="body" placeholder="Body..."></textarea>
    </div>
    <div class="form-actions">
      <input class="btn" type="submit" value="Save">
    </div>
  </form>
</template>

<template name="Loading">
  Hang tight I'm loading...
</template>					
				</xmp>
			</td>
		</tr>
		<tr>
			<td>config layout</td>
			<td>
				<xmp>
Router.configure({
	layoutTemplate: 'Layout'	
});		

Router.route('/', {
	name: 'home',
	template: 'Blog',
	action: function(){
		this.layout('Layout2');
		this.render('Blog');
	}
});		
				</xmp>
			</td>
		</tr>
		<tr>
			<td>json</td>
			<td>
				<xmp>
Router.use(Router.bodyParser.json());

Router.route('/webhooks/stripe', {name: 'webhooks.stripe', where: 'server'}).post(function(){
	var json = this.request.body;
	this.response.end("You posted" + JSON.stringify(json) + "\n");
});					
				</xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<xmp></xmp>
			</td>
		</tr>
	</table>
</body>
</html>